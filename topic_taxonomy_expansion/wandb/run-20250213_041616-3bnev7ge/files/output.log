/n/home09/michaelzhao/Downloads/topicexpan/myenv/lib/python3.12/site-packages/transformers/training_args.py:1568: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
/n/home09/michaelzhao/Downloads/thesis/topic_taxonomy_expansion/sweep_bart.py:102: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Seq2SeqTrainer.__init__`. Use `processing_class` instead.
  trainer = Seq2SeqTrainer(
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
wandb: WARNING The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
wandb: WARNING Config item 'dropout' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'length_penalty' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'output_dir' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'learning_rate' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'num_train_epochs' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'warmup_steps' was locked by 'sweep' (ignored update).
  0%|          | 0/1038 [00:00<?, ?it/s]/n/home09/michaelzhao/Downloads/topicexpan/myenv/lib/python3.12/site-packages/torch/nn/parallel/parallel_apply.py:79: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.device(device), torch.cuda.stream(stream), autocast(enabled=autocast_enabled):
/n/home09/michaelzhao/Downloads/topicexpan/myenv/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '




































































































































































 48%|████▊     | 500/1038 [05:30<05:59,  1.50it/s]
{'loss': 4.87, 'grad_norm': 124697.859375, 'learning_rate': 2.9343337866334513e-05, 'epoch': 2.89}






 84%|████████▍ | 37/44 [00:11<00:02,  2.73it/s]








































































































































































 96%|█████████▌| 999/1038 [11:20<00:25,  1.52it/s]
 96%|█████████▋| 1000/1038 [11:21<00:24,  1.52it/s]






 95%|█████████▌| 42/44 [00:13<00:00,  2.89it/s]













100%|█████████▉| 1037/1038 [12:00<00:00,  1.45it/s]
{'train_runtime': 721.0732, 'train_samples_per_second': 22.908, 'train_steps_per_second': 1.44, 'train_loss': 2.933494865549782, 'epoch': 6.0}

100%|██████████| 1038/1038 [12:01<00:00,  1.44it/s]
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
  0%|          | 0/44 [00:00<?, ?it/s]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
  5%|▍         | 2/44 [00:09<03:23,  4.84s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
  7%|▋         | 3/44 [00:20<05:08,  7.53s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
  9%|▉         | 4/44 [00:25<04:16,  6.40s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 11%|█▏        | 5/44 [00:35<05:05,  7.83s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 14%|█▎        | 6/44 [00:45<05:19,  8.40s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 16%|█▌        | 7/44 [00:56<05:43,  9.27s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 18%|█▊        | 8/44 [01:06<05:45,  9.60s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 20%|██        | 9/44 [01:17<05:46,  9.89s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 23%|██▎       | 10/44 [01:27<05:42, 10.08s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 25%|██▌       | 11/44 [01:37<05:26,  9.89s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 27%|██▋       | 12/44 [01:47<05:16,  9.90s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.

 30%|██▉       | 13/44 [01:57<05:08,  9.94s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 32%|███▏      | 14/44 [02:07<04:57,  9.91s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 34%|███▍      | 15/44 [02:17<04:47,  9.91s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 36%|███▋      | 16/44 [02:27<04:37,  9.90s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 39%|███▊      | 17/44 [02:36<04:26,  9.88s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 41%|████      | 18/44 [02:46<04:17,  9.91s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 43%|████▎     | 19/44 [02:58<04:18, 10.34s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.ou should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.ou should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 50%|█████     | 22/44 [03:29<03:48, 10.39s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 52%|█████▏    | 23/44 [03:39<03:37, 10.38s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 52%|█████▏    | 23/44 [03:39<03:37, 10.38s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 55%|█████▍    | 24/44 [03:51<03:33, 10.69s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 55%|█████▍    | 24/44 [03:51<03:33, 10.69s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 57%|█████▋    | 25/44 [04:01<03:19, 10.49s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 59%|█████▉    | 26/44 [04:11<03:05, 10.30s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 61%|██████▏   | 27/44 [04:20<02:52, 10.14s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 64%|██████▎   | 28/44 [04:32<02:47, 10.47s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 66%|██████▌   | 29/44 [04:43<02:41, 10.77s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 68%|██████▊   | 30/44 [04:54<02:30, 10.73s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 70%|███████   | 31/44 [05:03<02:14, 10.35s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 73%|███████▎  | 32/44 [05:14<02:04, 10.34s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 75%|███████▌  | 33/44 [05:24<01:54, 10.43s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 77%|███████▋  | 34/44 [05:34<01:43, 10.38s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 80%|███████▉  | 35/44 [05:42<01:26,  9.58s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 82%|████████▏ | 36/44 [05:44<00:58,  7.33s/it] use Trainer.processing_class instead.ou should use Trainer.processing_class instead.
 84%|████████▍ | 37/44 [05:49<00:45,  6.46s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 86%|████████▋ | 38/44 [05:53<00:35,  5.92s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 89%|████████▊ | 39/44 [05:58<00:27,  5.50s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 91%|█████████ | 40/44 [06:02<00:20,  5.24s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 93%|█████████▎| 41/44 [06:07<00:15,  5.07s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 95%|█████████▌| 42/44 [06:12<00:09,  4.91s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 98%|█████████▊| 43/44 [06:16<00:04,  4.85s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
100%|██████████| 44/44 [06:18<00:00,  8.61s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
100%|██████████| 44/44 [06:18<00:00,  8.61s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Saved evaluation results to ./lora_bart_subtopics_sweep/eval_results_64_64_4_2.9343337866334513e-05_6_4.371725226888382_0.0718643927395994.csv