/n/home09/michaelzhao/Downloads/topicexpan/myenv/lib/python3.12/site-packages/transformers/training_args.py:1568: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
/n/home09/michaelzhao/Downloads/thesis/topic_taxonomy_expansion/sweep_bart.py:102: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Seq2SeqTrainer.__init__`. Use `processing_class` instead.
  trainer = Seq2SeqTrainer(
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
wandb: WARNING The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
wandb: WARNING Config item 'dropout' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'length_penalty' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'output_dir' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'learning_rate' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'num_train_epochs' was locked by 'sweep' (ignored update).
wandb: WARNING Config item 'warmup_steps' was locked by 'sweep' (ignored update).
  0%|          | 0/1557 [00:00<?, ?it/s]/n/home09/michaelzhao/Downloads/topicexpan/myenv/lib/python3.12/site-packages/torch/nn/parallel/parallel_apply.py:79: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.device(device), torch.cuda.stream(stream), autocast(enabled=autocast_enabled):
/n/home09/michaelzhao/Downloads/topicexpan/myenv/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '




























































































































































 32%|███▏      | 500/1557 [05:16<10:12,  1.73it/s]
{'loss': 9.3795, 'grad_norm': 108001.9609375, 'learning_rate': 3.710851258229632e-06, 'epoch': 2.89}





 93%|█████████▎| 41/44 [00:11<00:00,  3.59it/s]



























































































































































 64%|██████▍   | 998/1557 [10:38<05:46,  1.61it/s]
 64%|██████▍   | 1000/1557 [10:39<06:07,  1.52it/s]





 86%|████████▋ | 38/44 [00:10<00:01,  3.51it/s]






































































































































 96%|█████████▋| 1500/1557 [15:19<00:21,  2.60it/s]
{'loss': 6.193, 'grad_norm': 127704.53125, 'learning_rate': 3.9315710356707996e-07, 'epoch': 8.67}



 82%|████████▏ | 36/44 [00:07<00:01,  4.34it/s]












100%|█████████▉| 1554/1557 [15:50<00:01,  2.28it/s]
{'train_runtime': 951.822, 'train_samples_per_second': 26.031, 'train_steps_per_second': 1.636, 'train_loss': 7.74516634490908, 'epoch': 9.0}

100%|██████████| 1557/1557 [15:51<00:00,  1.64it/s]
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
  0%|          | 0/44 [00:00<?, ?it/s]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
  5%|▍         | 2/44 [00:06<02:09,  3.09s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
  7%|▋         | 3/44 [00:12<03:09,  4.62s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
  9%|▉         | 4/44 [00:18<03:14,  4.87s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 11%|█▏        | 5/44 [00:24<03:28,  5.35s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 14%|█▎        | 6/44 [00:29<03:25,  5.39s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 16%|█▌        | 7/44 [00:36<03:32,  5.75s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 18%|█▊        | 8/44 [00:42<03:33,  5.93s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 20%|██        | 9/44 [00:50<03:44,  6.41s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 23%|██▎       | 10/44 [00:55<03:25,  6.04s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.ou should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.ou should use Trainer.processing_class instead.
Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 27%|██▋       | 12/44 [01:09<03:26,  6.45s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 30%|██▉       | 13/44 [01:16<03:30,  6.80s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 32%|███▏      | 14/44 [01:23<03:20,  6.67s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 34%|███▍      | 15/44 [01:30<03:22,  6.97s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 34%|███▍      | 15/44 [01:30<03:22,  6.97s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 36%|███▋      | 16/44 [01:36<03:06,  6.67s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 39%|███▊      | 17/44 [01:43<02:57,  6.59s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 41%|████      | 18/44 [01:48<02:45,  6.37s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 43%|████▎     | 19/44 [01:55<02:38,  6.35s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 45%|████▌     | 20/44 [02:02<02:36,  6.51s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 48%|████▊     | 21/44 [02:08<02:30,  6.55s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 50%|█████     | 22/44 [02:15<02:24,  6.56s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 52%|█████▏    | 23/44 [02:21<02:16,  6.51s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 55%|█████▍    | 24/44 [02:28<02:11,  6.55s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 57%|█████▋    | 25/44 [02:35<02:09,  6.82s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 59%|█████▉    | 26/44 [02:41<01:58,  6.57s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 61%|██████▏   | 27/44 [02:47<01:48,  6.36s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 64%|██████▎   | 28/44 [02:53<01:37,  6.10s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 66%|██████▌   | 29/44 [02:59<01:34,  6.27s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 68%|██████▊   | 30/44 [03:06<01:28,  6.32s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 70%|███████   | 31/44 [03:09<01:09,  5.38s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 73%|███████▎  | 32/44 [03:12<00:54,  4.54s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 75%|███████▌  | 33/44 [03:14<00:42,  3.89s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 77%|███████▋  | 34/44 [03:16<00:34,  3.44s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 80%|███████▉  | 35/44 [03:19<00:29,  3.29s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 82%|████████▏ | 36/44 [03:22<00:24,  3.07s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 84%|████████▍ | 37/44 [03:24<00:20,  2.91s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 86%|████████▋ | 38/44 [03:27<00:16,  2.74s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 89%|████████▊ | 39/44 [03:29<00:13,  2.70s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 91%|█████████ | 40/44 [03:32<00:10,  2.62s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 93%|█████████▎| 41/44 [03:34<00:07,  2.59s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 95%|█████████▌| 42/44 [03:37<00:05,  2.67s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 98%|█████████▊| 43/44 [03:39<00:02,  2.57s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
 98%|█████████▊| 43/44 [03:39<00:02,  2.57s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
100%|██████████| 44/44 [03:40<00:00,  5.02s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.
100%|██████████| 44/44 [03:40<00:00,  5.02s/it]Trainer.tokenizer is now deprecated. You should use Trainer.processing_class instead.