Generating data split: 0 examples [00:00, ? examples/s]Generating data split: 1061 examples [00:00, 4910.64 examples/s]Generating data split: 1061 examples [00:00, 1325.79 examples/s]
Map:   0%|          | 0/1061 [00:00<?, ? examples/s]Map:  94%|█████████▍| 1000/1061 [00:00<00:00, 1736.96 examples/s]Map: 100%|██████████| 1061/1061 [00:00<00:00, 1093.30 examples/s]
Generating predictions:   0%|          | 0/133 [00:00<?, ?it/s]Generating predictions:   1%|          | 1/133 [00:07<16:17,  7.41s/it]Generating predictions:   2%|▏         | 2/133 [00:07<06:58,  3.20s/it]Generating predictions:   2%|▏         | 3/133 [00:07<04:01,  1.86s/it]Generating predictions:   3%|▎         | 4/133 [00:08<02:36,  1.22s/it]Generating predictions:   4%|▍         | 5/133 [00:08<01:50,  1.16it/s]Generating predictions:   5%|▍         | 6/133 [00:08<01:22,  1.54it/s]Generating predictions:   5%|▌         | 7/133 [00:08<01:05,  1.93it/s]Generating predictions:   6%|▌         | 8/133 [00:09<00:53,  2.33it/s]Generating predictions:   7%|▋         | 9/133 [00:09<00:45,  2.71it/s]Generating predictions:   8%|▊         | 10/133 [00:09<00:40,  3.02it/s]Generating predictions:   8%|▊         | 11/133 [00:09<00:37,  3.27it/s]Generating predictions:   9%|▉         | 12/133 [00:10<00:35,  3.42it/s]Generating predictions:  10%|▉         | 13/133 [00:10<00:33,  3.59it/s]Generating predictions:  11%|█         | 14/133 [00:10<00:32,  3.71it/s]Generating predictions:  11%|█▏        | 15/133 [00:10<00:31,  3.80it/s]Generating predictions:  12%|█▏        | 16/133 [00:11<00:29,  3.92it/s]Generating predictions:  13%|█▎        | 17/133 [00:11<00:29,  3.96it/s]Generating predictions:  14%|█▎        | 18/133 [00:11<00:31,  3.70it/s]Generating predictions:  14%|█▍        | 19/133 [00:11<00:30,  3.70it/s]Generating predictions:  15%|█▌        | 20/133 [00:12<00:29,  3.85it/s]Generating predictions:  16%|█▌        | 21/133 [00:12<00:27,  4.01it/s]Generating predictions:  17%|█▋        | 22/133 [00:12<00:28,  3.96it/s]Generating predictions:  17%|█▋        | 23/133 [00:12<00:28,  3.91it/s]Generating predictions:  18%|█▊        | 24/133 [00:13<00:27,  3.95it/s]Generating predictions:  19%|█▉        | 25/133 [00:13<00:28,  3.80it/s]Generating predictions:  20%|█▉        | 26/133 [00:13<00:27,  3.92it/s]Generating predictions:  20%|██        | 27/133 [00:13<00:27,  3.89it/s]Generating predictions:  21%|██        | 28/133 [00:14<00:26,  3.94it/s]Generating predictions:  22%|██▏       | 29/133 [00:14<00:26,  3.96it/s]Generating predictions:  23%|██▎       | 30/133 [00:14<00:25,  3.99it/s]Generating predictions:  23%|██▎       | 31/133 [00:14<00:25,  4.00it/s]Generating predictions:  24%|██▍       | 32/133 [00:15<00:25,  3.95it/s]Generating predictions:  25%|██▍       | 33/133 [00:15<00:24,  4.04it/s]Generating predictions:  26%|██▌       | 34/133 [00:15<00:24,  3.98it/s]Generating predictions:  26%|██▋       | 35/133 [00:15<00:24,  3.99it/s]Generating predictions:  27%|██▋       | 36/133 [00:16<00:24,  4.00it/s]Generating predictions:  28%|██▊       | 37/133 [00:16<00:24,  3.96it/s]Generating predictions:  29%|██▊       | 38/133 [00:16<00:23,  3.97it/s]Generating predictions:  29%|██▉       | 39/133 [00:16<00:23,  3.99it/s]Generating predictions:  30%|███       | 40/133 [00:17<00:23,  3.88it/s]Generating predictions:  31%|███       | 41/133 [00:17<00:23,  3.92it/s]Generating predictions:  32%|███▏      | 42/133 [00:17<00:22,  4.02it/s]Generating predictions:  32%|███▏      | 43/133 [00:17<00:22,  4.02it/s]Generating predictions:  33%|███▎      | 44/133 [00:18<00:22,  3.91it/s]Generating predictions:  34%|███▍      | 45/133 [00:18<00:21,  4.00it/s]Generating predictions:  35%|███▍      | 46/133 [00:18<00:21,  4.01it/s]Generating predictions:  35%|███▌      | 47/133 [00:18<00:21,  4.02it/s]Generating predictions:  36%|███▌      | 48/133 [00:19<00:21,  4.03it/s]Generating predictions:  37%|███▋      | 49/133 [00:19<00:21,  3.97it/s]Generating predictions:  38%|███▊      | 50/133 [00:19<00:20,  3.98it/s]Generating predictions:  38%|███▊      | 51/133 [00:19<00:20,  4.00it/s]Generating predictions:  39%|███▉      | 52/133 [00:20<00:20,  4.00it/s]Generating predictions:  40%|███▉      | 53/133 [00:20<00:19,  4.01it/s]Generating predictions:  41%|████      | 54/133 [00:20<00:19,  3.95it/s]Generating predictions:  41%|████▏     | 55/133 [00:20<00:19,  3.98it/s]Generating predictions:  42%|████▏     | 56/133 [00:21<00:19,  3.94it/s]Generating predictions:  43%|████▎     | 57/133 [00:21<00:20,  3.79it/s]Generating predictions:  44%|████▎     | 58/133 [00:21<00:19,  3.80it/s]Generating predictions:  44%|████▍     | 59/133 [00:22<00:19,  3.87it/s]Generating predictions:  45%|████▌     | 60/133 [00:22<00:18,  3.98it/s]Generating predictions:  46%|████▌     | 61/133 [00:22<00:18,  3.99it/s]Generating predictions:  47%|████▋     | 62/133 [00:22<00:17,  3.95it/s]Generating predictions:  47%|████▋     | 63/133 [00:22<00:17,  3.97it/s]Generating predictions:  48%|████▊     | 64/133 [00:23<00:16,  4.12it/s]Generating predictions:  49%|████▉     | 65/133 [00:23<00:16,  4.10it/s]Generating predictions:  50%|████▉     | 66/133 [00:23<00:16,  3.96it/s]Generating predictions:  50%|█████     | 67/133 [00:23<00:16,  4.04it/s]Generating predictions:  51%|█████     | 68/133 [00:24<00:15,  4.10it/s]Generating predictions:  52%|█████▏    | 69/133 [00:24<00:16,  3.90it/s]Generating predictions:  53%|█████▎    | 70/133 [00:24<00:16,  3.93it/s]Generating predictions:  53%|█████▎    | 71/133 [00:25<00:15,  3.90it/s]Generating predictions:  54%|█████▍    | 72/133 [00:25<00:15,  4.01it/s]Generating predictions:  55%|█████▍    | 73/133 [00:25<00:14,  4.02it/s]Generating predictions:  56%|█████▌    | 74/133 [00:25<00:14,  3.97it/s]Generating predictions:  56%|█████▋    | 75/133 [00:26<00:14,  3.93it/s]Generating predictions:  57%|█████▋    | 76/133 [00:26<00:14,  3.96it/s]Generating predictions:  58%|█████▊    | 77/133 [00:26<00:14,  3.98it/s]Generating predictions:  59%|█████▊    | 78/133 [00:26<00:13,  4.00it/s]Generating predictions:  59%|█████▉    | 79/133 [00:26<00:13,  4.01it/s]Generating predictions:  60%|██████    | 80/133 [00:27<00:13,  4.02it/s]Generating predictions:  61%|██████    | 81/133 [00:27<00:13,  3.96it/s]Generating predictions:  62%|██████▏   | 82/133 [00:27<00:12,  4.04it/s]Generating predictions:  62%|██████▏   | 83/133 [00:27<00:12,  3.98it/s]Generating predictions:  63%|██████▎   | 84/133 [00:28<00:12,  3.88it/s]Generating predictions:  64%|██████▍   | 85/133 [00:28<00:12,  3.98it/s]Generating predictions:  65%|██████▍   | 86/133 [00:28<00:11,  3.97it/s]Generating predictions:  65%|██████▌   | 87/133 [00:29<00:11,  3.94it/s]Generating predictions:  66%|██████▌   | 88/133 [00:29<00:11,  4.02it/s]Generating predictions:  67%|██████▋   | 89/133 [00:29<00:10,  4.08it/s]Generating predictions:  68%|██████▊   | 90/133 [00:29<00:10,  4.00it/s]Generating predictions:  68%|██████▊   | 91/133 [00:30<00:10,  3.89it/s]Generating predictions:  69%|██████▉   | 92/133 [00:30<00:10,  3.94it/s]Generating predictions:  70%|██████▉   | 93/133 [00:30<00:10,  3.86it/s]Generating predictions:  71%|███████   | 94/133 [00:30<00:09,  3.96it/s]Generating predictions:  71%|███████▏  | 95/133 [00:31<00:09,  3.98it/s]Generating predictions:  72%|███████▏  | 96/133 [00:31<00:09,  3.93it/s]Generating predictions:  73%|███████▎  | 97/133 [00:31<00:08,  4.02it/s]Generating predictions:  74%|███████▎  | 98/133 [00:31<00:08,  4.03it/s]Generating predictions:  74%|███████▍  | 99/133 [00:31<00:08,  4.14it/s]Generating predictions:  75%|███████▌  | 100/133 [00:32<00:07,  4.17it/s]Generating predictions:  76%|███████▌  | 101/133 [00:32<00:07,  4.13it/s]Generating predictions:  77%|███████▋  | 102/133 [00:32<00:07,  4.10it/s]Generating predictions:  77%|███████▋  | 103/133 [00:32<00:07,  4.08it/s]Generating predictions:  78%|███████▊  | 104/133 [00:33<00:07,  3.94it/s]Generating predictions:  79%|███████▉  | 105/133 [00:33<00:06,  4.03it/s]Generating predictions:  80%|███████▉  | 106/133 [00:33<00:06,  3.98it/s]Generating predictions:  80%|████████  | 107/133 [00:33<00:06,  4.06it/s]Generating predictions:  81%|████████  | 108/133 [00:34<00:06,  4.06it/s]Generating predictions:  82%|████████▏ | 109/133 [00:34<00:06,  3.99it/s]Generating predictions:  83%|████████▎ | 110/133 [00:34<00:05,  3.95it/s]Generating predictions:  83%|████████▎ | 111/133 [00:34<00:05,  3.98it/s]Generating predictions:  84%|████████▍ | 112/133 [00:35<00:05,  3.99it/s]Generating predictions:  85%|████████▍ | 113/133 [00:35<00:04,  4.01it/s]Generating predictions:  86%|████████▌ | 114/133 [00:35<00:04,  4.02it/s]Generating predictions:  86%|████████▋ | 115/133 [00:35<00:04,  4.02it/s]Generating predictions:  87%|████████▋ | 116/133 [00:36<00:04,  4.08it/s]Generating predictions:  88%|████████▊ | 117/133 [00:36<00:03,  4.13it/s]Generating predictions:  89%|████████▊ | 118/133 [00:36<00:03,  3.98it/s]Generating predictions:  89%|████████▉ | 119/133 [00:36<00:03,  3.99it/s]Generating predictions:  90%|█████████ | 120/133 [00:37<00:03,  4.01it/s]Generating predictions:  91%|█████████ | 121/133 [00:37<00:02,  4.07it/s]Generating predictions:  92%|█████████▏| 122/133 [00:37<00:02,  4.06it/s]Generating predictions:  92%|█████████▏| 123/133 [00:37<00:02,  3.87it/s]Generating predictions:  93%|█████████▎| 124/133 [00:38<00:02,  3.92it/s]Generating predictions:  94%|█████████▍| 125/133 [00:38<00:02,  3.96it/s]Generating predictions:  95%|█████████▍| 126/133 [00:38<00:01,  4.01it/s]Generating predictions:  95%|█████████▌| 127/133 [00:38<00:01,  4.02it/s]Generating predictions:  96%|█████████▌| 128/133 [00:39<00:01,  4.09it/s]Generating predictions:  97%|█████████▋| 129/133 [00:39<00:00,  4.14it/s]Generating predictions:  98%|█████████▊| 130/133 [00:39<00:00,  4.04it/s]Generating predictions:  98%|█████████▊| 131/133 [00:39<00:00,  3.97it/s]Generating predictions:  99%|█████████▉| 132/133 [00:40<00:00,  3.87it/s]Generating predictions: 100%|██████████| 133/133 [00:40<00:00,  4.24it/s]Generating predictions: 100%|██████████| 133/133 [00:40<00:00,  3.29it/s]
regeneration check: 0it [00:00, ?it/s]regeneration check: 1061it [00:00, 67297.12it/s]
Generating embeddings:   0%|          | 0/772 [00:00<?, ?it/s]Generating embeddings:   0%|          | 1/772 [00:00<06:37,  1.94it/s]Generating embeddings:   5%|▌         | 42/772 [00:00<00:08, 90.11it/s]Generating embeddings:  11%|█         | 83/772 [00:00<00:04, 165.34it/s]Generating embeddings:  16%|█▌        | 121/772 [00:00<00:02, 219.25it/s]Generating embeddings:  21%|██        | 162/772 [00:00<00:02, 268.93it/s]Generating embeddings:  26%|██▋       | 203/772 [00:01<00:01, 306.62it/s]Generating embeddings:  32%|███▏      | 244/772 [00:01<00:01, 333.87it/s]Generating embeddings:  37%|███▋      | 285/772 [00:01<00:01, 354.52it/s]Generating embeddings:  42%|████▏     | 326/772 [00:01<00:01, 369.57it/s]Generating embeddings:  48%|████▊     | 367/772 [00:01<00:01, 380.18it/s]Generating embeddings:  53%|█████▎    | 408/772 [00:01<00:00, 387.66it/s]Generating embeddings:  58%|█████▊    | 449/772 [00:01<00:00, 387.96it/s]Generating embeddings:  63%|██████▎   | 490/772 [00:01<00:00, 392.94it/s]Generating embeddings:  69%|██████▉   | 531/772 [00:01<00:00, 396.68it/s]Generating embeddings:  74%|███████▍  | 572/772 [00:01<00:00, 399.34it/s]Generating embeddings:  79%|███████▉  | 613/772 [00:02<00:00, 401.15it/s]Generating embeddings:  85%|████████▍ | 654/772 [00:02<00:00, 402.50it/s]Generating embeddings:  90%|█████████ | 695/772 [00:02<00:00, 403.48it/s]Generating embeddings:  95%|█████████▌| 736/772 [00:02<00:00, 404.15it/s]Generating embeddings: 100%|██████████| 772/772 [00:02<00:00, 317.89it/s]
Traceback (most recent call last):
  File "/n/home09/michaelzhao/Downloads/thesis/topic_taxonomy_expansion/clustering.py", line 277, in <module>
    main()
  File "/n/home09/michaelzhao/Downloads/thesis/topic_taxonomy_expansion/clustering.py", line 128, in main
    misc_embedding = tuple(embeddings["Misc."])
                           ~~~~~~~~~~^^^^^^^^^
KeyError: 'Misc.'
Processing taxonomy:   0%|          | 0/102 [00:00<?, ?it/s]Processing taxonomy:   0%|          | 0/102 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/n/home09/michaelzhao/Downloads/topicexpan/myenv/lib/python3.12/site-packages/pandas/core/indexes/range.py", line 413, in get_loc
    return self._range.index(new_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: 5273 is not in range

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/n/home09/michaelzhao/Downloads/thesis/topic_taxonomy_expansion/topic_generation_2.py", line 92, in <module>
    main()
  File "/n/home09/michaelzhao/Downloads/thesis/topic_taxonomy_expansion/topic_generation_2.py", line 50, in main
    doc_text = original_df.loc[doc_idx, "document"]
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/n/home09/michaelzhao/Downloads/topicexpan/myenv/lib/python3.12/site-packages/pandas/core/indexing.py", line 1183, in __getitem__
    return self.obj._get_value(*key, takeable=self._takeable)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home09/michaelzhao/Downloads/topicexpan/myenv/lib/python3.12/site-packages/pandas/core/frame.py", line 4221, in _get_value
    row = self.index.get_loc(index)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home09/michaelzhao/Downloads/topicexpan/myenv/lib/python3.12/site-packages/pandas/core/indexes/range.py", line 415, in get_loc
    raise KeyError(key) from err
KeyError: 5273
Generating embeddings:   0%|          | 0/3474 [00:00<?, ?it/s]Generating embeddings:   0%|          | 1/3474 [00:00<07:19,  7.90it/s]Generating embeddings:   1%|          | 41/3474 [00:00<00:15, 215.05it/s]Generating embeddings:   2%|▏         | 82/3474 [00:00<00:11, 296.43it/s]Generating embeddings:   4%|▎         | 123/3474 [00:00<00:09, 337.15it/s]Generating embeddings:   5%|▍         | 161/3474 [00:00<00:09, 351.19it/s]Generating embeddings:   6%|▌         | 202/3474 [00:00<00:08, 368.40it/s]Generating embeddings:   7%|▋         | 243/3474 [00:00<00:08, 379.23it/s]Generating embeddings:   8%|▊         | 284/3474 [00:00<00:08, 386.23it/s]Generating embeddings:   9%|▉         | 325/3474 [00:00<00:08, 390.85it/s]Generating embeddings:  11%|█         | 365/3474 [00:01<00:08, 388.46it/s]Generating embeddings:  12%|█▏        | 406/3474 [00:01<00:07, 392.43it/s]Generating embeddings:  13%|█▎        | 447/3474 [00:01<00:07, 394.93it/s]Generating embeddings:  14%|█▍        | 487/3474 [00:01<00:07, 395.42it/s]Generating embeddings:  15%|█▌        | 528/3474 [00:01<00:07, 396.98it/s]Generating embeddings:  16%|█▋        | 569/3474 [00:01<00:07, 398.39it/s]Generating embeddings:  18%|█▊        | 610/3474 [00:01<00:07, 399.31it/s]Generating embeddings:  19%|█▊        | 651/3474 [00:01<00:07, 399.98it/s]Generating embeddings:  20%|█▉        | 692/3474 [00:01<00:06, 400.71it/s]Generating embeddings:  21%|██        | 733/3474 [00:01<00:06, 401.28it/s]Generating embeddings:  22%|██▏       | 774/3474 [00:02<00:06, 401.64it/s]Generating embeddings:  23%|██▎       | 815/3474 [00:02<00:06, 401.49it/s]Generating embeddings:  25%|██▍       | 856/3474 [00:02<00:06, 401.40it/s]Generating embeddings:  26%|██▌       | 897/3474 [00:02<00:06, 401.54it/s]Generating embeddings:  27%|██▋       | 938/3474 [00:02<00:06, 401.71it/s]Generating embeddings:  28%|██▊       | 979/3474 [00:02<00:06, 401.75it/s]Generating embeddings:  29%|██▉       | 1020/3474 [00:02<00:06, 401.78it/s]Generating embeddings:  31%|███       | 1061/3474 [00:02<00:06, 398.40it/s]Generating embeddings:  32%|███▏      | 1101/3474 [00:02<00:05, 398.56it/s]Generating embeddings:  33%|███▎      | 1142/3474 [00:02<00:05, 399.18it/s]Generating embeddings:  34%|███▍      | 1183/3474 [00:03<00:05, 399.66it/s]Generating embeddings:  35%|███▌      | 1224/3474 [00:03<00:05, 399.92it/s]Generating embeddings:  36%|███▋      | 1265/3474 [00:03<00:05, 400.43it/s]Generating embeddings:  38%|███▊      | 1306/3474 [00:03<00:05, 400.50it/s]Generating embeddings:  39%|███▉      | 1347/3474 [00:03<00:05, 399.97it/s]Generating embeddings:  40%|███▉      | 1388/3474 [00:03<00:05, 400.51it/s]Generating embeddings:  41%|████      | 1429/3474 [00:03<00:05, 400.67it/s]Generating embeddings:  42%|████▏     | 1470/3474 [00:03<00:04, 401.08it/s]Generating embeddings:  43%|████▎     | 1511/3474 [00:03<00:04, 401.01it/s]Generating embeddings:  45%|████▍     | 1552/3474 [00:04<00:04, 400.90it/s]Generating embeddings:  46%|████▌     | 1593/3474 [00:04<00:04, 400.90it/s]Generating embeddings:  47%|████▋     | 1634/3474 [00:04<00:04, 400.90it/s]Generating embeddings:  48%|████▊     | 1675/3474 [00:04<00:04, 401.05it/s]Generating embeddings:  49%|████▉     | 1716/3474 [00:04<00:04, 401.19it/s]Generating embeddings:  51%|█████     | 1757/3474 [00:04<00:04, 401.12it/s]Generating embeddings:  52%|█████▏    | 1798/3474 [00:04<00:04, 401.32it/s]Generating embeddings:  53%|█████▎    | 1839/3474 [00:04<00:04, 401.31it/s]Generating embeddings:  54%|█████▍    | 1880/3474 [00:04<00:03, 401.37it/s]Generating embeddings:  55%|█████▌    | 1921/3474 [00:04<00:03, 401.38it/s]Generating embeddings:  56%|█████▋    | 1962/3474 [00:05<00:03, 401.34it/s]Generating embeddings:  58%|█████▊    | 2003/3474 [00:05<00:03, 399.40it/s]Generating embeddings:  59%|█████▉    | 2044/3474 [00:05<00:03, 399.85it/s]Generating embeddings:  60%|██████    | 2085/3474 [00:05<00:03, 400.26it/s]Generating embeddings:  61%|██████    | 2126/3474 [00:05<00:03, 400.65it/s]Generating embeddings:  62%|██████▏   | 2167/3474 [00:05<00:03, 401.05it/s]Generating embeddings:  64%|██████▎   | 2208/3474 [00:05<00:03, 400.78it/s]Generating embeddings:  65%|██████▍   | 2249/3474 [00:05<00:03, 401.15it/s]Generating embeddings:  66%|██████▌   | 2290/3474 [00:05<00:02, 401.15it/s]Generating embeddings:  67%|██████▋   | 2331/3474 [00:05<00:02, 400.94it/s]Generating embeddings:  68%|██████▊   | 2372/3474 [00:06<00:02, 401.06it/s]Generating embeddings:  69%|██████▉   | 2413/3474 [00:06<00:02, 400.95it/s]Generating embeddings:  71%|███████   | 2454/3474 [00:06<00:02, 401.07it/s]Generating embeddings:  72%|███████▏  | 2495/3474 [00:06<00:02, 401.20it/s]Generating embeddings:  73%|███████▎  | 2536/3474 [00:06<00:02, 401.02it/s]Generating embeddings:  74%|███████▍  | 2577/3474 [00:06<00:02, 401.11it/s]Generating embeddings:  75%|███████▌  | 2618/3474 [00:06<00:02, 401.38it/s]Generating embeddings:  77%|███████▋  | 2659/3474 [00:06<00:02, 401.34it/s]Generating embeddings:  78%|███████▊  | 2700/3474 [00:06<00:01, 401.33it/s]Generating embeddings:  79%|███████▉  | 2741/3474 [00:06<00:01, 401.33it/s]Generating embeddings:  80%|████████  | 2782/3474 [00:07<00:01, 401.53it/s]Generating embeddings:  81%|████████▏ | 2823/3474 [00:07<00:01, 401.60it/s]Generating embeddings:  82%|████████▏ | 2864/3474 [00:07<00:01, 401.63it/s]Generating embeddings:  84%|████████▎ | 2905/3474 [00:07<00:01, 399.27it/s]Generating embeddings:  85%|████████▍ | 2946/3474 [00:07<00:01, 399.85it/s]Generating embeddings:  86%|████████▌ | 2987/3474 [00:07<00:01, 400.62it/s]Generating embeddings:  87%|████████▋ | 3028/3474 [00:07<00:01, 401.03it/s]Generating embeddings:  88%|████████▊ | 3069/3474 [00:07<00:01, 401.33it/s]Generating embeddings:  90%|████████▉ | 3110/3474 [00:07<00:00, 400.90it/s]Generating embeddings:  91%|█████████ | 3151/3474 [00:07<00:00, 401.11it/s]Generating embeddings:  92%|█████████▏| 3192/3474 [00:08<00:00, 401.48it/s]Generating embeddings:  93%|█████████▎| 3233/3474 [00:08<00:00, 401.14it/s]Generating embeddings:  94%|█████████▍| 3274/3474 [00:08<00:00, 400.89it/s]Generating embeddings:  95%|█████████▌| 3315/3474 [00:08<00:00, 400.93it/s]Generating embeddings:  97%|█████████▋| 3356/3474 [00:08<00:00, 401.06it/s]Generating embeddings:  98%|█████████▊| 3397/3474 [00:08<00:00, 400.65it/s]Generating embeddings:  99%|█████████▉| 3438/3474 [00:08<00:00, 400.96it/s]Generating embeddings: 100%|██████████| 3474/3474 [00:08<00:00, 394.78it/s]
/n/home09/michaelzhao/Downloads/topicexpan/myenv/lib/python3.12/site-packages/umap/spectral.py:548: UserWarning: Spectral initialisation failed! The eigenvector solver
failed. This is likely due to too small an eigengap. Consider
adding some noise or jitter to your data.

Falling back to random initialisation!
  warn(
/n/home09/michaelzhao/Downloads/topicexpan/myenv/lib/python3.12/site-packages/umap/umap_.py:2462: UserWarning: n_neighbors is larger than the dataset size; truncating to X.shape[0] - 1
  warn(
/n/home09/michaelzhao/Downloads/topicexpan/myenv/lib/python3.12/site-packages/umap/umap_.py:2462: UserWarning: n_neighbors is larger than the dataset size; truncating to X.shape[0] - 1
  warn(
