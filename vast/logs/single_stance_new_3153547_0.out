Running experiment with model: linear
Using device: cuda
Using classifier type: linear
Using joint query prefix: True

=== Running experiment: LR=0.001, BS=8, Model=linear, Use Prefix=True ===
Encoding training data jointly...
Encoding dev data jointly...

Epoch 1/50
Epoch 1 - Train Loss: 0.9589, Train Accuracy: 0.5558
Epoch 1 - Dev Loss: 1.0080, Dev Accuracy: 0.4670, Dev F1: 0.3766
Dev loss improved; saving best model.

Epoch 2/50
Epoch 2 - Train Loss: 0.9276, Train Accuracy: 0.5690
Epoch 2 - Dev Loss: 0.9701, Dev Accuracy: 0.5000, Dev F1: 0.4379
Dev loss improved; saving best model.

Epoch 3/50
Epoch 3 - Train Loss: 0.9070, Train Accuracy: 0.5796
Epoch 3 - Dev Loss: 1.0078, Dev Accuracy: 0.4913, Dev F1: 0.4092
No improvement on dev loss. Patience: 1/10

Epoch 4/50
Epoch 4 - Train Loss: 0.8908, Train Accuracy: 0.5896
Epoch 4 - Dev Loss: 0.9530, Dev Accuracy: 0.5247, Dev F1: 0.4758
Dev loss improved; saving best model.

Epoch 5/50
Epoch 5 - Train Loss: 0.8773, Train Accuracy: 0.5980
Epoch 5 - Dev Loss: 0.9604, Dev Accuracy: 0.5218, Dev F1: 0.4687
No improvement on dev loss. Patience: 1/10

Epoch 6/50
Epoch 6 - Train Loss: 0.8657, Train Accuracy: 0.6056
Epoch 6 - Dev Loss: 0.9521, Dev Accuracy: 0.5233, Dev F1: 0.4763
Dev loss improved; saving best model.

Epoch 7/50
Epoch 7 - Train Loss: 0.8554, Train Accuracy: 0.6124
Epoch 7 - Dev Loss: 0.9330, Dev Accuracy: 0.5432, Dev F1: 0.5144
Dev loss improved; saving best model.

Epoch 8/50
Epoch 8 - Train Loss: 0.8463, Train Accuracy: 0.6186
Epoch 8 - Dev Loss: 0.8908, Dev Accuracy: 0.5824, Dev F1: 0.5702
Dev loss improved; saving best model.

Epoch 9/50
Epoch 9 - Train Loss: 0.8380, Train Accuracy: 0.6242
Epoch 9 - Dev Loss: 0.8827, Dev Accuracy: 0.5854, Dev F1: 0.5752
Dev loss improved; saving best model.

Epoch 10/50
Epoch 10 - Train Loss: 0.8305, Train Accuracy: 0.6291
Epoch 10 - Dev Loss: 0.8905, Dev Accuracy: 0.5824, Dev F1: 0.5710
No improvement on dev loss. Patience: 1/10

Epoch 11/50
Epoch 11 - Train Loss: 0.8236, Train Accuracy: 0.6339
Epoch 11 - Dev Loss: 0.9166, Dev Accuracy: 0.5611, Dev F1: 0.5403
No improvement on dev loss. Patience: 2/10

Epoch 12/50
Epoch 12 - Train Loss: 0.8172, Train Accuracy: 0.6382
Epoch 12 - Dev Loss: 0.8939, Dev Accuracy: 0.5795, Dev F1: 0.5663
No improvement on dev loss. Patience: 3/10

Epoch 13/50
Epoch 13 - Train Loss: 0.8113, Train Accuracy: 0.6422
Epoch 13 - Dev Loss: 0.8980, Dev Accuracy: 0.5747, Dev F1: 0.5598
No improvement on dev loss. Patience: 4/10

Epoch 14/50
Epoch 14 - Train Loss: 0.8058, Train Accuracy: 0.6458
Epoch 14 - Dev Loss: 0.9168, Dev Accuracy: 0.5640, Dev F1: 0.5454
No improvement on dev loss. Patience: 5/10

Epoch 15/50
Epoch 15 - Train Loss: 0.8007, Train Accuracy: 0.6493
Epoch 15 - Dev Loss: 0.9107, Dev Accuracy: 0.5684, Dev F1: 0.5508
No improvement on dev loss. Patience: 6/10

Epoch 16/50
Epoch 16 - Train Loss: 0.7959, Train Accuracy: 0.6524
Epoch 16 - Dev Loss: 0.8792, Dev Accuracy: 0.5878, Dev F1: 0.5795
Dev loss improved; saving best model.

Epoch 17/50
Epoch 17 - Train Loss: 0.7913, Train Accuracy: 0.6556
Epoch 17 - Dev Loss: 0.9057, Dev Accuracy: 0.5737, Dev F1: 0.5579
No improvement on dev loss. Patience: 1/10

Epoch 18/50
Epoch 18 - Train Loss: 0.7870, Train Accuracy: 0.6585
Epoch 18 - Dev Loss: 0.8595, Dev Accuracy: 0.6052, Dev F1: 0.6005
Dev loss improved; saving best model.

Epoch 19/50
Epoch 19 - Train Loss: 0.7830, Train Accuracy: 0.6611
Epoch 19 - Dev Loss: 0.8919, Dev Accuracy: 0.5829, Dev F1: 0.5714
No improvement on dev loss. Patience: 1/10

Epoch 20/50
Epoch 20 - Train Loss: 0.7792, Train Accuracy: 0.6636
Epoch 20 - Dev Loss: 0.8792, Dev Accuracy: 0.5897, Dev F1: 0.5799
No improvement on dev loss. Patience: 2/10

Epoch 21/50
Epoch 21 - Train Loss: 0.7756, Train Accuracy: 0.6661
Epoch 21 - Dev Loss: 0.8518, Dev Accuracy: 0.6048, Dev F1: 0.6018
Dev loss improved; saving best model.

Epoch 22/50
Epoch 22 - Train Loss: 0.7721, Train Accuracy: 0.6683
Epoch 22 - Dev Loss: 0.8694, Dev Accuracy: 0.5931, Dev F1: 0.5865
No improvement on dev loss. Patience: 1/10

Epoch 23/50
Epoch 23 - Train Loss: 0.7689, Train Accuracy: 0.6704
Epoch 23 - Dev Loss: 0.8563, Dev Accuracy: 0.6018, Dev F1: 0.5982
No improvement on dev loss. Patience: 2/10

Epoch 24/50
Epoch 24 - Train Loss: 0.7658, Train Accuracy: 0.6724
Epoch 24 - Dev Loss: 0.8642, Dev Accuracy: 0.6009, Dev F1: 0.5953
No improvement on dev loss. Patience: 3/10

Epoch 25/50
Epoch 25 - Train Loss: 0.7629, Train Accuracy: 0.6743
Epoch 25 - Dev Loss: 0.8830, Dev Accuracy: 0.5892, Dev F1: 0.5796
No improvement on dev loss. Patience: 4/10

Epoch 26/50
Epoch 26 - Train Loss: 0.7600, Train Accuracy: 0.6761
Epoch 26 - Dev Loss: 0.8645, Dev Accuracy: 0.5936, Dev F1: 0.5883
No improvement on dev loss. Patience: 5/10

Epoch 27/50
Epoch 27 - Train Loss: 0.7573, Train Accuracy: 0.6779
Epoch 27 - Dev Loss: 0.8617, Dev Accuracy: 0.5951, Dev F1: 0.5901
No improvement on dev loss. Patience: 6/10

Epoch 28/50
Epoch 28 - Train Loss: 0.7548, Train Accuracy: 0.6795
Epoch 28 - Dev Loss: 0.8502, Dev Accuracy: 0.6081, Dev F1: 0.6053
Dev loss improved; saving best model.

Epoch 29/50
Epoch 29 - Train Loss: 0.7523, Train Accuracy: 0.6810
Epoch 29 - Dev Loss: 0.8650, Dev Accuracy: 0.6062, Dev F1: 0.6002
No improvement on dev loss. Patience: 1/10

Epoch 30/50
Epoch 30 - Train Loss: 0.7499, Train Accuracy: 0.6825
Epoch 30 - Dev Loss: 0.8513, Dev Accuracy: 0.6072, Dev F1: 0.6040
No improvement on dev loss. Patience: 2/10

Epoch 31/50
Epoch 31 - Train Loss: 0.7476, Train Accuracy: 0.6840
Epoch 31 - Dev Loss: 0.8609, Dev Accuracy: 0.6023, Dev F1: 0.5979
No improvement on dev loss. Patience: 3/10

Epoch 32/50
Epoch 32 - Train Loss: 0.7455, Train Accuracy: 0.6853
Epoch 32 - Dev Loss: 0.8462, Dev Accuracy: 0.6086, Dev F1: 0.6059
Dev loss improved; saving best model.

Epoch 33/50
Epoch 33 - Train Loss: 0.7434, Train Accuracy: 0.6866
Epoch 33 - Dev Loss: 0.8632, Dev Accuracy: 0.6009, Dev F1: 0.5960
No improvement on dev loss. Patience: 1/10

Epoch 34/50
Epoch 34 - Train Loss: 0.7414, Train Accuracy: 0.6879
Epoch 34 - Dev Loss: 0.8490, Dev Accuracy: 0.6096, Dev F1: 0.6066
No improvement on dev loss. Patience: 2/10

Epoch 35/50
Epoch 35 - Train Loss: 0.7394, Train Accuracy: 0.6891
Epoch 35 - Dev Loss: 0.8495, Dev Accuracy: 0.6086, Dev F1: 0.6058
No improvement on dev loss. Patience: 3/10

Epoch 36/50
Epoch 36 - Train Loss: 0.7376, Train Accuracy: 0.6902
Epoch 36 - Dev Loss: 0.8635, Dev Accuracy: 0.5999, Dev F1: 0.5951
No improvement on dev loss. Patience: 4/10

Epoch 37/50
Epoch 37 - Train Loss: 0.7358, Train Accuracy: 0.6913
Epoch 37 - Dev Loss: 0.8510, Dev Accuracy: 0.6120, Dev F1: 0.6086
No improvement on dev loss. Patience: 5/10

Epoch 38/50
Epoch 38 - Train Loss: 0.7341, Train Accuracy: 0.6924
Epoch 38 - Dev Loss: 0.8474, Dev Accuracy: 0.6081, Dev F1: 0.6057
No improvement on dev loss. Patience: 6/10

Epoch 39/50
Epoch 39 - Train Loss: 0.7324, Train Accuracy: 0.6934
Epoch 39 - Dev Loss: 0.8474, Dev Accuracy: 0.6101, Dev F1: 0.6073
No improvement on dev loss. Patience: 7/10

Epoch 40/50
Epoch 40 - Train Loss: 0.7308, Train Accuracy: 0.6944
Epoch 40 - Dev Loss: 0.8436, Dev Accuracy: 0.6130, Dev F1: 0.6109
Dev loss improved; saving best model.

Epoch 41/50
Epoch 41 - Train Loss: 0.7293, Train Accuracy: 0.6953
Epoch 41 - Dev Loss: 0.8354, Dev Accuracy: 0.6174, Dev F1: 0.6162
Dev loss improved; saving best model.

Epoch 42/50
Epoch 42 - Train Loss: 0.7278, Train Accuracy: 0.6963
Epoch 42 - Dev Loss: 0.8558, Dev Accuracy: 0.6062, Dev F1: 0.6026
No improvement on dev loss. Patience: 1/10

Epoch 43/50
Epoch 43 - Train Loss: 0.7264, Train Accuracy: 0.6971
Epoch 43 - Dev Loss: 0.8431, Dev Accuracy: 0.6120, Dev F1: 0.6100
No improvement on dev loss. Patience: 2/10

Epoch 44/50
Epoch 44 - Train Loss: 0.7250, Train Accuracy: 0.6979
Epoch 44 - Dev Loss: 0.8432, Dev Accuracy: 0.6125, Dev F1: 0.6103
No improvement on dev loss. Patience: 3/10

Epoch 45/50
Epoch 45 - Train Loss: 0.7237, Train Accuracy: 0.6987
Epoch 45 - Dev Loss: 0.8418, Dev Accuracy: 0.6145, Dev F1: 0.6126
No improvement on dev loss. Patience: 4/10

Epoch 46/50
Epoch 46 - Train Loss: 0.7224, Train Accuracy: 0.6995
Epoch 46 - Dev Loss: 0.8364, Dev Accuracy: 0.6164, Dev F1: 0.6150
No improvement on dev loss. Patience: 5/10

Epoch 47/50
Epoch 47 - Train Loss: 0.7211, Train Accuracy: 0.7002
Epoch 47 - Dev Loss: 0.8442, Dev Accuracy: 0.6145, Dev F1: 0.6123
No improvement on dev loss. Patience: 6/10

Epoch 48/50
Epoch 48 - Train Loss: 0.7199, Train Accuracy: 0.7010
Epoch 48 - Dev Loss: 0.8399, Dev Accuracy: 0.6140, Dev F1: 0.6124
No improvement on dev loss. Patience: 7/10

Epoch 49/50
Epoch 49 - Train Loss: 0.7188, Train Accuracy: 0.7017
Epoch 49 - Dev Loss: 0.8454, Dev Accuracy: 0.6130, Dev F1: 0.6107
No improvement on dev loss. Patience: 8/10

Epoch 50/50
Epoch 50 - Train Loss: 0.7177, Train Accuracy: 0.7024
Epoch 50 - Dev Loss: 0.8470, Dev Accuracy: 0.6111, Dev F1: 0.6084
No improvement on dev loss. Patience: 9/10

Final Training Loss: 0.7177
Final Training Accuracy: 0.7024
Best Dev Loss: 0.8354
Best Dev Accuracy: 0.6111, Best Dev Macro F1: 0.6084
Config LR=0.001, BS=8 -> Dev Loss: 0.8470, Dev Accuracy: 0.6111, Dev F1: 0.6084

=== Running experiment: LR=0.001, BS=16, Model=linear, Use Prefix=True ===
Encoding training data jointly...
Encoding dev data jointly...

Epoch 1/50
Epoch 1 - Train Loss: 0.9717, Train Accuracy: 0.5515
Epoch 1 - Dev Loss: 1.0789, Dev Accuracy: 0.4602, Dev F1: 0.3688
Dev loss improved; saving best model.

Epoch 2/50
Epoch 2 - Train Loss: 0.9420, Train Accuracy: 0.5627
Epoch 2 - Dev Loss: 1.0468, Dev Accuracy: 0.4588, Dev F1: 0.3673
Dev loss improved; saving best model.

Epoch 3/50
Epoch 3 - Train Loss: 0.9232, Train Accuracy: 0.5712
Epoch 3 - Dev Loss: 0.9774, Dev Accuracy: 0.4952, Dev F1: 0.4245
Dev loss improved; saving best model.

Epoch 4/50
Epoch 4 - Train Loss: 0.9086, Train Accuracy: 0.5793
Epoch 4 - Dev Loss: 0.9720, Dev Accuracy: 0.5048, Dev F1: 0.4408
Dev loss improved; saving best model.

Epoch 5/50
Epoch 5 - Train Loss: 0.8965, Train Accuracy: 0.5860
Epoch 5 - Dev Loss: 0.9756, Dev Accuracy: 0.5053, Dev F1: 0.4416
No improvement on dev loss. Patience: 1/10

Epoch 6/50
Epoch 6 - Train Loss: 0.8861, Train Accuracy: 0.5923
Epoch 6 - Dev Loss: 0.9590, Dev Accuracy: 0.5175, Dev F1: 0.4646
Dev loss improved; saving best model.

Epoch 7/50
Epoch 7 - Train Loss: 0.8768, Train Accuracy: 0.5984
Epoch 7 - Dev Loss: 0.9296, Dev Accuracy: 0.5432, Dev F1: 0.5106
Dev loss improved; saving best model.

Epoch 8/50
Epoch 8 - Train Loss: 0.8686, Train Accuracy: 0.6038
Epoch 8 - Dev Loss: 0.9250, Dev Accuracy: 0.5475, Dev F1: 0.5181
Dev loss improved; saving best model.

Epoch 9/50
Epoch 9 - Train Loss: 0.8610, Train Accuracy: 0.6085
Epoch 9 - Dev Loss: 0.9223, Dev Accuracy: 0.5533, Dev F1: 0.5230
Dev loss improved; saving best model.

Epoch 10/50
Epoch 10 - Train Loss: 0.8540, Train Accuracy: 0.6131
Epoch 10 - Dev Loss: 0.9233, Dev Accuracy: 0.5504, Dev F1: 0.5229
No improvement on dev loss. Patience: 1/10

Epoch 11/50
Epoch 11 - Train Loss: 0.8476, Train Accuracy: 0.6175
Epoch 11 - Dev Loss: 0.9093, Dev Accuracy: 0.5655, Dev F1: 0.5458
Dev loss improved; saving best model.

Epoch 12/50
Epoch 12 - Train Loss: 0.8415, Train Accuracy: 0.6216
Epoch 12 - Dev Loss: 0.8945, Dev Accuracy: 0.5800, Dev F1: 0.5674
Dev loss improved; saving best model.

Epoch 13/50
Epoch 13 - Train Loss: 0.8360, Train Accuracy: 0.6252
Epoch 13 - Dev Loss: 0.9224, Dev Accuracy: 0.5509, Dev F1: 0.5239
No improvement on dev loss. Patience: 1/10

Epoch 14/50
Epoch 14 - Train Loss: 0.8308, Train Accuracy: 0.6288
Epoch 14 - Dev Loss: 0.9204, Dev Accuracy: 0.5567, Dev F1: 0.5323
No improvement on dev loss. Patience: 2/10

Epoch 15/50
Epoch 15 - Train Loss: 0.8258, Train Accuracy: 0.6324
Epoch 15 - Dev Loss: 0.9132, Dev Accuracy: 0.5611, Dev F1: 0.5405
No improvement on dev loss. Patience: 3/10

Epoch 16/50
Epoch 16 - Train Loss: 0.8212, Train Accuracy: 0.6355
Epoch 16 - Dev Loss: 0.8904, Dev Accuracy: 0.5829, Dev F1: 0.5712
Dev loss improved; saving best model.

Epoch 17/50
Epoch 17 - Train Loss: 0.8168, Train Accuracy: 0.6386
Epoch 17 - Dev Loss: 0.8933, Dev Accuracy: 0.5800, Dev F1: 0.5676
No improvement on dev loss. Patience: 1/10

Epoch 18/50
Epoch 18 - Train Loss: 0.8127, Train Accuracy: 0.6414
Epoch 18 - Dev Loss: 0.8839, Dev Accuracy: 0.5878, Dev F1: 0.5784
Dev loss improved; saving best model.

Epoch 19/50
Epoch 19 - Train Loss: 0.8088, Train Accuracy: 0.6440
Epoch 19 - Dev Loss: 0.8870, Dev Accuracy: 0.5820, Dev F1: 0.5725
No improvement on dev loss. Patience: 1/10

Epoch 20/50
Epoch 20 - Train Loss: 0.8050, Train Accuracy: 0.6465
Epoch 20 - Dev Loss: 0.8756, Dev Accuracy: 0.5912, Dev F1: 0.5824
Dev loss improved; saving best model.

Epoch 21/50
Epoch 21 - Train Loss: 0.8015, Train Accuracy: 0.6489
Epoch 21 - Dev Loss: 0.8873, Dev Accuracy: 0.5844, Dev F1: 0.5722
No improvement on dev loss. Patience: 1/10

Epoch 22/50
Epoch 22 - Train Loss: 0.7981, Train Accuracy: 0.6512
Epoch 22 - Dev Loss: 0.8853, Dev Accuracy: 0.5863, Dev F1: 0.5770
No improvement on dev loss. Patience: 2/10

Epoch 23/50
Epoch 23 - Train Loss: 0.7949, Train Accuracy: 0.6534
Epoch 23 - Dev Loss: 0.8914, Dev Accuracy: 0.5849, Dev F1: 0.5739
No improvement on dev loss. Patience: 3/10

Epoch 24/50
Epoch 24 - Train Loss: 0.7918, Train Accuracy: 0.6555
Epoch 24 - Dev Loss: 0.8977, Dev Accuracy: 0.5805, Dev F1: 0.5673
No improvement on dev loss. Patience: 4/10

Epoch 25/50
Epoch 25 - Train Loss: 0.7888, Train Accuracy: 0.6574
Epoch 25 - Dev Loss: 0.8648, Dev Accuracy: 0.5999, Dev F1: 0.5942
Dev loss improved; saving best model.

Epoch 26/50
Epoch 26 - Train Loss: 0.7860, Train Accuracy: 0.6593
Epoch 26 - Dev Loss: 0.8842, Dev Accuracy: 0.5873, Dev F1: 0.5765
No improvement on dev loss. Patience: 1/10

Epoch 27/50
Epoch 27 - Train Loss: 0.7833, Train Accuracy: 0.6611
Epoch 27 - Dev Loss: 0.8642, Dev Accuracy: 0.6014, Dev F1: 0.5960
Dev loss improved; saving best model.

Epoch 28/50
Epoch 28 - Train Loss: 0.7807, Train Accuracy: 0.6628
Epoch 28 - Dev Loss: 0.8546, Dev Accuracy: 0.6115, Dev F1: 0.6076
Dev loss improved; saving best model.

Epoch 29/50
Epoch 29 - Train Loss: 0.7782, Train Accuracy: 0.6644
Epoch 29 - Dev Loss: 0.8770, Dev Accuracy: 0.5868, Dev F1: 0.5795
No improvement on dev loss. Patience: 1/10

Epoch 30/50
Epoch 30 - Train Loss: 0.7758, Train Accuracy: 0.6660
Epoch 30 - Dev Loss: 0.8652, Dev Accuracy: 0.5970, Dev F1: 0.5908
No improvement on dev loss. Patience: 2/10

Epoch 31/50
Epoch 31 - Train Loss: 0.7735, Train Accuracy: 0.6676
Epoch 31 - Dev Loss: 0.8660, Dev Accuracy: 0.5984, Dev F1: 0.5924
No improvement on dev loss. Patience: 3/10

Epoch 32/50
Epoch 32 - Train Loss: 0.7713, Train Accuracy: 0.6690
Epoch 32 - Dev Loss: 0.8856, Dev Accuracy: 0.5868, Dev F1: 0.5774
No improvement on dev loss. Patience: 4/10

Epoch 33/50
Epoch 33 - Train Loss: 0.7692, Train Accuracy: 0.6704
Epoch 33 - Dev Loss: 0.8638, Dev Accuracy: 0.6043, Dev F1: 0.5988
No improvement on dev loss. Patience: 5/10

Epoch 34/50
Epoch 34 - Train Loss: 0.7672, Train Accuracy: 0.6717
Epoch 34 - Dev Loss: 0.8725, Dev Accuracy: 0.5926, Dev F1: 0.5853
No improvement on dev loss. Patience: 6/10

Epoch 35/50
Epoch 35 - Train Loss: 0.7652, Train Accuracy: 0.6730
Epoch 35 - Dev Loss: 0.8622, Dev Accuracy: 0.5970, Dev F1: 0.5919
No improvement on dev loss. Patience: 7/10

Epoch 36/50
Epoch 36 - Train Loss: 0.7633, Train Accuracy: 0.6742
Epoch 36 - Dev Loss: 0.8662, Dev Accuracy: 0.5980, Dev F1: 0.5919
No improvement on dev loss. Patience: 8/10

Epoch 37/50
Epoch 37 - Train Loss: 0.7615, Train Accuracy: 0.6753
Epoch 37 - Dev Loss: 0.8658, Dev Accuracy: 0.5994, Dev F1: 0.5933
No improvement on dev loss. Patience: 9/10

Epoch 38/50
Epoch 38 - Train Loss: 0.7597, Train Accuracy: 0.6765
Epoch 38 - Dev Loss: 0.8695, Dev Accuracy: 0.5951, Dev F1: 0.5883
No improvement on dev loss. Patience: 10/10
Early stopping triggered.

Final Training Loss: 0.7597
Final Training Accuracy: 0.6765
Best Dev Loss: 0.8546
Best Dev Accuracy: 0.5951, Best Dev Macro F1: 0.5883
Config LR=0.001, BS=16 -> Dev Loss: 0.8695, Dev Accuracy: 0.5951, Dev F1: 0.5883

=== Running experiment: LR=0.001, BS=32, Model=linear, Use Prefix=True ===
Encoding training data jointly...
Encoding dev data jointly...

Epoch 1/50
Epoch 1 - Train Loss: 0.9856, Train Accuracy: 0.5440
Epoch 1 - Dev Loss: 1.0580, Dev Accuracy: 0.4714, Dev F1: 0.3782
Dev loss improved; saving best model.

Epoch 2/50
Epoch 2 - Train Loss: 0.9570, Train Accuracy: 0.5563
Epoch 2 - Dev Loss: 1.0467, Dev Accuracy: 0.4719, Dev F1: 0.3792
Dev loss improved; saving best model.

Epoch 3/50
Epoch 3 - Train Loss: 0.9390, Train Accuracy: 0.5636
Epoch 3 - Dev Loss: 1.0138, Dev Accuracy: 0.4748, Dev F1: 0.3836
Dev loss improved; saving best model.

Epoch 4/50
Epoch 4 - Train Loss: 0.9255, Train Accuracy: 0.5701
Epoch 4 - Dev Loss: 0.9862, Dev Accuracy: 0.4947, Dev F1: 0.4164
Dev loss improved; saving best model.

Epoch 5/50
Epoch 5 - Train Loss: 0.9145, Train Accuracy: 0.5750
Epoch 5 - Dev Loss: 0.9650, Dev Accuracy: 0.5058, Dev F1: 0.4449
Dev loss improved; saving best model.

Epoch 6/50
Epoch 6 - Train Loss: 0.9050, Train Accuracy: 0.5800
Epoch 6 - Dev Loss: 0.9915, Dev Accuracy: 0.4893, Dev F1: 0.4150
No improvement on dev loss. Patience: 1/10

Epoch 7/50
Epoch 7 - Train Loss: 0.8967, Train Accuracy: 0.5849
Epoch 7 - Dev Loss: 0.9661, Dev Accuracy: 0.5082, Dev F1: 0.4472
No improvement on dev loss. Patience: 2/10

Epoch 8/50
Epoch 8 - Train Loss: 0.8893, Train Accuracy: 0.5896
Epoch 8 - Dev Loss: 0.9898, Dev Accuracy: 0.4995, Dev F1: 0.4292
No improvement on dev loss. Patience: 3/10

Epoch 9/50
Epoch 9 - Train Loss: 0.8824, Train Accuracy: 0.5941
Epoch 9 - Dev Loss: 0.9608, Dev Accuracy: 0.5189, Dev F1: 0.4649
Dev loss improved; saving best model.

Epoch 10/50
Epoch 10 - Train Loss: 0.8761, Train Accuracy: 0.5983
Epoch 10 - Dev Loss: 0.9487, Dev Accuracy: 0.5209, Dev F1: 0.4770
Dev loss improved; saving best model.

Epoch 11/50
Epoch 11 - Train Loss: 0.8703, Train Accuracy: 0.6021
Epoch 11 - Dev Loss: 0.9327, Dev Accuracy: 0.5441, Dev F1: 0.5093
Dev loss improved; saving best model.

Epoch 12/50
Epoch 12 - Train Loss: 0.8649, Train Accuracy: 0.6057
Epoch 12 - Dev Loss: 0.9316, Dev Accuracy: 0.5422, Dev F1: 0.5084
Dev loss improved; saving best model.

Epoch 13/50
Epoch 13 - Train Loss: 0.8598, Train Accuracy: 0.6090
Epoch 13 - Dev Loss: 0.9250, Dev Accuracy: 0.5509, Dev F1: 0.5274
Dev loss improved; saving best model.

Epoch 14/50
Epoch 14 - Train Loss: 0.8550, Train Accuracy: 0.6122
Epoch 14 - Dev Loss: 0.9420, Dev Accuracy: 0.5310, Dev F1: 0.4906
No improvement on dev loss. Patience: 1/10

Epoch 15/50
Epoch 15 - Train Loss: 0.8505, Train Accuracy: 0.6151
Epoch 15 - Dev Loss: 0.9162, Dev Accuracy: 0.5533, Dev F1: 0.5269
Dev loss improved; saving best model.

Epoch 16/50
Epoch 16 - Train Loss: 0.8462, Train Accuracy: 0.6180
Epoch 16 - Dev Loss: 0.9104, Dev Accuracy: 0.5611, Dev F1: 0.5399
Dev loss improved; saving best model.

Epoch 17/50
Epoch 17 - Train Loss: 0.8422, Train Accuracy: 0.6209
Epoch 17 - Dev Loss: 0.9355, Dev Accuracy: 0.5393, Dev F1: 0.5041
No improvement on dev loss. Patience: 1/10

Epoch 18/50
Epoch 18 - Train Loss: 0.8383, Train Accuracy: 0.6234
Epoch 18 - Dev Loss: 0.9257, Dev Accuracy: 0.5514, Dev F1: 0.5240
No improvement on dev loss. Patience: 2/10

Epoch 19/50
Epoch 19 - Train Loss: 0.8347, Train Accuracy: 0.6259
Epoch 19 - Dev Loss: 0.9020, Dev Accuracy: 0.5684, Dev F1: 0.5536
Dev loss improved; saving best model.

Epoch 20/50
Epoch 20 - Train Loss: 0.8312, Train Accuracy: 0.6283
Epoch 20 - Dev Loss: 0.9093, Dev Accuracy: 0.5650, Dev F1: 0.5475
No improvement on dev loss. Patience: 1/10

Epoch 21/50
Epoch 21 - Train Loss: 0.8279, Train Accuracy: 0.6305
Epoch 21 - Dev Loss: 0.9226, Dev Accuracy: 0.5524, Dev F1: 0.5268
No improvement on dev loss. Patience: 2/10

Epoch 22/50
Epoch 22 - Train Loss: 0.8247, Train Accuracy: 0.6326
Epoch 22 - Dev Loss: 0.8888, Dev Accuracy: 0.5805, Dev F1: 0.5702
Dev loss improved; saving best model.

Epoch 23/50
Epoch 23 - Train Loss: 0.8217, Train Accuracy: 0.6348
Epoch 23 - Dev Loss: 0.8912, Dev Accuracy: 0.5815, Dev F1: 0.5698
No improvement on dev loss. Patience: 1/10

Epoch 24/50
Epoch 24 - Train Loss: 0.8188, Train Accuracy: 0.6368
Epoch 24 - Dev Loss: 0.8944, Dev Accuracy: 0.5810, Dev F1: 0.5673
No improvement on dev loss. Patience: 2/10

Epoch 25/50
Epoch 25 - Train Loss: 0.8160, Train Accuracy: 0.6388
Epoch 25 - Dev Loss: 0.8926, Dev Accuracy: 0.5824, Dev F1: 0.5698
No improvement on dev loss. Patience: 3/10

Epoch 26/50
Epoch 26 - Train Loss: 0.8133, Train Accuracy: 0.6407
Epoch 26 - Dev Loss: 0.9113, Dev Accuracy: 0.5669, Dev F1: 0.5474
No improvement on dev loss. Patience: 4/10

Epoch 27/50
Epoch 27 - Train Loss: 0.8108, Train Accuracy: 0.6424
Epoch 27 - Dev Loss: 0.8997, Dev Accuracy: 0.5757, Dev F1: 0.5602
No improvement on dev loss. Patience: 5/10

Epoch 28/50
Epoch 28 - Train Loss: 0.8083, Train Accuracy: 0.6441
Epoch 28 - Dev Loss: 0.9096, Dev Accuracy: 0.5640, Dev F1: 0.5482
No improvement on dev loss. Patience: 6/10

Epoch 29/50
Epoch 29 - Train Loss: 0.8059, Train Accuracy: 0.6457
Epoch 29 - Dev Loss: 0.9083, Dev Accuracy: 0.5669, Dev F1: 0.5510
No improvement on dev loss. Patience: 7/10

Epoch 30/50
Epoch 30 - Train Loss: 0.8036, Train Accuracy: 0.6474
Epoch 30 - Dev Loss: 0.9004, Dev Accuracy: 0.5766, Dev F1: 0.5615
No improvement on dev loss. Patience: 8/10

Epoch 31/50
Epoch 31 - Train Loss: 0.8014, Train Accuracy: 0.6489
Epoch 31 - Dev Loss: 0.8957, Dev Accuracy: 0.5786, Dev F1: 0.5649
No improvement on dev loss. Patience: 9/10

Epoch 32/50
Epoch 32 - Train Loss: 0.7993, Train Accuracy: 0.6503
Epoch 32 - Dev Loss: 0.8975, Dev Accuracy: 0.5766, Dev F1: 0.5629
No improvement on dev loss. Patience: 10/10
Early stopping triggered.

Final Training Loss: 0.7993
Final Training Accuracy: 0.6503
Best Dev Loss: 0.8888
Best Dev Accuracy: 0.5766, Best Dev Macro F1: 0.5629
Config LR=0.001, BS=32 -> Dev Loss: 0.8975, Dev Accuracy: 0.5766, Dev F1: 0.5629

=== Running experiment: LR=0.001, BS=64, Model=linear, Use Prefix=True ===
Encoding training data jointly...
Encoding dev data jointly...

Epoch 1/50
Epoch 1 - Train Loss: 1.0001, Train Accuracy: 0.5431
Epoch 1 - Dev Loss: 1.0937, Dev Accuracy: 0.4646, Dev F1: 0.3727
Dev loss improved; saving best model.

Epoch 2/50
Epoch 2 - Train Loss: 0.9731, Train Accuracy: 0.5543
Epoch 2 - Dev Loss: 1.0426, Dev Accuracy: 0.4772, Dev F1: 0.3834
Dev loss improved; saving best model.

Epoch 3/50
Epoch 3 - Train Loss: 0.9560, Train Accuracy: 0.5602
Epoch 3 - Dev Loss: 1.0306, Dev Accuracy: 0.4641, Dev F1: 0.3727
Dev loss improved; saving best model.

Epoch 4/50
Epoch 4 - Train Loss: 0.9432, Train Accuracy: 0.5646
Epoch 4 - Dev Loss: 1.0207, Dev Accuracy: 0.4796, Dev F1: 0.3862
Dev loss improved; saving best model.

Epoch 5/50
Epoch 5 - Train Loss: 0.9330, Train Accuracy: 0.5684
Epoch 5 - Dev Loss: 1.0156, Dev Accuracy: 0.4825, Dev F1: 0.3912
Dev loss improved; saving best model.

Epoch 6/50
Epoch 6 - Train Loss: 0.9242, Train Accuracy: 0.5725
Epoch 6 - Dev Loss: 1.0116, Dev Accuracy: 0.4850, Dev F1: 0.3965
Dev loss improved; saving best model.

Epoch 7/50
Epoch 7 - Train Loss: 0.9165, Train Accuracy: 0.5759
Epoch 7 - Dev Loss: 1.0157, Dev Accuracy: 0.4787, Dev F1: 0.3894
No improvement on dev loss. Patience: 1/10

Epoch 8/50
Epoch 8 - Train Loss: 0.9096, Train Accuracy: 0.5794
Epoch 8 - Dev Loss: 1.0003, Dev Accuracy: 0.4864, Dev F1: 0.4060
Dev loss improved; saving best model.

Epoch 9/50
Epoch 9 - Train Loss: 0.9034, Train Accuracy: 0.5827
Epoch 9 - Dev Loss: 0.9630, Dev Accuracy: 0.5092, Dev F1: 0.4526
Dev loss improved; saving best model.

Epoch 10/50
Epoch 10 - Train Loss: 0.8977, Train Accuracy: 0.5859
Epoch 10 - Dev Loss: 0.9655, Dev Accuracy: 0.5058, Dev F1: 0.4462
No improvement on dev loss. Patience: 1/10

Epoch 11/50
Epoch 11 - Train Loss: 0.8924, Train Accuracy: 0.5891
Epoch 11 - Dev Loss: 0.9487, Dev Accuracy: 0.5228, Dev F1: 0.4763
Dev loss improved; saving best model.

Epoch 12/50
Epoch 12 - Train Loss: 0.8875, Train Accuracy: 0.5920
Epoch 12 - Dev Loss: 0.9675, Dev Accuracy: 0.5092, Dev F1: 0.4495
No improvement on dev loss. Patience: 1/10

Epoch 13/50
Epoch 13 - Train Loss: 0.8829, Train Accuracy: 0.5949
Epoch 13 - Dev Loss: 0.9699, Dev Accuracy: 0.5097, Dev F1: 0.4494
No improvement on dev loss. Patience: 2/10

Epoch 14/50
Epoch 14 - Train Loss: 0.8786, Train Accuracy: 0.5976
Epoch 14 - Dev Loss: 0.9453, Dev Accuracy: 0.5276, Dev F1: 0.4853
Dev loss improved; saving best model.

Epoch 15/50
Epoch 15 - Train Loss: 0.8745, Train Accuracy: 0.6001
Epoch 15 - Dev Loss: 0.9521, Dev Accuracy: 0.5184, Dev F1: 0.4719
No improvement on dev loss. Patience: 1/10

Epoch 16/50
Epoch 16 - Train Loss: 0.8706, Train Accuracy: 0.6026
Epoch 16 - Dev Loss: 0.9355, Dev Accuracy: 0.5359, Dev F1: 0.4994
Dev loss improved; saving best model.

Epoch 17/50
Epoch 17 - Train Loss: 0.8670, Train Accuracy: 0.6050
Epoch 17 - Dev Loss: 0.9532, Dev Accuracy: 0.5223, Dev F1: 0.4741
No improvement on dev loss. Patience: 1/10

Epoch 18/50
Epoch 18 - Train Loss: 0.8635, Train Accuracy: 0.6074
Epoch 18 - Dev Loss: 0.9361, Dev Accuracy: 0.5335, Dev F1: 0.4977
No improvement on dev loss. Patience: 2/10

Epoch 19/50
Epoch 19 - Train Loss: 0.8601, Train Accuracy: 0.6096
Epoch 19 - Dev Loss: 0.9271, Dev Accuracy: 0.5446, Dev F1: 0.5122
Dev loss improved; saving best model.

Epoch 20/50
Epoch 20 - Train Loss: 0.8570, Train Accuracy: 0.6117
Epoch 20 - Dev Loss: 0.9282, Dev Accuracy: 0.5432, Dev F1: 0.5120
No improvement on dev loss. Patience: 1/10

Epoch 21/50
Epoch 21 - Train Loss: 0.8539, Train Accuracy: 0.6137
Epoch 21 - Dev Loss: 0.9327, Dev Accuracy: 0.5393, Dev F1: 0.5059
No improvement on dev loss. Patience: 2/10

Epoch 22/50
Epoch 22 - Train Loss: 0.8510, Train Accuracy: 0.6156
Epoch 22 - Dev Loss: 0.9279, Dev Accuracy: 0.5461, Dev F1: 0.5138
No improvement on dev loss. Patience: 3/10

Epoch 23/50
Epoch 23 - Train Loss: 0.8482, Train Accuracy: 0.6175
Epoch 23 - Dev Loss: 0.9379, Dev Accuracy: 0.5349, Dev F1: 0.4963
No improvement on dev loss. Patience: 4/10

Epoch 24/50
Epoch 24 - Train Loss: 0.8456, Train Accuracy: 0.6193
Epoch 24 - Dev Loss: 0.9263, Dev Accuracy: 0.5466, Dev F1: 0.5159
Dev loss improved; saving best model.

Epoch 25/50
Epoch 25 - Train Loss: 0.8430, Train Accuracy: 0.6210
Epoch 25 - Dev Loss: 0.9295, Dev Accuracy: 0.5432, Dev F1: 0.5113
No improvement on dev loss. Patience: 1/10

Epoch 26/50
Epoch 26 - Train Loss: 0.8405, Train Accuracy: 0.6226
Epoch 26 - Dev Loss: 0.9301, Dev Accuracy: 0.5466, Dev F1: 0.5149
No improvement on dev loss. Patience: 2/10

Epoch 27/50
Epoch 27 - Train Loss: 0.8382, Train Accuracy: 0.6242
Epoch 27 - Dev Loss: 0.9058, Dev Accuracy: 0.5655, Dev F1: 0.5474
Dev loss improved; saving best model.

Epoch 28/50
Epoch 28 - Train Loss: 0.8359, Train Accuracy: 0.6257
Epoch 28 - Dev Loss: 0.9211, Dev Accuracy: 0.5509, Dev F1: 0.5243
No improvement on dev loss. Patience: 1/10

Epoch 29/50
Epoch 29 - Train Loss: 0.8337, Train Accuracy: 0.6272
Epoch 29 - Dev Loss: 0.9119, Dev Accuracy: 0.5592, Dev F1: 0.5378
No improvement on dev loss. Patience: 2/10

Epoch 30/50
Epoch 30 - Train Loss: 0.8316, Train Accuracy: 0.6286
Epoch 30 - Dev Loss: 0.9229, Dev Accuracy: 0.5490, Dev F1: 0.5207
No improvement on dev loss. Patience: 3/10

Epoch 31/50
Epoch 31 - Train Loss: 0.8295, Train Accuracy: 0.6300
Epoch 31 - Dev Loss: 0.9145, Dev Accuracy: 0.5572, Dev F1: 0.5339
No improvement on dev loss. Patience: 4/10

Epoch 32/50
Epoch 32 - Train Loss: 0.8276, Train Accuracy: 0.6313
Epoch 32 - Dev Loss: 0.9142, Dev Accuracy: 0.5567, Dev F1: 0.5332
No improvement on dev loss. Patience: 5/10

Epoch 33/50
Epoch 33 - Train Loss: 0.8257, Train Accuracy: 0.6326
Epoch 33 - Dev Loss: 0.9143, Dev Accuracy: 0.5601, Dev F1: 0.5382
No improvement on dev loss. Patience: 6/10

Epoch 34/50
Epoch 34 - Train Loss: 0.8238, Train Accuracy: 0.6338
Epoch 34 - Dev Loss: 0.9115, Dev Accuracy: 0.5626, Dev F1: 0.5428
No improvement on dev loss. Patience: 7/10

Epoch 35/50
Epoch 35 - Train Loss: 0.8221, Train Accuracy: 0.6350
Epoch 35 - Dev Loss: 0.9095, Dev Accuracy: 0.5640, Dev F1: 0.5456
No improvement on dev loss. Patience: 8/10

Epoch 36/50
Epoch 36 - Train Loss: 0.8203, Train Accuracy: 0.6361
Epoch 36 - Dev Loss: 0.9001, Dev Accuracy: 0.5732, Dev F1: 0.5574
Dev loss improved; saving best model.

Epoch 37/50
Epoch 37 - Train Loss: 0.8187, Train Accuracy: 0.6373
Epoch 37 - Dev Loss: 0.9103, Dev Accuracy: 0.5630, Dev F1: 0.5424
No improvement on dev loss. Patience: 1/10

Epoch 38/50
Epoch 38 - Train Loss: 0.8171, Train Accuracy: 0.6383
Epoch 38 - Dev Loss: 0.9086, Dev Accuracy: 0.5664, Dev F1: 0.5478
No improvement on dev loss. Patience: 2/10

Epoch 39/50
Epoch 39 - Train Loss: 0.8156, Train Accuracy: 0.6393
Epoch 39 - Dev Loss: 0.8994, Dev Accuracy: 0.5752, Dev F1: 0.5601
Dev loss improved; saving best model.

Epoch 40/50
Epoch 40 - Train Loss: 0.8141, Train Accuracy: 0.6404
Epoch 40 - Dev Loss: 0.9092, Dev Accuracy: 0.5664, Dev F1: 0.5473
No improvement on dev loss. Patience: 1/10

Epoch 41/50
Epoch 41 - Train Loss: 0.8127, Train Accuracy: 0.6413
Epoch 41 - Dev Loss: 0.9126, Dev Accuracy: 0.5626, Dev F1: 0.5423
No improvement on dev loss. Patience: 2/10

Epoch 42/50
Epoch 42 - Train Loss: 0.8113, Train Accuracy: 0.6423
Epoch 42 - Dev Loss: 0.9080, Dev Accuracy: 0.5679, Dev F1: 0.5491
No improvement on dev loss. Patience: 3/10

Epoch 43/50
Epoch 43 - Train Loss: 0.8099, Train Accuracy: 0.6432
Epoch 43 - Dev Loss: 0.9044, Dev Accuracy: 0.5689, Dev F1: 0.5504
No improvement on dev loss. Patience: 4/10

Epoch 44/50
Epoch 44 - Train Loss: 0.8086, Train Accuracy: 0.6441
Epoch 44 - Dev Loss: 0.9007, Dev Accuracy: 0.5703, Dev F1: 0.5550
No improvement on dev loss. Patience: 5/10

Epoch 45/50
Epoch 45 - Train Loss: 0.8074, Train Accuracy: 0.6450
Epoch 45 - Dev Loss: 0.9053, Dev Accuracy: 0.5727, Dev F1: 0.5552
No improvement on dev loss. Patience: 6/10

Epoch 46/50
Epoch 46 - Train Loss: 0.8062, Train Accuracy: 0.6458
Epoch 46 - Dev Loss: 0.9011, Dev Accuracy: 0.5732, Dev F1: 0.5570
No improvement on dev loss. Patience: 7/10

Epoch 47/50
Epoch 47 - Train Loss: 0.8050, Train Accuracy: 0.6466
Epoch 47 - Dev Loss: 0.9045, Dev Accuracy: 0.5718, Dev F1: 0.5548
No improvement on dev loss. Patience: 8/10

Epoch 48/50
Epoch 48 - Train Loss: 0.8039, Train Accuracy: 0.6473
Epoch 48 - Dev Loss: 0.9058, Dev Accuracy: 0.5713, Dev F1: 0.5539
No improvement on dev loss. Patience: 9/10

Epoch 49/50
Epoch 49 - Train Loss: 0.8029, Train Accuracy: 0.6481
Epoch 49 - Dev Loss: 0.9046, Dev Accuracy: 0.5713, Dev F1: 0.5544
No improvement on dev loss. Patience: 10/10
Early stopping triggered.

Final Training Loss: 0.8029
Final Training Accuracy: 0.6481
Best Dev Loss: 0.8994
Best Dev Accuracy: 0.5713, Best Dev Macro F1: 0.5544
Config LR=0.001, BS=64 -> Dev Loss: 0.9046, Dev Accuracy: 0.5713, Dev F1: 0.5544

=== Running experiment: LR=0.001, BS=128, Model=linear, Use Prefix=True ===
Encoding training data jointly...
Encoding dev data jointly...

Epoch 1/50
Epoch 1 - Train Loss: 1.0154, Train Accuracy: 0.5296
Epoch 1 - Dev Loss: 1.1006, Dev Accuracy: 0.4758, Dev F1: 0.3814
Dev loss improved; saving best model.

Epoch 2/50
Epoch 2 - Train Loss: 0.9903, Train Accuracy: 0.5459
Epoch 2 - Dev Loss: 1.0600, Dev Accuracy: 0.4661, Dev F1: 0.3739
Dev loss improved; saving best model.

Epoch 3/50
Epoch 3 - Train Loss: 0.9738, Train Accuracy: 0.5530
Epoch 3 - Dev Loss: 1.0371, Dev Accuracy: 0.4743, Dev F1: 0.3811
Dev loss improved; saving best model.

Epoch 4/50
Epoch 4 - Train Loss: 0.9615, Train Accuracy: 0.5575
Epoch 4 - Dev Loss: 1.0385, Dev Accuracy: 0.4699, Dev F1: 0.3777
No improvement on dev loss. Patience: 1/10

Epoch 5/50
Epoch 5 - Train Loss: 0.9516, Train Accuracy: 0.5609
Epoch 5 - Dev Loss: 1.0216, Dev Accuracy: 0.4767, Dev F1: 0.3832
Dev loss improved; saving best model.

Epoch 6/50
Epoch 6 - Train Loss: 0.9433, Train Accuracy: 0.5638
Epoch 6 - Dev Loss: 1.0193, Dev Accuracy: 0.4714, Dev F1: 0.3795
Dev loss improved; saving best model.

Epoch 7/50
Epoch 7 - Train Loss: 0.9362, Train Accuracy: 0.5665
Epoch 7 - Dev Loss: 1.0222, Dev Accuracy: 0.4801, Dev F1: 0.3873
No improvement on dev loss. Patience: 1/10

Epoch 8/50
Epoch 8 - Train Loss: 0.9299, Train Accuracy: 0.5692
Epoch 8 - Dev Loss: 1.0029, Dev Accuracy: 0.4801, Dev F1: 0.3920
Dev loss improved; saving best model.

Epoch 9/50
Epoch 9 - Train Loss: 0.9242, Train Accuracy: 0.5716
Epoch 9 - Dev Loss: 0.9871, Dev Accuracy: 0.4879, Dev F1: 0.4109
Dev loss improved; saving best model.

Epoch 10/50
Epoch 10 - Train Loss: 0.9190, Train Accuracy: 0.5741
Epoch 10 - Dev Loss: 0.9908, Dev Accuracy: 0.4874, Dev F1: 0.4093
No improvement on dev loss. Patience: 1/10

Epoch 11/50
Epoch 11 - Train Loss: 0.9142, Train Accuracy: 0.5765
Epoch 11 - Dev Loss: 0.9801, Dev Accuracy: 0.4952, Dev F1: 0.4233
Dev loss improved; saving best model.

Epoch 12/50
Epoch 12 - Train Loss: 0.9098, Train Accuracy: 0.5788
Epoch 12 - Dev Loss: 0.9822, Dev Accuracy: 0.4937, Dev F1: 0.4209
No improvement on dev loss. Patience: 1/10

Epoch 13/50
Epoch 13 - Train Loss: 0.9056, Train Accuracy: 0.5810
Epoch 13 - Dev Loss: 0.9657, Dev Accuracy: 0.5082, Dev F1: 0.4467
Dev loss improved; saving best model.

Epoch 14/50
Epoch 14 - Train Loss: 0.9018, Train Accuracy: 0.5833
Epoch 14 - Dev Loss: 0.9741, Dev Accuracy: 0.5015, Dev F1: 0.4368
No improvement on dev loss. Patience: 1/10

Epoch 15/50
Epoch 15 - Train Loss: 0.8981, Train Accuracy: 0.5854
Epoch 15 - Dev Loss: 0.9783, Dev Accuracy: 0.5019, Dev F1: 0.4330
No improvement on dev loss. Patience: 2/10

Epoch 16/50
Epoch 16 - Train Loss: 0.8946, Train Accuracy: 0.5873
Epoch 16 - Dev Loss: 0.9564, Dev Accuracy: 0.5194, Dev F1: 0.4672
Dev loss improved; saving best model.

Epoch 17/50
Epoch 17 - Train Loss: 0.8914, Train Accuracy: 0.5893
Epoch 17 - Dev Loss: 0.9693, Dev Accuracy: 0.5073, Dev F1: 0.4463
No improvement on dev loss. Patience: 1/10

Epoch 18/50
Epoch 18 - Train Loss: 0.8882, Train Accuracy: 0.5910
Epoch 18 - Dev Loss: 0.9535, Dev Accuracy: 0.5199, Dev F1: 0.4690
Dev loss improved; saving best model.

Epoch 19/50
Epoch 19 - Train Loss: 0.8853, Train Accuracy: 0.5929
Epoch 19 - Dev Loss: 0.9709, Dev Accuracy: 0.5039, Dev F1: 0.4440
No improvement on dev loss. Patience: 1/10

Epoch 20/50
Epoch 20 - Train Loss: 0.8824, Train Accuracy: 0.5947
Epoch 20 - Dev Loss: 0.9673, Dev Accuracy: 0.5073, Dev F1: 0.4459
No improvement on dev loss. Patience: 2/10

Epoch 21/50
Epoch 21 - Train Loss: 0.8797, Train Accuracy: 0.5964
Epoch 21 - Dev Loss: 0.9619, Dev Accuracy: 0.5141, Dev F1: 0.4591
No improvement on dev loss. Patience: 3/10

Epoch 22/50
Epoch 22 - Train Loss: 0.8771, Train Accuracy: 0.5981
Epoch 22 - Dev Loss: 0.9664, Dev Accuracy: 0.5150, Dev F1: 0.4569
No improvement on dev loss. Patience: 4/10

Epoch 23/50
Epoch 23 - Train Loss: 0.8746, Train Accuracy: 0.5996
Epoch 23 - Dev Loss: 0.9559, Dev Accuracy: 0.5238, Dev F1: 0.4726
No improvement on dev loss. Patience: 5/10

Epoch 24/50
Epoch 24 - Train Loss: 0.8722, Train Accuracy: 0.6012
Epoch 24 - Dev Loss: 0.9471, Dev Accuracy: 0.5281, Dev F1: 0.4830
Dev loss improved; saving best model.

Epoch 25/50
Epoch 25 - Train Loss: 0.8699, Train Accuracy: 0.6027
Epoch 25 - Dev Loss: 0.9519, Dev Accuracy: 0.5228, Dev F1: 0.4741
No improvement on dev loss. Patience: 1/10

Epoch 26/50
Epoch 26 - Train Loss: 0.8677, Train Accuracy: 0.6042
Epoch 26 - Dev Loss: 0.9478, Dev Accuracy: 0.5291, Dev F1: 0.4837
No improvement on dev loss. Patience: 2/10

Epoch 27/50
Epoch 27 - Train Loss: 0.8655, Train Accuracy: 0.6055
Epoch 27 - Dev Loss: 0.9467, Dev Accuracy: 0.5247, Dev F1: 0.4804
Dev loss improved; saving best model.

Epoch 28/50
Epoch 28 - Train Loss: 0.8635, Train Accuracy: 0.6069
Epoch 28 - Dev Loss: 0.9422, Dev Accuracy: 0.5301, Dev F1: 0.4879
Dev loss improved; saving best model.

Epoch 29/50
Epoch 29 - Train Loss: 0.8615, Train Accuracy: 0.6082
Epoch 29 - Dev Loss: 0.9460, Dev Accuracy: 0.5281, Dev F1: 0.4841
No improvement on dev loss. Patience: 1/10

Epoch 30/50
Epoch 30 - Train Loss: 0.8596, Train Accuracy: 0.6094
Epoch 30 - Dev Loss: 0.9404, Dev Accuracy: 0.5310, Dev F1: 0.4926
Dev loss improved; saving best model.

Epoch 31/50
Epoch 31 - Train Loss: 0.8577, Train Accuracy: 0.6106
Epoch 31 - Dev Loss: 0.9365, Dev Accuracy: 0.5344, Dev F1: 0.4951
Dev loss improved; saving best model.

Epoch 32/50
Epoch 32 - Train Loss: 0.8560, Train Accuracy: 0.6119
Epoch 32 - Dev Loss: 0.9345, Dev Accuracy: 0.5383, Dev F1: 0.5018
Dev loss improved; saving best model.

Epoch 33/50
Epoch 33 - Train Loss: 0.8542, Train Accuracy: 0.6131
Epoch 33 - Dev Loss: 0.9476, Dev Accuracy: 0.5272, Dev F1: 0.4820
No improvement on dev loss. Patience: 1/10

Epoch 34/50
Epoch 34 - Train Loss: 0.8526, Train Accuracy: 0.6141
Epoch 34 - Dev Loss: 0.9397, Dev Accuracy: 0.5330, Dev F1: 0.4935
No improvement on dev loss. Patience: 2/10

Epoch 35/50
Epoch 35 - Train Loss: 0.8510, Train Accuracy: 0.6152
Epoch 35 - Dev Loss: 0.9341, Dev Accuracy: 0.5393, Dev F1: 0.5037
Dev loss improved; saving best model.

Epoch 36/50
Epoch 36 - Train Loss: 0.8494, Train Accuracy: 0.6162
Epoch 36 - Dev Loss: 0.9327, Dev Accuracy: 0.5417, Dev F1: 0.5080
Dev loss improved; saving best model.

Epoch 37/50
Epoch 37 - Train Loss: 0.8479, Train Accuracy: 0.6172
Epoch 37 - Dev Loss: 0.9339, Dev Accuracy: 0.5407, Dev F1: 0.5057
No improvement on dev loss. Patience: 1/10

Epoch 38/50
Epoch 38 - Train Loss: 0.8465, Train Accuracy: 0.6182
Epoch 38 - Dev Loss: 0.9369, Dev Accuracy: 0.5359, Dev F1: 0.4979
No improvement on dev loss. Patience: 2/10

Epoch 39/50
Epoch 39 - Train Loss: 0.8451, Train Accuracy: 0.6191
Epoch 39 - Dev Loss: 0.9305, Dev Accuracy: 0.5432, Dev F1: 0.5106
Dev loss improved; saving best model.

Epoch 40/50
Epoch 40 - Train Loss: 0.8437, Train Accuracy: 0.6200
Epoch 40 - Dev Loss: 0.9303, Dev Accuracy: 0.5432, Dev F1: 0.5106
Dev loss improved; saving best model.

Epoch 41/50
Epoch 41 - Train Loss: 0.8424, Train Accuracy: 0.6209
Epoch 41 - Dev Loss: 0.9344, Dev Accuracy: 0.5407, Dev F1: 0.5046
No improvement on dev loss. Patience: 1/10

Epoch 42/50
Epoch 42 - Train Loss: 0.8411, Train Accuracy: 0.6217
Epoch 42 - Dev Loss: 0.9319, Dev Accuracy: 0.5407, Dev F1: 0.5075
No improvement on dev loss. Patience: 2/10

Epoch 43/50
Epoch 43 - Train Loss: 0.8399, Train Accuracy: 0.6225
Epoch 43 - Dev Loss: 0.9259, Dev Accuracy: 0.5490, Dev F1: 0.5193
Dev loss improved; saving best model.

Epoch 44/50
Epoch 44 - Train Loss: 0.8387, Train Accuracy: 0.6234
Epoch 44 - Dev Loss: 0.9290, Dev Accuracy: 0.5441, Dev F1: 0.5125
No improvement on dev loss. Patience: 1/10

Epoch 45/50
Epoch 45 - Train Loss: 0.8376, Train Accuracy: 0.6241
Epoch 45 - Dev Loss: 0.9299, Dev Accuracy: 0.5436, Dev F1: 0.5114
No improvement on dev loss. Patience: 2/10

Epoch 46/50
Epoch 46 - Train Loss: 0.8365, Train Accuracy: 0.6249
Epoch 46 - Dev Loss: 0.9307, Dev Accuracy: 0.5436, Dev F1: 0.5110
No improvement on dev loss. Patience: 3/10

Epoch 47/50
Epoch 47 - Train Loss: 0.8355, Train Accuracy: 0.6256
Epoch 47 - Dev Loss: 0.9295, Dev Accuracy: 0.5441, Dev F1: 0.5121
No improvement on dev loss. Patience: 4/10

Epoch 48/50
Epoch 48 - Train Loss: 0.8344, Train Accuracy: 0.6263
Epoch 48 - Dev Loss: 0.9287, Dev Accuracy: 0.5446, Dev F1: 0.5132
No improvement on dev loss. Patience: 5/10

Epoch 49/50
Epoch 49 - Train Loss: 0.8335, Train Accuracy: 0.6269
Epoch 49 - Dev Loss: 0.9289, Dev Accuracy: 0.5451, Dev F1: 0.5136
No improvement on dev loss. Patience: 6/10

Epoch 50/50
Epoch 50 - Train Loss: 0.8325, Train Accuracy: 0.6275
Epoch 50 - Dev Loss: 0.9289, Dev Accuracy: 0.5446, Dev F1: 0.5132
No improvement on dev loss. Patience: 7/10

Final Training Loss: 0.8325
Final Training Accuracy: 0.6275
Best Dev Loss: 0.9259
Best Dev Accuracy: 0.5446, Best Dev Macro F1: 0.5132
Config LR=0.001, BS=128 -> Dev Loss: 0.9289, Dev Accuracy: 0.5446, Dev F1: 0.5132

=== Running experiment: LR=0.0001, BS=8, Model=linear, Use Prefix=True ===
Encoding training data jointly...
Encoding dev data jointly...

Epoch 1/50
Epoch 1 - Train Loss: 1.0299, Train Accuracy: 0.5332
Epoch 1 - Dev Loss: 1.1190, Dev Accuracy: 0.4685, Dev F1: 0.3749
Dev loss improved; saving best model.

Epoch 2/50
Epoch 2 - Train Loss: 1.0119, Train Accuracy: 0.5459
Epoch 2 - Dev Loss: 1.1029, Dev Accuracy: 0.4568, Dev F1: 0.3661
Dev loss improved; saving best model.

Epoch 3/50
Epoch 3 - Train Loss: 0.9987, Train Accuracy: 0.5506
Epoch 3 - Dev Loss: 1.0757, Dev Accuracy: 0.4699, Dev F1: 0.3770
Dev loss improved; saving best model.

Epoch 4/50
Epoch 4 - Train Loss: 0.9884, Train Accuracy: 0.5544
Epoch 4 - Dev Loss: 1.0671, Dev Accuracy: 0.4690, Dev F1: 0.3762
Dev loss improved; saving best model.

Epoch 5/50
Epoch 5 - Train Loss: 0.9800, Train Accuracy: 0.5566
Epoch 5 - Dev Loss: 1.0636, Dev Accuracy: 0.4656, Dev F1: 0.3735
Dev loss improved; saving best model.

Epoch 6/50
Epoch 6 - Train Loss: 0.9729, Train Accuracy: 0.5584
Epoch 6 - Dev Loss: 1.0486, Dev Accuracy: 0.4690, Dev F1: 0.3762
Dev loss improved; saving best model.

Epoch 7/50
Epoch 7 - Train Loss: 0.9668, Train Accuracy: 0.5603
Epoch 7 - Dev Loss: 1.0413, Dev Accuracy: 0.4704, Dev F1: 0.3781
Dev loss improved; saving best model.

Epoch 8/50
Epoch 8 - Train Loss: 0.9615, Train Accuracy: 0.5619
Epoch 8 - Dev Loss: 1.0454, Dev Accuracy: 0.4738, Dev F1: 0.3807
No improvement on dev loss. Patience: 1/10

Epoch 9/50
Epoch 9 - Train Loss: 0.9568, Train Accuracy: 0.5632
Epoch 9 - Dev Loss: 1.0363, Dev Accuracy: 0.4724, Dev F1: 0.3796
Dev loss improved; saving best model.

Epoch 10/50
Epoch 10 - Train Loss: 0.9526, Train Accuracy: 0.5642
Epoch 10 - Dev Loss: 1.0290, Dev Accuracy: 0.4753, Dev F1: 0.3821
Dev loss improved; saving best model.

Epoch 11/50
Epoch 11 - Train Loss: 0.9487, Train Accuracy: 0.5653
Epoch 11 - Dev Loss: 1.0277, Dev Accuracy: 0.4748, Dev F1: 0.3817
Dev loss improved; saving best model.

Epoch 12/50
Epoch 12 - Train Loss: 0.9452, Train Accuracy: 0.5662
Epoch 12 - Dev Loss: 1.0187, Dev Accuracy: 0.4748, Dev F1: 0.3817
Dev loss improved; saving best model.

Epoch 13/50
Epoch 13 - Train Loss: 0.9419, Train Accuracy: 0.5671
Epoch 13 - Dev Loss: 1.0143, Dev Accuracy: 0.4782, Dev F1: 0.3851
Dev loss improved; saving best model.

Epoch 14/50
Epoch 14 - Train Loss: 0.9389, Train Accuracy: 0.5681
Epoch 14 - Dev Loss: 1.0195, Dev Accuracy: 0.4743, Dev F1: 0.3820
No improvement on dev loss. Patience: 1/10

Epoch 15/50
Epoch 15 - Train Loss: 0.9360, Train Accuracy: 0.5689
Epoch 15 - Dev Loss: 1.0138, Dev Accuracy: 0.4753, Dev F1: 0.3841
Dev loss improved; saving best model.

Epoch 16/50
Epoch 16 - Train Loss: 0.9333, Train Accuracy: 0.5698
Epoch 16 - Dev Loss: 1.0040, Dev Accuracy: 0.4762, Dev F1: 0.3868
Dev loss improved; saving best model.

Epoch 17/50
Epoch 17 - Train Loss: 0.9308, Train Accuracy: 0.5707
Epoch 17 - Dev Loss: 1.0125, Dev Accuracy: 0.4758, Dev F1: 0.3857
No improvement on dev loss. Patience: 1/10

Epoch 18/50
Epoch 18 - Train Loss: 0.9285, Train Accuracy: 0.5716
Epoch 18 - Dev Loss: 1.0098, Dev Accuracy: 0.4772, Dev F1: 0.3869
No improvement on dev loss. Patience: 2/10

Epoch 19/50
Epoch 19 - Train Loss: 0.9262, Train Accuracy: 0.5725
Epoch 19 - Dev Loss: 1.0064, Dev Accuracy: 0.4816, Dev F1: 0.3918
No improvement on dev loss. Patience: 3/10

Epoch 20/50
Epoch 20 - Train Loss: 0.9241, Train Accuracy: 0.5733
Epoch 20 - Dev Loss: 1.0020, Dev Accuracy: 0.4811, Dev F1: 0.3934
Dev loss improved; saving best model.

Epoch 21/50
Epoch 21 - Train Loss: 0.9220, Train Accuracy: 0.5741
Epoch 21 - Dev Loss: 1.0037, Dev Accuracy: 0.4830, Dev F1: 0.3949
No improvement on dev loss. Patience: 1/10

Epoch 22/50
Epoch 22 - Train Loss: 0.9201, Train Accuracy: 0.5749
Epoch 22 - Dev Loss: 1.0075, Dev Accuracy: 0.4835, Dev F1: 0.3947
No improvement on dev loss. Patience: 2/10

Epoch 23/50
Epoch 23 - Train Loss: 0.9182, Train Accuracy: 0.5756
Epoch 23 - Dev Loss: 0.9982, Dev Accuracy: 0.4850, Dev F1: 0.3997
Dev loss improved; saving best model.

Epoch 24/50
Epoch 24 - Train Loss: 0.9164, Train Accuracy: 0.5764
Epoch 24 - Dev Loss: 0.9968, Dev Accuracy: 0.4864, Dev F1: 0.4022
Dev loss improved; saving best model.

Epoch 25/50
Epoch 25 - Train Loss: 0.9147, Train Accuracy: 0.5771
Epoch 25 - Dev Loss: 0.9967, Dev Accuracy: 0.4855, Dev F1: 0.4021
Dev loss improved; saving best model.

Epoch 26/50
Epoch 26 - Train Loss: 0.9131, Train Accuracy: 0.5778
Epoch 26 - Dev Loss: 1.0008, Dev Accuracy: 0.4825, Dev F1: 0.3984
No improvement on dev loss. Patience: 1/10

Epoch 27/50
Epoch 27 - Train Loss: 0.9115, Train Accuracy: 0.5785
Epoch 27 - Dev Loss: 0.9930, Dev Accuracy: 0.4864, Dev F1: 0.4054
Dev loss improved; saving best model.

Epoch 28/50
Epoch 28 - Train Loss: 0.9100, Train Accuracy: 0.5792
Epoch 28 - Dev Loss: 0.9884, Dev Accuracy: 0.4888, Dev F1: 0.4111
Dev loss improved; saving best model.

Epoch 29/50
Epoch 29 - Train Loss: 0.9086, Train Accuracy: 0.5799
Epoch 29 - Dev Loss: 0.9913, Dev Accuracy: 0.4879, Dev F1: 0.4091
No improvement on dev loss. Patience: 1/10

Epoch 30/50
Epoch 30 - Train Loss: 0.9072, Train Accuracy: 0.5806
Epoch 30 - Dev Loss: 0.9924, Dev Accuracy: 0.4879, Dev F1: 0.4084
No improvement on dev loss. Patience: 2/10

Epoch 31/50
Epoch 31 - Train Loss: 0.9058, Train Accuracy: 0.5812
Epoch 31 - Dev Loss: 0.9926, Dev Accuracy: 0.4932, Dev F1: 0.4121
No improvement on dev loss. Patience: 3/10

Epoch 32/50
Epoch 32 - Train Loss: 0.9045, Train Accuracy: 0.5818
Epoch 32 - Dev Loss: 0.9923, Dev Accuracy: 0.4903, Dev F1: 0.4104
No improvement on dev loss. Patience: 4/10

Epoch 33/50
Epoch 33 - Train Loss: 0.9033, Train Accuracy: 0.5824
Epoch 33 - Dev Loss: 0.9909, Dev Accuracy: 0.4874, Dev F1: 0.4099
No improvement on dev loss. Patience: 5/10

Epoch 34/50
Epoch 34 - Train Loss: 0.9021, Train Accuracy: 0.5831
Epoch 34 - Dev Loss: 0.9897, Dev Accuracy: 0.4903, Dev F1: 0.4116
No improvement on dev loss. Patience: 6/10

Epoch 35/50
Epoch 35 - Train Loss: 0.9009, Train Accuracy: 0.5837
Epoch 35 - Dev Loss: 0.9919, Dev Accuracy: 0.4879, Dev F1: 0.4091
No improvement on dev loss. Patience: 7/10

Epoch 36/50
Epoch 36 - Train Loss: 0.8998, Train Accuracy: 0.5842
Epoch 36 - Dev Loss: 0.9863, Dev Accuracy: 0.4918, Dev F1: 0.4153
Dev loss improved; saving best model.

Epoch 37/50
Epoch 37 - Train Loss: 0.8987, Train Accuracy: 0.5848
Epoch 37 - Dev Loss: 0.9876, Dev Accuracy: 0.4884, Dev F1: 0.4113
No improvement on dev loss. Patience: 1/10

Epoch 38/50
Epoch 38 - Train Loss: 0.8976, Train Accuracy: 0.5854
Epoch 38 - Dev Loss: 0.9856, Dev Accuracy: 0.4908, Dev F1: 0.4157
Dev loss improved; saving best model.

Epoch 39/50
Epoch 39 - Train Loss: 0.8966, Train Accuracy: 0.5859
Epoch 39 - Dev Loss: 0.9839, Dev Accuracy: 0.4947, Dev F1: 0.4206
Dev loss improved; saving best model.

Epoch 40/50
Epoch 40 - Train Loss: 0.8956, Train Accuracy: 0.5864
Epoch 40 - Dev Loss: 0.9829, Dev Accuracy: 0.4956, Dev F1: 0.4220
Dev loss improved; saving best model.

Epoch 41/50
Epoch 41 - Train Loss: 0.8947, Train Accuracy: 0.5869
Epoch 41 - Dev Loss: 0.9810, Dev Accuracy: 0.4966, Dev F1: 0.4250
Dev loss improved; saving best model.

Epoch 42/50
Epoch 42 - Train Loss: 0.8938, Train Accuracy: 0.5874
Epoch 42 - Dev Loss: 0.9822, Dev Accuracy: 0.4971, Dev F1: 0.4249
No improvement on dev loss. Patience: 1/10

Epoch 43/50
Epoch 43 - Train Loss: 0.8929, Train Accuracy: 0.5878
Epoch 43 - Dev Loss: 0.9815, Dev Accuracy: 0.4952, Dev F1: 0.4232
No improvement on dev loss. Patience: 2/10

Epoch 44/50
Epoch 44 - Train Loss: 0.8920, Train Accuracy: 0.5883
Epoch 44 - Dev Loss: 0.9820, Dev Accuracy: 0.4961, Dev F1: 0.4240
No improvement on dev loss. Patience: 3/10

Epoch 45/50
Epoch 45 - Train Loss: 0.8912, Train Accuracy: 0.5887
Epoch 45 - Dev Loss: 0.9815, Dev Accuracy: 0.4966, Dev F1: 0.4250
No improvement on dev loss. Patience: 4/10

Epoch 46/50
Epoch 46 - Train Loss: 0.8904, Train Accuracy: 0.5891
Epoch 46 - Dev Loss: 0.9817, Dev Accuracy: 0.4956, Dev F1: 0.4236
No improvement on dev loss. Patience: 5/10

Epoch 47/50
Epoch 47 - Train Loss: 0.8897, Train Accuracy: 0.5895
Epoch 47 - Dev Loss: 0.9819, Dev Accuracy: 0.4952, Dev F1: 0.4232
No improvement on dev loss. Patience: 6/10

Epoch 48/50
Epoch 48 - Train Loss: 0.8889, Train Accuracy: 0.5899
Epoch 48 - Dev Loss: 0.9817, Dev Accuracy: 0.4952, Dev F1: 0.4232
No improvement on dev loss. Patience: 7/10

Epoch 49/50
Epoch 49 - Train Loss: 0.8882, Train Accuracy: 0.5903
Epoch 49 - Dev Loss: 0.9818, Dev Accuracy: 0.4952, Dev F1: 0.4232
No improvement on dev loss. Patience: 8/10

Epoch 50/50
Epoch 50 - Train Loss: 0.8876, Train Accuracy: 0.5906
Epoch 50 - Dev Loss: 0.9817, Dev Accuracy: 0.4952, Dev F1: 0.4232
No improvement on dev loss. Patience: 9/10

Final Training Loss: 0.8876
Final Training Accuracy: 0.5906
Best Dev Loss: 0.9810
Best Dev Accuracy: 0.4952, Best Dev Macro F1: 0.4232
Config LR=0.0001, BS=8 -> Dev Loss: 0.9817, Dev Accuracy: 0.4952, Dev F1: 0.4232

=== Running experiment: LR=0.0001, BS=16, Model=linear, Use Prefix=True ===
Encoding training data jointly...
Encoding dev data jointly...

Epoch 1/50
Epoch 1 - Train Loss: 1.0386, Train Accuracy: 0.5238
Epoch 1 - Dev Loss: 1.1351, Dev Accuracy: 0.4597, Dev F1: 0.3661
Dev loss improved; saving best model.

Epoch 2/50
Epoch 2 - Train Loss: 1.0232, Train Accuracy: 0.5402
Epoch 2 - Dev Loss: 1.1142, Dev Accuracy: 0.4719, Dev F1: 0.3786
Dev loss improved; saving best model.

Epoch 3/50
Epoch 3 - Train Loss: 1.0116, Train Accuracy: 0.5470
Epoch 3 - Dev Loss: 1.0921, Dev Accuracy: 0.4690, Dev F1: 0.3762
Dev loss improved; saving best model.

Epoch 4/50
Epoch 4 - Train Loss: 1.0023, Train Accuracy: 0.5507
Epoch 4 - Dev Loss: 1.0866, Dev Accuracy: 0.4753, Dev F1: 0.3813
Dev loss improved; saving best model.

Epoch 5/50
Epoch 5 - Train Loss: 0.9944, Train Accuracy: 0.5530
Epoch 5 - Dev Loss: 1.0803, Dev Accuracy: 0.4762, Dev F1: 0.3820
Dev loss improved; saving best model.

Epoch 6/50
Epoch 6 - Train Loss: 0.9877, Train Accuracy: 0.5548
Epoch 6 - Dev Loss: 1.0685, Dev Accuracy: 0.4714, Dev F1: 0.3782
Dev loss improved; saving best model.

Epoch 7/50
Epoch 7 - Train Loss: 0.9819, Train Accuracy: 0.5563
Epoch 7 - Dev Loss: 1.0604, Dev Accuracy: 0.4661, Dev F1: 0.3739
Dev loss improved; saving best model.

Epoch 8/50
Epoch 8 - Train Loss: 0.9767, Train Accuracy: 0.5576
Epoch 8 - Dev Loss: 1.0550, Dev Accuracy: 0.4675, Dev F1: 0.3751
Dev loss improved; saving best model.

Epoch 9/50
Epoch 9 - Train Loss: 0.9722, Train Accuracy: 0.5588
Epoch 9 - Dev Loss: 1.0505, Dev Accuracy: 0.4699, Dev F1: 0.3770
Dev loss improved; saving best model.

Epoch 10/50
Epoch 10 - Train Loss: 0.9680, Train Accuracy: 0.5599
Epoch 10 - Dev Loss: 1.0506, Dev Accuracy: 0.4694, Dev F1: 0.3766
No improvement on dev loss. Patience: 1/10

Epoch 11/50
Epoch 11 - Train Loss: 0.9643, Train Accuracy: 0.5610
Epoch 11 - Dev Loss: 1.0462, Dev Accuracy: 0.4699, Dev F1: 0.3777
Dev loss improved; saving best model.

Epoch 12/50
Epoch 12 - Train Loss: 0.9608, Train Accuracy: 0.5618
Epoch 12 - Dev Loss: 1.0425, Dev Accuracy: 0.4709, Dev F1: 0.3785
Dev loss improved; saving best model.

Epoch 13/50
Epoch 13 - Train Loss: 0.9576, Train Accuracy: 0.5627
Epoch 13 - Dev Loss: 1.0342, Dev Accuracy: 0.4694, Dev F1: 0.3773
Dev loss improved; saving best model.

Epoch 14/50
Epoch 14 - Train Loss: 0.9547, Train Accuracy: 0.5635
Epoch 14 - Dev Loss: 1.0332, Dev Accuracy: 0.4699, Dev F1: 0.3777
Dev loss improved; saving best model.

Epoch 15/50
Epoch 15 - Train Loss: 0.9520, Train Accuracy: 0.5643
Epoch 15 - Dev Loss: 1.0347, Dev Accuracy: 0.4709, Dev F1: 0.3785
No improvement on dev loss. Patience: 1/10

Epoch 16/50
Epoch 16 - Train Loss: 0.9494, Train Accuracy: 0.5650
Epoch 16 - Dev Loss: 1.0267, Dev Accuracy: 0.4762, Dev F1: 0.3828
Dev loss improved; saving best model.

Epoch 17/50
Epoch 17 - Train Loss: 0.9470, Train Accuracy: 0.5657
Epoch 17 - Dev Loss: 1.0328, Dev Accuracy: 0.4694, Dev F1: 0.3773
No improvement on dev loss. Patience: 1/10

Epoch 18/50
Epoch 18 - Train Loss: 0.9447, Train Accuracy: 0.5662
Epoch 18 - Dev Loss: 1.0274, Dev Accuracy: 0.4699, Dev F1: 0.3777
No improvement on dev loss. Patience: 2/10

Epoch 19/50
Epoch 19 - Train Loss: 0.9426, Train Accuracy: 0.5668
Epoch 19 - Dev Loss: 1.0254, Dev Accuracy: 0.4719, Dev F1: 0.3793
Dev loss improved; saving best model.

Epoch 20/50
Epoch 20 - Train Loss: 0.9405, Train Accuracy: 0.5674
Epoch 20 - Dev Loss: 1.0171, Dev Accuracy: 0.4748, Dev F1: 0.3830
Dev loss improved; saving best model.

Epoch 21/50
Epoch 21 - Train Loss: 0.9386, Train Accuracy: 0.5680
Epoch 21 - Dev Loss: 1.0136, Dev Accuracy: 0.4724, Dev F1: 0.3811
Dev loss improved; saving best model.

Epoch 22/50
Epoch 22 - Train Loss: 0.9368, Train Accuracy: 0.5686
Epoch 22 - Dev Loss: 1.0186, Dev Accuracy: 0.4719, Dev F1: 0.3800
No improvement on dev loss. Patience: 1/10

Epoch 23/50
Epoch 23 - Train Loss: 0.9350, Train Accuracy: 0.5692
Epoch 23 - Dev Loss: 1.0150, Dev Accuracy: 0.4791, Dev F1: 0.3865
No improvement on dev loss. Patience: 2/10

Epoch 24/50
Epoch 24 - Train Loss: 0.9333, Train Accuracy: 0.5697
Epoch 24 - Dev Loss: 1.0224, Dev Accuracy: 0.4724, Dev F1: 0.3804
No improvement on dev loss. Patience: 3/10

Epoch 25/50
Epoch 25 - Train Loss: 0.9317, Train Accuracy: 0.5703
Epoch 25 - Dev Loss: 1.0185, Dev Accuracy: 0.4738, Dev F1: 0.3822
No improvement on dev loss. Patience: 4/10

Epoch 26/50
Epoch 26 - Train Loss: 0.9302, Train Accuracy: 0.5708
Epoch 26 - Dev Loss: 1.0155, Dev Accuracy: 0.4733, Dev F1: 0.3818
No improvement on dev loss. Patience: 5/10

Epoch 27/50
Epoch 27 - Train Loss: 0.9287, Train Accuracy: 0.5714
Epoch 27 - Dev Loss: 1.0097, Dev Accuracy: 0.4758, Dev F1: 0.3858
Dev loss improved; saving best model.

Epoch 28/50
Epoch 28 - Train Loss: 0.9273, Train Accuracy: 0.5719
Epoch 28 - Dev Loss: 1.0104, Dev Accuracy: 0.4772, Dev F1: 0.3876
No improvement on dev loss. Patience: 1/10

Epoch 29/50
Epoch 29 - Train Loss: 0.9260, Train Accuracy: 0.5724
Epoch 29 - Dev Loss: 1.0096, Dev Accuracy: 0.4753, Dev F1: 0.3860
Dev loss improved; saving best model.

Epoch 30/50
Epoch 30 - Train Loss: 0.9247, Train Accuracy: 0.5728
Epoch 30 - Dev Loss: 1.0077, Dev Accuracy: 0.4806, Dev F1: 0.3916
Dev loss improved; saving best model.

Epoch 31/50
Epoch 31 - Train Loss: 0.9234, Train Accuracy: 0.5733
Epoch 31 - Dev Loss: 1.0093, Dev Accuracy: 0.4772, Dev F1: 0.3882
No improvement on dev loss. Patience: 1/10

Epoch 32/50
Epoch 32 - Train Loss: 0.9222, Train Accuracy: 0.5737
Epoch 32 - Dev Loss: 1.0088, Dev Accuracy: 0.4791, Dev F1: 0.3898
No improvement on dev loss. Patience: 2/10

Epoch 33/50
Epoch 33 - Train Loss: 0.9211, Train Accuracy: 0.5741
Epoch 33 - Dev Loss: 1.0075, Dev Accuracy: 0.4777, Dev F1: 0.3893
Dev loss improved; saving best model.

Epoch 34/50
Epoch 34 - Train Loss: 0.9199, Train Accuracy: 0.5746
Epoch 34 - Dev Loss: 1.0082, Dev Accuracy: 0.4806, Dev F1: 0.3916
No improvement on dev loss. Patience: 1/10

Epoch 35/50
Epoch 35 - Train Loss: 0.9189, Train Accuracy: 0.5750
Epoch 35 - Dev Loss: 1.0069, Dev Accuracy: 0.4782, Dev F1: 0.3896
Dev loss improved; saving best model.

Epoch 36/50
Epoch 36 - Train Loss: 0.9178, Train Accuracy: 0.5754
Epoch 36 - Dev Loss: 1.0045, Dev Accuracy: 0.4787, Dev F1: 0.3913
Dev loss improved; saving best model.

Epoch 37/50
Epoch 37 - Train Loss: 0.9168, Train Accuracy: 0.5758
Epoch 37 - Dev Loss: 1.0048, Dev Accuracy: 0.4787, Dev F1: 0.3907
No improvement on dev loss. Patience: 1/10

Epoch 38/50
Epoch 38 - Train Loss: 0.9159, Train Accuracy: 0.5761
Epoch 38 - Dev Loss: 1.0026, Dev Accuracy: 0.4806, Dev F1: 0.3943
Dev loss improved; saving best model.

Epoch 39/50
Epoch 39 - Train Loss: 0.9149, Train Accuracy: 0.5765
Epoch 39 - Dev Loss: 1.0043, Dev Accuracy: 0.4791, Dev F1: 0.3917
No improvement on dev loss. Patience: 1/10

Epoch 40/50
Epoch 40 - Train Loss: 0.9140, Train Accuracy: 0.5769
Epoch 40 - Dev Loss: 1.0021, Dev Accuracy: 0.4796, Dev F1: 0.3935
Dev loss improved; saving best model.

Epoch 41/50
Epoch 41 - Train Loss: 0.9132, Train Accuracy: 0.5772
Epoch 41 - Dev Loss: 1.0019, Dev Accuracy: 0.4791, Dev F1: 0.3931
Dev loss improved; saving best model.

Epoch 42/50
Epoch 42 - Train Loss: 0.9123, Train Accuracy: 0.5775
Epoch 42 - Dev Loss: 1.0017, Dev Accuracy: 0.4806, Dev F1: 0.3949
Dev loss improved; saving best model.

Epoch 43/50
Epoch 43 - Train Loss: 0.9115, Train Accuracy: 0.5779
Epoch 43 - Dev Loss: 1.0018, Dev Accuracy: 0.4821, Dev F1: 0.3961
No improvement on dev loss. Patience: 1/10

Epoch 44/50
Epoch 44 - Train Loss: 0.9107, Train Accuracy: 0.5782
Epoch 44 - Dev Loss: 1.0010, Dev Accuracy: 0.4830, Dev F1: 0.3975
Dev loss improved; saving best model.

Epoch 45/50
Epoch 45 - Train Loss: 0.9100, Train Accuracy: 0.5785
Epoch 45 - Dev Loss: 1.0013, Dev Accuracy: 0.4821, Dev F1: 0.3967
No improvement on dev loss. Patience: 1/10

Epoch 46/50
Epoch 46 - Train Loss: 0.9093, Train Accuracy: 0.5788
Epoch 46 - Dev Loss: 1.0013, Dev Accuracy: 0.4821, Dev F1: 0.3967
No improvement on dev loss. Patience: 2/10

Epoch 47/50
Epoch 47 - Train Loss: 0.9086, Train Accuracy: 0.5791
Epoch 47 - Dev Loss: 1.0009, Dev Accuracy: 0.4811, Dev F1: 0.3959
Dev loss improved; saving best model.

Epoch 48/50
Epoch 48 - Train Loss: 0.9079, Train Accuracy: 0.5794
Epoch 48 - Dev Loss: 1.0009, Dev Accuracy: 0.4821, Dev F1: 0.3967
Dev loss improved; saving best model.

Epoch 49/50
Epoch 49 - Train Loss: 0.9072, Train Accuracy: 0.5796
Epoch 49 - Dev Loss: 1.0007, Dev Accuracy: 0.4811, Dev F1: 0.3959
Dev loss improved; saving best model.

Epoch 50/50
Epoch 50 - Train Loss: 0.9066, Train Accuracy: 0.5799
Epoch 50 - Dev Loss: 1.0008, Dev Accuracy: 0.4811, Dev F1: 0.3959
No improvement on dev loss. Patience: 1/10

Final Training Loss: 0.9066
Final Training Accuracy: 0.5799
Best Dev Loss: 1.0007
Best Dev Accuracy: 0.4811, Best Dev Macro F1: 0.3959
Config LR=0.0001, BS=16 -> Dev Loss: 1.0008, Dev Accuracy: 0.4811, Dev F1: 0.3959

=== Running experiment: LR=0.0001, BS=32, Model=linear, Use Prefix=True ===
Encoding training data jointly...
Encoding dev data jointly...

Epoch 1/50
Epoch 1 - Train Loss: 1.0468, Train Accuracy: 0.5140
Epoch 1 - Dev Loss: 1.1401, Dev Accuracy: 0.4743, Dev F1: 0.3793
Dev loss improved; saving best model.

Epoch 2/50
Epoch 2 - Train Loss: 1.0330, Train Accuracy: 0.5355
Epoch 2 - Dev Loss: 1.1281, Dev Accuracy: 0.4690, Dev F1: 0.3762
Dev loss improved; saving best model.

Epoch 3/50
Epoch 3 - Train Loss: 1.0232, Train Accuracy: 0.5434
Epoch 3 - Dev Loss: 1.1159, Dev Accuracy: 0.4733, Dev F1: 0.3797
Dev loss improved; saving best model.

Epoch 4/50
Epoch 4 - Train Loss: 1.0151, Train Accuracy: 0.5478
Epoch 4 - Dev Loss: 1.0993, Dev Accuracy: 0.4704, Dev F1: 0.3774
Dev loss improved; saving best model.

Epoch 5/50
Epoch 5 - Train Loss: 1.0082, Train Accuracy: 0.5506
Epoch 5 - Dev Loss: 1.0953, Dev Accuracy: 0.4728, Dev F1: 0.3793
Dev loss improved; saving best model.

Epoch 6/50
Epoch 6 - Train Loss: 1.0021, Train Accuracy: 0.5526
Epoch 6 - Dev Loss: 1.0865, Dev Accuracy: 0.4617, Dev F1: 0.3703
Dev loss improved; saving best model.

Epoch 7/50
Epoch 7 - Train Loss: 0.9968, Train Accuracy: 0.5542
Epoch 7 - Dev Loss: 1.0766, Dev Accuracy: 0.4690, Dev F1: 0.3762
Dev loss improved; saving best model.

Epoch 8/50
Epoch 8 - Train Loss: 0.9919, Train Accuracy: 0.5554
Epoch 8 - Dev Loss: 1.0723, Dev Accuracy: 0.4724, Dev F1: 0.3790
Dev loss improved; saving best model.

Epoch 9/50
Epoch 9 - Train Loss: 0.9876, Train Accuracy: 0.5565
Epoch 9 - Dev Loss: 1.0666, Dev Accuracy: 0.4743, Dev F1: 0.3805
Dev loss improved; saving best model.

Epoch 10/50
Epoch 10 - Train Loss: 0.9837, Train Accuracy: 0.5574
Epoch 10 - Dev Loss: 1.0661, Dev Accuracy: 0.4690, Dev F1: 0.3762
Dev loss improved; saving best model.

Epoch 11/50
Epoch 11 - Train Loss: 0.9800, Train Accuracy: 0.5584
Epoch 11 - Dev Loss: 1.0627, Dev Accuracy: 0.4675, Dev F1: 0.3751
Dev loss improved; saving best model.

Epoch 12/50
Epoch 12 - Train Loss: 0.9767, Train Accuracy: 0.5592
Epoch 12 - Dev Loss: 1.0590, Dev Accuracy: 0.4680, Dev F1: 0.3754
Dev loss improved; saving best model.

Epoch 13/50
Epoch 13 - Train Loss: 0.9737, Train Accuracy: 0.5600
Epoch 13 - Dev Loss: 1.0536, Dev Accuracy: 0.4753, Dev F1: 0.3813
Dev loss improved; saving best model.

Epoch 14/50
Epoch 14 - Train Loss: 0.9708, Train Accuracy: 0.5606
Epoch 14 - Dev Loss: 1.0465, Dev Accuracy: 0.4694, Dev F1: 0.3766
Dev loss improved; saving best model.

Epoch 15/50
Epoch 15 - Train Loss: 0.9681, Train Accuracy: 0.5613
Epoch 15 - Dev Loss: 1.0487, Dev Accuracy: 0.4738, Dev F1: 0.3801
No improvement on dev loss. Patience: 1/10

Epoch 16/50
Epoch 16 - Train Loss: 0.9656, Train Accuracy: 0.5619
Epoch 16 - Dev Loss: 1.0466, Dev Accuracy: 0.4690, Dev F1: 0.3762
No improvement on dev loss. Patience: 2/10

Epoch 17/50
Epoch 17 - Train Loss: 0.9633, Train Accuracy: 0.5624
Epoch 17 - Dev Loss: 1.0454, Dev Accuracy: 0.4699, Dev F1: 0.3777
Dev loss improved; saving best model.

Epoch 18/50
Epoch 18 - Train Loss: 0.9611, Train Accuracy: 0.5630
Epoch 18 - Dev Loss: 1.0414, Dev Accuracy: 0.4699, Dev F1: 0.3777
Dev loss improved; saving best model.

Epoch 19/50
Epoch 19 - Train Loss: 0.9590, Train Accuracy: 0.5635
Epoch 19 - Dev Loss: 1.0425, Dev Accuracy: 0.4699, Dev F1: 0.3777
No improvement on dev loss. Patience: 1/10

Epoch 20/50
Epoch 20 - Train Loss: 0.9570, Train Accuracy: 0.5639
Epoch 20 - Dev Loss: 1.0386, Dev Accuracy: 0.4709, Dev F1: 0.3784
Dev loss improved; saving best model.

Epoch 21/50
Epoch 21 - Train Loss: 0.9552, Train Accuracy: 0.5643
Epoch 21 - Dev Loss: 1.0388, Dev Accuracy: 0.4704, Dev F1: 0.3780
No improvement on dev loss. Patience: 1/10

Epoch 22/50
Epoch 22 - Train Loss: 0.9534, Train Accuracy: 0.5648
Epoch 22 - Dev Loss: 1.0342, Dev Accuracy: 0.4709, Dev F1: 0.3784
Dev loss improved; saving best model.

Epoch 23/50
Epoch 23 - Train Loss: 0.9517, Train Accuracy: 0.5652
Epoch 23 - Dev Loss: 1.0332, Dev Accuracy: 0.4709, Dev F1: 0.3785
Dev loss improved; saving best model.

Epoch 24/50
Epoch 24 - Train Loss: 0.9501, Train Accuracy: 0.5656
Epoch 24 - Dev Loss: 1.0301, Dev Accuracy: 0.4709, Dev F1: 0.3785
Dev loss improved; saving best model.

Epoch 25/50
Epoch 25 - Train Loss: 0.9486, Train Accuracy: 0.5660
Epoch 25 - Dev Loss: 1.0305, Dev Accuracy: 0.4714, Dev F1: 0.3788
No improvement on dev loss. Patience: 1/10

Epoch 26/50
Epoch 26 - Train Loss: 0.9471, Train Accuracy: 0.5663
Epoch 26 - Dev Loss: 1.0334, Dev Accuracy: 0.4719, Dev F1: 0.3792
No improvement on dev loss. Patience: 2/10

Epoch 27/50
Epoch 27 - Train Loss: 0.9457, Train Accuracy: 0.5666
Epoch 27 - Dev Loss: 1.0318, Dev Accuracy: 0.4719, Dev F1: 0.3794
No improvement on dev loss. Patience: 3/10

Epoch 28/50
Epoch 28 - Train Loss: 0.9443, Train Accuracy: 0.5669
Epoch 28 - Dev Loss: 1.0290, Dev Accuracy: 0.4724, Dev F1: 0.3797
Dev loss improved; saving best model.

Epoch 29/50
Epoch 29 - Train Loss: 0.9431, Train Accuracy: 0.5673
Epoch 29 - Dev Loss: 1.0287, Dev Accuracy: 0.4728, Dev F1: 0.3801
Dev loss improved; saving best model.

Epoch 30/50
Epoch 30 - Train Loss: 0.9418, Train Accuracy: 0.5676
Epoch 30 - Dev Loss: 1.0256, Dev Accuracy: 0.4724, Dev F1: 0.3797
Dev loss improved; saving best model.

Epoch 31/50
Epoch 31 - Train Loss: 0.9406, Train Accuracy: 0.5679
Epoch 31 - Dev Loss: 1.0234, Dev Accuracy: 0.4724, Dev F1: 0.3797
Dev loss improved; saving best model.

Epoch 32/50
Epoch 32 - Train Loss: 0.9395, Train Accuracy: 0.5682
Epoch 32 - Dev Loss: 1.0236, Dev Accuracy: 0.4724, Dev F1: 0.3797
No improvement on dev loss. Patience: 1/10

Epoch 33/50
Epoch 33 - Train Loss: 0.9384, Train Accuracy: 0.5685
Epoch 33 - Dev Loss: 1.0207, Dev Accuracy: 0.4733, Dev F1: 0.3805
Dev loss improved; saving best model.

Epoch 34/50
Epoch 34 - Train Loss: 0.9373, Train Accuracy: 0.5688
Epoch 34 - Dev Loss: 1.0209, Dev Accuracy: 0.4719, Dev F1: 0.3793
No improvement on dev loss. Patience: 1/10

Epoch 35/50
Epoch 35 - Train Loss: 0.9363, Train Accuracy: 0.5691
Epoch 35 - Dev Loss: 1.0212, Dev Accuracy: 0.4709, Dev F1: 0.3786
No improvement on dev loss. Patience: 2/10

Epoch 36/50
Epoch 36 - Train Loss: 0.9353, Train Accuracy: 0.5693
Epoch 36 - Dev Loss: 1.0203, Dev Accuracy: 0.4714, Dev F1: 0.3789
Dev loss improved; saving best model.

Epoch 37/50
Epoch 37 - Train Loss: 0.9344, Train Accuracy: 0.5696
Epoch 37 - Dev Loss: 1.0200, Dev Accuracy: 0.4714, Dev F1: 0.3796
Dev loss improved; saving best model.

Epoch 38/50
Epoch 38 - Train Loss: 0.9335, Train Accuracy: 0.5699
Epoch 38 - Dev Loss: 1.0196, Dev Accuracy: 0.4728, Dev F1: 0.3808
Dev loss improved; saving best model.

Epoch 39/50
Epoch 39 - Train Loss: 0.9326, Train Accuracy: 0.5701
Epoch 39 - Dev Loss: 1.0196, Dev Accuracy: 0.4728, Dev F1: 0.3808
Dev loss improved; saving best model.

Epoch 40/50
Epoch 40 - Train Loss: 0.9317, Train Accuracy: 0.5704
Epoch 40 - Dev Loss: 1.0191, Dev Accuracy: 0.4724, Dev F1: 0.3804
Dev loss improved; saving best model.

Epoch 41/50
Epoch 41 - Train Loss: 0.9309, Train Accuracy: 0.5707
Epoch 41 - Dev Loss: 1.0187, Dev Accuracy: 0.4724, Dev F1: 0.3804
Dev loss improved; saving best model.

Epoch 42/50
Epoch 42 - Train Loss: 0.9301, Train Accuracy: 0.5709
Epoch 42 - Dev Loss: 1.0185, Dev Accuracy: 0.4724, Dev F1: 0.3804
Dev loss improved; saving best model.

Epoch 43/50
Epoch 43 - Train Loss: 0.9294, Train Accuracy: 0.5711
Epoch 43 - Dev Loss: 1.0182, Dev Accuracy: 0.4724, Dev F1: 0.3804
Dev loss improved; saving best model.

Epoch 44/50
Epoch 44 - Train Loss: 0.9286, Train Accuracy: 0.5714
Epoch 44 - Dev Loss: 1.0181, Dev Accuracy: 0.4724, Dev F1: 0.3804
Dev loss improved; saving best model.

Epoch 45/50
Epoch 45 - Train Loss: 0.9279, Train Accuracy: 0.5716
Epoch 45 - Dev Loss: 1.0177, Dev Accuracy: 0.4724, Dev F1: 0.3804
Dev loss improved; saving best model.

Epoch 46/50
Epoch 46 - Train Loss: 0.9273, Train Accuracy: 0.5718
Epoch 46 - Dev Loss: 1.0176, Dev Accuracy: 0.4733, Dev F1: 0.3812
Dev loss improved; saving best model.

Epoch 47/50
Epoch 47 - Train Loss: 0.9266, Train Accuracy: 0.5720
Epoch 47 - Dev Loss: 1.0177, Dev Accuracy: 0.4733, Dev F1: 0.3812
No improvement on dev loss. Patience: 1/10

Epoch 48/50
Epoch 48 - Train Loss: 0.9260, Train Accuracy: 0.5722
Epoch 48 - Dev Loss: 1.0173, Dev Accuracy: 0.4728, Dev F1: 0.3808
Dev loss improved; saving best model.

Epoch 49/50
Epoch 49 - Train Loss: 0.9254, Train Accuracy: 0.5724
Epoch 49 - Dev Loss: 1.0175, Dev Accuracy: 0.4728, Dev F1: 0.3808
No improvement on dev loss. Patience: 1/10

Epoch 50/50
Epoch 50 - Train Loss: 0.9248, Train Accuracy: 0.5726
Epoch 50 - Dev Loss: 1.0175, Dev Accuracy: 0.4728, Dev F1: 0.3808
No improvement on dev loss. Patience: 2/10

Final Training Loss: 0.9248
Final Training Accuracy: 0.5726
Best Dev Loss: 1.0173
Best Dev Accuracy: 0.4728, Best Dev Macro F1: 0.3808
Config LR=0.0001, BS=32 -> Dev Loss: 1.0175, Dev Accuracy: 0.4728, Dev F1: 0.3808

=== Running experiment: LR=0.0001, BS=64, Model=linear, Use Prefix=True ===
Encoding training data jointly...
Encoding dev data jointly...

Epoch 1/50
Epoch 1 - Train Loss: 1.0558, Train Accuracy: 0.5036
Epoch 1 - Dev Loss: 1.1326, Dev Accuracy: 0.4394, Dev F1: 0.3432
Dev loss improved; saving best model.

Epoch 2/50
Epoch 2 - Train Loss: 1.0424, Train Accuracy: 0.5249
Epoch 2 - Dev Loss: 1.1331, Dev Accuracy: 0.4787, Dev F1: 0.3840
No improvement on dev loss. Patience: 1/10

Epoch 3/50
Epoch 3 - Train Loss: 1.0339, Train Accuracy: 0.5358
Epoch 3 - Dev Loss: 1.1252, Dev Accuracy: 0.4791, Dev F1: 0.3843
Dev loss improved; saving best model.

Epoch 4/50
Epoch 4 - Train Loss: 1.0271, Train Accuracy: 0.5418
Epoch 4 - Dev Loss: 1.1156, Dev Accuracy: 0.4738, Dev F1: 0.3801
Dev loss improved; saving best model.

Epoch 5/50
Epoch 5 - Train Loss: 1.0212, Train Accuracy: 0.5454
Epoch 5 - Dev Loss: 1.1082, Dev Accuracy: 0.4709, Dev F1: 0.3778
Dev loss improved; saving best model.

Epoch 6/50
Epoch 6 - Train Loss: 1.0160, Train Accuracy: 0.5479
Epoch 6 - Dev Loss: 1.1052, Dev Accuracy: 0.4767, Dev F1: 0.3825
Dev loss improved; saving best model.

Epoch 7/50
Epoch 7 - Train Loss: 1.0113, Train Accuracy: 0.5499
Epoch 7 - Dev Loss: 1.1004, Dev Accuracy: 0.4743, Dev F1: 0.3805
Dev loss improved; saving best model.

Epoch 8/50
Epoch 8 - Train Loss: 1.0070, Train Accuracy: 0.5515
Epoch 8 - Dev Loss: 1.0940, Dev Accuracy: 0.4728, Dev F1: 0.3793
Dev loss improved; saving best model.

Epoch 9/50
Epoch 9 - Train Loss: 1.0031, Train Accuracy: 0.5528
Epoch 9 - Dev Loss: 1.0838, Dev Accuracy: 0.4690, Dev F1: 0.3762
Dev loss improved; saving best model.

Epoch 10/50
Epoch 10 - Train Loss: 0.9995, Train Accuracy: 0.5538
Epoch 10 - Dev Loss: 1.0819, Dev Accuracy: 0.4685, Dev F1: 0.3758
Dev loss improved; saving best model.

Epoch 11/50
Epoch 11 - Train Loss: 0.9961, Train Accuracy: 0.5548
Epoch 11 - Dev Loss: 1.0782, Dev Accuracy: 0.4685, Dev F1: 0.3758
Dev loss improved; saving best model.

Epoch 12/50
Epoch 12 - Train Loss: 0.9930, Train Accuracy: 0.5555
Epoch 12 - Dev Loss: 1.0721, Dev Accuracy: 0.4699, Dev F1: 0.3770
Dev loss improved; saving best model.

Epoch 13/50
Epoch 13 - Train Loss: 0.9901, Train Accuracy: 0.5563
Epoch 13 - Dev Loss: 1.0712, Dev Accuracy: 0.4685, Dev F1: 0.3758
Dev loss improved; saving best model.

Epoch 14/50
Epoch 14 - Train Loss: 0.9874, Train Accuracy: 0.5569
Epoch 14 - Dev Loss: 1.0690, Dev Accuracy: 0.4694, Dev F1: 0.3766
Dev loss improved; saving best model.

Epoch 15/50
Epoch 15 - Train Loss: 0.9849, Train Accuracy: 0.5576
Epoch 15 - Dev Loss: 1.0638, Dev Accuracy: 0.4680, Dev F1: 0.3755
Dev loss improved; saving best model.

Epoch 16/50
Epoch 16 - Train Loss: 0.9825, Train Accuracy: 0.5581
Epoch 16 - Dev Loss: 1.0650, Dev Accuracy: 0.4694, Dev F1: 0.3766
No improvement on dev loss. Patience: 1/10

Epoch 17/50
Epoch 17 - Train Loss: 0.9802, Train Accuracy: 0.5587
Epoch 17 - Dev Loss: 1.0641, Dev Accuracy: 0.4690, Dev F1: 0.3762
No improvement on dev loss. Patience: 2/10

Epoch 18/50
Epoch 18 - Train Loss: 0.9781, Train Accuracy: 0.5593
Epoch 18 - Dev Loss: 1.0602, Dev Accuracy: 0.4690, Dev F1: 0.3762
Dev loss improved; saving best model.

Epoch 19/50
Epoch 19 - Train Loss: 0.9760, Train Accuracy: 0.5598
Epoch 19 - Dev Loss: 1.0578, Dev Accuracy: 0.4685, Dev F1: 0.3758
Dev loss improved; saving best model.

Epoch 20/50
Epoch 20 - Train Loss: 0.9741, Train Accuracy: 0.5602
Epoch 20 - Dev Loss: 1.0540, Dev Accuracy: 0.4670, Dev F1: 0.3747
Dev loss improved; saving best model.

Epoch 21/50
Epoch 21 - Train Loss: 0.9723, Train Accuracy: 0.5606
Epoch 21 - Dev Loss: 1.0520, Dev Accuracy: 0.4670, Dev F1: 0.3747
Dev loss improved; saving best model.

Epoch 22/50
Epoch 22 - Train Loss: 0.9706, Train Accuracy: 0.5610
Epoch 22 - Dev Loss: 1.0503, Dev Accuracy: 0.4690, Dev F1: 0.3762
Dev loss improved; saving best model.

Epoch 23/50
Epoch 23 - Train Loss: 0.9689, Train Accuracy: 0.5614
Epoch 23 - Dev Loss: 1.0493, Dev Accuracy: 0.4685, Dev F1: 0.3758
Dev loss improved; saving best model.

Epoch 24/50
Epoch 24 - Train Loss: 0.9674, Train Accuracy: 0.5618
Epoch 24 - Dev Loss: 1.0469, Dev Accuracy: 0.4680, Dev F1: 0.3754
Dev loss improved; saving best model.

Epoch 25/50
Epoch 25 - Train Loss: 0.9658, Train Accuracy: 0.5621
Epoch 25 - Dev Loss: 1.0482, Dev Accuracy: 0.4690, Dev F1: 0.3762
No improvement on dev loss. Patience: 1/10

Epoch 26/50
Epoch 26 - Train Loss: 0.9644, Train Accuracy: 0.5625
Epoch 26 - Dev Loss: 1.0455, Dev Accuracy: 0.4685, Dev F1: 0.3758
Dev loss improved; saving best model.

Epoch 27/50
Epoch 27 - Train Loss: 0.9630, Train Accuracy: 0.5628
Epoch 27 - Dev Loss: 1.0456, Dev Accuracy: 0.4694, Dev F1: 0.3766
No improvement on dev loss. Patience: 1/10

Epoch 28/50
Epoch 28 - Train Loss: 0.9617, Train Accuracy: 0.5631
Epoch 28 - Dev Loss: 1.0436, Dev Accuracy: 0.4690, Dev F1: 0.3769
Dev loss improved; saving best model.

Epoch 29/50
Epoch 29 - Train Loss: 0.9604, Train Accuracy: 0.5634
Epoch 29 - Dev Loss: 1.0449, Dev Accuracy: 0.4694, Dev F1: 0.3773
No improvement on dev loss. Patience: 1/10

Epoch 30/50
Epoch 30 - Train Loss: 0.9592, Train Accuracy: 0.5637
Epoch 30 - Dev Loss: 1.0432, Dev Accuracy: 0.4699, Dev F1: 0.3777
Dev loss improved; saving best model.

Epoch 31/50
Epoch 31 - Train Loss: 0.9581, Train Accuracy: 0.5640
Epoch 31 - Dev Loss: 1.0416, Dev Accuracy: 0.4704, Dev F1: 0.3781
Dev loss improved; saving best model.

Epoch 32/50
Epoch 32 - Train Loss: 0.9569, Train Accuracy: 0.5642
Epoch 32 - Dev Loss: 1.0395, Dev Accuracy: 0.4704, Dev F1: 0.3781
Dev loss improved; saving best model.

Epoch 33/50
Epoch 33 - Train Loss: 0.9559, Train Accuracy: 0.5645
Epoch 33 - Dev Loss: 1.0394, Dev Accuracy: 0.4719, Dev F1: 0.3792
Dev loss improved; saving best model.

Epoch 34/50
Epoch 34 - Train Loss: 0.9548, Train Accuracy: 0.5647
Epoch 34 - Dev Loss: 1.0393, Dev Accuracy: 0.4709, Dev F1: 0.3785
Dev loss improved; saving best model.

Epoch 35/50
Epoch 35 - Train Loss: 0.9538, Train Accuracy: 0.5650
Epoch 35 - Dev Loss: 1.0380, Dev Accuracy: 0.4694, Dev F1: 0.3773
Dev loss improved; saving best model.

Epoch 36/50
Epoch 36 - Train Loss: 0.9529, Train Accuracy: 0.5652
Epoch 36 - Dev Loss: 1.0376, Dev Accuracy: 0.4724, Dev F1: 0.3796
Dev loss improved; saving best model.

Epoch 37/50
Epoch 37 - Train Loss: 0.9519, Train Accuracy: 0.5654
Epoch 37 - Dev Loss: 1.0370, Dev Accuracy: 0.4704, Dev F1: 0.3781
Dev loss improved; saving best model.

Epoch 38/50
Epoch 38 - Train Loss: 0.9511, Train Accuracy: 0.5656
Epoch 38 - Dev Loss: 1.0361, Dev Accuracy: 0.4724, Dev F1: 0.3796
Dev loss improved; saving best model.

Epoch 39/50
Epoch 39 - Train Loss: 0.9502, Train Accuracy: 0.5658
Epoch 39 - Dev Loss: 1.0362, Dev Accuracy: 0.4724, Dev F1: 0.3796
No improvement on dev loss. Patience: 1/10

Epoch 40/50
Epoch 40 - Train Loss: 0.9494, Train Accuracy: 0.5660
Epoch 40 - Dev Loss: 1.0362, Dev Accuracy: 0.4714, Dev F1: 0.3788
No improvement on dev loss. Patience: 2/10

Epoch 41/50
Epoch 41 - Train Loss: 0.9486, Train Accuracy: 0.5662
Epoch 41 - Dev Loss: 1.0357, Dev Accuracy: 0.4719, Dev F1: 0.3792
Dev loss improved; saving best model.

Epoch 42/50
Epoch 42 - Train Loss: 0.9478, Train Accuracy: 0.5664
Epoch 42 - Dev Loss: 1.0356, Dev Accuracy: 0.4709, Dev F1: 0.3785
Dev loss improved; saving best model.

Epoch 43/50
Epoch 43 - Train Loss: 0.9471, Train Accuracy: 0.5665
Epoch 43 - Dev Loss: 1.0352, Dev Accuracy: 0.4699, Dev F1: 0.3777
Dev loss improved; saving best model.

Epoch 44/50
Epoch 44 - Train Loss: 0.9464, Train Accuracy: 0.5667
Epoch 44 - Dev Loss: 1.0348, Dev Accuracy: 0.4714, Dev F1: 0.3788
Dev loss improved; saving best model.

Epoch 45/50
Epoch 45 - Train Loss: 0.9457, Train Accuracy: 0.5669
Epoch 45 - Dev Loss: 1.0347, Dev Accuracy: 0.4714, Dev F1: 0.3788
Dev loss improved; saving best model.

Epoch 46/50
Epoch 46 - Train Loss: 0.9450, Train Accuracy: 0.5670
Epoch 46 - Dev Loss: 1.0345, Dev Accuracy: 0.4714, Dev F1: 0.3788
Dev loss improved; saving best model.

Epoch 47/50
Epoch 47 - Train Loss: 0.9444, Train Accuracy: 0.5672
Epoch 47 - Dev Loss: 1.0342, Dev Accuracy: 0.4714, Dev F1: 0.3788
Dev loss improved; saving best model.

Epoch 48/50
Epoch 48 - Train Loss: 0.9438, Train Accuracy: 0.5673
Epoch 48 - Dev Loss: 1.0341, Dev Accuracy: 0.4719, Dev F1: 0.3792
Dev loss improved; saving best model.

Epoch 49/50
Epoch 49 - Train Loss: 0.9432, Train Accuracy: 0.5674
Epoch 49 - Dev Loss: 1.0339, Dev Accuracy: 0.4714, Dev F1: 0.3788
Dev loss improved; saving best model.

Epoch 50/50
Epoch 50 - Train Loss: 0.9426, Train Accuracy: 0.5676
Epoch 50 - Dev Loss: 1.0339, Dev Accuracy: 0.4714, Dev F1: 0.3788
No improvement on dev loss. Patience: 1/10

Final Training Loss: 0.9426
Final Training Accuracy: 0.5676
Best Dev Loss: 1.0339
Best Dev Accuracy: 0.4714, Best Dev Macro F1: 0.3788
Config LR=0.0001, BS=64 -> Dev Loss: 1.0339, Dev Accuracy: 0.4714, Dev F1: 0.3788

=== Running experiment: LR=0.0001, BS=128, Model=linear, Use Prefix=True ===
Encoding training data jointly...
Encoding dev data jointly...

Epoch 1/50
Epoch 1 - Train Loss: 1.0697, Train Accuracy: 0.4579
Epoch 1 - Dev Loss: 1.1183, Dev Accuracy: 0.4559, Dev F1: 0.3644
Dev loss improved; saving best model.

Epoch 2/50
Epoch 2 - Train Loss: 1.0549, Train Accuracy: 0.4884
Epoch 2 - Dev Loss: 1.1347, Dev Accuracy: 0.4709, Dev F1: 0.3778
No improvement on dev loss. Patience: 1/10

Epoch 3/50
Epoch 3 - Train Loss: 1.0466, Train Accuracy: 0.5093
Epoch 3 - Dev Loss: 1.1367, Dev Accuracy: 0.4685, Dev F1: 0.3759
No improvement on dev loss. Patience: 2/10

Epoch 4/50
Epoch 4 - Train Loss: 1.0405, Train Accuracy: 0.5204
Epoch 4 - Dev Loss: 1.1335, Dev Accuracy: 0.4699, Dev F1: 0.3769
No improvement on dev loss. Patience: 3/10

Epoch 5/50
Epoch 5 - Train Loss: 1.0355, Train Accuracy: 0.5276
Epoch 5 - Dev Loss: 1.1270, Dev Accuracy: 0.4724, Dev F1: 0.3788
No improvement on dev loss. Patience: 4/10

Epoch 6/50
Epoch 6 - Train Loss: 1.0312, Train Accuracy: 0.5323
Epoch 6 - Dev Loss: 1.1215, Dev Accuracy: 0.4728, Dev F1: 0.3792
No improvement on dev loss. Patience: 5/10

Epoch 7/50
Epoch 7 - Train Loss: 1.0272, Train Accuracy: 0.5361
Epoch 7 - Dev Loss: 1.1150, Dev Accuracy: 0.4728, Dev F1: 0.3793
Dev loss improved; saving best model.

Epoch 8/50
Epoch 8 - Train Loss: 1.0236, Train Accuracy: 0.5389
Epoch 8 - Dev Loss: 1.1118, Dev Accuracy: 0.4728, Dev F1: 0.3793
Dev loss improved; saving best model.

Epoch 9/50
Epoch 9 - Train Loss: 1.0203, Train Accuracy: 0.5413
Epoch 9 - Dev Loss: 1.1076, Dev Accuracy: 0.4738, Dev F1: 0.3801
Dev loss improved; saving best model.

Epoch 10/50
Epoch 10 - Train Loss: 1.0172, Train Accuracy: 0.5431
Epoch 10 - Dev Loss: 1.1048, Dev Accuracy: 0.4738, Dev F1: 0.3801
Dev loss improved; saving best model.

Epoch 11/50
Epoch 11 - Train Loss: 1.0143, Train Accuracy: 0.5447
Epoch 11 - Dev Loss: 1.1000, Dev Accuracy: 0.4738, Dev F1: 0.3801
Dev loss improved; saving best model.

Epoch 12/50
Epoch 12 - Train Loss: 1.0116, Train Accuracy: 0.5460
Epoch 12 - Dev Loss: 1.0950, Dev Accuracy: 0.4719, Dev F1: 0.3786
Dev loss improved; saving best model.

Epoch 13/50
Epoch 13 - Train Loss: 1.0090, Train Accuracy: 0.5473
Epoch 13 - Dev Loss: 1.0947, Dev Accuracy: 0.4753, Dev F1: 0.3813
Dev loss improved; saving best model.

Epoch 14/50
Epoch 14 - Train Loss: 1.0066, Train Accuracy: 0.5483
Epoch 14 - Dev Loss: 1.0918, Dev Accuracy: 0.4748, Dev F1: 0.3809
Dev loss improved; saving best model.

Epoch 15/50
Epoch 15 - Train Loss: 1.0043, Train Accuracy: 0.5493
Epoch 15 - Dev Loss: 1.0878, Dev Accuracy: 0.4728, Dev F1: 0.3793
Dev loss improved; saving best model.

Epoch 16/50
Epoch 16 - Train Loss: 1.0021, Train Accuracy: 0.5501
Epoch 16 - Dev Loss: 1.0856, Dev Accuracy: 0.4714, Dev F1: 0.3782
Dev loss improved; saving best model.

Epoch 17/50
Epoch 17 - Train Loss: 1.0000, Train Accuracy: 0.5508
Epoch 17 - Dev Loss: 1.0829, Dev Accuracy: 0.4675, Dev F1: 0.3751
Dev loss improved; saving best model.

Epoch 18/50
Epoch 18 - Train Loss: 0.9980, Train Accuracy: 0.5515
Epoch 18 - Dev Loss: 1.0821, Dev Accuracy: 0.4675, Dev F1: 0.3751
Dev loss improved; saving best model.

Epoch 19/50
Epoch 19 - Train Loss: 0.9961, Train Accuracy: 0.5522
Epoch 19 - Dev Loss: 1.0799, Dev Accuracy: 0.4675, Dev F1: 0.3751
Dev loss improved; saving best model.

Epoch 20/50
Epoch 20 - Train Loss: 0.9943, Train Accuracy: 0.5528
Epoch 20 - Dev Loss: 1.0773, Dev Accuracy: 0.4694, Dev F1: 0.3766
Dev loss improved; saving best model.

Epoch 21/50
Epoch 21 - Train Loss: 0.9926, Train Accuracy: 0.5534
Epoch 21 - Dev Loss: 1.0750, Dev Accuracy: 0.4675, Dev F1: 0.3751
Dev loss improved; saving best model.

Epoch 22/50
Epoch 22 - Train Loss: 0.9910, Train Accuracy: 0.5539
Epoch 22 - Dev Loss: 1.0729, Dev Accuracy: 0.4733, Dev F1: 0.3797
Dev loss improved; saving best model.

Epoch 23/50
Epoch 23 - Train Loss: 0.9894, Train Accuracy: 0.5544
Epoch 23 - Dev Loss: 1.0720, Dev Accuracy: 0.4675, Dev F1: 0.3751
Dev loss improved; saving best model.

Epoch 24/50
Epoch 24 - Train Loss: 0.9879, Train Accuracy: 0.5549
Epoch 24 - Dev Loss: 1.0701, Dev Accuracy: 0.4675, Dev F1: 0.3751
Dev loss improved; saving best model.

Epoch 25/50
Epoch 25 - Train Loss: 0.9864, Train Accuracy: 0.5553
Epoch 25 - Dev Loss: 1.0690, Dev Accuracy: 0.4685, Dev F1: 0.3758
Dev loss improved; saving best model.

Epoch 26/50
Epoch 26 - Train Loss: 0.9850, Train Accuracy: 0.5557
Epoch 26 - Dev Loss: 1.0674, Dev Accuracy: 0.4670, Dev F1: 0.3747
Dev loss improved; saving best model.

Epoch 27/50
Epoch 27 - Train Loss: 0.9837, Train Accuracy: 0.5561
Epoch 27 - Dev Loss: 1.0664, Dev Accuracy: 0.4675, Dev F1: 0.3751
Dev loss improved; saving best model.

Epoch 28/50
Epoch 28 - Train Loss: 0.9824, Train Accuracy: 0.5565
Epoch 28 - Dev Loss: 1.0666, Dev Accuracy: 0.4685, Dev F1: 0.3758
No improvement on dev loss. Patience: 1/10

Epoch 29/50
Epoch 29 - Train Loss: 0.9812, Train Accuracy: 0.5569
Epoch 29 - Dev Loss: 1.0647, Dev Accuracy: 0.4685, Dev F1: 0.3758
Dev loss improved; saving best model.

Epoch 30/50
Epoch 30 - Train Loss: 0.9800, Train Accuracy: 0.5572
Epoch 30 - Dev Loss: 1.0642, Dev Accuracy: 0.4685, Dev F1: 0.3758
Dev loss improved; saving best model.

Epoch 31/50
Epoch 31 - Train Loss: 0.9789, Train Accuracy: 0.5576
Epoch 31 - Dev Loss: 1.0623, Dev Accuracy: 0.4680, Dev F1: 0.3754
Dev loss improved; saving best model.

Epoch 32/50
Epoch 32 - Train Loss: 0.9778, Train Accuracy: 0.5579
Epoch 32 - Dev Loss: 1.0617, Dev Accuracy: 0.4685, Dev F1: 0.3758
Dev loss improved; saving best model.

Epoch 33/50
Epoch 33 - Train Loss: 0.9767, Train Accuracy: 0.5582
Epoch 33 - Dev Loss: 1.0609, Dev Accuracy: 0.4680, Dev F1: 0.3754
Dev loss improved; saving best model.

Epoch 34/50
Epoch 34 - Train Loss: 0.9757, Train Accuracy: 0.5585
Epoch 34 - Dev Loss: 1.0602, Dev Accuracy: 0.4680, Dev F1: 0.3754
Dev loss improved; saving best model.

Epoch 35/50
Epoch 35 - Train Loss: 0.9747, Train Accuracy: 0.5588
Epoch 35 - Dev Loss: 1.0587, Dev Accuracy: 0.4680, Dev F1: 0.3754
Dev loss improved; saving best model.

Epoch 36/50
Epoch 36 - Train Loss: 0.9738, Train Accuracy: 0.5590
Epoch 36 - Dev Loss: 1.0585, Dev Accuracy: 0.4670, Dev F1: 0.3747
Dev loss improved; saving best model.

Epoch 37/50
Epoch 37 - Train Loss: 0.9729, Train Accuracy: 0.5593
Epoch 37 - Dev Loss: 1.0580, Dev Accuracy: 0.4670, Dev F1: 0.3747
Dev loss improved; saving best model.

Epoch 38/50
Epoch 38 - Train Loss: 0.9720, Train Accuracy: 0.5595
Epoch 38 - Dev Loss: 1.0575, Dev Accuracy: 0.4670, Dev F1: 0.3747
Dev loss improved; saving best model.

Epoch 39/50
Epoch 39 - Train Loss: 0.9712, Train Accuracy: 0.5598
Epoch 39 - Dev Loss: 1.0572, Dev Accuracy: 0.4670, Dev F1: 0.3747
Dev loss improved; saving best model.

Epoch 40/50
Epoch 40 - Train Loss: 0.9704, Train Accuracy: 0.5600
Epoch 40 - Dev Loss: 1.0569, Dev Accuracy: 0.4670, Dev F1: 0.3747
Dev loss improved; saving best model.

Epoch 41/50
Epoch 41 - Train Loss: 0.9696, Train Accuracy: 0.5602
Epoch 41 - Dev Loss: 1.0560, Dev Accuracy: 0.4680, Dev F1: 0.3754
Dev loss improved; saving best model.

Epoch 42/50
Epoch 42 - Train Loss: 0.9688, Train Accuracy: 0.5604
Epoch 42 - Dev Loss: 1.0557, Dev Accuracy: 0.4675, Dev F1: 0.3751
Dev loss improved; saving best model.

Epoch 43/50
Epoch 43 - Train Loss: 0.9681, Train Accuracy: 0.5606
Epoch 43 - Dev Loss: 1.0550, Dev Accuracy: 0.4675, Dev F1: 0.3751
Dev loss improved; saving best model.

Epoch 44/50
Epoch 44 - Train Loss: 0.9674, Train Accuracy: 0.5608
Epoch 44 - Dev Loss: 1.0546, Dev Accuracy: 0.4675, Dev F1: 0.3751
Dev loss improved; saving best model.

Epoch 45/50
Epoch 45 - Train Loss: 0.9667, Train Accuracy: 0.5610
Epoch 45 - Dev Loss: 1.0545, Dev Accuracy: 0.4675, Dev F1: 0.3751
Dev loss improved; saving best model.

Epoch 46/50
Epoch 46 - Train Loss: 0.9660, Train Accuracy: 0.5611
Epoch 46 - Dev Loss: 1.0544, Dev Accuracy: 0.4675, Dev F1: 0.3751
Dev loss improved; saving best model.

Epoch 47/50
Epoch 47 - Train Loss: 0.9654, Train Accuracy: 0.5613
Epoch 47 - Dev Loss: 1.0543, Dev Accuracy: 0.4675, Dev F1: 0.3751
Dev loss improved; saving best model.

Epoch 48/50
Epoch 48 - Train Loss: 0.9648, Train Accuracy: 0.5615
Epoch 48 - Dev Loss: 1.0544, Dev Accuracy: 0.4675, Dev F1: 0.3751
No improvement on dev loss. Patience: 1/10

Epoch 49/50
Epoch 49 - Train Loss: 0.9642, Train Accuracy: 0.5616
Epoch 49 - Dev Loss: 1.0542, Dev Accuracy: 0.4675, Dev F1: 0.3751
Dev loss improved; saving best model.

Epoch 50/50
Epoch 50 - Train Loss: 0.9637, Train Accuracy: 0.5618
Epoch 50 - Dev Loss: 1.0542, Dev Accuracy: 0.4675, Dev F1: 0.3751
No improvement on dev loss. Patience: 1/10

Final Training Loss: 0.9637
Final Training Accuracy: 0.5618
Best Dev Loss: 1.0542
Best Dev Accuracy: 0.4675, Best Dev Macro F1: 0.3751
Config LR=0.0001, BS=128 -> Dev Loss: 1.0542, Dev Accuracy: 0.4675, Dev F1: 0.3751

=== Running experiment: LR=1e-05, BS=8, Model=linear, Use Prefix=True ===
Encoding training data jointly...
Encoding dev data jointly...

Epoch 1/50
Epoch 1 - Train Loss: 1.0722, Train Accuracy: 0.4499
Epoch 1 - Dev Loss: 1.1147, Dev Accuracy: 0.4321, Dev F1: 0.3450
Dev loss improved; saving best model.

Epoch 2/50
Epoch 2 - Train Loss: 1.0596, Train Accuracy: 0.4846
Epoch 2 - Dev Loss: 1.1313, Dev Accuracy: 0.4374, Dev F1: 0.3422
No improvement on dev loss. Patience: 1/10

Epoch 3/50
Epoch 3 - Train Loss: 1.0525, Train Accuracy: 0.5005
Epoch 3 - Dev Loss: 1.1379, Dev Accuracy: 0.4568, Dev F1: 0.3624
No improvement on dev loss. Patience: 2/10

Epoch 4/50
Epoch 4 - Train Loss: 1.0477, Train Accuracy: 0.5122
Epoch 4 - Dev Loss: 1.1397, Dev Accuracy: 0.4641, Dev F1: 0.3698
No improvement on dev loss. Patience: 3/10

Epoch 5/50
Epoch 5 - Train Loss: 1.0439, Train Accuracy: 0.5203
Epoch 5 - Dev Loss: 1.1390, Dev Accuracy: 0.4728, Dev F1: 0.3790
No improvement on dev loss. Patience: 4/10

Epoch 6/50
Epoch 6 - Train Loss: 1.0408, Train Accuracy: 0.5260
Epoch 6 - Dev Loss: 1.1365, Dev Accuracy: 0.4767, Dev F1: 0.3823
No improvement on dev loss. Patience: 5/10

Epoch 7/50
Epoch 7 - Train Loss: 1.0380, Train Accuracy: 0.5302
Epoch 7 - Dev Loss: 1.1337, Dev Accuracy: 0.4777, Dev F1: 0.3830
No improvement on dev loss. Patience: 6/10

Epoch 8/50
Epoch 8 - Train Loss: 1.0355, Train Accuracy: 0.5334
Epoch 8 - Dev Loss: 1.1303, Dev Accuracy: 0.4782, Dev F1: 0.3833
No improvement on dev loss. Patience: 7/10

Epoch 9/50
Epoch 9 - Train Loss: 1.0332, Train Accuracy: 0.5360
Epoch 9 - Dev Loss: 1.1285, Dev Accuracy: 0.4762, Dev F1: 0.3819
No improvement on dev loss. Patience: 8/10

Epoch 10/50
Epoch 10 - Train Loss: 1.0311, Train Accuracy: 0.5381
Epoch 10 - Dev Loss: 1.1257, Dev Accuracy: 0.4758, Dev F1: 0.3816
No improvement on dev loss. Patience: 9/10

Epoch 11/50
Epoch 11 - Train Loss: 1.0291, Train Accuracy: 0.5398
Epoch 11 - Dev Loss: 1.1234, Dev Accuracy: 0.4767, Dev F1: 0.3824
No improvement on dev loss. Patience: 10/10
Early stopping triggered.

Final Training Loss: 1.0291
Final Training Accuracy: 0.5398
Best Dev Loss: 1.1147
Best Dev Accuracy: 0.4767, Best Dev Macro F1: 0.3824
Config LR=1e-05, BS=8 -> Dev Loss: 1.1234, Dev Accuracy: 0.4767, Dev F1: 0.3824

=== Running experiment: LR=1e-05, BS=16, Model=linear, Use Prefix=True ===
Encoding training data jointly...
Encoding dev data jointly...

Epoch 1/50
Epoch 1 - Train Loss: 1.0774, Train Accuracy: 0.4194
Epoch 1 - Dev Loss: 1.1076, Dev Accuracy: 0.3327, Dev F1: 0.1682
Dev loss improved; saving best model.

Epoch 2/50
Epoch 2 - Train Loss: 1.0659, Train Accuracy: 0.4385
Epoch 2 - Dev Loss: 1.1204, Dev Accuracy: 0.3642, Dev F1: 0.2320
No improvement on dev loss. Patience: 1/10

Epoch 3/50
Epoch 3 - Train Loss: 1.0587, Train Accuracy: 0.4522
Epoch 3 - Dev Loss: 1.1299, Dev Accuracy: 0.4185, Dev F1: 0.3165
No improvement on dev loss. Patience: 2/10

Epoch 4/50
Epoch 4 - Train Loss: 1.0537, Train Accuracy: 0.4678
Epoch 4 - Dev Loss: 1.1356, Dev Accuracy: 0.4467, Dev F1: 0.3534
No improvement on dev loss. Patience: 3/10

Epoch 5/50
Epoch 5 - Train Loss: 1.0500, Train Accuracy: 0.4818
Epoch 5 - Dev Loss: 1.1382, Dev Accuracy: 0.4612, Dev F1: 0.3682
No improvement on dev loss. Patience: 4/10

Epoch 6/50
Epoch 6 - Train Loss: 1.0470, Train Accuracy: 0.4932
Epoch 6 - Dev Loss: 1.1388, Dev Accuracy: 0.4719, Dev F1: 0.3782
No improvement on dev loss. Patience: 5/10

Epoch 7/50
Epoch 7 - Train Loss: 1.0444, Train Accuracy: 0.5019
Epoch 7 - Dev Loss: 1.1384, Dev Accuracy: 0.4728, Dev F1: 0.3790
No improvement on dev loss. Patience: 6/10

Epoch 8/50
Epoch 8 - Train Loss: 1.0422, Train Accuracy: 0.5086
Epoch 8 - Dev Loss: 1.1376, Dev Accuracy: 0.4743, Dev F1: 0.3801
No improvement on dev loss. Patience: 7/10

Epoch 9/50
Epoch 9 - Train Loss: 1.0402, Train Accuracy: 0.5139
Epoch 9 - Dev Loss: 1.1362, Dev Accuracy: 0.4728, Dev F1: 0.3789
No improvement on dev loss. Patience: 8/10

Epoch 10/50
Epoch 10 - Train Loss: 1.0383, Train Accuracy: 0.5182
Epoch 10 - Dev Loss: 1.1350, Dev Accuracy: 0.4733, Dev F1: 0.3795
No improvement on dev loss. Patience: 9/10

Epoch 11/50
Epoch 11 - Train Loss: 1.0366, Train Accuracy: 0.5219
Epoch 11 - Dev Loss: 1.1331, Dev Accuracy: 0.4724, Dev F1: 0.3788
No improvement on dev loss. Patience: 10/10
Early stopping triggered.

Final Training Loss: 1.0366
Final Training Accuracy: 0.5219
Best Dev Loss: 1.1076
Best Dev Accuracy: 0.4724, Best Dev Macro F1: 0.3788
Config LR=1e-05, BS=16 -> Dev Loss: 1.1331, Dev Accuracy: 0.4724, Dev F1: 0.3788

=== Running experiment: LR=1e-05, BS=32, Model=linear, Use Prefix=True ===
Encoding training data jointly...
Encoding dev data jointly...

Epoch 1/50
Epoch 1 - Train Loss: 1.0910, Train Accuracy: 0.3946
Epoch 1 - Dev Loss: 1.1011, Dev Accuracy: 0.3317, Dev F1: 0.1661
Dev loss improved; saving best model.

Epoch 2/50
Epoch 2 - Train Loss: 1.0803, Train Accuracy: 0.4051
Epoch 2 - Dev Loss: 1.1077, Dev Accuracy: 0.3327, Dev F1: 0.1681
No improvement on dev loss. Patience: 1/10

Epoch 3/50
Epoch 3 - Train Loss: 1.0725, Train Accuracy: 0.4122
Epoch 3 - Dev Loss: 1.1152, Dev Accuracy: 0.3516, Dev F1: 0.2079
No improvement on dev loss. Patience: 2/10

Epoch 4/50
Epoch 4 - Train Loss: 1.0667, Train Accuracy: 0.4239
Epoch 4 - Dev Loss: 1.1220, Dev Accuracy: 0.3846, Dev F1: 0.2660
No improvement on dev loss. Patience: 3/10

Epoch 5/50
Epoch 5 - Train Loss: 1.0622, Train Accuracy: 0.4383
Epoch 5 - Dev Loss: 1.1277, Dev Accuracy: 0.4049, Dev F1: 0.2992
No improvement on dev loss. Patience: 4/10

Epoch 6/50
Epoch 6 - Train Loss: 1.0585, Train Accuracy: 0.4510
Epoch 6 - Dev Loss: 1.1318, Dev Accuracy: 0.4297, Dev F1: 0.3320
No improvement on dev loss. Patience: 5/10

Epoch 7/50
Epoch 7 - Train Loss: 1.0556, Train Accuracy: 0.4624
Epoch 7 - Dev Loss: 1.1347, Dev Accuracy: 0.4539, Dev F1: 0.3593
No improvement on dev loss. Patience: 6/10

Epoch 8/50
Epoch 8 - Train Loss: 1.0530, Train Accuracy: 0.4725
Epoch 8 - Dev Loss: 1.1364, Dev Accuracy: 0.4568, Dev F1: 0.3626
No improvement on dev loss. Patience: 7/10

Epoch 9/50
Epoch 9 - Train Loss: 1.0508, Train Accuracy: 0.4806
Epoch 9 - Dev Loss: 1.1375, Dev Accuracy: 0.4670, Dev F1: 0.3733
No improvement on dev loss. Patience: 8/10

Epoch 10/50
Epoch 10 - Train Loss: 1.0489, Train Accuracy: 0.4875
Epoch 10 - Dev Loss: 1.1378, Dev Accuracy: 0.4690, Dev F1: 0.3747
No improvement on dev loss. Patience: 9/10

Epoch 11/50
Epoch 11 - Train Loss: 1.0472, Train Accuracy: 0.4932
Epoch 11 - Dev Loss: 1.1378, Dev Accuracy: 0.4661, Dev F1: 0.3726
No improvement on dev loss. Patience: 10/10
Early stopping triggered.

Final Training Loss: 1.0472
Final Training Accuracy: 0.4932
Best Dev Loss: 1.1011
Best Dev Accuracy: 0.4661, Best Dev Macro F1: 0.3726
Config LR=1e-05, BS=32 -> Dev Loss: 1.1378, Dev Accuracy: 0.4661, Dev F1: 0.3726

=== Running experiment: LR=1e-05, BS=64, Model=linear, Use Prefix=True ===
Encoding training data jointly...
Encoding dev data jointly...

Epoch 1/50
Epoch 1 - Train Loss: 1.0867, Train Accuracy: 0.4008
Epoch 1 - Dev Loss: 1.1019, Dev Accuracy: 0.3487, Dev F1: 0.2769
Dev loss improved; saving best model.

Epoch 2/50
Epoch 2 - Train Loss: 1.0803, Train Accuracy: 0.4313
Epoch 2 - Dev Loss: 1.1055, Dev Accuracy: 0.3851, Dev F1: 0.3060
No improvement on dev loss. Patience: 1/10

Epoch 3/50
Epoch 3 - Train Loss: 1.0750, Train Accuracy: 0.4540
Epoch 3 - Dev Loss: 1.1098, Dev Accuracy: 0.3972, Dev F1: 0.3093
No improvement on dev loss. Patience: 2/10

Epoch 4/50
Epoch 4 - Train Loss: 1.0707, Train Accuracy: 0.4666
Epoch 4 - Dev Loss: 1.1143, Dev Accuracy: 0.4069, Dev F1: 0.3117
No improvement on dev loss. Patience: 3/10

Epoch 5/50
Epoch 5 - Train Loss: 1.0670, Train Accuracy: 0.4747
Epoch 5 - Dev Loss: 1.1187, Dev Accuracy: 0.4113, Dev F1: 0.3136
No improvement on dev loss. Patience: 4/10

Epoch 6/50
Epoch 6 - Train Loss: 1.0639, Train Accuracy: 0.4809
Epoch 6 - Dev Loss: 1.1228, Dev Accuracy: 0.4156, Dev F1: 0.3169
No improvement on dev loss. Patience: 5/10

Epoch 7/50
Epoch 7 - Train Loss: 1.0612, Train Accuracy: 0.4863
Epoch 7 - Dev Loss: 1.1263, Dev Accuracy: 0.4180, Dev F1: 0.3192
No improvement on dev loss. Patience: 6/10

Epoch 8/50
Epoch 8 - Train Loss: 1.0589, Train Accuracy: 0.4910
Epoch 8 - Dev Loss: 1.1294, Dev Accuracy: 0.4234, Dev F1: 0.3253
No improvement on dev loss. Patience: 7/10

Epoch 9/50
Epoch 9 - Train Loss: 1.0569, Train Accuracy: 0.4954
Epoch 9 - Dev Loss: 1.1319, Dev Accuracy: 0.4316, Dev F1: 0.3361
No improvement on dev loss. Patience: 8/10

Epoch 10/50
Epoch 10 - Train Loss: 1.0551, Train Accuracy: 0.4991
Epoch 10 - Dev Loss: 1.1341, Dev Accuracy: 0.4336, Dev F1: 0.3386
No improvement on dev loss. Patience: 9/10

Epoch 11/50
Epoch 11 - Train Loss: 1.0535, Train Accuracy: 0.5023
Epoch 11 - Dev Loss: 1.1357, Dev Accuracy: 0.4389, Dev F1: 0.3443
No improvement on dev loss. Patience: 10/10
Early stopping triggered.

Final Training Loss: 1.0535
Final Training Accuracy: 0.5023
Best Dev Loss: 1.1019
Best Dev Accuracy: 0.4389, Best Dev Macro F1: 0.3443
Config LR=1e-05, BS=64 -> Dev Loss: 1.1357, Dev Accuracy: 0.4389, Dev F1: 0.3443

=== Running experiment: LR=1e-05, BS=128, Model=linear, Use Prefix=True ===
Encoding training data jointly...
Encoding dev data jointly...

Epoch 1/50
Epoch 1 - Train Loss: 1.0955, Train Accuracy: 0.3671
Epoch 1 - Dev Loss: 1.0987, Dev Accuracy: 0.3385, Dev F1: 0.2713
Dev loss improved; saving best model.

Epoch 2/50
Epoch 2 - Train Loss: 1.0911, Train Accuracy: 0.3946
Epoch 2 - Dev Loss: 1.0997, Dev Accuracy: 0.3598, Dev F1: 0.2846
No improvement on dev loss. Patience: 1/10

Epoch 3/50
Epoch 3 - Train Loss: 1.0871, Train Accuracy: 0.4138
Epoch 3 - Dev Loss: 1.1012, Dev Accuracy: 0.3729, Dev F1: 0.2923
No improvement on dev loss. Patience: 2/10

Epoch 4/50
Epoch 4 - Train Loss: 1.0836, Train Accuracy: 0.4290
Epoch 4 - Dev Loss: 1.1031, Dev Accuracy: 0.3841, Dev F1: 0.2941
No improvement on dev loss. Patience: 3/10

Epoch 5/50
Epoch 5 - Train Loss: 1.0805, Train Accuracy: 0.4406
Epoch 5 - Dev Loss: 1.1052, Dev Accuracy: 0.3943, Dev F1: 0.3002
No improvement on dev loss. Patience: 4/10

Epoch 6/50
Epoch 6 - Train Loss: 1.0776, Train Accuracy: 0.4496
Epoch 6 - Dev Loss: 1.1075, Dev Accuracy: 0.3967, Dev F1: 0.2995
No improvement on dev loss. Patience: 5/10

Epoch 7/50
Epoch 7 - Train Loss: 1.0750, Train Accuracy: 0.4560
Epoch 7 - Dev Loss: 1.1098, Dev Accuracy: 0.3996, Dev F1: 0.3012
No improvement on dev loss. Patience: 6/10

Epoch 8/50
Epoch 8 - Train Loss: 1.0727, Train Accuracy: 0.4617
Epoch 8 - Dev Loss: 1.1121, Dev Accuracy: 0.4040, Dev F1: 0.3048
No improvement on dev loss. Patience: 7/10

Epoch 9/50
Epoch 9 - Train Loss: 1.0706, Train Accuracy: 0.4664
Epoch 9 - Dev Loss: 1.1143, Dev Accuracy: 0.4103, Dev F1: 0.3105
No improvement on dev loss. Patience: 8/10

Epoch 10/50
Epoch 10 - Train Loss: 1.0686, Train Accuracy: 0.4708
Epoch 10 - Dev Loss: 1.1164, Dev Accuracy: 0.4146, Dev F1: 0.3157
No improvement on dev loss. Patience: 9/10

Epoch 11/50
Epoch 11 - Train Loss: 1.0669, Train Accuracy: 0.4747
Epoch 11 - Dev Loss: 1.1185, Dev Accuracy: 0.4185, Dev F1: 0.3195
No improvement on dev loss. Patience: 10/10
Early stopping triggered.

Final Training Loss: 1.0669
Final Training Accuracy: 0.4747
Best Dev Loss: 1.0987
Best Dev Accuracy: 0.4185, Best Dev Macro F1: 0.3195
Config LR=1e-05, BS=128 -> Dev Loss: 1.1185, Dev Accuracy: 0.4185, Dev F1: 0.3195

=== Best configuration for model linear: (0.001, 8) with Dev Loss: 0.8470, Dev Accuracy: 0.6111, Dev F1: 0.6084 ===
Running inference on training_data.csv...
Predictions written to predictions.csv.
Evaluating on the official VAST test set...
VAST Test Set Accuracy: 0.5805
VAST Test Set Macro F1: 0.5784
VAST Test Set Zero-shot Macro F1: 0.6020
VAST Test Set Few-shot Macro F1: 0.5562
