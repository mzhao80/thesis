Create sweep with ID: eko9ylky
Sweep URL: https://wandb.ai/michaelzhao-harvard-university/wiki-multiple/sweeps/eko9ylky
Starting training with config: {'batch_size': 64, 'epochs': 25, 'l2_reg': 0.0005413090046320467, 'lr': 3.31949550803375e-05, 'n_layers_freeze': 11, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.080
Batch: 5/29	Loss: 1.064
Batch: 7/29	Loss: 1.047
Batch: 9/29	Loss: 1.033
Batch: 11/29	Loss: 1.016
Batch: 13/29	Loss: 1.001
Batch: 15/29	Loss: 1.000
Batch: 17/29	Loss: 0.961
Batch: 19/29	Loss: 0.949
Batch: 21/29	Loss: 0.930
Batch: 23/29	Loss: 0.927
Batch: 25/29	Loss: 0.894
Batch: 27/29	Loss: 0.875
Batch: 29/29	Loss: 0.882
Epoch: 1	Train Loss: 0.983	Val F1: 0.223
Best Epoch: 1	Best Val F1: 0.223

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.868
Batch: 3/29	Loss: 0.860
Batch: 5/29	Loss: 0.883
Batch: 7/29	Loss: 0.838
Batch: 9/29	Loss: 0.851
Batch: 11/29	Loss: 0.803
Batch: 13/29	Loss: 0.799
Batch: 15/29	Loss: 0.825
Batch: 17/29	Loss: 0.808
Batch: 19/29	Loss: 0.846
Batch: 21/29	Loss: 0.790
Batch: 23/29	Loss: 0.798
Batch: 25/29	Loss: 0.772
Batch: 27/29	Loss: 0.841
Batch: 29/29	Loss: 0.780
Epoch: 2	Train Loss: 0.819	Val F1: 0.219
Best Epoch: 1	Best Val F1: 0.223

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.760
Batch: 3/29	Loss: 0.786
Batch: 5/29	Loss: 0.771
Batch: 7/29	Loss: 0.812
Batch: 9/29	Loss: 0.748
Batch: 11/29	Loss: 0.753
Batch: 13/29	Loss: 0.809
Batch: 15/29	Loss: 0.767
Batch: 17/29	Loss: 0.788
Batch: 19/29	Loss: 0.780
Batch: 21/29	Loss: 0.747
Batch: 23/29	Loss: 0.742
Batch: 25/29	Loss: 0.775
Batch: 27/29	Loss: 0.743
Batch: 29/29	Loss: 0.753
Epoch: 3	Train Loss: 0.770	Val F1: 0.264
Best Epoch: 3	Best Val F1: 0.264

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.733
Batch: 3/29	Loss: 0.751
Batch: 5/29	Loss: 0.725
Batch: 7/29	Loss: 0.794
Batch: 9/29	Loss: 0.768
Batch: 11/29	Loss: 0.705
Batch: 13/29	Loss: 0.734
Batch: 15/29	Loss: 0.713
Batch: 17/29	Loss: 0.726
Batch: 19/29	Loss: 0.766
Batch: 21/29	Loss: 0.771
Batch: 23/29	Loss: 0.761
Batch: 25/29	Loss: 0.753
Batch: 27/29	Loss: 0.768
Batch: 29/29	Loss: 0.746
Epoch: 4	Train Loss: 0.747	Val F1: 0.303
Best Epoch: 4	Best Val F1: 0.303

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.724
Batch: 3/29	Loss: 0.723
Batch: 5/29	Loss: 0.692
Batch: 7/29	Loss: 0.689
Batch: 9/29	Loss: 0.686
Batch: 11/29	Loss: 0.691
Batch: 13/29	Loss: 0.688
Batch: 15/29	Loss: 0.715
Batch: 17/29	Loss: 0.759
Batch: 19/29	Loss: 0.715
Batch: 21/29	Loss: 0.669
Batch: 23/29	Loss: 0.726
Batch: 25/29	Loss: 0.729
Batch: 27/29	Loss: 0.668
Batch: 29/29	Loss: 0.718
Epoch: 5	Train Loss: 0.718	Val F1: 0.309
Best Epoch: 5	Best Val F1: 0.309

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.687
Batch: 3/29	Loss: 0.774
Batch: 5/29	Loss: 0.646
Batch: 7/29	Loss: 0.776
Batch: 9/29	Loss: 0.684
Batch: 11/29	Loss: 0.685
Batch: 13/29	Loss: 0.660
Batch: 15/29	Loss: 0.659
Batch: 17/29	Loss: 0.678
Batch: 19/29	Loss: 0.626
Batch: 21/29	Loss: 0.736
Batch: 23/29	Loss: 0.652
Batch: 25/29	Loss: 0.709
Batch: 27/29	Loss: 0.661
Batch: 29/29	Loss: 0.640
Epoch: 6	Train Loss: 0.683	Val F1: 0.307
Best Epoch: 5	Best Val F1: 0.309

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.625
Batch: 3/29	Loss: 0.668
Batch: 5/29	Loss: 0.771
Batch: 7/29	Loss: 0.692
Batch: 9/29	Loss: 0.672
Batch: 11/29	Loss: 0.618
Batch: 13/29	Loss: 0.663
Batch: 15/29	Loss: 0.567
Batch: 17/29	Loss: 0.727
Batch: 19/29	Loss: 0.703
Batch: 21/29	Loss: 0.614
Batch: 23/29	Loss: 0.623
Batch: 25/29	Loss: 0.562
Batch: 27/29	Loss: 0.634
Batch: 29/29	Loss: 0.624
Epoch: 7	Train Loss: 0.653	Val F1: 0.306
Best Epoch: 5	Best Val F1: 0.309

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.644
Batch: 3/29	Loss: 0.601
Batch: 5/29	Loss: 0.645
Batch: 7/29	Loss: 0.596
Batch: 9/29	Loss: 0.629
Batch: 11/29	Loss: 0.614
Batch: 13/29	Loss: 0.687
Batch: 15/29	Loss: 0.611
Batch: 17/29	Loss: 0.672
Batch: 19/29	Loss: 0.658
Batch: 21/29	Loss: 0.687
Batch: 23/29	Loss: 0.622
Batch: 25/29	Loss: 0.672
Batch: 27/29	Loss: 0.627
Batch: 29/29	Loss: 0.616
Epoch: 8	Train Loss: 0.627	Val F1: 0.315
Best Epoch: 8	Best Val F1: 0.315

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.657
Batch: 3/29	Loss: 0.562
Batch: 5/29	Loss: 0.601
Batch: 7/29	Loss: 0.572
Batch: 9/29	Loss: 0.684
Batch: 11/29	Loss: 0.599
Batch: 13/29	Loss: 0.629
Batch: 15/29	Loss: 0.582
Batch: 17/29	Loss: 0.594
Batch: 19/29	Loss: 0.507
Batch: 21/29	Loss: 0.643
Batch: 23/29	Loss: 0.610
Batch: 25/29	Loss: 0.569
Batch: 27/29	Loss: 0.633
Batch: 29/29	Loss: 0.553
Epoch: 9	Train Loss: 0.607	Val F1: 0.307
Best Epoch: 8	Best Val F1: 0.315

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.547
Batch: 3/29	Loss: 0.565
Batch: 5/29	Loss: 0.557
Batch: 7/29	Loss: 0.577
Batch: 9/29	Loss: 0.536
Batch: 11/29	Loss: 0.471
Batch: 13/29	Loss: 0.674
Batch: 15/29	Loss: 0.666
Batch: 17/29	Loss: 0.632
Batch: 19/29	Loss: 0.461
Batch: 21/29	Loss: 0.634
Batch: 23/29	Loss: 0.633
Batch: 25/29	Loss: 0.621
Batch: 27/29	Loss: 0.531
Batch: 29/29	Loss: 0.664
Epoch: 10	Train Loss: 0.579	Val F1: 0.312
Best Epoch: 8	Best Val F1: 0.315

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.533
Batch: 3/29	Loss: 0.497
Batch: 5/29	Loss: 0.661
Batch: 7/29	Loss: 0.600
Batch: 9/29	Loss: 0.548
Batch: 11/29	Loss: 0.567
Batch: 13/29	Loss: 0.561
Batch: 15/29	Loss: 0.453
Batch: 17/29	Loss: 0.617
Batch: 19/29	Loss: 0.542
Batch: 21/29	Loss: 0.486
Batch: 23/29	Loss: 0.511
Batch: 25/29	Loss: 0.482
Batch: 27/29	Loss: 0.515
Batch: 29/29	Loss: 0.534
Epoch: 11	Train Loss: 0.559	Val F1: 0.316
Best Epoch: 11	Best Val F1: 0.316

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.693
Batch: 3/29	Loss: 0.482
Batch: 5/29	Loss: 0.492
Batch: 7/29	Loss: 0.485
Batch: 9/29	Loss: 0.540
Batch: 11/29	Loss: 0.533
Batch: 13/29	Loss: 0.493
Batch: 15/29	Loss: 0.514
Batch: 17/29	Loss: 0.574
Batch: 19/29	Loss: 0.471
Batch: 21/29	Loss: 0.511
Batch: 23/29	Loss: 0.572
Batch: 25/29	Loss: 0.514
Batch: 27/29	Loss: 0.567
Batch: 29/29	Loss: 0.409
Epoch: 12	Train Loss: 0.531	Val F1: 0.312
Best Epoch: 11	Best Val F1: 0.316

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.496
Batch: 3/29	Loss: 0.445
Batch: 5/29	Loss: 0.521
Batch: 7/29	Loss: 0.516
Batch: 9/29	Loss: 0.518
Batch: 11/29	Loss: 0.536
Batch: 13/29	Loss: 0.552
Batch: 15/29	Loss: 0.506
Batch: 17/29	Loss: 0.451
Batch: 19/29	Loss: 0.399
Batch: 21/29	Loss: 0.459
Batch: 23/29	Loss: 0.507
Batch: 25/29	Loss: 0.380
Batch: 27/29	Loss: 0.544
Batch: 29/29	Loss: 0.479
Epoch: 13	Train Loss: 0.509	Val F1: 0.319
Best Epoch: 13	Best Val F1: 0.319

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.452
Batch: 3/29	Loss: 0.546
Batch: 5/29	Loss: 0.390
Batch: 7/29	Loss: 0.466
Batch: 9/29	Loss: 0.505
Batch: 11/29	Loss: 0.521
Batch: 13/29	Loss: 0.465
Batch: 15/29	Loss: 0.391
Batch: 17/29	Loss: 0.526
Batch: 19/29	Loss: 0.603
Batch: 21/29	Loss: 0.370
Batch: 23/29	Loss: 0.371
Batch: 25/29	Loss: 0.527
Batch: 27/29	Loss: 0.527
Batch: 29/29	Loss: 0.512
Epoch: 14	Train Loss: 0.486	Val F1: 0.315
Best Epoch: 13	Best Val F1: 0.319

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.463
Batch: 3/29	Loss: 0.436
Batch: 5/29	Loss: 0.377
Batch: 7/29	Loss: 0.378
Batch: 9/29	Loss: 0.464
Batch: 11/29	Loss: 0.438
Batch: 13/29	Loss: 0.461
Batch: 15/29	Loss: 0.490
Batch: 17/29	Loss: 0.542
Batch: 19/29	Loss: 0.477
Batch: 21/29	Loss: 0.437
Batch: 23/29	Loss: 0.463
Batch: 25/29	Loss: 0.515
Batch: 27/29	Loss: 0.429
Batch: 29/29	Loss: 0.463
Epoch: 15	Train Loss: 0.469	Val F1: 0.321
Best Epoch: 15	Best Val F1: 0.321

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.475
Batch: 3/29	Loss: 0.397
Batch: 5/29	Loss: 0.460
Batch: 7/29	Loss: 0.442
Batch: 9/29	Loss: 0.529
Batch: 11/29	Loss: 0.468
Batch: 13/29	Loss: 0.394
Batch: 15/29	Loss: 0.443
Batch: 17/29	Loss: 0.394
Batch: 19/29	Loss: 0.484
Batch: 21/29	Loss: 0.373
Batch: 23/29	Loss: 0.479
Batch: 25/29	Loss: 0.430
Batch: 27/29	Loss: 0.456
Batch: 29/29	Loss: 0.486
Epoch: 16	Train Loss: 0.445	Val F1: 0.312
Best Epoch: 15	Best Val F1: 0.321

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.342
Batch: 3/29	Loss: 0.498
Batch: 5/29	Loss: 0.498
Batch: 7/29	Loss: 0.439
Batch: 9/29	Loss: 0.314
Batch: 11/29	Loss: 0.457
Batch: 13/29	Loss: 0.464
Batch: 15/29	Loss: 0.437
Batch: 17/29	Loss: 0.512
Batch: 19/29	Loss: 0.378
Batch: 21/29	Loss: 0.480
Batch: 23/29	Loss: 0.450
Batch: 25/29	Loss: 0.270
Batch: 27/29	Loss: 0.454
Batch: 29/29	Loss: 0.399
Epoch: 17	Train Loss: 0.422	Val F1: 0.318
Best Epoch: 15	Best Val F1: 0.321

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.483
Batch: 3/29	Loss: 0.444
Batch: 5/29	Loss: 0.444
Batch: 7/29	Loss: 0.411
Batch: 9/29	Loss: 0.491
Batch: 11/29	Loss: 0.396
Batch: 13/29	Loss: 0.365
Batch: 15/29	Loss: 0.418
Batch: 17/29	Loss: 0.413
Batch: 19/29	Loss: 0.314
Batch: 21/29	Loss: 0.482
Batch: 23/29	Loss: 0.400
Batch: 25/29	Loss: 0.464
Batch: 27/29	Loss: 0.328
Batch: 29/29	Loss: 0.402
Epoch: 18	Train Loss: 0.407	Val F1: 0.312
Best Epoch: 15	Best Val F1: 0.321

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.342
Batch: 3/29	Loss: 0.296
Batch: 5/29	Loss: 0.441
Batch: 7/29	Loss: 0.499
Batch: 9/29	Loss: 0.340
Batch: 11/29	Loss: 0.399
Batch: 13/29	Loss: 0.423
Batch: 15/29	Loss: 0.360
Batch: 17/29	Loss: 0.313
Batch: 19/29	Loss: 0.520
Batch: 21/29	Loss: 0.389
Batch: 23/29	Loss: 0.408
Batch: 25/29	Loss: 0.383
Batch: 27/29	Loss: 0.331
Batch: 29/29	Loss: 0.331
Epoch: 19	Train Loss: 0.389	Val F1: 0.312
Best Epoch: 15	Best Val F1: 0.321

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.448
Batch: 3/29	Loss: 0.360
Batch: 5/29	Loss: 0.370
Batch: 7/29	Loss: 0.268
Batch: 9/29	Loss: 0.385
Batch: 11/29	Loss: 0.362
Batch: 13/29	Loss: 0.312
Batch: 15/29	Loss: 0.358
Batch: 17/29	Loss: 0.406
Batch: 19/29	Loss: 0.350
Batch: 21/29	Loss: 0.392
Batch: 23/29	Loss: 0.432
Batch: 25/29	Loss: 0.417
Batch: 27/29	Loss: 0.371
Batch: 29/29	Loss: 0.420
Epoch: 20	Train Loss: 0.370	Val F1: 0.317
Best Epoch: 15	Best Val F1: 0.321

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.310
Batch: 3/29	Loss: 0.363
Batch: 5/29	Loss: 0.275
Batch: 7/29	Loss: 0.510
Batch: 9/29	Loss: 0.335
Batch: 11/29	Loss: 0.286
Batch: 13/29	Loss: 0.381
Batch: 15/29	Loss: 0.400
Batch: 17/29	Loss: 0.263
Batch: 19/29	Loss: 0.341
Batch: 21/29	Loss: 0.370
Batch: 23/29	Loss: 0.370
Batch: 25/29	Loss: 0.371
Batch: 27/29	Loss: 0.393
Batch: 29/29	Loss: 0.410
Epoch: 21	Train Loss: 0.351	Val F1: 0.331
Best Epoch: 21	Best Val F1: 0.331

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.313
Batch: 3/29	Loss: 0.311
Batch: 5/29	Loss: 0.409
Batch: 7/29	Loss: 0.351
Batch: 9/29	Loss: 0.329
Batch: 11/29	Loss: 0.373
Batch: 13/29	Loss: 0.310
Batch: 15/29	Loss: 0.323
Batch: 17/29	Loss: 0.339
Batch: 19/29	Loss: 0.390
Batch: 21/29	Loss: 0.417
Batch: 23/29	Loss: 0.296
Batch: 25/29	Loss: 0.370
Batch: 27/29	Loss: 0.345
Batch: 29/29	Loss: 0.303
Epoch: 22	Train Loss: 0.343	Val F1: 0.316
Best Epoch: 21	Best Val F1: 0.331

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.306
Batch: 3/29	Loss: 0.344
Batch: 5/29	Loss: 0.354
Batch: 7/29	Loss: 0.406
Batch: 9/29	Loss: 0.293
Batch: 11/29	Loss: 0.367
Batch: 13/29	Loss: 0.262
Batch: 15/29	Loss: 0.372
Batch: 17/29	Loss: 0.329
Batch: 19/29	Loss: 0.311
Batch: 21/29	Loss: 0.295
Batch: 23/29	Loss: 0.243
Batch: 25/29	Loss: 0.283
Batch: 27/29	Loss: 0.275
Batch: 29/29	Loss: 0.297
Epoch: 23	Train Loss: 0.331	Val F1: 0.320
Best Epoch: 21	Best Val F1: 0.331

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.256
Batch: 3/29	Loss: 0.289
Batch: 5/29	Loss: 0.353
Batch: 7/29	Loss: 0.273
Batch: 9/29	Loss: 0.309
Batch: 11/29	Loss: 0.319
Batch: 13/29	Loss: 0.255
Batch: 15/29	Loss: 0.277
Batch: 17/29	Loss: 0.286
Batch: 19/29	Loss: 0.377
Batch: 21/29	Loss: 0.383
Batch: 23/29	Loss: 0.312
Batch: 25/29	Loss: 0.298
Batch: 27/29	Loss: 0.307
Batch: 29/29	Loss: 0.312
Epoch: 24	Train Loss: 0.313	Val F1: 0.317
Best Epoch: 21	Best Val F1: 0.331

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.364
Batch: 3/29	Loss: 0.282
Batch: 5/29	Loss: 0.267
Batch: 7/29	Loss: 0.287
Batch: 9/29	Loss: 0.345
Batch: 11/29	Loss: 0.258
Batch: 13/29	Loss: 0.356
Batch: 15/29	Loss: 0.345
Batch: 17/29	Loss: 0.276
Batch: 19/29	Loss: 0.265
Batch: 21/29	Loss: 0.244
Batch: 23/29	Loss: 0.339
Batch: 25/29	Loss: 0.331
Batch: 27/29	Loss: 0.284
Batch: 29/29	Loss: 0.300
Epoch: 25	Train Loss: 0.295	Val F1: 0.319
Best Epoch: 21	Best Val F1: 0.331

Saving the best checkpoint....
Inference...
Test F1: 0.358	Test F1_Few: 0.368	Test F1_Zero: 0.348
Starting training with config: {'batch_size': 32, 'epochs': 50, 'l2_reg': 0.00047713945470969737, 'lr': 4.844330717724521e-05, 'n_layers_freeze': 9, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 0.998
Batch: 11/58	Loss: 0.914
Batch: 16/58	Loss: 0.832
Batch: 21/58	Loss: 0.854
Batch: 26/58	Loss: 0.842
Batch: 31/58	Loss: 0.797
Batch: 36/58	Loss: 0.845
Batch: 41/58	Loss: 0.764
Batch: 46/58	Loss: 0.753
Batch: 51/58	Loss: 0.738
Batch: 56/58	Loss: 0.751
Batch: 58/58	Loss: 0.765
Epoch: 1	Train Loss: 0.852	Val F1: 0.204
Best Epoch: 1	Best Val F1: 0.204

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.780
Batch: 6/58	Loss: 0.807
Batch: 11/58	Loss: 0.796
Batch: 16/58	Loss: 0.703
Batch: 21/58	Loss: 0.715
Batch: 26/58	Loss: 0.691
Batch: 31/58	Loss: 0.777
Batch: 36/58	Loss: 0.749
Batch: 41/58	Loss: 0.653
Batch: 46/58	Loss: 0.679
Batch: 51/58	Loss: 0.718
Batch: 56/58	Loss: 0.707
Batch: 58/58	Loss: 0.664
Epoch: 2	Train Loss: 0.739	Val F1: 0.309
Best Epoch: 2	Best Val F1: 0.309

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.629
Batch: 6/58	Loss: 0.571
Batch: 11/58	Loss: 0.684
Batch: 16/58	Loss: 0.628
Batch: 21/58	Loss: 0.707
Batch: 26/58	Loss: 0.619
Batch: 31/58	Loss: 0.887
Batch: 36/58	Loss: 0.710
Batch: 41/58	Loss: 0.575
Batch: 46/58	Loss: 0.574
Batch: 51/58	Loss: 0.804
Batch: 56/58	Loss: 0.638
Batch: 58/58	Loss: 0.686
Epoch: 3	Train Loss: 0.684	Val F1: 0.283
Best Epoch: 2	Best Val F1: 0.309

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.711
Batch: 6/58	Loss: 0.615
Batch: 11/58	Loss: 0.606
Batch: 16/58	Loss: 0.589
Batch: 21/58	Loss: 0.548
Batch: 26/58	Loss: 0.491
Batch: 31/58	Loss: 0.507
Batch: 36/58	Loss: 0.739
Batch: 41/58	Loss: 0.686
Batch: 46/58	Loss: 0.626
Batch: 51/58	Loss: 0.542
Batch: 56/58	Loss: 0.566
Batch: 58/58	Loss: 0.553
Epoch: 4	Train Loss: 0.627	Val F1: 0.314
Best Epoch: 4	Best Val F1: 0.314

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.517
Batch: 6/58	Loss: 0.560
Batch: 11/58	Loss: 0.546
Batch: 16/58	Loss: 0.549
Batch: 21/58	Loss: 0.458
Batch: 26/58	Loss: 0.455
Batch: 31/58	Loss: 0.759
Batch: 36/58	Loss: 0.589
Batch: 41/58	Loss: 0.616
Batch: 46/58	Loss: 0.550
Batch: 51/58	Loss: 0.675
Batch: 56/58	Loss: 0.629
Batch: 58/58	Loss: 0.716
Epoch: 5	Train Loss: 0.589	Val F1: 0.310
Best Epoch: 4	Best Val F1: 0.314

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.548
Batch: 6/58	Loss: 0.649
Batch: 11/58	Loss: 0.565
Batch: 16/58	Loss: 0.561
Batch: 21/58	Loss: 0.529
Batch: 26/58	Loss: 0.349
Batch: 31/58	Loss: 0.553
Batch: 36/58	Loss: 0.406
Batch: 41/58	Loss: 0.601
Batch: 46/58	Loss: 0.514
Batch: 51/58	Loss: 0.521
Batch: 56/58	Loss: 0.510
Batch: 58/58	Loss: 0.429
Epoch: 6	Train Loss: 0.540	Val F1: 0.307
Best Epoch: 4	Best Val F1: 0.314

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.362
Batch: 6/58	Loss: 0.558
Batch: 11/58	Loss: 0.520
Batch: 16/58	Loss: 0.405
Batch: 21/58	Loss: 0.500
Batch: 26/58	Loss: 0.574
Batch: 31/58	Loss: 0.414
Batch: 36/58	Loss: 0.476
Batch: 41/58	Loss: 0.457
Batch: 46/58	Loss: 0.442
Batch: 51/58	Loss: 0.468
Batch: 56/58	Loss: 0.463
Batch: 58/58	Loss: 0.279
Epoch: 7	Train Loss: 0.482	Val F1: 0.320
Best Epoch: 7	Best Val F1: 0.320

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.482
Batch: 6/58	Loss: 0.408
Batch: 11/58	Loss: 0.387
Batch: 16/58	Loss: 0.346
Batch: 21/58	Loss: 0.483
Batch: 26/58	Loss: 0.280
Batch: 31/58	Loss: 0.357
Batch: 36/58	Loss: 0.344
Batch: 41/58	Loss: 0.438
Batch: 46/58	Loss: 0.463
Batch: 51/58	Loss: 0.376
Batch: 56/58	Loss: 0.347
Batch: 58/58	Loss: 0.464
Epoch: 8	Train Loss: 0.429	Val F1: 0.317
Best Epoch: 7	Best Val F1: 0.320

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.366
Batch: 6/58	Loss: 0.548
Batch: 11/58	Loss: 0.490
Batch: 16/58	Loss: 0.314
Batch: 21/58	Loss: 0.376
Batch: 26/58	Loss: 0.272
Batch: 31/58	Loss: 0.348
Batch: 36/58	Loss: 0.342
Batch: 41/58	Loss: 0.600
Batch: 46/58	Loss: 0.450
Batch: 51/58	Loss: 0.399
Batch: 56/58	Loss: 0.353
Batch: 58/58	Loss: 0.341
Epoch: 9	Train Loss: 0.394	Val F1: 0.324
Best Epoch: 9	Best Val F1: 0.324

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.358
Batch: 6/58	Loss: 0.328
Batch: 11/58	Loss: 0.389
Batch: 16/58	Loss: 0.549
Batch: 21/58	Loss: 0.283
Batch: 26/58	Loss: 0.389
Batch: 31/58	Loss: 0.286
Batch: 36/58	Loss: 0.435
Batch: 41/58	Loss: 0.378
Batch: 46/58	Loss: 0.671
Batch: 51/58	Loss: 0.271
Batch: 56/58	Loss: 0.285
Batch: 58/58	Loss: 0.459
Epoch: 10	Train Loss: 0.354	Val F1: 0.302
Best Epoch: 9	Best Val F1: 0.324

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.290
Batch: 6/58	Loss: 0.249
Batch: 11/58	Loss: 0.311
Batch: 16/58	Loss: 0.265
Batch: 21/58	Loss: 0.327
Batch: 26/58	Loss: 0.353
Batch: 31/58	Loss: 0.328
Batch: 36/58	Loss: 0.459
Batch: 41/58	Loss: 0.255
Batch: 46/58	Loss: 0.353
Batch: 51/58	Loss: 0.319
Batch: 56/58	Loss: 0.323
Batch: 58/58	Loss: 0.243
Epoch: 11	Train Loss: 0.305	Val F1: 0.311
Best Epoch: 9	Best Val F1: 0.324

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.312
Batch: 6/58	Loss: 0.226
Batch: 11/58	Loss: 0.262
Batch: 16/58	Loss: 0.214
Batch: 21/58	Loss: 0.275
Batch: 26/58	Loss: 0.243
Batch: 31/58	Loss: 0.291
Batch: 36/58	Loss: 0.260
Batch: 41/58	Loss: 0.231
Batch: 46/58	Loss: 0.263
Batch: 51/58	Loss: 0.424
Batch: 56/58	Loss: 0.195
Batch: 58/58	Loss: 0.110
Epoch: 12	Train Loss: 0.266	Val F1: 0.315
Best Epoch: 9	Best Val F1: 0.324

****************************** Epoch: 13 ******************************
Batch: 1/58	Loss: 0.161
Batch: 6/58	Loss: 0.190
Batch: 11/58	Loss: 0.249
Batch: 16/58	Loss: 0.179
Batch: 21/58	Loss: 0.233
Batch: 26/58	Loss: 0.189
Batch: 31/58	Loss: 0.203
Batch: 36/58	Loss: 0.352
Batch: 41/58	Loss: 0.172
Batch: 46/58	Loss: 0.269
Batch: 51/58	Loss: 0.179
Batch: 56/58	Loss: 0.299
Batch: 58/58	Loss: 0.172
Epoch: 13	Train Loss: 0.229	Val F1: 0.293
Best Epoch: 9	Best Val F1: 0.324

****************************** Epoch: 14 ******************************
Batch: 1/58	Loss: 0.287
Batch: 6/58	Loss: 0.205
Batch: 11/58	Loss: 0.206
Batch: 16/58	Loss: 0.178
Batch: 21/58	Loss: 0.144
Batch: 26/58	Loss: 0.190
Batch: 31/58	Loss: 0.330
Batch: 36/58	Loss: 0.147
Batch: 41/58	Loss: 0.112
Batch: 46/58	Loss: 0.105
Batch: 51/58	Loss: 0.251
Batch: 56/58	Loss: 0.229
Batch: 58/58	Loss: 0.198
Epoch: 14	Train Loss: 0.187	Val F1: 0.306
Best Epoch: 9	Best Val F1: 0.324

****************************** Epoch: 15 ******************************
Batch: 1/58	Loss: 0.127
Batch: 6/58	Loss: 0.260
Batch: 11/58	Loss: 0.141
Batch: 16/58	Loss: 0.082
Batch: 21/58	Loss: 0.189
Batch: 26/58	Loss: 0.112
Batch: 31/58	Loss: 0.098
Batch: 36/58	Loss: 0.174
Batch: 41/58	Loss: 0.091
Batch: 46/58	Loss: 0.097
Batch: 51/58	Loss: 0.156
Batch: 56/58	Loss: 0.103
Batch: 58/58	Loss: 0.137
Epoch: 15	Train Loss: 0.147	Val F1: 0.322
Best Epoch: 9	Best Val F1: 0.324

****************************** Epoch: 16 ******************************
Batch: 1/58	Loss: 0.082
Batch: 6/58	Loss: 0.071
Batch: 11/58	Loss: 0.086
Batch: 16/58	Loss: 0.075
Batch: 21/58	Loss: 0.130
Batch: 26/58	Loss: 0.063
Batch: 31/58	Loss: 0.065
Batch: 36/58	Loss: 0.080
Batch: 41/58	Loss: 0.100
Batch: 46/58	Loss: 0.164
Batch: 51/58	Loss: 0.082
Batch: 56/58	Loss: 0.135
Batch: 58/58	Loss: 0.075
Epoch: 16	Train Loss: 0.125	Val F1: 0.313
Best Epoch: 9	Best Val F1: 0.324

****************************** Epoch: 17 ******************************
Batch: 1/58	Loss: 0.057
Batch: 6/58	Loss: 0.105
Batch: 11/58	Loss: 0.068
Batch: 16/58	Loss: 0.081
Batch: 21/58	Loss: 0.116
Batch: 26/58	Loss: 0.131
Batch: 31/58	Loss: 0.087
Batch: 36/58	Loss: 0.104
Batch: 41/58	Loss: 0.092
Batch: 46/58	Loss: 0.131
Batch: 51/58	Loss: 0.056
Batch: 56/58	Loss: 0.105
Batch: 58/58	Loss: 0.081
Epoch: 17	Train Loss: 0.099	Val F1: 0.314
Best Epoch: 9	Best Val F1: 0.324

****************************** Epoch: 18 ******************************
Batch: 1/58	Loss: 0.114
Batch: 6/58	Loss: 0.106
Batch: 11/58	Loss: 0.076
Batch: 16/58	Loss: 0.209
Batch: 21/58	Loss: 0.075
Batch: 26/58	Loss: 0.113
Batch: 31/58	Loss: 0.058
Batch: 36/58	Loss: 0.093
Batch: 41/58	Loss: 0.069
Batch: 46/58	Loss: 0.100
Batch: 51/58	Loss: 0.071
Batch: 56/58	Loss: 0.063
Batch: 58/58	Loss: 0.102
Epoch: 18	Train Loss: 0.097	Val F1: 0.309
Best Epoch: 9	Best Val F1: 0.324

****************************** Epoch: 19 ******************************
Batch: 1/58	Loss: 0.151
Batch: 6/58	Loss: 0.068
Batch: 11/58	Loss: 0.125
Batch: 16/58	Loss: 0.035
Batch: 21/58	Loss: 0.074
Batch: 26/58	Loss: 0.048
Batch: 31/58	Loss: 0.044
Batch: 36/58	Loss: 0.030
Batch: 41/58	Loss: 0.045
Batch: 46/58	Loss: 0.097
Batch: 51/58	Loss: 0.060
Batch: 56/58	Loss: 0.052
Batch: 58/58	Loss: 0.058
Epoch: 19	Train Loss: 0.073	Val F1: 0.333
Best Epoch: 19	Best Val F1: 0.333

****************************** Epoch: 20 ******************************
Batch: 1/58	Loss: 0.081
Batch: 6/58	Loss: 0.047
Batch: 11/58	Loss: 0.080
Batch: 16/58	Loss: 0.034
Batch: 21/58	Loss: 0.050
Batch: 26/58	Loss: 0.045
Batch: 31/58	Loss: 0.087
Batch: 36/58	Loss: 0.036
Batch: 41/58	Loss: 0.030
Batch: 46/58	Loss: 0.098
Batch: 51/58	Loss: 0.050
Batch: 56/58	Loss: 0.062
Batch: 58/58	Loss: 0.053
Epoch: 20	Train Loss: 0.057	Val F1: 0.316
Best Epoch: 19	Best Val F1: 0.333

****************************** Epoch: 21 ******************************
Batch: 1/58	Loss: 0.074
Batch: 6/58	Loss: 0.019
Batch: 11/58	Loss: 0.026
Batch: 16/58	Loss: 0.035
Batch: 21/58	Loss: 0.026
Batch: 26/58	Loss: 0.102
Batch: 31/58	Loss: 0.021
Batch: 36/58	Loss: 0.053
Batch: 41/58	Loss: 0.043
Batch: 46/58	Loss: 0.073
Batch: 51/58	Loss: 0.030
Batch: 56/58	Loss: 0.023
Batch: 58/58	Loss: 0.027
Epoch: 21	Train Loss: 0.048	Val F1: 0.322
Best Epoch: 19	Best Val F1: 0.333

****************************** Epoch: 22 ******************************
Batch: 1/58	Loss: 0.122
Batch: 6/58	Loss: 0.043
Batch: 11/58	Loss: 0.065
Batch: 16/58	Loss: 0.082
Batch: 21/58	Loss: 0.031
Batch: 26/58	Loss: 0.043
Batch: 31/58	Loss: 0.037
Batch: 36/58	Loss: 0.063
Batch: 41/58	Loss: 0.040
Batch: 46/58	Loss: 0.052
Batch: 51/58	Loss: 0.016
Batch: 56/58	Loss: 0.055
Batch: 58/58	Loss: 0.111
Epoch: 22	Train Loss: 0.047	Val F1: 0.329
Best Epoch: 19	Best Val F1: 0.333

****************************** Epoch: 23 ******************************
Batch: 1/58	Loss: 0.031
Batch: 6/58	Loss: 0.026
Batch: 11/58	Loss: 0.019
Batch: 16/58	Loss: 0.031
Batch: 21/58	Loss: 0.020
Batch: 26/58	Loss: 0.046
Batch: 31/58	Loss: 0.045
Batch: 36/58	Loss: 0.075
Batch: 41/58	Loss: 0.039
Batch: 46/58	Loss: 0.064
Batch: 51/58	Loss: 0.010
Batch: 56/58	Loss: 0.022
Batch: 58/58	Loss: 0.024
Epoch: 23	Train Loss: 0.034	Val F1: 0.326
Best Epoch: 19	Best Val F1: 0.333

****************************** Epoch: 24 ******************************
Batch: 1/58	Loss: 0.027
Batch: 6/58	Loss: 0.033
Batch: 11/58	Loss: 0.019
Batch: 16/58	Loss: 0.099
Batch: 21/58	Loss: 0.025
Batch: 26/58	Loss: 0.016
Batch: 31/58	Loss: 0.016
Batch: 36/58	Loss: 0.024
Batch: 41/58	Loss: 0.084
Batch: 46/58	Loss: 0.014
Batch: 51/58	Loss: 0.044
Batch: 56/58	Loss: 0.017
Batch: 58/58	Loss: 0.046
Epoch: 24	Train Loss: 0.031	Val F1: 0.331
Best Epoch: 19	Best Val F1: 0.333

****************************** Epoch: 25 ******************************
Batch: 1/58	Loss: 0.033
Batch: 6/58	Loss: 0.030
Batch: 11/58	Loss: 0.017
Batch: 16/58	Loss: 0.007
Batch: 21/58	Loss: 0.043
Batch: 26/58	Loss: 0.072
Batch: 31/58	Loss: 0.039
Batch: 36/58	Loss: 0.022
Batch: 41/58	Loss: 0.059
Batch: 46/58	Loss: 0.052
Batch: 51/58	Loss: 0.019
Batch: 56/58	Loss: 0.037
Batch: 58/58	Loss: 0.032
Epoch: 25	Train Loss: 0.037	Val F1: 0.323
Best Epoch: 19	Best Val F1: 0.333

****************************** Epoch: 26 ******************************
Batch: 1/58	Loss: 0.017
Batch: 6/58	Loss: 0.039
Batch: 11/58	Loss: 0.062
Batch: 16/58	Loss: 0.030
Batch: 21/58	Loss: 0.027
Batch: 26/58	Loss: 0.032
Batch: 31/58	Loss: 0.023
Batch: 36/58	Loss: 0.019
Batch: 41/58	Loss: 0.019
Batch: 46/58	Loss: 0.021
Batch: 51/58	Loss: 0.040
Batch: 56/58	Loss: 0.023
Batch: 58/58	Loss: 0.010
Epoch: 26	Train Loss: 0.029	Val F1: 0.320
Best Epoch: 19	Best Val F1: 0.333

****************************** Epoch: 27 ******************************
Batch: 1/58	Loss: 0.015
Batch: 6/58	Loss: 0.034
Batch: 11/58	Loss: 0.024
Batch: 16/58	Loss: 0.022
Batch: 21/58	Loss: 0.031
Batch: 26/58	Loss: 0.016
Batch: 31/58	Loss: 0.012
Batch: 36/58	Loss: 0.012
Batch: 41/58	Loss: 0.040
Batch: 46/58	Loss: 0.010
Batch: 51/58	Loss: 0.010
Batch: 56/58	Loss: 0.012
Batch: 58/58	Loss: 0.037
Epoch: 27	Train Loss: 0.020	Val F1: 0.326
Best Epoch: 19	Best Val F1: 0.333

****************************** Epoch: 28 ******************************
Batch: 1/58	Loss: 0.026
Batch: 6/58	Loss: 0.019
Batch: 11/58	Loss: 0.016
Batch: 16/58	Loss: 0.011
Batch: 21/58	Loss: 0.019
Batch: 26/58	Loss: 0.004
Batch: 31/58	Loss: 0.021
Batch: 36/58	Loss: 0.007
Batch: 41/58	Loss: 0.013
Batch: 46/58	Loss: 0.032
Batch: 51/58	Loss: 0.023
Batch: 56/58	Loss: 0.051
Batch: 58/58	Loss: 0.032
Epoch: 28	Train Loss: 0.027	Val F1: 0.330
Best Epoch: 19	Best Val F1: 0.333

****************************** Epoch: 29 ******************************
Batch: 1/58	Loss: 0.037
Batch: 6/58	Loss: 0.013
Batch: 11/58	Loss: 0.014
Batch: 16/58	Loss: 0.012
Batch: 21/58	Loss: 0.067
Batch: 26/58	Loss: 0.031
Batch: 31/58	Loss: 0.016
Batch: 36/58	Loss: 0.018
Batch: 41/58	Loss: 0.013
Batch: 46/58	Loss: 0.006
Batch: 51/58	Loss: 0.022
Batch: 56/58	Loss: 0.033
Batch: 58/58	Loss: 0.010
Epoch: 29	Train Loss: 0.024	Val F1: 0.317
Best Epoch: 19	Best Val F1: 0.333

Saving the best checkpoint....
Inference...
Test F1: 0.367	Test F1_Few: 0.445	Test F1_Zero: 0.358
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0004251033103751551, 'lr': 3.91515072344422e-05, 'n_layers_freeze': 12, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.091
Batch: 5/29	Loss: 1.085
Batch: 7/29	Loss: 1.078
Batch: 9/29	Loss: 1.074
Batch: 11/29	Loss: 1.064
Batch: 13/29	Loss: 1.056
Batch: 15/29	Loss: 1.057
Batch: 17/29	Loss: 1.040
Batch: 19/29	Loss: 1.034
Batch: 21/29	Loss: 1.025
Batch: 23/29	Loss: 1.028
Batch: 25/29	Loss: 1.014
Batch: 27/29	Loss: 0.998
Batch: 29/29	Loss: 1.006
Epoch: 1	Train Loss: 1.049	Val F1: 0.305
Best Epoch: 1	Best Val F1: 0.305

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.998
Batch: 3/29	Loss: 0.992
Batch: 5/29	Loss: 0.993
Batch: 7/29	Loss: 0.978
Batch: 9/29	Loss: 0.975
Batch: 11/29	Loss: 0.955
Batch: 13/29	Loss: 0.949
Batch: 15/29	Loss: 0.955
Batch: 17/29	Loss: 0.943
Batch: 19/29	Loss: 0.951
Batch: 21/29	Loss: 0.930
Batch: 23/29	Loss: 0.921
Batch: 25/29	Loss: 0.911
Batch: 27/29	Loss: 0.932
Batch: 29/29	Loss: 0.909
Epoch: 2	Train Loss: 0.951	Val F1: 0.257
Best Epoch: 1	Best Val F1: 0.305

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.895
Batch: 3/29	Loss: 0.895
Batch: 5/29	Loss: 0.884
Batch: 7/29	Loss: 0.900
Batch: 9/29	Loss: 0.866
Batch: 11/29	Loss: 0.866
Batch: 13/29	Loss: 0.891
Batch: 15/29	Loss: 0.853
Batch: 17/29	Loss: 0.868
Batch: 19/29	Loss: 0.860
Batch: 21/29	Loss: 0.839
Batch: 23/29	Loss: 0.834
Batch: 25/29	Loss: 0.843
Batch: 27/29	Loss: 0.824
Batch: 29/29	Loss: 0.827
Epoch: 3	Train Loss: 0.864	Val F1: 0.231
Best Epoch: 1	Best Val F1: 0.305

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.818
Batch: 3/29	Loss: 0.830
Batch: 5/29	Loss: 0.798
Batch: 7/29	Loss: 0.846
Batch: 9/29	Loss: 0.820
Batch: 11/29	Loss: 0.787
Batch: 13/29	Loss: 0.796
Batch: 15/29	Loss: 0.781
Batch: 17/29	Loss: 0.798
Batch: 19/29	Loss: 0.812
Batch: 21/29	Loss: 0.818
Batch: 23/29	Loss: 0.808
Batch: 25/29	Loss: 0.798
Batch: 27/29	Loss: 0.812
Batch: 29/29	Loss: 0.794
Epoch: 4	Train Loss: 0.807	Val F1: 0.237
Best Epoch: 1	Best Val F1: 0.305

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.780
Batch: 3/29	Loss: 0.779
Batch: 5/29	Loss: 0.761
Batch: 7/29	Loss: 0.753
Batch: 9/29	Loss: 0.751
Batch: 11/29	Loss: 0.765
Batch: 13/29	Loss: 0.755
Batch: 15/29	Loss: 0.780
Batch: 17/29	Loss: 0.803
Batch: 19/29	Loss: 0.768
Batch: 21/29	Loss: 0.744
Batch: 23/29	Loss: 0.768
Batch: 25/29	Loss: 0.799
Batch: 27/29	Loss: 0.745
Batch: 29/29	Loss: 0.762
Epoch: 5	Train Loss: 0.775	Val F1: 0.268
Best Epoch: 1	Best Val F1: 0.305

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.737
Batch: 3/29	Loss: 0.810
Batch: 5/29	Loss: 0.734
Batch: 7/29	Loss: 0.804
Batch: 9/29	Loss: 0.767
Batch: 11/29	Loss: 0.767
Batch: 13/29	Loss: 0.755
Batch: 15/29	Loss: 0.727
Batch: 17/29	Loss: 0.744
Batch: 19/29	Loss: 0.732
Batch: 21/29	Loss: 0.773
Batch: 23/29	Loss: 0.740
Batch: 25/29	Loss: 0.783
Batch: 27/29	Loss: 0.734
Batch: 29/29	Loss: 0.754
Epoch: 6	Train Loss: 0.759	Val F1: 0.278
Best Epoch: 1	Best Val F1: 0.305

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.734
Batch: 3/29	Loss: 0.777
Batch: 5/29	Loss: 0.798
Batch: 7/29	Loss: 0.735
Batch: 9/29	Loss: 0.775
Batch: 11/29	Loss: 0.716
Batch: 13/29	Loss: 0.734
Batch: 15/29	Loss: 0.713
Batch: 17/29	Loss: 0.779
Batch: 19/29	Loss: 0.777
Batch: 21/29	Loss: 0.732
Batch: 23/29	Loss: 0.736
Batch: 25/29	Loss: 0.703
Batch: 27/29	Loss: 0.729
Batch: 29/29	Loss: 0.737
Epoch: 7	Train Loss: 0.748	Val F1: 0.285
Best Epoch: 1	Best Val F1: 0.305

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.769
Batch: 3/29	Loss: 0.710
Batch: 5/29	Loss: 0.710
Batch: 7/29	Loss: 0.735
Batch: 9/29	Loss: 0.714
Batch: 11/29	Loss: 0.699
Batch: 13/29	Loss: 0.805
Batch: 15/29	Loss: 0.692
Batch: 17/29	Loss: 0.763
Batch: 19/29	Loss: 0.750
Batch: 21/29	Loss: 0.741
Batch: 23/29	Loss: 0.753
Batch: 25/29	Loss: 0.747
Batch: 27/29	Loss: 0.758
Batch: 29/29	Loss: 0.726
Epoch: 8	Train Loss: 0.738	Val F1: 0.295
Best Epoch: 1	Best Val F1: 0.305

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.782
Batch: 3/29	Loss: 0.751
Batch: 5/29	Loss: 0.697
Batch: 7/29	Loss: 0.691
Batch: 9/29	Loss: 0.751
Batch: 11/29	Loss: 0.744
Batch: 13/29	Loss: 0.775
Batch: 15/29	Loss: 0.729
Batch: 17/29	Loss: 0.711
Batch: 19/29	Loss: 0.709
Batch: 21/29	Loss: 0.773
Batch: 23/29	Loss: 0.718
Batch: 25/29	Loss: 0.700
Batch: 27/29	Loss: 0.713
Batch: 29/29	Loss: 0.686
Epoch: 9	Train Loss: 0.730	Val F1: 0.299
Best Epoch: 1	Best Val F1: 0.305

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.701
Batch: 3/29	Loss: 0.714
Batch: 5/29	Loss: 0.705
Batch: 7/29	Loss: 0.714
Batch: 9/29	Loss: 0.708
Batch: 11/29	Loss: 0.727
Batch: 13/29	Loss: 0.776
Batch: 15/29	Loss: 0.773
Batch: 17/29	Loss: 0.760
Batch: 19/29	Loss: 0.659
Batch: 21/29	Loss: 0.756
Batch: 23/29	Loss: 0.694
Batch: 25/29	Loss: 0.764
Batch: 27/29	Loss: 0.695
Batch: 29/29	Loss: 0.757
Epoch: 10	Train Loss: 0.721	Val F1: 0.301
Best Epoch: 1	Best Val F1: 0.305

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.723
Batch: 3/29	Loss: 0.694
Batch: 5/29	Loss: 0.774
Batch: 7/29	Loss: 0.711
Batch: 9/29	Loss: 0.734
Batch: 11/29	Loss: 0.712
Batch: 13/29	Loss: 0.708
Batch: 15/29	Loss: 0.652
Batch: 17/29	Loss: 0.742
Batch: 19/29	Loss: 0.731
Batch: 21/29	Loss: 0.682
Batch: 23/29	Loss: 0.685
Batch: 25/29	Loss: 0.680
Batch: 27/29	Loss: 0.717
Batch: 29/29	Loss: 0.660
Epoch: 11	Train Loss: 0.712	Val F1: 0.300
Best Epoch: 1	Best Val F1: 0.305

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.802
Batch: 3/29	Loss: 0.680
Batch: 5/29	Loss: 0.711
Batch: 7/29	Loss: 0.694
Batch: 9/29	Loss: 0.722
Batch: 11/29	Loss: 0.697
Batch: 13/29	Loss: 0.666
Batch: 15/29	Loss: 0.675
Batch: 17/29	Loss: 0.701
Batch: 19/29	Loss: 0.689
Batch: 21/29	Loss: 0.697
Batch: 23/29	Loss: 0.698
Batch: 25/29	Loss: 0.728
Batch: 27/29	Loss: 0.734
Batch: 29/29	Loss: 0.643
Epoch: 12	Train Loss: 0.702	Val F1: 0.307
Best Epoch: 12	Best Val F1: 0.307

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.751
Batch: 3/29	Loss: 0.660
Batch: 5/29	Loss: 0.694
Batch: 7/29	Loss: 0.646
Batch: 9/29	Loss: 0.709
Batch: 11/29	Loss: 0.697
Batch: 13/29	Loss: 0.732
Batch: 15/29	Loss: 0.707
Batch: 17/29	Loss: 0.635
Batch: 19/29	Loss: 0.662
Batch: 21/29	Loss: 0.657
Batch: 23/29	Loss: 0.691
Batch: 25/29	Loss: 0.645
Batch: 27/29	Loss: 0.687
Batch: 29/29	Loss: 0.727
Epoch: 13	Train Loss: 0.691	Val F1: 0.304
Best Epoch: 12	Best Val F1: 0.307

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.680
Batch: 3/29	Loss: 0.671
Batch: 5/29	Loss: 0.661
Batch: 7/29	Loss: 0.631
Batch: 9/29	Loss: 0.709
Batch: 11/29	Loss: 0.678
Batch: 13/29	Loss: 0.651
Batch: 15/29	Loss: 0.658
Batch: 17/29	Loss: 0.693
Batch: 19/29	Loss: 0.740
Batch: 21/29	Loss: 0.617
Batch: 23/29	Loss: 0.636
Batch: 25/29	Loss: 0.715
Batch: 27/29	Loss: 0.679
Batch: 29/29	Loss: 0.703
Epoch: 14	Train Loss: 0.681	Val F1: 0.307
Best Epoch: 14	Best Val F1: 0.307

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.638
Batch: 3/29	Loss: 0.655
Batch: 5/29	Loss: 0.599
Batch: 7/29	Loss: 0.673
Batch: 9/29	Loss: 0.663
Batch: 11/29	Loss: 0.665
Batch: 13/29	Loss: 0.677
Batch: 15/29	Loss: 0.680
Batch: 17/29	Loss: 0.692
Batch: 19/29	Loss: 0.652
Batch: 21/29	Loss: 0.703
Batch: 23/29	Loss: 0.659
Batch: 25/29	Loss: 0.662
Batch: 27/29	Loss: 0.647
Batch: 29/29	Loss: 0.724
Epoch: 15	Train Loss: 0.668	Val F1: 0.314
Best Epoch: 15	Best Val F1: 0.314

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.647
Batch: 3/29	Loss: 0.622
Batch: 5/29	Loss: 0.725
Batch: 7/29	Loss: 0.624
Batch: 9/29	Loss: 0.675
Batch: 11/29	Loss: 0.645
Batch: 13/29	Loss: 0.622
Batch: 15/29	Loss: 0.650
Batch: 17/29	Loss: 0.625
Batch: 19/29	Loss: 0.674
Batch: 21/29	Loss: 0.622
Batch: 23/29	Loss: 0.668
Batch: 25/29	Loss: 0.668
Batch: 27/29	Loss: 0.618
Batch: 29/29	Loss: 0.667
Epoch: 16	Train Loss: 0.654	Val F1: 0.309
Best Epoch: 15	Best Val F1: 0.314

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.597
Batch: 3/29	Loss: 0.702
Batch: 5/29	Loss: 0.653
Batch: 7/29	Loss: 0.622
Batch: 9/29	Loss: 0.577
Batch: 11/29	Loss: 0.727
Batch: 13/29	Loss: 0.619
Batch: 15/29	Loss: 0.602
Batch: 17/29	Loss: 0.717
Batch: 19/29	Loss: 0.569
Batch: 21/29	Loss: 0.677
Batch: 23/29	Loss: 0.676
Batch: 25/29	Loss: 0.532
Batch: 27/29	Loss: 0.637
Batch: 29/29	Loss: 0.670
Epoch: 17	Train Loss: 0.642	Val F1: 0.308
Best Epoch: 15	Best Val F1: 0.314

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.657
Batch: 3/29	Loss: 0.694
Batch: 5/29	Loss: 0.690
Batch: 7/29	Loss: 0.601
Batch: 9/29	Loss: 0.693
Batch: 11/29	Loss: 0.611
Batch: 13/29	Loss: 0.613
Batch: 15/29	Loss: 0.588
Batch: 17/29	Loss: 0.576
Batch: 19/29	Loss: 0.587
Batch: 21/29	Loss: 0.635
Batch: 23/29	Loss: 0.618
Batch: 25/29	Loss: 0.663
Batch: 27/29	Loss: 0.630
Batch: 29/29	Loss: 0.625
Epoch: 18	Train Loss: 0.626	Val F1: 0.304
Best Epoch: 15	Best Val F1: 0.314

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.565
Batch: 3/29	Loss: 0.497
Batch: 5/29	Loss: 0.641
Batch: 7/29	Loss: 0.702
Batch: 9/29	Loss: 0.581
Batch: 11/29	Loss: 0.651
Batch: 13/29	Loss: 0.648
Batch: 15/29	Loss: 0.614
Batch: 17/29	Loss: 0.555
Batch: 19/29	Loss: 0.782
Batch: 21/29	Loss: 0.648
Batch: 23/29	Loss: 0.597
Batch: 25/29	Loss: 0.555
Batch: 27/29	Loss: 0.584
Batch: 29/29	Loss: 0.511
Epoch: 19	Train Loss: 0.615	Val F1: 0.307
Best Epoch: 15	Best Val F1: 0.314

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.653
Batch: 3/29	Loss: 0.578
Batch: 5/29	Loss: 0.614
Batch: 7/29	Loss: 0.488
Batch: 9/29	Loss: 0.606
Batch: 11/29	Loss: 0.570
Batch: 13/29	Loss: 0.627
Batch: 15/29	Loss: 0.594
Batch: 17/29	Loss: 0.663
Batch: 19/29	Loss: 0.620
Batch: 21/29	Loss: 0.591
Batch: 23/29	Loss: 0.595
Batch: 25/29	Loss: 0.554
Batch: 27/29	Loss: 0.634
Batch: 29/29	Loss: 0.599
Epoch: 20	Train Loss: 0.595	Val F1: 0.308
Best Epoch: 15	Best Val F1: 0.314

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.556
Batch: 3/29	Loss: 0.541
Batch: 5/29	Loss: 0.561
Batch: 7/29	Loss: 0.720
Batch: 9/29	Loss: 0.562
Batch: 11/29	Loss: 0.514
Batch: 13/29	Loss: 0.639
Batch: 15/29	Loss: 0.658
Batch: 17/29	Loss: 0.518
Batch: 19/29	Loss: 0.580
Batch: 21/29	Loss: 0.594
Batch: 23/29	Loss: 0.561
Batch: 25/29	Loss: 0.597
Batch: 27/29	Loss: 0.552
Batch: 29/29	Loss: 0.603
Epoch: 21	Train Loss: 0.579	Val F1: 0.312
Best Epoch: 15	Best Val F1: 0.314

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.520
Batch: 3/29	Loss: 0.522
Batch: 5/29	Loss: 0.604
Batch: 7/29	Loss: 0.571
Batch: 9/29	Loss: 0.564
Batch: 11/29	Loss: 0.550
Batch: 13/29	Loss: 0.496
Batch: 15/29	Loss: 0.625
Batch: 17/29	Loss: 0.594
Batch: 19/29	Loss: 0.620
Batch: 21/29	Loss: 0.659
Batch: 23/29	Loss: 0.521
Batch: 25/29	Loss: 0.570
Batch: 27/29	Loss: 0.573
Batch: 29/29	Loss: 0.558
Epoch: 22	Train Loss: 0.567	Val F1: 0.307
Best Epoch: 15	Best Val F1: 0.314

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.572
Batch: 3/29	Loss: 0.549
Batch: 5/29	Loss: 0.553
Batch: 7/29	Loss: 0.692
Batch: 9/29	Loss: 0.520
Batch: 11/29	Loss: 0.576
Batch: 13/29	Loss: 0.492
Batch: 15/29	Loss: 0.603
Batch: 17/29	Loss: 0.585
Batch: 19/29	Loss: 0.555
Batch: 21/29	Loss: 0.500
Batch: 23/29	Loss: 0.476
Batch: 25/29	Loss: 0.519
Batch: 27/29	Loss: 0.511
Batch: 29/29	Loss: 0.547
Epoch: 23	Train Loss: 0.553	Val F1: 0.308
Best Epoch: 15	Best Val F1: 0.314

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.484
Batch: 3/29	Loss: 0.545
Batch: 5/29	Loss: 0.534
Batch: 7/29	Loss: 0.562
Batch: 9/29	Loss: 0.558
Batch: 11/29	Loss: 0.579
Batch: 13/29	Loss: 0.489
Batch: 15/29	Loss: 0.515
Batch: 17/29	Loss: 0.459
Batch: 19/29	Loss: 0.595
Batch: 21/29	Loss: 0.575
Batch: 23/29	Loss: 0.557
Batch: 25/29	Loss: 0.554
Batch: 27/29	Loss: 0.509
Batch: 29/29	Loss: 0.517
Epoch: 24	Train Loss: 0.541	Val F1: 0.309
Best Epoch: 15	Best Val F1: 0.314

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.580
Batch: 3/29	Loss: 0.554
Batch: 5/29	Loss: 0.556
Batch: 7/29	Loss: 0.536
Batch: 9/29	Loss: 0.583
Batch: 11/29	Loss: 0.558
Batch: 13/29	Loss: 0.490
Batch: 15/29	Loss: 0.568
Batch: 17/29	Loss: 0.506
Batch: 19/29	Loss: 0.481
Batch: 21/29	Loss: 0.550
Batch: 23/29	Loss: 0.572
Batch: 25/29	Loss: 0.555
Batch: 27/29	Loss: 0.480
Batch: 29/29	Loss: 0.524
Epoch: 25	Train Loss: 0.524	Val F1: 0.313
Best Epoch: 15	Best Val F1: 0.314

****************************** Epoch: 26 ******************************
Batch: 1/29	Loss: 0.502
Batch: 3/29	Loss: 0.465
Batch: 5/29	Loss: 0.544
Batch: 7/29	Loss: 0.541
Batch: 9/29	Loss: 0.468
Batch: 11/29	Loss: 0.523
Batch: 13/29	Loss: 0.630
Batch: 15/29	Loss: 0.485
Batch: 17/29	Loss: 0.524
Batch: 19/29	Loss: 0.508
Batch: 21/29	Loss: 0.561
Batch: 23/29	Loss: 0.402
Batch: 25/29	Loss: 0.537
Batch: 27/29	Loss: 0.525
Batch: 29/29	Loss: 0.513
Epoch: 26	Train Loss: 0.507	Val F1: 0.317
Best Epoch: 26	Best Val F1: 0.317

****************************** Epoch: 27 ******************************
Batch: 1/29	Loss: 0.465
Batch: 3/29	Loss: 0.488
Batch: 5/29	Loss: 0.611
Batch: 7/29	Loss: 0.487
Batch: 9/29	Loss: 0.610
Batch: 11/29	Loss: 0.434
Batch: 13/29	Loss: 0.588
Batch: 15/29	Loss: 0.523
Batch: 17/29	Loss: 0.530
Batch: 19/29	Loss: 0.487
Batch: 21/29	Loss: 0.484
Batch: 23/29	Loss: 0.446
Batch: 25/29	Loss: 0.439
Batch: 27/29	Loss: 0.435
Batch: 29/29	Loss: 0.440
Epoch: 27	Train Loss: 0.489	Val F1: 0.311
Best Epoch: 26	Best Val F1: 0.317

****************************** Epoch: 28 ******************************
Batch: 1/29	Loss: 0.433
Batch: 3/29	Loss: 0.482
Batch: 5/29	Loss: 0.472
Batch: 7/29	Loss: 0.522
Batch: 9/29	Loss: 0.520
Batch: 11/29	Loss: 0.543
Batch: 13/29	Loss: 0.469
Batch: 15/29	Loss: 0.506
Batch: 17/29	Loss: 0.544
Batch: 19/29	Loss: 0.429
Batch: 21/29	Loss: 0.453
Batch: 23/29	Loss: 0.512
Batch: 25/29	Loss: 0.482
Batch: 27/29	Loss: 0.420
Batch: 29/29	Loss: 0.498
Epoch: 28	Train Loss: 0.478	Val F1: 0.314
Best Epoch: 26	Best Val F1: 0.317

****************************** Epoch: 29 ******************************
Batch: 1/29	Loss: 0.470
Batch: 3/29	Loss: 0.404
Batch: 5/29	Loss: 0.459
Batch: 7/29	Loss: 0.419
Batch: 9/29	Loss: 0.418
Batch: 11/29	Loss: 0.491
Batch: 13/29	Loss: 0.575
Batch: 15/29	Loss: 0.432
Batch: 17/29	Loss: 0.537
Batch: 19/29	Loss: 0.423
Batch: 21/29	Loss: 0.481
Batch: 23/29	Loss: 0.425
Batch: 25/29	Loss: 0.477
Batch: 27/29	Loss: 0.470
Batch: 29/29	Loss: 0.500
Epoch: 29	Train Loss: 0.462	Val F1: 0.315
Best Epoch: 26	Best Val F1: 0.317

****************************** Epoch: 30 ******************************
Batch: 1/29	Loss: 0.459
Batch: 3/29	Loss: 0.399
Batch: 5/29	Loss: 0.483
Batch: 7/29	Loss: 0.423
Batch: 9/29	Loss: 0.450
Batch: 11/29	Loss: 0.441
Batch: 13/29	Loss: 0.448
Batch: 15/29	Loss: 0.407
Batch: 17/29	Loss: 0.461
Batch: 19/29	Loss: 0.490
Batch: 21/29	Loss: 0.479
Batch: 23/29	Loss: 0.435
Batch: 25/29	Loss: 0.397
Batch: 27/29	Loss: 0.415
Batch: 29/29	Loss: 0.428
Epoch: 30	Train Loss: 0.451	Val F1: 0.320
Best Epoch: 30	Best Val F1: 0.320

****************************** Epoch: 31 ******************************
Batch: 1/29	Loss: 0.367
Batch: 3/29	Loss: 0.424
Batch: 5/29	Loss: 0.416
Batch: 7/29	Loss: 0.420
Batch: 9/29	Loss: 0.410
Batch: 11/29	Loss: 0.458
Batch: 13/29	Loss: 0.419
Batch: 15/29	Loss: 0.384
Batch: 17/29	Loss: 0.456
Batch: 19/29	Loss: 0.402
Batch: 21/29	Loss: 0.415
Batch: 23/29	Loss: 0.438
Batch: 25/29	Loss: 0.467
Batch: 27/29	Loss: 0.378
Batch: 29/29	Loss: 0.437
Epoch: 31	Train Loss: 0.430	Val F1: 0.314
Best Epoch: 30	Best Val F1: 0.320

****************************** Epoch: 32 ******************************
Batch: 1/29	Loss: 0.536
Batch: 3/29	Loss: 0.470
Batch: 5/29	Loss: 0.415
Batch: 7/29	Loss: 0.405
Batch: 9/29	Loss: 0.438
Batch: 11/29	Loss: 0.423
Batch: 13/29	Loss: 0.405
Batch: 15/29	Loss: 0.336
Batch: 17/29	Loss: 0.456
Batch: 19/29	Loss: 0.487
Batch: 21/29	Loss: 0.382
Batch: 23/29	Loss: 0.416
Batch: 25/29	Loss: 0.440
Batch: 27/29	Loss: 0.270
Batch: 29/29	Loss: 0.449
Epoch: 32	Train Loss: 0.419	Val F1: 0.318
Best Epoch: 30	Best Val F1: 0.320

****************************** Epoch: 33 ******************************
Batch: 1/29	Loss: 0.454
Batch: 3/29	Loss: 0.374
Batch: 5/29	Loss: 0.514
Batch: 7/29	Loss: 0.399
Batch: 9/29	Loss: 0.474
Batch: 11/29	Loss: 0.320
Batch: 13/29	Loss: 0.424
Batch: 15/29	Loss: 0.398
Batch: 17/29	Loss: 0.446
Batch: 19/29	Loss: 0.402
Batch: 21/29	Loss: 0.346
Batch: 23/29	Loss: 0.349
Batch: 25/29	Loss: 0.425
Batch: 27/29	Loss: 0.457
Batch: 29/29	Loss: 0.388
Epoch: 33	Train Loss: 0.406	Val F1: 0.322
Best Epoch: 33	Best Val F1: 0.322

****************************** Epoch: 34 ******************************
Batch: 1/29	Loss: 0.348
Batch: 3/29	Loss: 0.392
Batch: 5/29	Loss: 0.379
Batch: 7/29	Loss: 0.349
Batch: 9/29	Loss: 0.409
Batch: 11/29	Loss: 0.467
Batch: 13/29	Loss: 0.378
Batch: 15/29	Loss: 0.422
Batch: 17/29	Loss: 0.458
Batch: 19/29	Loss: 0.374
Batch: 21/29	Loss: 0.390
Batch: 23/29	Loss: 0.375
Batch: 25/29	Loss: 0.366
Batch: 27/29	Loss: 0.306
Batch: 29/29	Loss: 0.433
Epoch: 34	Train Loss: 0.389	Val F1: 0.313
Best Epoch: 33	Best Val F1: 0.322

****************************** Epoch: 35 ******************************
Batch: 1/29	Loss: 0.345
Batch: 3/29	Loss: 0.387
Batch: 5/29	Loss: 0.448
Batch: 7/29	Loss: 0.390
Batch: 9/29	Loss: 0.373
Batch: 11/29	Loss: 0.329
Batch: 13/29	Loss: 0.370
Batch: 15/29	Loss: 0.384
Batch: 17/29	Loss: 0.394
Batch: 19/29	Loss: 0.348
Batch: 21/29	Loss: 0.371
Batch: 23/29	Loss: 0.515
Batch: 25/29	Loss: 0.315
Batch: 27/29	Loss: 0.376
Batch: 29/29	Loss: 0.293
Epoch: 35	Train Loss: 0.379	Val F1: 0.316
Best Epoch: 33	Best Val F1: 0.322

****************************** Epoch: 36 ******************************
Batch: 1/29	Loss: 0.355
Batch: 3/29	Loss: 0.367
Batch: 5/29	Loss: 0.340
Batch: 7/29	Loss: 0.368
Batch: 9/29	Loss: 0.387
Batch: 11/29	Loss: 0.272
Batch: 13/29	Loss: 0.400
Batch: 15/29	Loss: 0.418
Batch: 17/29	Loss: 0.430
Batch: 19/29	Loss: 0.357
Batch: 21/29	Loss: 0.361
Batch: 23/29	Loss: 0.339
Batch: 25/29	Loss: 0.319
Batch: 27/29	Loss: 0.336
Batch: 29/29	Loss: 0.313
Epoch: 36	Train Loss: 0.368	Val F1: 0.315
Best Epoch: 33	Best Val F1: 0.322

****************************** Epoch: 37 ******************************
Batch: 1/29	Loss: 0.298
Batch: 3/29	Loss: 0.479
Batch: 5/29	Loss: 0.358
Batch: 7/29	Loss: 0.364
Batch: 9/29	Loss: 0.330
Batch: 11/29	Loss: 0.376
Batch: 13/29	Loss: 0.370
Batch: 15/29	Loss: 0.382
Batch: 17/29	Loss: 0.342
Batch: 19/29	Loss: 0.372
Batch: 21/29	Loss: 0.368
Batch: 23/29	Loss: 0.325
Batch: 25/29	Loss: 0.340
Batch: 27/29	Loss: 0.277
Batch: 29/29	Loss: 0.400
Epoch: 37	Train Loss: 0.356	Val F1: 0.320
Best Epoch: 33	Best Val F1: 0.322

****************************** Epoch: 38 ******************************
Batch: 1/29	Loss: 0.336
Batch: 3/29	Loss: 0.396
Batch: 5/29	Loss: 0.303
Batch: 7/29	Loss: 0.365
Batch: 9/29	Loss: 0.363
Batch: 11/29	Loss: 0.336
Batch: 13/29	Loss: 0.308
Batch: 15/29	Loss: 0.362
Batch: 17/29	Loss: 0.374
Batch: 19/29	Loss: 0.317
Batch: 21/29	Loss: 0.264
Batch: 23/29	Loss: 0.343
Batch: 25/29	Loss: 0.293
Batch: 27/29	Loss: 0.406
Batch: 29/29	Loss: 0.352
Epoch: 38	Train Loss: 0.345	Val F1: 0.319
Best Epoch: 33	Best Val F1: 0.322

****************************** Epoch: 39 ******************************
Batch: 1/29	Loss: 0.275
Batch: 3/29	Loss: 0.378
Batch: 5/29	Loss: 0.313
Batch: 7/29	Loss: 0.409
Batch: 9/29	Loss: 0.307
Batch: 11/29	Loss: 0.315
Batch: 13/29	Loss: 0.349
Batch: 15/29	Loss: 0.314
Batch: 17/29	Loss: 0.279
Batch: 19/29	Loss: 0.336
Batch: 21/29	Loss: 0.261
Batch: 23/29	Loss: 0.357
Batch: 25/29	Loss: 0.387
Batch: 27/29	Loss: 0.366
Batch: 29/29	Loss: 0.366
Epoch: 39	Train Loss: 0.336	Val F1: 0.324
Best Epoch: 39	Best Val F1: 0.324

****************************** Epoch: 40 ******************************
Batch: 1/29	Loss: 0.377
Batch: 3/29	Loss: 0.316
Batch: 5/29	Loss: 0.380
Batch: 7/29	Loss: 0.351
Batch: 9/29	Loss: 0.255
Batch: 11/29	Loss: 0.240
Batch: 13/29	Loss: 0.384
Batch: 15/29	Loss: 0.374
Batch: 17/29	Loss: 0.451
Batch: 19/29	Loss: 0.348
Batch: 21/29	Loss: 0.316
Batch: 23/29	Loss: 0.272
Batch: 25/29	Loss: 0.295
Batch: 27/29	Loss: 0.256
Batch: 29/29	Loss: 0.372
Epoch: 40	Train Loss: 0.327	Val F1: 0.324
Best Epoch: 39	Best Val F1: 0.324

****************************** Epoch: 41 ******************************
Batch: 1/29	Loss: 0.279
Batch: 3/29	Loss: 0.408
Batch: 5/29	Loss: 0.283
Batch: 7/29	Loss: 0.358
Batch: 9/29	Loss: 0.255
Batch: 11/29	Loss: 0.351
Batch: 13/29	Loss: 0.303
Batch: 15/29	Loss: 0.318
Batch: 17/29	Loss: 0.336
Batch: 19/29	Loss: 0.281
Batch: 21/29	Loss: 0.241
Batch: 23/29	Loss: 0.337
Batch: 25/29	Loss: 0.368
Batch: 27/29	Loss: 0.382
Batch: 29/29	Loss: 0.312
Epoch: 41	Train Loss: 0.323	Val F1: 0.317
Best Epoch: 39	Best Val F1: 0.324

****************************** Epoch: 42 ******************************
Batch: 1/29	Loss: 0.351
Batch: 3/29	Loss: 0.406
Batch: 5/29	Loss: 0.277
Batch: 7/29	Loss: 0.315
Batch: 9/29	Loss: 0.365
Batch: 11/29	Loss: 0.335
Batch: 13/29	Loss: 0.368
Batch: 15/29	Loss: 0.244
Batch: 17/29	Loss: 0.318
Batch: 19/29	Loss: 0.247
Batch: 21/29	Loss: 0.368
Batch: 23/29	Loss: 0.320
Batch: 25/29	Loss: 0.289
Batch: 27/29	Loss: 0.330
Batch: 29/29	Loss: 0.279
Epoch: 42	Train Loss: 0.317	Val F1: 0.320
Best Epoch: 39	Best Val F1: 0.324

****************************** Epoch: 43 ******************************
Batch: 1/29	Loss: 0.335
Batch: 3/29	Loss: 0.265
Batch: 5/29	Loss: 0.356
Batch: 7/29	Loss: 0.298
Batch: 9/29	Loss: 0.368
Batch: 11/29	Loss: 0.297
Batch: 13/29	Loss: 0.338
Batch: 15/29	Loss: 0.270
Batch: 17/29	Loss: 0.266
Batch: 19/29	Loss: 0.275
Batch: 21/29	Loss: 0.316
Batch: 23/29	Loss: 0.253
Batch: 25/29	Loss: 0.255
Batch: 27/29	Loss: 0.278
Batch: 29/29	Loss: 0.328
Epoch: 43	Train Loss: 0.304	Val F1: 0.319
Best Epoch: 39	Best Val F1: 0.324

****************************** Epoch: 44 ******************************
Batch: 1/29	Loss: 0.303
Batch: 3/29	Loss: 0.277
Batch: 5/29	Loss: 0.253
Batch: 7/29	Loss: 0.247
Batch: 9/29	Loss: 0.415
Batch: 11/29	Loss: 0.239
Batch: 13/29	Loss: 0.255
Batch: 15/29	Loss: 0.260
Batch: 17/29	Loss: 0.243
Batch: 19/29	Loss: 0.314
Batch: 21/29	Loss: 0.350
Batch: 23/29	Loss: 0.293
Batch: 25/29	Loss: 0.343
Batch: 27/29	Loss: 0.248
Batch: 29/29	Loss: 0.254
Epoch: 44	Train Loss: 0.297	Val F1: 0.318
Best Epoch: 39	Best Val F1: 0.324

****************************** Epoch: 45 ******************************
Batch: 1/29	Loss: 0.230
Batch: 3/29	Loss: 0.269
Batch: 5/29	Loss: 0.335
Batch: 7/29	Loss: 0.334
Batch: 9/29	Loss: 0.277
Batch: 11/29	Loss: 0.333
Batch: 13/29	Loss: 0.283
Batch: 15/29	Loss: 0.270
Batch: 17/29	Loss: 0.300
Batch: 19/29	Loss: 0.209
Batch: 21/29	Loss: 0.268
Batch: 23/29	Loss: 0.265
Batch: 25/29	Loss: 0.285
Batch: 27/29	Loss: 0.262
Batch: 29/29	Loss: 0.357
Epoch: 45	Train Loss: 0.291	Val F1: 0.321
Best Epoch: 39	Best Val F1: 0.324

****************************** Epoch: 46 ******************************
Batch: 1/29	Loss: 0.328
Batch: 3/29	Loss: 0.259
Batch: 5/29	Loss: 0.286
Batch: 7/29	Loss: 0.314
Batch: 9/29	Loss: 0.250
Batch: 11/29	Loss: 0.236
Batch: 13/29	Loss: 0.360
Batch: 15/29	Loss: 0.241
Batch: 17/29	Loss: 0.301
Batch: 19/29	Loss: 0.327
Batch: 21/29	Loss: 0.300
Batch: 23/29	Loss: 0.291
Batch: 25/29	Loss: 0.288
Batch: 27/29	Loss: 0.295
Batch: 29/29	Loss: 0.294
Epoch: 46	Train Loss: 0.287	Val F1: 0.317
Best Epoch: 39	Best Val F1: 0.324

****************************** Epoch: 47 ******************************
Batch: 1/29	Loss: 0.256
Batch: 3/29	Loss: 0.241
Batch: 5/29	Loss: 0.339
Batch: 7/29	Loss: 0.315
Batch: 9/29	Loss: 0.284
Batch: 11/29	Loss: 0.266
Batch: 13/29	Loss: 0.306
Batch: 15/29	Loss: 0.280
Batch: 17/29	Loss: 0.244
Batch: 19/29	Loss: 0.277
Batch: 21/29	Loss: 0.291
Batch: 23/29	Loss: 0.316
Batch: 25/29	Loss: 0.266
Batch: 27/29	Loss: 0.275
Batch: 29/29	Loss: 0.343
Epoch: 47	Train Loss: 0.282	Val F1: 0.317
Best Epoch: 39	Best Val F1: 0.324

****************************** Epoch: 48 ******************************
Batch: 1/29	Loss: 0.300
Batch: 3/29	Loss: 0.230
Batch: 5/29	Loss: 0.396
Batch: 7/29	Loss: 0.203
Batch: 9/29	Loss: 0.239
Batch: 11/29	Loss: 0.312
Batch: 13/29	Loss: 0.331
Batch: 15/29	Loss: 0.274
Batch: 17/29	Loss: 0.257
Batch: 19/29	Loss: 0.216
Batch: 21/29	Loss: 0.287
Batch: 23/29	Loss: 0.249
Batch: 25/29	Loss: 0.244
Batch: 27/29	Loss: 0.270
Batch: 29/29	Loss: 0.216
Epoch: 48	Train Loss: 0.275	Val F1: 0.313
Best Epoch: 39	Best Val F1: 0.324

****************************** Epoch: 49 ******************************
Batch: 1/29	Loss: 0.267
Batch: 3/29	Loss: 0.214
Batch: 5/29	Loss: 0.285
Batch: 7/29	Loss: 0.267
Batch: 9/29	Loss: 0.287
Batch: 11/29	Loss: 0.354
Batch: 13/29	Loss: 0.317
Batch: 15/29	Loss: 0.255
Batch: 17/29	Loss: 0.201
Batch: 19/29	Loss: 0.338
Batch: 21/29	Loss: 0.230
Batch: 23/29	Loss: 0.225
Batch: 25/29	Loss: 0.275
Batch: 27/29	Loss: 0.246
Batch: 29/29	Loss: 0.198
Epoch: 49	Train Loss: 0.269	Val F1: 0.312
Best Epoch: 39	Best Val F1: 0.324

****************************** Epoch: 50 ******************************
Batch: 1/29	Loss: 0.269
Batch: 3/29	Loss: 0.361
Batch: 5/29	Loss: 0.276
Batch: 7/29	Loss: 0.217
Batch: 9/29	Loss: 0.264
Batch: 11/29	Loss: 0.286
Batch: 13/29	Loss: 0.319
Batch: 15/29	Loss: 0.294
Batch: 17/29	Loss: 0.298
Batch: 19/29	Loss: 0.278
Batch: 21/29	Loss: 0.280
Batch: 23/29	Loss: 0.204
Batch: 25/29	Loss: 0.267
Batch: 27/29	Loss: 0.389
Batch: 29/29	Loss: 0.362
Epoch: 50	Train Loss: 0.270	Val F1: 0.313
Best Epoch: 39	Best Val F1: 0.324

Saving the best checkpoint....
Inference...
Test F1: 0.366	Test F1_Few: 0.435	Test F1_Zero: 0.366
Starting training with config: {'batch_size': 8, 'epochs': 75, 'l2_reg': 0.0003147744962877587, 'lr': 4.375770911038685e-06, 'n_layers_freeze': 10, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/231	Loss: 1.080
Batch: 24/231	Loss: 1.060
Batch: 47/231	Loss: 1.034
Batch: 70/231	Loss: 1.021
Batch: 93/231	Loss: 0.966
Batch: 116/231	Loss: 0.966
Batch: 139/231	Loss: 0.947
Batch: 162/231	Loss: 0.908
Batch: 185/231	Loss: 0.873
Batch: 208/231	Loss: 0.882
Batch: 231/231	Loss: 0.860
Epoch: 1	Train Loss: 0.967	Val F1: 0.215
Best Epoch: 1	Best Val F1: 0.215

****************************** Epoch: 2 ******************************
Batch: 1/231	Loss: 0.847
Batch: 24/231	Loss: 0.871
Batch: 47/231	Loss: 0.826
Batch: 70/231	Loss: 0.968
Batch: 93/231	Loss: 0.811
Batch: 116/231	Loss: 0.805
Batch: 139/231	Loss: 0.929
Batch: 162/231	Loss: 0.793
Batch: 185/231	Loss: 0.799
Batch: 208/231	Loss: 0.837
Batch: 231/231	Loss: 0.788
Epoch: 2	Train Loss: 0.831	Val F1: 0.224
Best Epoch: 2	Best Val F1: 0.224

****************************** Epoch: 3 ******************************
Batch: 1/231	Loss: 0.774
Batch: 24/231	Loss: 0.782
Batch: 47/231	Loss: 0.846
Batch: 70/231	Loss: 0.764
Batch: 93/231	Loss: 0.766
Batch: 116/231	Loss: 0.747
Batch: 139/231	Loss: 0.763
Batch: 162/231	Loss: 0.746
Batch: 185/231	Loss: 0.741
Batch: 208/231	Loss: 0.815
Batch: 231/231	Loss: 0.741
Epoch: 3	Train Loss: 0.791	Val F1: 0.208
Best Epoch: 2	Best Val F1: 0.224

****************************** Epoch: 4 ******************************
Batch: 1/231	Loss: 0.829
Batch: 24/231	Loss: 0.753
Batch: 47/231	Loss: 0.737
Batch: 70/231	Loss: 0.817
Batch: 93/231	Loss: 0.827
Batch: 116/231	Loss: 0.746
Batch: 139/231	Loss: 1.138
Batch: 162/231	Loss: 0.814
Batch: 185/231	Loss: 0.720
Batch: 208/231	Loss: 0.719
Batch: 231/231	Loss: 0.855
Epoch: 4	Train Loss: 0.771	Val F1: 0.267
Best Epoch: 4	Best Val F1: 0.267

****************************** Epoch: 5 ******************************
Batch: 1/231	Loss: 0.707
Batch: 24/231	Loss: 0.723
Batch: 47/231	Loss: 0.899
Batch: 70/231	Loss: 0.710
Batch: 93/231	Loss: 0.727
Batch: 116/231	Loss: 0.692
Batch: 139/231	Loss: 0.899
Batch: 162/231	Loss: 0.678
Batch: 185/231	Loss: 0.768
Batch: 208/231	Loss: 0.698
Batch: 231/231	Loss: 0.676
Epoch: 5	Train Loss: 0.753	Val F1: 0.311
Best Epoch: 5	Best Val F1: 0.311

****************************** Epoch: 6 ******************************
Batch: 1/231	Loss: 0.732
Batch: 24/231	Loss: 0.903
Batch: 47/231	Loss: 0.696
Batch: 70/231	Loss: 0.689
Batch: 93/231	Loss: 0.673
Batch: 116/231	Loss: 0.707
Batch: 139/231	Loss: 0.898
Batch: 162/231	Loss: 0.816
Batch: 185/231	Loss: 0.841
Batch: 208/231	Loss: 0.870
Batch: 231/231	Loss: 0.601
Epoch: 6	Train Loss: 0.728	Val F1: 0.294
Best Epoch: 5	Best Val F1: 0.311

****************************** Epoch: 7 ******************************
Batch: 1/231	Loss: 0.666
Batch: 24/231	Loss: 0.749
Batch: 47/231	Loss: 0.562
Batch: 70/231	Loss: 0.690
Batch: 93/231	Loss: 0.612
Batch: 116/231	Loss: 0.608
Batch: 139/231	Loss: 0.666
Batch: 162/231	Loss: 0.607
Batch: 185/231	Loss: 0.560
Batch: 208/231	Loss: 0.831
Batch: 231/231	Loss: 0.732
Epoch: 7	Train Loss: 0.707	Val F1: 0.312
Best Epoch: 7	Best Val F1: 0.312

****************************** Epoch: 8 ******************************
Batch: 1/231	Loss: 0.731
Batch: 24/231	Loss: 0.641
Batch: 47/231	Loss: 0.599
Batch: 70/231	Loss: 0.809
Batch: 93/231	Loss: 0.612
Batch: 116/231	Loss: 0.597
Batch: 139/231	Loss: 0.709
Batch: 162/231	Loss: 0.613
Batch: 185/231	Loss: 0.792
Batch: 208/231	Loss: 0.672
Batch: 231/231	Loss: 0.636
Epoch: 8	Train Loss: 0.690	Val F1: 0.308
Best Epoch: 7	Best Val F1: 0.312

****************************** Epoch: 9 ******************************
Batch: 1/231	Loss: 0.814
Batch: 24/231	Loss: 0.757
Batch: 47/231	Loss: 0.732
Batch: 70/231	Loss: 0.718
Batch: 93/231	Loss: 0.779
Batch: 116/231	Loss: 0.624
Batch: 139/231	Loss: 0.803
Batch: 162/231	Loss: 0.900
Batch: 185/231	Loss: 0.599
Batch: 208/231	Loss: 0.644
Batch: 231/231	Loss: 0.837
Epoch: 9	Train Loss: 0.675	Val F1: 0.319
Best Epoch: 9	Best Val F1: 0.319

****************************** Epoch: 10 ******************************
Batch: 1/231	Loss: 0.716
Batch: 24/231	Loss: 0.615
Batch: 47/231	Loss: 0.772
Batch: 70/231	Loss: 0.643
Batch: 93/231	Loss: 0.718
Batch: 116/231	Loss: 0.531
Batch: 139/231	Loss: 0.514
Batch: 162/231	Loss: 0.608
Batch: 185/231	Loss: 0.900
Batch: 208/231	Loss: 0.673
Batch: 231/231	Loss: 0.706
Epoch: 10	Train Loss: 0.662	Val F1: 0.320
Best Epoch: 10	Best Val F1: 0.320

****************************** Epoch: 11 ******************************
Batch: 1/231	Loss: 0.588
Batch: 24/231	Loss: 0.544
Batch: 47/231	Loss: 0.506
Batch: 70/231	Loss: 0.499
Batch: 93/231	Loss: 0.629
Batch: 116/231	Loss: 0.601
Batch: 139/231	Loss: 0.617
Batch: 162/231	Loss: 0.612
Batch: 185/231	Loss: 0.538
Batch: 208/231	Loss: 0.705
Batch: 231/231	Loss: 0.376
Epoch: 11	Train Loss: 0.648	Val F1: 0.323
Best Epoch: 11	Best Val F1: 0.323

****************************** Epoch: 12 ******************************
Batch: 1/231	Loss: 0.898
Batch: 24/231	Loss: 0.461
Batch: 47/231	Loss: 0.453
Batch: 70/231	Loss: 0.596
Batch: 93/231	Loss: 0.776
Batch: 116/231	Loss: 0.494
Batch: 139/231	Loss: 0.558
Batch: 162/231	Loss: 0.695
Batch: 185/231	Loss: 0.539
Batch: 208/231	Loss: 0.514
Batch: 231/231	Loss: 0.601
Epoch: 12	Train Loss: 0.638	Val F1: 0.321
Best Epoch: 11	Best Val F1: 0.323

****************************** Epoch: 13 ******************************
Batch: 1/231	Loss: 0.876
Batch: 24/231	Loss: 0.634
Batch: 47/231	Loss: 0.522
Batch: 70/231	Loss: 0.682
Batch: 93/231	Loss: 0.621
Batch: 116/231	Loss: 0.743
Batch: 139/231	Loss: 0.603
Batch: 162/231	Loss: 0.655
Batch: 185/231	Loss: 0.720
Batch: 208/231	Loss: 0.482
Batch: 231/231	Loss: 0.465
Epoch: 13	Train Loss: 0.629	Val F1: 0.318
Best Epoch: 11	Best Val F1: 0.323

****************************** Epoch: 14 ******************************
Batch: 1/231	Loss: 0.813
Batch: 24/231	Loss: 0.939
Batch: 47/231	Loss: 0.591
Batch: 70/231	Loss: 0.528
Batch: 93/231	Loss: 0.451
Batch: 116/231	Loss: 0.605
Batch: 139/231	Loss: 0.628
Batch: 162/231	Loss: 0.371
Batch: 185/231	Loss: 0.603
Batch: 208/231	Loss: 0.296
Batch: 231/231	Loss: 0.550
Epoch: 14	Train Loss: 0.620	Val F1: 0.318
Best Epoch: 11	Best Val F1: 0.323

****************************** Epoch: 15 ******************************
Batch: 1/231	Loss: 0.479
Batch: 24/231	Loss: 0.753
Batch: 47/231	Loss: 0.383
Batch: 70/231	Loss: 0.644
Batch: 93/231	Loss: 0.651
Batch: 116/231	Loss: 0.528
Batch: 139/231	Loss: 0.761
Batch: 162/231	Loss: 0.565
Batch: 185/231	Loss: 0.620
Batch: 208/231	Loss: 0.709
Batch: 231/231	Loss: 0.636
Epoch: 15	Train Loss: 0.608	Val F1: 0.319
Best Epoch: 11	Best Val F1: 0.323

****************************** Epoch: 16 ******************************
Batch: 1/231	Loss: 0.616
Batch: 24/231	Loss: 0.301
Batch: 47/231	Loss: 0.507
Batch: 70/231	Loss: 0.824
Batch: 93/231	Loss: 0.753
Batch: 116/231	Loss: 0.474
Batch: 139/231	Loss: 0.348
Batch: 162/231	Loss: 0.503
Batch: 185/231	Loss: 0.518
Batch: 208/231	Loss: 0.625
Batch: 231/231	Loss: 0.717
Epoch: 16	Train Loss: 0.598	Val F1: 0.320
Best Epoch: 11	Best Val F1: 0.323

Saving the best checkpoint....
Inference...
Test F1: 0.350	Test F1_Few: 0.412	Test F1_Zero: 0.352
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0007534193612677356, 'lr': 7.289739148846642e-05, 'n_layers_freeze': 0, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.002
Batch: 5/29	Loss: 0.921
Batch: 7/29	Loss: 0.901
Batch: 9/29	Loss: 0.875
Batch: 11/29	Loss: 0.876
Batch: 13/29	Loss: 0.858
Batch: 15/29	Loss: 0.892
Batch: 17/29	Loss: 0.822
Batch: 19/29	Loss: 0.837
Batch: 21/29	Loss: 0.793
Batch: 23/29	Loss: 0.824
Batch: 25/29	Loss: 0.761
Batch: 27/29	Loss: 0.771
Batch: 29/29	Loss: 0.792
Epoch: 1	Train Loss: 0.864	Val F1: 0.214
Best Epoch: 1	Best Val F1: 0.214

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.777
Batch: 3/29	Loss: 0.783
Batch: 5/29	Loss: 0.846
Batch: 7/29	Loss: 0.763
Batch: 9/29	Loss: 0.806
Batch: 11/29	Loss: 0.727
Batch: 13/29	Loss: 0.736
Batch: 15/29	Loss: 0.766
Batch: 17/29	Loss: 0.755
Batch: 19/29	Loss: 0.828
Batch: 21/29	Loss: 0.736
Batch: 23/29	Loss: 0.734
Batch: 25/29	Loss: 0.733
Batch: 27/29	Loss: 0.823
Batch: 29/29	Loss: 0.704
Epoch: 2	Train Loss: 0.760	Val F1: 0.317
Best Epoch: 2	Best Val F1: 0.317

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.696
Batch: 3/29	Loss: 0.711
Batch: 5/29	Loss: 0.717
Batch: 7/29	Loss: 0.799
Batch: 9/29	Loss: 0.661
Batch: 11/29	Loss: 0.701
Batch: 13/29	Loss: 0.749
Batch: 15/29	Loss: 0.702
Batch: 17/29	Loss: 0.702
Batch: 19/29	Loss: 0.725
Batch: 21/29	Loss: 0.686
Batch: 23/29	Loss: 0.697
Batch: 25/29	Loss: 0.727
Batch: 27/29	Loss: 0.682
Batch: 29/29	Loss: 0.703
Epoch: 3	Train Loss: 0.712	Val F1: 0.295
Best Epoch: 2	Best Val F1: 0.317

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.666
Batch: 3/29	Loss: 0.670
Batch: 5/29	Loss: 0.699
Batch: 7/29	Loss: 0.729
Batch: 9/29	Loss: 0.689
Batch: 11/29	Loss: 0.687
Batch: 13/29	Loss: 0.557
Batch: 15/29	Loss: 0.657
Batch: 17/29	Loss: 0.628
Batch: 19/29	Loss: 0.686
Batch: 21/29	Loss: 0.664
Batch: 23/29	Loss: 0.685
Batch: 25/29	Loss: 0.598
Batch: 27/29	Loss: 0.648
Batch: 29/29	Loss: 0.638
Epoch: 4	Train Loss: 0.664	Val F1: 0.334
Best Epoch: 4	Best Val F1: 0.334

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.567
Batch: 3/29	Loss: 0.558
Batch: 5/29	Loss: 0.576
Batch: 7/29	Loss: 0.611
Batch: 9/29	Loss: 0.546
Batch: 11/29	Loss: 0.596
Batch: 13/29	Loss: 0.584
Batch: 15/29	Loss: 0.657
Batch: 17/29	Loss: 0.648
Batch: 19/29	Loss: 0.595
Batch: 21/29	Loss: 0.583
Batch: 23/29	Loss: 0.677
Batch: 25/29	Loss: 0.610
Batch: 27/29	Loss: 0.574
Batch: 29/29	Loss: 0.664
Epoch: 5	Train Loss: 0.615	Val F1: 0.324
Best Epoch: 4	Best Val F1: 0.334

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.608
Batch: 3/29	Loss: 0.676
Batch: 5/29	Loss: 0.484
Batch: 7/29	Loss: 0.676
Batch: 9/29	Loss: 0.540
Batch: 11/29	Loss: 0.544
Batch: 13/29	Loss: 0.548
Batch: 15/29	Loss: 0.528
Batch: 17/29	Loss: 0.496
Batch: 19/29	Loss: 0.485
Batch: 21/29	Loss: 0.616
Batch: 23/29	Loss: 0.597
Batch: 25/29	Loss: 0.551
Batch: 27/29	Loss: 0.552
Batch: 29/29	Loss: 0.492
Epoch: 6	Train Loss: 0.551	Val F1: 0.332
Best Epoch: 4	Best Val F1: 0.334

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.475
Batch: 3/29	Loss: 0.538
Batch: 5/29	Loss: 0.566
Batch: 7/29	Loss: 0.509
Batch: 9/29	Loss: 0.531
Batch: 11/29	Loss: 0.390
Batch: 13/29	Loss: 0.508
Batch: 15/29	Loss: 0.462
Batch: 17/29	Loss: 0.514
Batch: 19/29	Loss: 0.512
Batch: 21/29	Loss: 0.436
Batch: 23/29	Loss: 0.370
Batch: 25/29	Loss: 0.458
Batch: 27/29	Loss: 0.400
Batch: 29/29	Loss: 0.396
Epoch: 7	Train Loss: 0.465	Val F1: 0.364
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.439
Batch: 3/29	Loss: 0.391
Batch: 5/29	Loss: 0.397
Batch: 7/29	Loss: 0.431
Batch: 9/29	Loss: 0.296
Batch: 11/29	Loss: 0.459
Batch: 13/29	Loss: 0.379
Batch: 15/29	Loss: 0.399
Batch: 17/29	Loss: 0.469
Batch: 19/29	Loss: 0.383
Batch: 21/29	Loss: 0.425
Batch: 23/29	Loss: 0.488
Batch: 25/29	Loss: 0.519
Batch: 27/29	Loss: 0.410
Batch: 29/29	Loss: 0.467
Epoch: 8	Train Loss: 0.415	Val F1: 0.341
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.473
Batch: 3/29	Loss: 0.464
Batch: 5/29	Loss: 0.438
Batch: 7/29	Loss: 0.329
Batch: 9/29	Loss: 0.415
Batch: 11/29	Loss: 0.386
Batch: 13/29	Loss: 0.380
Batch: 15/29	Loss: 0.328
Batch: 17/29	Loss: 0.316
Batch: 19/29	Loss: 0.320
Batch: 21/29	Loss: 0.389
Batch: 23/29	Loss: 0.358
Batch: 25/29	Loss: 0.337
Batch: 27/29	Loss: 0.392
Batch: 29/29	Loss: 0.315
Epoch: 9	Train Loss: 0.383	Val F1: 0.357
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.314
Batch: 3/29	Loss: 0.370
Batch: 5/29	Loss: 0.245
Batch: 7/29	Loss: 0.377
Batch: 9/29	Loss: 0.304
Batch: 11/29	Loss: 0.311
Batch: 13/29	Loss: 0.385
Batch: 15/29	Loss: 0.331
Batch: 17/29	Loss: 0.372
Batch: 19/29	Loss: 0.243
Batch: 21/29	Loss: 0.421
Batch: 23/29	Loss: 0.426
Batch: 25/29	Loss: 0.412
Batch: 27/29	Loss: 0.300
Batch: 29/29	Loss: 0.385
Epoch: 10	Train Loss: 0.342	Val F1: 0.343
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.313
Batch: 3/29	Loss: 0.228
Batch: 5/29	Loss: 0.429
Batch: 7/29	Loss: 0.377
Batch: 9/29	Loss: 0.322
Batch: 11/29	Loss: 0.357
Batch: 13/29	Loss: 0.362
Batch: 15/29	Loss: 0.258
Batch: 17/29	Loss: 0.305
Batch: 19/29	Loss: 0.343
Batch: 21/29	Loss: 0.260
Batch: 23/29	Loss: 0.277
Batch: 25/29	Loss: 0.271
Batch: 27/29	Loss: 0.295
Batch: 29/29	Loss: 0.338
Epoch: 11	Train Loss: 0.319	Val F1: 0.340
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.365
Batch: 3/29	Loss: 0.222
Batch: 5/29	Loss: 0.270
Batch: 7/29	Loss: 0.276
Batch: 9/29	Loss: 0.319
Batch: 11/29	Loss: 0.280
Batch: 13/29	Loss: 0.293
Batch: 15/29	Loss: 0.275
Batch: 17/29	Loss: 0.238
Batch: 19/29	Loss: 0.258
Batch: 21/29	Loss: 0.267
Batch: 23/29	Loss: 0.295
Batch: 25/29	Loss: 0.239
Batch: 27/29	Loss: 0.354
Batch: 29/29	Loss: 0.223
Epoch: 12	Train Loss: 0.276	Val F1: 0.339
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.252
Batch: 3/29	Loss: 0.176
Batch: 5/29	Loss: 0.226
Batch: 7/29	Loss: 0.249
Batch: 9/29	Loss: 0.234
Batch: 11/29	Loss: 0.273
Batch: 13/29	Loss: 0.260
Batch: 15/29	Loss: 0.206
Batch: 17/29	Loss: 0.223
Batch: 19/29	Loss: 0.116
Batch: 21/29	Loss: 0.234
Batch: 23/29	Loss: 0.259
Batch: 25/29	Loss: 0.217
Batch: 27/29	Loss: 0.258
Batch: 29/29	Loss: 0.320
Epoch: 13	Train Loss: 0.247	Val F1: 0.318
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.280
Batch: 3/29	Loss: 0.237
Batch: 5/29	Loss: 0.189
Batch: 7/29	Loss: 0.296
Batch: 9/29	Loss: 0.254
Batch: 11/29	Loss: 0.173
Batch: 13/29	Loss: 0.224
Batch: 15/29	Loss: 0.177
Batch: 17/29	Loss: 0.260
Batch: 19/29	Loss: 0.257
Batch: 21/29	Loss: 0.114
Batch: 23/29	Loss: 0.157
Batch: 25/29	Loss: 0.258
Batch: 27/29	Loss: 0.203
Batch: 29/29	Loss: 0.229
Epoch: 14	Train Loss: 0.220	Val F1: 0.335
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.216
Batch: 3/29	Loss: 0.168
Batch: 5/29	Loss: 0.110
Batch: 7/29	Loss: 0.171
Batch: 9/29	Loss: 0.176
Batch: 11/29	Loss: 0.164
Batch: 13/29	Loss: 0.141
Batch: 15/29	Loss: 0.150
Batch: 17/29	Loss: 0.184
Batch: 19/29	Loss: 0.177
Batch: 21/29	Loss: 0.116
Batch: 23/29	Loss: 0.174
Batch: 25/29	Loss: 0.184
Batch: 27/29	Loss: 0.173
Batch: 29/29	Loss: 0.136
Epoch: 15	Train Loss: 0.171	Val F1: 0.351
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.165
Batch: 3/29	Loss: 0.143
Batch: 5/29	Loss: 0.127
Batch: 7/29	Loss: 0.094
Batch: 9/29	Loss: 0.174
Batch: 11/29	Loss: 0.116
Batch: 13/29	Loss: 0.128
Batch: 15/29	Loss: 0.097
Batch: 17/29	Loss: 0.117
Batch: 19/29	Loss: 0.144
Batch: 21/29	Loss: 0.092
Batch: 23/29	Loss: 0.141
Batch: 25/29	Loss: 0.173
Batch: 27/29	Loss: 0.169
Batch: 29/29	Loss: 0.123
Epoch: 16	Train Loss: 0.133	Val F1: 0.350
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.108
Batch: 3/29	Loss: 0.130
Batch: 5/29	Loss: 0.113
Batch: 7/29	Loss: 0.080
Batch: 9/29	Loss: 0.060
Batch: 11/29	Loss: 0.115
Batch: 13/29	Loss: 0.097
Batch: 15/29	Loss: 0.160
Batch: 17/29	Loss: 0.128
Batch: 19/29	Loss: 0.061
Batch: 21/29	Loss: 0.130
Batch: 23/29	Loss: 0.183
Batch: 25/29	Loss: 0.097
Batch: 27/29	Loss: 0.094
Batch: 29/29	Loss: 0.169
Epoch: 17	Train Loss: 0.111	Val F1: 0.343
Best Epoch: 7	Best Val F1: 0.364

Saving the best checkpoint....
Inference...
Test F1: 0.372	Test F1_Few: 0.441	Test F1_Zero: 0.369
Starting training with config: {'batch_size': 64, 'epochs': 75, 'l2_reg': 0.0009195810211398752, 'lr': 7.709809686358135e-05, 'n_layers_freeze': 0, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 0.998
Batch: 5/29	Loss: 0.916
Batch: 7/29	Loss: 0.907
Batch: 9/29	Loss: 0.874
Batch: 11/29	Loss: 0.874
Batch: 13/29	Loss: 0.855
Batch: 15/29	Loss: 0.889
Batch: 17/29	Loss: 0.816
Batch: 19/29	Loss: 0.834
Batch: 21/29	Loss: 0.789
Batch: 23/29	Loss: 0.821
Batch: 25/29	Loss: 0.757
Batch: 27/29	Loss: 0.768
Batch: 29/29	Loss: 0.788
Epoch: 1	Train Loss: 0.861	Val F1: 0.187
Best Epoch: 1	Best Val F1: 0.187

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.774
Batch: 3/29	Loss: 0.782
Batch: 5/29	Loss: 0.845
Batch: 7/29	Loss: 0.760
Batch: 9/29	Loss: 0.803
Batch: 11/29	Loss: 0.722
Batch: 13/29	Loss: 0.726
Batch: 15/29	Loss: 0.759
Batch: 17/29	Loss: 0.754
Batch: 19/29	Loss: 0.828
Batch: 21/29	Loss: 0.742
Batch: 23/29	Loss: 0.746
Batch: 25/29	Loss: 0.716
Batch: 27/29	Loss: 0.812
Batch: 29/29	Loss: 0.720
Epoch: 2	Train Loss: 0.761	Val F1: 0.330
Best Epoch: 2	Best Val F1: 0.330

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.688
Batch: 3/29	Loss: 0.717
Batch: 5/29	Loss: 0.697
Batch: 7/29	Loss: 0.799
Batch: 9/29	Loss: 0.664
Batch: 11/29	Loss: 0.702
Batch: 13/29	Loss: 0.770
Batch: 15/29	Loss: 0.736
Batch: 17/29	Loss: 0.714
Batch: 19/29	Loss: 0.745
Batch: 21/29	Loss: 0.659
Batch: 23/29	Loss: 0.683
Batch: 25/29	Loss: 0.755
Batch: 27/29	Loss: 0.677
Batch: 29/29	Loss: 0.713
Epoch: 3	Train Loss: 0.715	Val F1: 0.303
Best Epoch: 2	Best Val F1: 0.330

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.667
Batch: 3/29	Loss: 0.679
Batch: 5/29	Loss: 0.719
Batch: 7/29	Loss: 0.739
Batch: 9/29	Loss: 0.705
Batch: 11/29	Loss: 0.610
Batch: 13/29	Loss: 0.611
Batch: 15/29	Loss: 0.653
Batch: 17/29	Loss: 0.614
Batch: 19/29	Loss: 0.728
Batch: 21/29	Loss: 0.660
Batch: 23/29	Loss: 0.716
Batch: 25/29	Loss: 0.593
Batch: 27/29	Loss: 0.704
Batch: 29/29	Loss: 0.660
Epoch: 4	Train Loss: 0.683	Val F1: 0.337
Best Epoch: 4	Best Val F1: 0.337

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.616
Batch: 3/29	Loss: 0.645
Batch: 5/29	Loss: 0.580
Batch: 7/29	Loss: 0.595
Batch: 9/29	Loss: 0.643
Batch: 11/29	Loss: 0.658
Batch: 13/29	Loss: 0.635
Batch: 15/29	Loss: 0.664
Batch: 17/29	Loss: 0.726
Batch: 19/29	Loss: 0.686
Batch: 21/29	Loss: 0.606
Batch: 23/29	Loss: 0.716
Batch: 25/29	Loss: 0.673
Batch: 27/29	Loss: 0.600
Batch: 29/29	Loss: 0.686
Epoch: 5	Train Loss: 0.664	Val F1: 0.325
Best Epoch: 4	Best Val F1: 0.337

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.631
Batch: 3/29	Loss: 0.723
Batch: 5/29	Loss: 0.578
Batch: 7/29	Loss: 0.745
Batch: 9/29	Loss: 0.637
Batch: 11/29	Loss: 0.601
Batch: 13/29	Loss: 0.651
Batch: 15/29	Loss: 0.574
Batch: 17/29	Loss: 0.583
Batch: 19/29	Loss: 0.547
Batch: 21/29	Loss: 0.644
Batch: 23/29	Loss: 0.661
Batch: 25/29	Loss: 0.688
Batch: 27/29	Loss: 0.614
Batch: 29/29	Loss: 0.606
Epoch: 6	Train Loss: 0.630	Val F1: 0.331
Best Epoch: 4	Best Val F1: 0.337

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.591
Batch: 3/29	Loss: 0.674
Batch: 5/29	Loss: 0.704
Batch: 7/29	Loss: 0.667
Batch: 9/29	Loss: 0.657
Batch: 11/29	Loss: 0.558
Batch: 13/29	Loss: 0.594
Batch: 15/29	Loss: 0.564
Batch: 17/29	Loss: 0.694
Batch: 19/29	Loss: 0.663
Batch: 21/29	Loss: 0.621
Batch: 23/29	Loss: 0.565
Batch: 25/29	Loss: 0.484
Batch: 27/29	Loss: 0.573
Batch: 29/29	Loss: 0.542
Epoch: 7	Train Loss: 0.609	Val F1: 0.321
Best Epoch: 4	Best Val F1: 0.337

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.614
Batch: 3/29	Loss: 0.552
Batch: 5/29	Loss: 0.604
Batch: 7/29	Loss: 0.530
Batch: 9/29	Loss: 0.577
Batch: 11/29	Loss: 0.616
Batch: 13/29	Loss: 0.591
Batch: 15/29	Loss: 0.520
Batch: 17/29	Loss: 0.599
Batch: 19/29	Loss: 0.597
Batch: 21/29	Loss: 0.641
Batch: 23/29	Loss: 0.599
Batch: 25/29	Loss: 0.673
Batch: 27/29	Loss: 0.599
Batch: 29/29	Loss: 0.717
Epoch: 8	Train Loss: 0.591	Val F1: 0.282
Best Epoch: 4	Best Val F1: 0.337

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.724
Batch: 3/29	Loss: 0.581
Batch: 5/29	Loss: 0.613
Batch: 7/29	Loss: 0.564
Batch: 9/29	Loss: 0.685
Batch: 11/29	Loss: 0.597
Batch: 13/29	Loss: 0.604
Batch: 15/29	Loss: 0.528
Batch: 17/29	Loss: 0.547
Batch: 19/29	Loss: 0.501
Batch: 21/29	Loss: 0.745
Batch: 23/29	Loss: 0.678
Batch: 25/29	Loss: 0.534
Batch: 27/29	Loss: 0.620
Batch: 29/29	Loss: 0.543
Epoch: 9	Train Loss: 0.607	Val F1: 0.276
Best Epoch: 4	Best Val F1: 0.337

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.704
Batch: 3/29	Loss: 0.731
Batch: 5/29	Loss: 0.623
Batch: 7/29	Loss: 0.637
Batch: 9/29	Loss: 0.606
Batch: 11/29	Loss: 0.569
Batch: 13/29	Loss: 0.748
Batch: 15/29	Loss: 0.656
Batch: 17/29	Loss: 0.711
Batch: 19/29	Loss: 0.497
Batch: 21/29	Loss: 0.610
Batch: 23/29	Loss: 0.760
Batch: 25/29	Loss: 0.727
Batch: 27/29	Loss: 0.614
Batch: 29/29	Loss: 0.697
Epoch: 10	Train Loss: 0.650	Val F1: 0.307
Best Epoch: 4	Best Val F1: 0.337

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.680
Batch: 3/29	Loss: 0.649
Batch: 5/29	Loss: 0.738
Batch: 7/29	Loss: 0.616
Batch: 9/29	Loss: 0.573
Batch: 11/29	Loss: 0.599
Batch: 13/29	Loss: 0.565
Batch: 15/29	Loss: 0.487
Batch: 17/29	Loss: 0.656
Batch: 19/29	Loss: 0.582
Batch: 21/29	Loss: 0.533
Batch: 23/29	Loss: 0.476
Batch: 25/29	Loss: 0.507
Batch: 27/29	Loss: 0.641
Batch: 29/29	Loss: 0.547
Epoch: 11	Train Loss: 0.611	Val F1: 0.343
Best Epoch: 11	Best Val F1: 0.343

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.719
Batch: 3/29	Loss: 0.632
Batch: 5/29	Loss: 0.581
Batch: 7/29	Loss: 0.532
Batch: 9/29	Loss: 0.575
Batch: 11/29	Loss: 0.535
Batch: 13/29	Loss: 0.571
Batch: 15/29	Loss: 0.531
Batch: 17/29	Loss: 0.531
Batch: 19/29	Loss: 0.603
Batch: 21/29	Loss: 0.613
Batch: 23/29	Loss: 0.661
Batch: 25/29	Loss: 0.607
Batch: 27/29	Loss: 0.662
Batch: 29/29	Loss: 0.457
Epoch: 12	Train Loss: 0.589	Val F1: 0.341
Best Epoch: 11	Best Val F1: 0.343

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.614
Batch: 3/29	Loss: 0.583
Batch: 5/29	Loss: 0.556
Batch: 7/29	Loss: 0.621
Batch: 9/29	Loss: 0.571
Batch: 11/29	Loss: 0.631
Batch: 13/29	Loss: 0.662
Batch: 15/29	Loss: 0.541
Batch: 17/29	Loss: 0.553
Batch: 19/29	Loss: 0.403
Batch: 21/29	Loss: 0.464
Batch: 23/29	Loss: 0.539
Batch: 25/29	Loss: 0.460
Batch: 27/29	Loss: 0.584
Batch: 29/29	Loss: 0.591
Epoch: 13	Train Loss: 0.575	Val F1: 0.326
Best Epoch: 11	Best Val F1: 0.343

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.503
Batch: 3/29	Loss: 0.588
Batch: 5/29	Loss: 0.433
Batch: 7/29	Loss: 0.535
Batch: 9/29	Loss: 0.560
Batch: 11/29	Loss: 0.572
Batch: 13/29	Loss: 0.540
Batch: 15/29	Loss: 0.487
Batch: 17/29	Loss: 0.600
Batch: 19/29	Loss: 0.593
Batch: 21/29	Loss: 0.464
Batch: 23/29	Loss: 0.416
Batch: 25/29	Loss: 0.589
Batch: 27/29	Loss: 0.662
Batch: 29/29	Loss: 0.544
Epoch: 14	Train Loss: 0.553	Val F1: 0.329
Best Epoch: 11	Best Val F1: 0.343

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.520
Batch: 3/29	Loss: 0.507
Batch: 5/29	Loss: 0.454
Batch: 7/29	Loss: 0.519
Batch: 9/29	Loss: 0.697
Batch: 11/29	Loss: 0.652
Batch: 13/29	Loss: 0.679
Batch: 15/29	Loss: 0.598
Batch: 17/29	Loss: 0.665
Batch: 19/29	Loss: 0.538
Batch: 21/29	Loss: 0.626
Batch: 23/29	Loss: 0.642
Batch: 25/29	Loss: 0.643
Batch: 27/29	Loss: 0.589
Batch: 29/29	Loss: 0.688
Epoch: 15	Train Loss: 0.604	Val F1: 0.340
Best Epoch: 11	Best Val F1: 0.343

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.624
Batch: 3/29	Loss: 0.600
Batch: 5/29	Loss: 0.626
Batch: 7/29	Loss: 0.533
Batch: 9/29	Loss: 0.574
Batch: 11/29	Loss: 0.570
Batch: 13/29	Loss: 0.561
Batch: 15/29	Loss: 0.526
Batch: 17/29	Loss: 0.505
Batch: 19/29	Loss: 0.602
Batch: 21/29	Loss: 0.443
Batch: 23/29	Loss: 0.547
Batch: 25/29	Loss: 0.519
Batch: 27/29	Loss: 0.558
Batch: 29/29	Loss: 0.599
Epoch: 16	Train Loss: 0.566	Val F1: 0.349
Best Epoch: 16	Best Val F1: 0.349

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.472
Batch: 3/29	Loss: 0.647
Batch: 5/29	Loss: 0.562
Batch: 7/29	Loss: 0.558
Batch: 9/29	Loss: 0.444
Batch: 11/29	Loss: 0.650
Batch: 13/29	Loss: 0.591
Batch: 15/29	Loss: 0.529
Batch: 17/29	Loss: 0.611
Batch: 19/29	Loss: 0.480
Batch: 21/29	Loss: 0.475
Batch: 23/29	Loss: 0.540
Batch: 25/29	Loss: 0.354
Batch: 27/29	Loss: 0.528
Batch: 29/29	Loss: 0.539
Epoch: 17	Train Loss: 0.539	Val F1: 0.338
Best Epoch: 16	Best Val F1: 0.349

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.638
Batch: 3/29	Loss: 0.635
Batch: 5/29	Loss: 0.538
Batch: 7/29	Loss: 0.576
Batch: 9/29	Loss: 0.574
Batch: 11/29	Loss: 0.526
Batch: 13/29	Loss: 0.548
Batch: 15/29	Loss: 0.501
Batch: 17/29	Loss: 0.496
Batch: 19/29	Loss: 0.442
Batch: 21/29	Loss: 0.575
Batch: 23/29	Loss: 0.494
Batch: 25/29	Loss: 0.621
Batch: 27/29	Loss: 0.419
Batch: 29/29	Loss: 0.538
Epoch: 18	Train Loss: 0.531	Val F1: 0.345
Best Epoch: 16	Best Val F1: 0.349

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.395
Batch: 3/29	Loss: 0.371
Batch: 5/29	Loss: 0.545
Batch: 7/29	Loss: 0.534
Batch: 9/29	Loss: 0.434
Batch: 11/29	Loss: 0.624
Batch: 13/29	Loss: 0.542
Batch: 15/29	Loss: 0.514
Batch: 17/29	Loss: 0.392
Batch: 19/29	Loss: 0.602
Batch: 21/29	Loss: 0.518
Batch: 23/29	Loss: 0.507
Batch: 25/29	Loss: 0.474
Batch: 27/29	Loss: 0.415
Batch: 29/29	Loss: 0.388
Epoch: 19	Train Loss: 0.492	Val F1: 0.347
Best Epoch: 16	Best Val F1: 0.349

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.474
Batch: 3/29	Loss: 0.494
Batch: 5/29	Loss: 0.510
Batch: 7/29	Loss: 0.402
Batch: 9/29	Loss: 0.596
Batch: 11/29	Loss: 0.455
Batch: 13/29	Loss: 0.440
Batch: 15/29	Loss: 0.436
Batch: 17/29	Loss: 0.571
Batch: 19/29	Loss: 0.444
Batch: 21/29	Loss: 0.401
Batch: 23/29	Loss: 0.467
Batch: 25/29	Loss: 0.503
Batch: 27/29	Loss: 0.451
Batch: 29/29	Loss: 0.532
Epoch: 20	Train Loss: 0.477	Val F1: 0.345
Best Epoch: 16	Best Val F1: 0.349

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.377
Batch: 3/29	Loss: 0.461
Batch: 5/29	Loss: 0.357
Batch: 7/29	Loss: 0.734
Batch: 9/29	Loss: 0.433
Batch: 11/29	Loss: 0.345
Batch: 13/29	Loss: 0.559
Batch: 15/29	Loss: 0.551
Batch: 17/29	Loss: 0.427
Batch: 19/29	Loss: 0.375
Batch: 21/29	Loss: 0.502
Batch: 23/29	Loss: 0.446
Batch: 25/29	Loss: 0.522
Batch: 27/29	Loss: 0.460
Batch: 29/29	Loss: 0.485
Epoch: 21	Train Loss: 0.461	Val F1: 0.337
Best Epoch: 16	Best Val F1: 0.349

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.441
Batch: 3/29	Loss: 0.349
Batch: 5/29	Loss: 0.541
Batch: 7/29	Loss: 0.429
Batch: 9/29	Loss: 0.455
Batch: 11/29	Loss: 0.674
Batch: 13/29	Loss: 0.763
Batch: 15/29	Loss: 0.869
Batch: 17/29	Loss: 0.775
Batch: 19/29	Loss: 0.772
Batch: 21/29	Loss: 0.766
Batch: 23/29	Loss: 0.794
Batch: 25/29	Loss: 0.791
Batch: 27/29	Loss: 0.778
Batch: 29/29	Loss: 0.752
Epoch: 22	Train Loss: 0.665	Val F1: 0.188
Best Epoch: 16	Best Val F1: 0.349

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.756
Batch: 3/29	Loss: 0.805
Batch: 5/29	Loss: 0.780
Batch: 7/29	Loss: 0.793
Batch: 9/29	Loss: 0.731
Batch: 11/29	Loss: 0.809
Batch: 13/29	Loss: 0.756
Batch: 15/29	Loss: 0.757
Batch: 17/29	Loss: 0.790
Batch: 19/29	Loss: 0.754
Batch: 21/29	Loss: 0.805
Batch: 23/29	Loss: 0.774
Batch: 25/29	Loss: 0.732
Batch: 27/29	Loss: 0.721
Batch: 29/29	Loss: 0.738
Epoch: 23	Train Loss: 0.767	Val F1: 0.187
Best Epoch: 16	Best Val F1: 0.349

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.759
Batch: 3/29	Loss: 0.763
Batch: 5/29	Loss: 0.758
Batch: 7/29	Loss: 0.869
Batch: 9/29	Loss: 0.799
Batch: 11/29	Loss: 0.797
Batch: 13/29	Loss: 0.734
Batch: 15/29	Loss: 0.758
Batch: 17/29	Loss: 0.726
Batch: 19/29	Loss: 0.791
Batch: 21/29	Loss: 0.816
Batch: 23/29	Loss: 0.746
Batch: 25/29	Loss: 0.820
Batch: 27/29	Loss: 0.724
Batch: 29/29	Loss: 0.721
Epoch: 24	Train Loss: 0.764	Val F1: 0.179
Best Epoch: 16	Best Val F1: 0.349

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.819
Batch: 3/29	Loss: 0.765
Batch: 5/29	Loss: 0.791
Batch: 7/29	Loss: 0.832
Batch: 9/29	Loss: 0.784
Batch: 11/29	Loss: 0.819
Batch: 13/29	Loss: 0.734
Batch: 15/29	Loss: 0.724
Batch: 17/29	Loss: 0.792
Batch: 19/29	Loss: 0.750
Batch: 21/29	Loss: 0.792
Batch: 23/29	Loss: 0.710
Batch: 25/29	Loss: 0.765
Batch: 27/29	Loss: 0.761
Batch: 29/29	Loss: 0.774
Epoch: 25	Train Loss: 0.761	Val F1: 0.187
Best Epoch: 16	Best Val F1: 0.349

****************************** Epoch: 26 ******************************
Batch: 1/29	Loss: 0.738
Batch: 3/29	Loss: 0.804
Batch: 5/29	Loss: 0.771
Batch: 7/29	Loss: 0.754
Batch: 9/29	Loss: 0.773
Batch: 11/29	Loss: 0.785
Batch: 13/29	Loss: 0.754
Batch: 15/29	Loss: 0.735
Batch: 17/29	Loss: 0.780
Batch: 19/29	Loss: 0.799
Batch: 21/29	Loss: 0.793
Batch: 23/29	Loss: 0.695
Batch: 25/29	Loss: 0.768
Batch: 27/29	Loss: 0.831
Batch: 29/29	Loss: 0.748
Epoch: 26	Train Loss: 0.764	Val F1: 0.187
Best Epoch: 16	Best Val F1: 0.349

Saving the best checkpoint....
Inference...
Test F1: 0.380	Test F1_Few: 0.449	Test F1_Zero: 0.383
Starting training with config: {'batch_size': 32, 'epochs': 25, 'l2_reg': 0.00013524560816653084, 'lr': 2.0607749123352555e-06, 'n_layers_freeze': 1, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 1.092
Batch: 11/58	Loss: 1.083
Batch: 16/58	Loss: 1.078
Batch: 21/58	Loss: 1.069
Batch: 26/58	Loss: 1.062
Batch: 31/58	Loss: 1.049
Batch: 36/58	Loss: 1.051
Batch: 41/58	Loss: 1.033
Batch: 46/58	Loss: 1.024
Batch: 51/58	Loss: 1.014
Batch: 56/58	Loss: 1.010
Batch: 58/58	Loss: 1.004
Epoch: 1	Train Loss: 1.054	Val F1: 0.297
Best Epoch: 1	Best Val F1: 0.297

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 1.008
Batch: 6/58	Loss: 1.006
Batch: 11/58	Loss: 0.992
Batch: 16/58	Loss: 0.974
Batch: 21/58	Loss: 0.962
Batch: 26/58	Loss: 0.960
Batch: 31/58	Loss: 0.964
Batch: 36/58	Loss: 0.959
Batch: 41/58	Loss: 0.938
Batch: 46/58	Loss: 0.932
Batch: 51/58	Loss: 0.929
Batch: 56/58	Loss: 0.929
Batch: 58/58	Loss: 0.920
Epoch: 2	Train Loss: 0.963	Val F1: 0.193
Best Epoch: 1	Best Val F1: 0.297

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.920
Batch: 6/58	Loss: 0.910
Batch: 11/58	Loss: 0.931
Batch: 16/58	Loss: 0.913
Batch: 21/58	Loss: 0.906
Batch: 26/58	Loss: 0.920
Batch: 31/58	Loss: 0.952
Batch: 36/58	Loss: 0.907
Batch: 41/58	Loss: 0.898
Batch: 46/58	Loss: 0.885
Batch: 51/58	Loss: 0.892
Batch: 56/58	Loss: 0.897
Batch: 58/58	Loss: 0.895
Epoch: 3	Train Loss: 0.910	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.297

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.889
Batch: 6/58	Loss: 0.898
Batch: 11/58	Loss: 0.887
Batch: 16/58	Loss: 0.895
Batch: 21/58	Loss: 0.869
Batch: 26/58	Loss: 0.868
Batch: 31/58	Loss: 0.868
Batch: 36/58	Loss: 0.891
Batch: 41/58	Loss: 0.902
Batch: 46/58	Loss: 0.891
Batch: 51/58	Loss: 0.853
Batch: 56/58	Loss: 0.861
Batch: 58/58	Loss: 0.897
Epoch: 4	Train Loss: 0.884	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.297

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.863
Batch: 6/58	Loss: 0.857
Batch: 11/58	Loss: 0.878
Batch: 16/58	Loss: 0.873
Batch: 21/58	Loss: 0.853
Batch: 26/58	Loss: 0.843
Batch: 31/58	Loss: 0.895
Batch: 36/58	Loss: 0.877
Batch: 41/58	Loss: 0.858
Batch: 46/58	Loss: 0.841
Batch: 51/58	Loss: 0.882
Batch: 56/58	Loss: 0.891
Batch: 58/58	Loss: 0.874
Epoch: 5	Train Loss: 0.867	Val F1: 0.193
Best Epoch: 1	Best Val F1: 0.297

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.841
Batch: 6/58	Loss: 0.886
Batch: 11/58	Loss: 0.887
Batch: 16/58	Loss: 0.861
Batch: 21/58	Loss: 0.877
Batch: 26/58	Loss: 0.859
Batch: 31/58	Loss: 0.848
Batch: 36/58	Loss: 0.835
Batch: 41/58	Loss: 0.851
Batch: 46/58	Loss: 0.839
Batch: 51/58	Loss: 0.848
Batch: 56/58	Loss: 0.865
Batch: 58/58	Loss: 0.844
Epoch: 6	Train Loss: 0.854	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.297

Saving the best checkpoint....
Inference...
Test F1: 0.276	Test F1_Few: 0.318	Test F1_Zero: 0.280
Starting training with config: {'batch_size': 32, 'epochs': 25, 'l2_reg': 0.0008581335604133682, 'lr': 2.985624299864429e-05, 'n_layers_freeze': 0, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 1.003
Batch: 11/58	Loss: 0.929
Batch: 16/58	Loss: 0.864
Batch: 21/58	Loss: 0.881
Batch: 26/58	Loss: 0.872
Batch: 31/58	Loss: 0.835
Batch: 36/58	Loss: 0.870
Batch: 41/58	Loss: 0.810
Batch: 46/58	Loss: 0.789
Batch: 51/58	Loss: 0.776
Batch: 56/58	Loss: 0.785
Batch: 58/58	Loss: 0.793
Epoch: 1	Train Loss: 0.876	Val F1: 0.187
Best Epoch: 1	Best Val F1: 0.187

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.806
Batch: 6/58	Loss: 0.818
Batch: 11/58	Loss: 0.818
Batch: 16/58	Loss: 0.739
Batch: 21/58	Loss: 0.745
Batch: 26/58	Loss: 0.751
Batch: 31/58	Loss: 0.795
Batch: 36/58	Loss: 0.760
Batch: 41/58	Loss: 0.699
Batch: 46/58	Loss: 0.708
Batch: 51/58	Loss: 0.763
Batch: 56/58	Loss: 0.729
Batch: 58/58	Loss: 0.692
Epoch: 2	Train Loss: 0.761	Val F1: 0.333
Best Epoch: 2	Best Val F1: 0.333

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.668
Batch: 6/58	Loss: 0.672
Batch: 11/58	Loss: 0.765
Batch: 16/58	Loss: 0.662
Batch: 21/58	Loss: 0.732
Batch: 26/58	Loss: 0.695
Batch: 31/58	Loss: 0.827
Batch: 36/58	Loss: 0.755
Batch: 41/58	Loss: 0.620
Batch: 46/58	Loss: 0.678
Batch: 51/58	Loss: 0.733
Batch: 56/58	Loss: 0.635
Batch: 58/58	Loss: 0.736
Epoch: 3	Train Loss: 0.709	Val F1: 0.288
Best Epoch: 2	Best Val F1: 0.333

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.738
Batch: 6/58	Loss: 0.681
Batch: 11/58	Loss: 0.616
Batch: 16/58	Loss: 0.588
Batch: 21/58	Loss: 0.599
Batch: 26/58	Loss: 0.553
Batch: 31/58	Loss: 0.533
Batch: 36/58	Loss: 0.704
Batch: 41/58	Loss: 0.709
Batch: 46/58	Loss: 0.627
Batch: 51/58	Loss: 0.583
Batch: 56/58	Loss: 0.566
Batch: 58/58	Loss: 0.648
Epoch: 4	Train Loss: 0.660	Val F1: 0.350
Best Epoch: 4	Best Val F1: 0.350

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.572
Batch: 6/58	Loss: 0.532
Batch: 11/58	Loss: 0.559
Batch: 16/58	Loss: 0.546
Batch: 21/58	Loss: 0.447
Batch: 26/58	Loss: 0.529
Batch: 31/58	Loss: 0.767
Batch: 36/58	Loss: 0.619
Batch: 41/58	Loss: 0.606
Batch: 46/58	Loss: 0.683
Batch: 51/58	Loss: 0.843
Batch: 56/58	Loss: 0.695
Batch: 58/58	Loss: 0.853
Epoch: 5	Train Loss: 0.616	Val F1: 0.360
Best Epoch: 5	Best Val F1: 0.360

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.548
Batch: 6/58	Loss: 0.759
Batch: 11/58	Loss: 0.609
Batch: 16/58	Loss: 0.704
Batch: 21/58	Loss: 0.651
Batch: 26/58	Loss: 0.518
Batch: 31/58	Loss: 0.529
Batch: 36/58	Loss: 0.434
Batch: 41/58	Loss: 0.594
Batch: 46/58	Loss: 0.542
Batch: 51/58	Loss: 0.535
Batch: 56/58	Loss: 0.551
Batch: 58/58	Loss: 0.439
Epoch: 6	Train Loss: 0.578	Val F1: 0.354
Best Epoch: 5	Best Val F1: 0.360

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.404
Batch: 6/58	Loss: 0.587
Batch: 11/58	Loss: 0.657
Batch: 16/58	Loss: 0.428
Batch: 21/58	Loss: 0.505
Batch: 26/58	Loss: 0.591
Batch: 31/58	Loss: 0.510
Batch: 36/58	Loss: 0.461
Batch: 41/58	Loss: 0.505
Batch: 46/58	Loss: 0.388
Batch: 51/58	Loss: 0.431
Batch: 56/58	Loss: 0.534
Batch: 58/58	Loss: 0.315
Epoch: 7	Train Loss: 0.490	Val F1: 0.364
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.408
Batch: 6/58	Loss: 0.327
Batch: 11/58	Loss: 0.381
Batch: 16/58	Loss: 0.363
Batch: 21/58	Loss: 0.377
Batch: 26/58	Loss: 0.354
Batch: 31/58	Loss: 0.361
Batch: 36/58	Loss: 0.362
Batch: 41/58	Loss: 0.438
Batch: 46/58	Loss: 0.463
Batch: 51/58	Loss: 0.341
Batch: 56/58	Loss: 0.325
Batch: 58/58	Loss: 0.402
Epoch: 8	Train Loss: 0.418	Val F1: 0.342
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.398
Batch: 6/58	Loss: 0.482
Batch: 11/58	Loss: 0.511
Batch: 16/58	Loss: 0.291
Batch: 21/58	Loss: 0.333
Batch: 26/58	Loss: 0.302
Batch: 31/58	Loss: 0.334
Batch: 36/58	Loss: 0.391
Batch: 41/58	Loss: 0.454
Batch: 46/58	Loss: 0.347
Batch: 51/58	Loss: 0.377
Batch: 56/58	Loss: 0.234
Batch: 58/58	Loss: 0.355
Epoch: 9	Train Loss: 0.375	Val F1: 0.351
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.332
Batch: 6/58	Loss: 0.324
Batch: 11/58	Loss: 0.407
Batch: 16/58	Loss: 0.482
Batch: 21/58	Loss: 0.315
Batch: 26/58	Loss: 0.356
Batch: 31/58	Loss: 0.253
Batch: 36/58	Loss: 0.528
Batch: 41/58	Loss: 0.349
Batch: 46/58	Loss: 0.475
Batch: 51/58	Loss: 0.354
Batch: 56/58	Loss: 0.283
Batch: 58/58	Loss: 0.380
Epoch: 10	Train Loss: 0.349	Val F1: 0.353
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.332
Batch: 6/58	Loss: 0.241
Batch: 11/58	Loss: 0.266
Batch: 16/58	Loss: 0.329
Batch: 21/58	Loss: 0.309
Batch: 26/58	Loss: 0.462
Batch: 31/58	Loss: 0.421
Batch: 36/58	Loss: 0.349
Batch: 41/58	Loss: 0.253
Batch: 46/58	Loss: 0.316
Batch: 51/58	Loss: 0.317
Batch: 56/58	Loss: 0.333
Batch: 58/58	Loss: 0.341
Epoch: 11	Train Loss: 0.326	Val F1: 0.362
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.316
Batch: 6/58	Loss: 0.235
Batch: 11/58	Loss: 0.258
Batch: 16/58	Loss: 0.277
Batch: 21/58	Loss: 0.377
Batch: 26/58	Loss: 0.282
Batch: 31/58	Loss: 0.425
Batch: 36/58	Loss: 0.296
Batch: 41/58	Loss: 0.292
Batch: 46/58	Loss: 0.352
Batch: 51/58	Loss: 0.359
Batch: 56/58	Loss: 0.245
Batch: 58/58	Loss: 0.125
Epoch: 12	Train Loss: 0.302	Val F1: 0.356
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 13 ******************************
Batch: 1/58	Loss: 0.254
Batch: 6/58	Loss: 0.242
Batch: 11/58	Loss: 0.282
Batch: 16/58	Loss: 0.241
Batch: 21/58	Loss: 0.227
Batch: 26/58	Loss: 0.268
Batch: 31/58	Loss: 0.227
Batch: 36/58	Loss: 0.246
Batch: 41/58	Loss: 0.227
Batch: 46/58	Loss: 0.260
Batch: 51/58	Loss: 0.233
Batch: 56/58	Loss: 0.381
Batch: 58/58	Loss: 0.139
Epoch: 13	Train Loss: 0.273	Val F1: 0.349
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 14 ******************************
Batch: 1/58	Loss: 0.314
Batch: 6/58	Loss: 0.267
Batch: 11/58	Loss: 0.199
Batch: 16/58	Loss: 0.291
Batch: 21/58	Loss: 0.211
Batch: 26/58	Loss: 0.256
Batch: 31/58	Loss: 0.257
Batch: 36/58	Loss: 0.230
Batch: 41/58	Loss: 0.134
Batch: 46/58	Loss: 0.180
Batch: 51/58	Loss: 0.327
Batch: 56/58	Loss: 0.162
Batch: 58/58	Loss: 0.244
Epoch: 14	Train Loss: 0.240	Val F1: 0.348
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 15 ******************************
Batch: 1/58	Loss: 0.210
Batch: 6/58	Loss: 0.306
Batch: 11/58	Loss: 0.194
Batch: 16/58	Loss: 0.144
Batch: 21/58	Loss: 0.316
Batch: 26/58	Loss: 0.181
Batch: 31/58	Loss: 0.188
Batch: 36/58	Loss: 0.271
Batch: 41/58	Loss: 0.281
Batch: 46/58	Loss: 0.183
Batch: 51/58	Loss: 0.194
Batch: 56/58	Loss: 0.142
Batch: 58/58	Loss: 0.233
Epoch: 15	Train Loss: 0.215	Val F1: 0.340
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 16 ******************************
Batch: 1/58	Loss: 0.187
Batch: 6/58	Loss: 0.106
Batch: 11/58	Loss: 0.084
Batch: 16/58	Loss: 0.167
Batch: 21/58	Loss: 0.087
Batch: 26/58	Loss: 0.130
Batch: 31/58	Loss: 0.148
Batch: 36/58	Loss: 0.177
Batch: 41/58	Loss: 0.178
Batch: 46/58	Loss: 0.138
Batch: 51/58	Loss: 0.179
Batch: 56/58	Loss: 0.129
Batch: 58/58	Loss: 0.096
Epoch: 16	Train Loss: 0.179	Val F1: 0.352
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 17 ******************************
Batch: 1/58	Loss: 0.112
Batch: 6/58	Loss: 0.147
Batch: 11/58	Loss: 0.101
Batch: 16/58	Loss: 0.143
Batch: 21/58	Loss: 0.176
Batch: 26/58	Loss: 0.163
Batch: 31/58	Loss: 0.135
Batch: 36/58	Loss: 0.116
Batch: 41/58	Loss: 0.171
Batch: 46/58	Loss: 0.255
Batch: 51/58	Loss: 0.202
Batch: 56/58	Loss: 0.200
Batch: 58/58	Loss: 0.120
Epoch: 17	Train Loss: 0.147	Val F1: 0.364
Best Epoch: 17	Best Val F1: 0.364

****************************** Epoch: 18 ******************************
Batch: 1/58	Loss: 0.115
Batch: 6/58	Loss: 0.245
Batch: 11/58	Loss: 0.132
Batch: 16/58	Loss: 0.175
Batch: 21/58	Loss: 0.125
Batch: 26/58	Loss: 0.144
Batch: 31/58	Loss: 0.091
Batch: 36/58	Loss: 0.078
Batch: 41/58	Loss: 0.105
Batch: 46/58	Loss: 0.133
Batch: 51/58	Loss: 0.049
Batch: 56/58	Loss: 0.123
Batch: 58/58	Loss: 0.144
Epoch: 18	Train Loss: 0.125	Val F1: 0.357
Best Epoch: 17	Best Val F1: 0.364

****************************** Epoch: 19 ******************************
Batch: 1/58	Loss: 0.113
Batch: 6/58	Loss: 0.123
Batch: 11/58	Loss: 0.076
Batch: 16/58	Loss: 0.039
Batch: 21/58	Loss: 0.074
Batch: 26/58	Loss: 0.064
Batch: 31/58	Loss: 0.066
Batch: 36/58	Loss: 0.044
Batch: 41/58	Loss: 0.130
Batch: 46/58	Loss: 0.100
Batch: 51/58	Loss: 0.077
Batch: 56/58	Loss: 0.053
Batch: 58/58	Loss: 0.063
Epoch: 19	Train Loss: 0.094	Val F1: 0.354
Best Epoch: 17	Best Val F1: 0.364

****************************** Epoch: 20 ******************************
Batch: 1/58	Loss: 0.051
Batch: 6/58	Loss: 0.118
Batch: 11/58	Loss: 0.073
Batch: 16/58	Loss: 0.092
Batch: 21/58	Loss: 0.070
Batch: 26/58	Loss: 0.131
Batch: 31/58	Loss: 0.090
Batch: 36/58	Loss: 0.030
Batch: 41/58	Loss: 0.065
Batch: 46/58	Loss: 0.113
Batch: 51/58	Loss: 0.041
Batch: 56/58	Loss: 0.041
Batch: 58/58	Loss: 0.117
Epoch: 20	Train Loss: 0.080	Val F1: 0.355
Best Epoch: 17	Best Val F1: 0.364

****************************** Epoch: 21 ******************************
Batch: 1/58	Loss: 0.105
Batch: 6/58	Loss: 0.052
Batch: 11/58	Loss: 0.049
Batch: 16/58	Loss: 0.042
Batch: 21/58	Loss: 0.058
Batch: 26/58	Loss: 0.049
Batch: 31/58	Loss: 0.028
Batch: 36/58	Loss: 0.063
Batch: 41/58	Loss: 0.037
Batch: 46/58	Loss: 0.092
Batch: 51/58	Loss: 0.026
Batch: 56/58	Loss: 0.017
Batch: 58/58	Loss: 0.051
Epoch: 21	Train Loss: 0.061	Val F1: 0.352
Best Epoch: 17	Best Val F1: 0.364

****************************** Epoch: 22 ******************************
Batch: 1/58	Loss: 0.072
Batch: 6/58	Loss: 0.040
Batch: 11/58	Loss: 0.071
Batch: 16/58	Loss: 0.030
Batch: 21/58	Loss: 0.050
Batch: 26/58	Loss: 0.035
Batch: 31/58	Loss: 0.027
Batch: 36/58	Loss: 0.023
Batch: 41/58	Loss: 0.039
Batch: 46/58	Loss: 0.099
Batch: 51/58	Loss: 0.017
Batch: 56/58	Loss: 0.038
Batch: 58/58	Loss: 0.198
Epoch: 22	Train Loss: 0.049	Val F1: 0.346
Best Epoch: 17	Best Val F1: 0.364

****************************** Epoch: 23 ******************************
Batch: 1/58	Loss: 0.034
Batch: 6/58	Loss: 0.063
Batch: 11/58	Loss: 0.016
Batch: 16/58	Loss: 0.042
Batch: 21/58	Loss: 0.030
Batch: 26/58	Loss: 0.030
Batch: 31/58	Loss: 0.025
Batch: 36/58	Loss: 0.115
Batch: 41/58	Loss: 0.052
Batch: 46/58	Loss: 0.079
Batch: 51/58	Loss: 0.015
Batch: 56/58	Loss: 0.038
Batch: 58/58	Loss: 0.021
Epoch: 23	Train Loss: 0.047	Val F1: 0.344
Best Epoch: 17	Best Val F1: 0.364

****************************** Epoch: 24 ******************************
Batch: 1/58	Loss: 0.048
Batch: 6/58	Loss: 0.050
Batch: 11/58	Loss: 0.027
Batch: 16/58	Loss: 0.063
Batch: 21/58	Loss: 0.042
Batch: 26/58	Loss: 0.019
Batch: 31/58	Loss: 0.024
Batch: 36/58	Loss: 0.028
Batch: 41/58	Loss: 0.038
Batch: 46/58	Loss: 0.021
Batch: 51/58	Loss: 0.082
Batch: 56/58	Loss: 0.019
Batch: 58/58	Loss: 0.031
Epoch: 24	Train Loss: 0.043	Val F1: 0.351
Best Epoch: 17	Best Val F1: 0.364

****************************** Epoch: 25 ******************************
Batch: 1/58	Loss: 0.135
Batch: 6/58	Loss: 0.034
Batch: 11/58	Loss: 0.079
Batch: 16/58	Loss: 0.017
Batch: 21/58	Loss: 0.030
Batch: 26/58	Loss: 0.097
Batch: 31/58	Loss: 0.079
Batch: 36/58	Loss: 0.066
Batch: 41/58	Loss: 0.034
Batch: 46/58	Loss: 0.039
Batch: 51/58	Loss: 0.020
Batch: 56/58	Loss: 0.024
Batch: 58/58	Loss: 0.017
Epoch: 25	Train Loss: 0.052	Val F1: 0.351
Best Epoch: 17	Best Val F1: 0.364

Saving the best checkpoint....
Inference...
Test F1: 0.353	Test F1_Few: 0.425	Test F1_Zero: 0.348
Starting training with config: {'batch_size': 32, 'epochs': 25, 'l2_reg': 0.0008809401233328146, 'lr': 7.792523328046519e-05, 'n_layers_freeze': 2, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 0.925
Batch: 11/58	Loss: 0.855
Batch: 16/58	Loss: 0.777
Batch: 21/58	Loss: 0.815
Batch: 26/58	Loss: 0.806
Batch: 31/58	Loss: 0.759
Batch: 36/58	Loss: 0.838
Batch: 41/58	Loss: 0.762
Batch: 46/58	Loss: 0.726
Batch: 51/58	Loss: 0.728
Batch: 56/58	Loss: 0.732
Batch: 58/58	Loss: 0.731
Epoch: 1	Train Loss: 0.817	Val F1: 0.266
Best Epoch: 1	Best Val F1: 0.266

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.771
Batch: 6/58	Loss: 0.809
Batch: 11/58	Loss: 0.841
Batch: 16/58	Loss: 0.717
Batch: 21/58	Loss: 0.719
Batch: 26/58	Loss: 0.760
Batch: 31/58	Loss: 0.816
Batch: 36/58	Loss: 0.816
Batch: 41/58	Loss: 0.735
Batch: 46/58	Loss: 0.737
Batch: 51/58	Loss: 0.734
Batch: 56/58	Loss: 0.744
Batch: 58/58	Loss: 0.713
Epoch: 2	Train Loss: 0.769	Val F1: 0.182
Best Epoch: 1	Best Val F1: 0.266

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.736
Batch: 6/58	Loss: 0.710
Batch: 11/58	Loss: 0.788
Batch: 16/58	Loss: 0.760
Batch: 21/58	Loss: 0.714
Batch: 26/58	Loss: 0.793
Batch: 31/58	Loss: 0.937
Batch: 36/58	Loss: 0.765
Batch: 41/58	Loss: 0.734
Batch: 46/58	Loss: 0.714
Batch: 51/58	Loss: 0.740
Batch: 56/58	Loss: 0.779
Batch: 58/58	Loss: 0.750
Epoch: 3	Train Loss: 0.765	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.266

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.741
Batch: 6/58	Loss: 0.762
Batch: 11/58	Loss: 0.754
Batch: 16/58	Loss: 0.777
Batch: 21/58	Loss: 0.706
Batch: 26/58	Loss: 0.710
Batch: 31/58	Loss: 0.714
Batch: 36/58	Loss: 0.798
Batch: 41/58	Loss: 0.868
Batch: 46/58	Loss: 0.812
Batch: 51/58	Loss: 0.716
Batch: 56/58	Loss: 0.712
Batch: 58/58	Loss: 0.830
Epoch: 4	Train Loss: 0.764	Val F1: 0.180
Best Epoch: 1	Best Val F1: 0.266

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.736
Batch: 6/58	Loss: 0.717
Batch: 11/58	Loss: 0.768
Batch: 16/58	Loss: 0.763
Batch: 21/58	Loss: 0.715
Batch: 26/58	Loss: 0.710
Batch: 31/58	Loss: 0.858
Batch: 36/58	Loss: 0.829
Batch: 41/58	Loss: 0.749
Batch: 46/58	Loss: 0.703
Batch: 51/58	Loss: 0.840
Batch: 56/58	Loss: 0.827
Batch: 58/58	Loss: 0.808
Epoch: 5	Train Loss: 0.764	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.266

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.714
Batch: 6/58	Loss: 0.850
Batch: 11/58	Loss: 0.850
Batch: 16/58	Loss: 0.764
Batch: 21/58	Loss: 0.826
Batch: 26/58	Loss: 0.781
Batch: 31/58	Loss: 0.741
Batch: 36/58	Loss: 0.707
Batch: 41/58	Loss: 0.757
Batch: 46/58	Loss: 0.736
Batch: 51/58	Loss: 0.751
Batch: 56/58	Loss: 0.785
Batch: 58/58	Loss: 0.735
Epoch: 6	Train Loss: 0.762	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.266

Saving the best checkpoint....
Inference...
Test F1: 0.296	Test F1_Few: 0.345	Test F1_Zero: 0.306
Starting training with config: {'batch_size': 16, 'epochs': 75, 'l2_reg': 9.360440854664582e-05, 'lr': 5.290160162174807e-05, 'n_layers_freeze': 0, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 0.907
Batch: 23/116	Loss: 0.839
Batch: 34/116	Loss: 0.825
Batch: 45/116	Loss: 0.776
Batch: 56/116	Loss: 0.804
Batch: 67/116	Loss: 0.723
Batch: 78/116	Loss: 0.729
Batch: 89/116	Loss: 0.870
Batch: 100/116	Loss: 0.723
Batch: 111/116	Loss: 0.737
Batch: 116/116	Loss: 0.691
Epoch: 1	Train Loss: 0.804	Val F1: 0.338
Best Epoch: 1	Best Val F1: 0.338

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.768
Batch: 12/116	Loss: 0.728
Batch: 23/116	Loss: 0.655
Batch: 34/116	Loss: 0.718
Batch: 45/116	Loss: 0.747
Batch: 56/116	Loss: 0.662
Batch: 67/116	Loss: 0.726
Batch: 78/116	Loss: 0.730
Batch: 89/116	Loss: 0.636
Batch: 100/116	Loss: 0.681
Batch: 111/116	Loss: 0.572
Batch: 116/116	Loss: 0.490
Epoch: 2	Train Loss: 0.709	Val F1: 0.288
Best Epoch: 1	Best Val F1: 0.338

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.610
Batch: 12/116	Loss: 0.513
Batch: 23/116	Loss: 0.629
Batch: 34/116	Loss: 0.725
Batch: 45/116	Loss: 0.762
Batch: 56/116	Loss: 0.659
Batch: 67/116	Loss: 0.523
Batch: 78/116	Loss: 0.702
Batch: 89/116	Loss: 0.724
Batch: 100/116	Loss: 0.832
Batch: 111/116	Loss: 0.860
Batch: 116/116	Loss: 0.696
Epoch: 3	Train Loss: 0.660	Val F1: 0.283
Best Epoch: 1	Best Val F1: 0.338

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.701
Batch: 12/116	Loss: 0.507
Batch: 23/116	Loss: 0.814
Batch: 34/116	Loss: 0.609
Batch: 45/116	Loss: 0.690
Batch: 56/116	Loss: 0.644
Batch: 67/116	Loss: 0.746
Batch: 78/116	Loss: 0.566
Batch: 89/116	Loss: 0.702
Batch: 100/116	Loss: 0.581
Batch: 111/116	Loss: 0.659
Batch: 116/116	Loss: 0.659
Epoch: 4	Train Loss: 0.630	Val F1: 0.284
Best Epoch: 1	Best Val F1: 0.338

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.372
Batch: 12/116	Loss: 0.617
Batch: 23/116	Loss: 0.507
Batch: 34/116	Loss: 0.492
Batch: 45/116	Loss: 0.669
Batch: 56/116	Loss: 0.505
Batch: 67/116	Loss: 0.595
Batch: 78/116	Loss: 0.578
Batch: 89/116	Loss: 0.721
Batch: 100/116	Loss: 0.650
Batch: 111/116	Loss: 0.660
Batch: 116/116	Loss: 0.456
Epoch: 5	Train Loss: 0.586	Val F1: 0.292
Best Epoch: 1	Best Val F1: 0.338

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.603
Batch: 12/116	Loss: 0.696
Batch: 23/116	Loss: 0.422
Batch: 34/116	Loss: 0.500
Batch: 45/116	Loss: 0.455
Batch: 56/116	Loss: 0.571
Batch: 67/116	Loss: 0.479
Batch: 78/116	Loss: 0.667
Batch: 89/116	Loss: 0.787
Batch: 100/116	Loss: 0.502
Batch: 111/116	Loss: 0.535
Batch: 116/116	Loss: 0.296
Epoch: 6	Train Loss: 0.518	Val F1: 0.319
Best Epoch: 1	Best Val F1: 0.338

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.448
Batch: 12/116	Loss: 0.873
Batch: 23/116	Loss: 0.501
Batch: 34/116	Loss: 0.683
Batch: 45/116	Loss: 0.412
Batch: 56/116	Loss: 0.786
Batch: 67/116	Loss: 0.541
Batch: 78/116	Loss: 0.542
Batch: 89/116	Loss: 0.358
Batch: 100/116	Loss: 0.292
Batch: 111/116	Loss: 0.662
Batch: 116/116	Loss: 0.336
Epoch: 7	Train Loss: 0.464	Val F1: 0.325
Best Epoch: 1	Best Val F1: 0.338

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.473
Batch: 12/116	Loss: 0.481
Batch: 23/116	Loss: 0.183
Batch: 34/116	Loss: 0.402
Batch: 45/116	Loss: 0.334
Batch: 56/116	Loss: 0.298
Batch: 67/116	Loss: 0.704
Batch: 78/116	Loss: 0.703
Batch: 89/116	Loss: 0.298
Batch: 100/116	Loss: 0.479
Batch: 111/116	Loss: 0.343
Batch: 116/116	Loss: 0.552
Epoch: 8	Train Loss: 0.452	Val F1: 0.337
Best Epoch: 1	Best Val F1: 0.338

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.399
Batch: 12/116	Loss: 0.446
Batch: 23/116	Loss: 0.399
Batch: 34/116	Loss: 0.706
Batch: 45/116	Loss: 0.366
Batch: 56/116	Loss: 0.422
Batch: 67/116	Loss: 0.375
Batch: 78/116	Loss: 0.428
Batch: 89/116	Loss: 0.258
Batch: 100/116	Loss: 0.372
Batch: 111/116	Loss: 0.347
Batch: 116/116	Loss: 0.473
Epoch: 9	Train Loss: 0.421	Val F1: 0.335
Best Epoch: 1	Best Val F1: 0.338

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.503
Batch: 12/116	Loss: 0.251
Batch: 23/116	Loss: 0.506
Batch: 34/116	Loss: 0.420
Batch: 45/116	Loss: 0.154
Batch: 56/116	Loss: 0.403
Batch: 67/116	Loss: 0.597
Batch: 78/116	Loss: 0.278
Batch: 89/116	Loss: 0.250
Batch: 100/116	Loss: 0.437
Batch: 111/116	Loss: 0.200
Batch: 116/116	Loss: 0.237
Epoch: 10	Train Loss: 0.370	Val F1: 0.325
Best Epoch: 1	Best Val F1: 0.338

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.304
Batch: 12/116	Loss: 0.325
Batch: 23/116	Loss: 0.209
Batch: 34/116	Loss: 0.253
Batch: 45/116	Loss: 0.324
Batch: 56/116	Loss: 0.472
Batch: 67/116	Loss: 0.450
Batch: 78/116	Loss: 0.281
Batch: 89/116	Loss: 0.276
Batch: 100/116	Loss: 0.301
Batch: 111/116	Loss: 0.472
Batch: 116/116	Loss: 0.126
Epoch: 11	Train Loss: 0.345	Val F1: 0.330
Best Epoch: 1	Best Val F1: 0.338

Saving the best checkpoint....
Inference...
Test F1: 0.354	Test F1_Few: 0.422	Test F1_Zero: 0.347
Starting training with config: {'batch_size': 32, 'epochs': 25, 'l2_reg': 0.00011063239720238004, 'lr': 7.105443417189665e-05, 'n_layers_freeze': 8, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 0.947
Batch: 11/58	Loss: 0.867
Batch: 16/58	Loss: 0.784
Batch: 21/58	Loss: 0.821
Batch: 26/58	Loss: 0.812
Batch: 31/58	Loss: 0.765
Batch: 36/58	Loss: 0.840
Batch: 41/58	Loss: 0.756
Batch: 46/58	Loss: 0.725
Batch: 51/58	Loss: 0.718
Batch: 56/58	Loss: 0.742
Batch: 58/58	Loss: 0.751
Epoch: 1	Train Loss: 0.825	Val F1: 0.210
Best Epoch: 1	Best Val F1: 0.210

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.779
Batch: 6/58	Loss: 0.808
Batch: 11/58	Loss: 0.792
Batch: 16/58	Loss: 0.677
Batch: 21/58	Loss: 0.706
Batch: 26/58	Loss: 0.656
Batch: 31/58	Loss: 0.788
Batch: 36/58	Loss: 0.754
Batch: 41/58	Loss: 0.624
Batch: 46/58	Loss: 0.675
Batch: 51/58	Loss: 0.693
Batch: 56/58	Loss: 0.695
Batch: 58/58	Loss: 0.636
Epoch: 2	Train Loss: 0.728	Val F1: 0.314
Best Epoch: 2	Best Val F1: 0.314

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.607
Batch: 6/58	Loss: 0.545
Batch: 11/58	Loss: 0.683
Batch: 16/58	Loss: 0.613
Batch: 21/58	Loss: 0.661
Batch: 26/58	Loss: 0.611
Batch: 31/58	Loss: 0.910
Batch: 36/58	Loss: 0.711
Batch: 41/58	Loss: 0.565
Batch: 46/58	Loss: 0.611
Batch: 51/58	Loss: 0.776
Batch: 56/58	Loss: 0.615
Batch: 58/58	Loss: 0.703
Epoch: 3	Train Loss: 0.673	Val F1: 0.262
Best Epoch: 2	Best Val F1: 0.314

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.678
Batch: 6/58	Loss: 0.611
Batch: 11/58	Loss: 0.590
Batch: 16/58	Loss: 0.557
Batch: 21/58	Loss: 0.444
Batch: 26/58	Loss: 0.464
Batch: 31/58	Loss: 0.510
Batch: 36/58	Loss: 0.762
Batch: 41/58	Loss: 0.679
Batch: 46/58	Loss: 0.628
Batch: 51/58	Loss: 0.483
Batch: 56/58	Loss: 0.508
Batch: 58/58	Loss: 0.554
Epoch: 4	Train Loss: 0.609	Val F1: 0.318
Best Epoch: 4	Best Val F1: 0.318

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.500
Batch: 6/58	Loss: 0.486
Batch: 11/58	Loss: 0.521
Batch: 16/58	Loss: 0.502
Batch: 21/58	Loss: 0.444
Batch: 26/58	Loss: 0.483
Batch: 31/58	Loss: 0.743
Batch: 36/58	Loss: 0.611
Batch: 41/58	Loss: 0.563
Batch: 46/58	Loss: 0.522
Batch: 51/58	Loss: 0.667
Batch: 56/58	Loss: 0.582
Batch: 58/58	Loss: 0.691
Epoch: 5	Train Loss: 0.567	Val F1: 0.325
Best Epoch: 5	Best Val F1: 0.325

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.507
Batch: 6/58	Loss: 0.600
Batch: 11/58	Loss: 0.568
Batch: 16/58	Loss: 0.538
Batch: 21/58	Loss: 0.520
Batch: 26/58	Loss: 0.314
Batch: 31/58	Loss: 0.512
Batch: 36/58	Loss: 0.346
Batch: 41/58	Loss: 0.572
Batch: 46/58	Loss: 0.504
Batch: 51/58	Loss: 0.445
Batch: 56/58	Loss: 0.476
Batch: 58/58	Loss: 0.394
Epoch: 6	Train Loss: 0.501	Val F1: 0.317
Best Epoch: 5	Best Val F1: 0.325

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.311
Batch: 6/58	Loss: 0.512
Batch: 11/58	Loss: 0.430
Batch: 16/58	Loss: 0.325
Batch: 21/58	Loss: 0.374
Batch: 26/58	Loss: 0.478
Batch: 31/58	Loss: 0.356
Batch: 36/58	Loss: 0.453
Batch: 41/58	Loss: 0.454
Batch: 46/58	Loss: 0.397
Batch: 51/58	Loss: 0.373
Batch: 56/58	Loss: 0.465
Batch: 58/58	Loss: 0.380
Epoch: 7	Train Loss: 0.437	Val F1: 0.333
Best Epoch: 7	Best Val F1: 0.333

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.420
Batch: 6/58	Loss: 0.357
Batch: 11/58	Loss: 0.352
Batch: 16/58	Loss: 0.331
Batch: 21/58	Loss: 0.361
Batch: 26/58	Loss: 0.230
Batch: 31/58	Loss: 0.343
Batch: 36/58	Loss: 0.303
Batch: 41/58	Loss: 0.498
Batch: 46/58	Loss: 0.373
Batch: 51/58	Loss: 0.315
Batch: 56/58	Loss: 0.383
Batch: 58/58	Loss: 0.406
Epoch: 8	Train Loss: 0.389	Val F1: 0.311
Best Epoch: 7	Best Val F1: 0.333

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.317
Batch: 6/58	Loss: 0.420
Batch: 11/58	Loss: 0.395
Batch: 16/58	Loss: 0.290
Batch: 21/58	Loss: 0.313
Batch: 26/58	Loss: 0.235
Batch: 31/58	Loss: 0.323
Batch: 36/58	Loss: 0.294
Batch: 41/58	Loss: 0.478
Batch: 46/58	Loss: 0.359
Batch: 51/58	Loss: 0.338
Batch: 56/58	Loss: 0.279
Batch: 58/58	Loss: 0.289
Epoch: 9	Train Loss: 0.335	Val F1: 0.327
Best Epoch: 7	Best Val F1: 0.333

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.278
Batch: 6/58	Loss: 0.248
Batch: 11/58	Loss: 0.368
Batch: 16/58	Loss: 0.405
Batch: 21/58	Loss: 0.319
Batch: 26/58	Loss: 0.321
Batch: 31/58	Loss: 0.226
Batch: 36/58	Loss: 0.384
Batch: 41/58	Loss: 0.335
Batch: 46/58	Loss: 0.464
Batch: 51/58	Loss: 0.203
Batch: 56/58	Loss: 0.239
Batch: 58/58	Loss: 0.311
Epoch: 10	Train Loss: 0.297	Val F1: 0.337
Best Epoch: 10	Best Val F1: 0.337

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.261
Batch: 6/58	Loss: 0.158
Batch: 11/58	Loss: 0.270
Batch: 16/58	Loss: 0.249
Batch: 21/58	Loss: 0.263
Batch: 26/58	Loss: 0.230
Batch: 31/58	Loss: 0.214
Batch: 36/58	Loss: 0.304
Batch: 41/58	Loss: 0.178
Batch: 46/58	Loss: 0.201
Batch: 51/58	Loss: 0.329
Batch: 56/58	Loss: 0.251
Batch: 58/58	Loss: 0.302
Epoch: 11	Train Loss: 0.250	Val F1: 0.323
Best Epoch: 10	Best Val F1: 0.337

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.239
Batch: 6/58	Loss: 0.150
Batch: 11/58	Loss: 0.145
Batch: 16/58	Loss: 0.145
Batch: 21/58	Loss: 0.218
Batch: 26/58	Loss: 0.191
Batch: 31/58	Loss: 0.233
Batch: 36/58	Loss: 0.195
Batch: 41/58	Loss: 0.191
Batch: 46/58	Loss: 0.195
Batch: 51/58	Loss: 0.350
Batch: 56/58	Loss: 0.138
Batch: 58/58	Loss: 0.118
Epoch: 12	Train Loss: 0.198	Val F1: 0.320
Best Epoch: 10	Best Val F1: 0.337

****************************** Epoch: 13 ******************************
Batch: 1/58	Loss: 0.107
Batch: 6/58	Loss: 0.184
Batch: 11/58	Loss: 0.208
Batch: 16/58	Loss: 0.143
Batch: 21/58	Loss: 0.175
Batch: 26/58	Loss: 0.102
Batch: 31/58	Loss: 0.127
Batch: 36/58	Loss: 0.141
Batch: 41/58	Loss: 0.097
Batch: 46/58	Loss: 0.094
Batch: 51/58	Loss: 0.092
Batch: 56/58	Loss: 0.211
Batch: 58/58	Loss: 0.117
Epoch: 13	Train Loss: 0.151	Val F1: 0.316
Best Epoch: 10	Best Val F1: 0.337

****************************** Epoch: 14 ******************************
Batch: 1/58	Loss: 0.171
Batch: 6/58	Loss: 0.147
Batch: 11/58	Loss: 0.095
Batch: 16/58	Loss: 0.142
Batch: 21/58	Loss: 0.113
Batch: 26/58	Loss: 0.175
Batch: 31/58	Loss: 0.122
Batch: 36/58	Loss: 0.128
Batch: 41/58	Loss: 0.067
Batch: 46/58	Loss: 0.047
Batch: 51/58	Loss: 0.126
Batch: 56/58	Loss: 0.096
Batch: 58/58	Loss: 0.206
Epoch: 14	Train Loss: 0.127	Val F1: 0.329
Best Epoch: 10	Best Val F1: 0.337

****************************** Epoch: 15 ******************************
Batch: 1/58	Loss: 0.082
Batch: 6/58	Loss: 0.169
Batch: 11/58	Loss: 0.055
Batch: 16/58	Loss: 0.080
Batch: 21/58	Loss: 0.079
Batch: 26/58	Loss: 0.099
Batch: 31/58	Loss: 0.054
Batch: 36/58	Loss: 0.073
Batch: 41/58	Loss: 0.060
Batch: 46/58	Loss: 0.048
Batch: 51/58	Loss: 0.089
Batch: 56/58	Loss: 0.062
Batch: 58/58	Loss: 0.085
Epoch: 15	Train Loss: 0.101	Val F1: 0.335
Best Epoch: 10	Best Val F1: 0.337

Saving the best checkpoint....
Inference...
Test F1: 0.368	Test F1_Few: 0.433	Test F1_Zero: 0.371
Starting training with config: {'batch_size': 8, 'epochs': 25, 'l2_reg': 0.0002310049537416545, 'lr': 6.331926554551199e-05, 'n_layers_freeze': 9, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/231	Loss: 1.080
Batch: 24/231	Loss: 0.832
Batch: 47/231	Loss: 0.759
Batch: 70/231	Loss: 0.759
Batch: 93/231	Loss: 0.694
Batch: 116/231	Loss: 0.815
Batch: 139/231	Loss: 0.763
Batch: 162/231	Loss: 0.907
Batch: 185/231	Loss: 0.662
Batch: 208/231	Loss: 0.683
Batch: 231/231	Loss: 0.627
Epoch: 1	Train Loss: 0.767	Val F1: 0.306
Best Epoch: 1	Best Val F1: 0.306

****************************** Epoch: 2 ******************************
Batch: 1/231	Loss: 0.715
Batch: 24/231	Loss: 0.732
Batch: 47/231	Loss: 0.779
Batch: 70/231	Loss: 0.946
Batch: 93/231	Loss: 0.717
Batch: 116/231	Loss: 0.528
Batch: 139/231	Loss: 1.036
Batch: 162/231	Loss: 0.474
Batch: 185/231	Loss: 0.828
Batch: 208/231	Loss: 0.689
Batch: 231/231	Loss: 0.577
Epoch: 2	Train Loss: 0.680	Val F1: 0.308
Best Epoch: 2	Best Val F1: 0.308

****************************** Epoch: 3 ******************************
Batch: 1/231	Loss: 0.506
Batch: 24/231	Loss: 0.501
Batch: 47/231	Loss: 0.630
Batch: 70/231	Loss: 0.626
Batch: 93/231	Loss: 0.567
Batch: 116/231	Loss: 0.422
Batch: 139/231	Loss: 0.546
Batch: 162/231	Loss: 0.586
Batch: 185/231	Loss: 0.690
Batch: 208/231	Loss: 0.657
Batch: 231/231	Loss: 0.641
Epoch: 3	Train Loss: 0.620	Val F1: 0.282
Best Epoch: 2	Best Val F1: 0.308

****************************** Epoch: 4 ******************************
Batch: 1/231	Loss: 0.856
Batch: 24/231	Loss: 0.304
Batch: 47/231	Loss: 0.499
Batch: 70/231	Loss: 0.676
Batch: 93/231	Loss: 0.660
Batch: 116/231	Loss: 0.492
Batch: 139/231	Loss: 1.298
Batch: 162/231	Loss: 0.775
Batch: 185/231	Loss: 0.375
Batch: 208/231	Loss: 0.342
Batch: 231/231	Loss: 0.571
Epoch: 4	Train Loss: 0.553	Val F1: 0.302
Best Epoch: 2	Best Val F1: 0.308

****************************** Epoch: 5 ******************************
Batch: 1/231	Loss: 0.278
Batch: 24/231	Loss: 0.634
Batch: 47/231	Loss: 0.813
Batch: 70/231	Loss: 0.502
Batch: 93/231	Loss: 0.469
Batch: 116/231	Loss: 0.312
Batch: 139/231	Loss: 0.794
Batch: 162/231	Loss: 0.654
Batch: 185/231	Loss: 0.540
Batch: 208/231	Loss: 0.270
Batch: 231/231	Loss: 0.445
Epoch: 5	Train Loss: 0.485	Val F1: 0.307
Best Epoch: 2	Best Val F1: 0.308

****************************** Epoch: 6 ******************************
Batch: 1/231	Loss: 0.357
Batch: 24/231	Loss: 0.423
Batch: 47/231	Loss: 0.322
Batch: 70/231	Loss: 0.505
Batch: 93/231	Loss: 0.193
Batch: 116/231	Loss: 0.756
Batch: 139/231	Loss: 0.548
Batch: 162/231	Loss: 0.574
Batch: 185/231	Loss: 0.508
Batch: 208/231	Loss: 0.423
Batch: 231/231	Loss: 0.191
Epoch: 6	Train Loss: 0.409	Val F1: 0.310
Best Epoch: 6	Best Val F1: 0.310

****************************** Epoch: 7 ******************************
Batch: 1/231	Loss: 0.409
Batch: 24/231	Loss: 0.631
Batch: 47/231	Loss: 0.220
Batch: 70/231	Loss: 0.457
Batch: 93/231	Loss: 0.186
Batch: 116/231	Loss: 0.399
Batch: 139/231	Loss: 0.103
Batch: 162/231	Loss: 0.411
Batch: 185/231	Loss: 0.119
Batch: 208/231	Loss: 0.480
Batch: 231/231	Loss: 0.130
Epoch: 7	Train Loss: 0.351	Val F1: 0.304
Best Epoch: 6	Best Val F1: 0.310

****************************** Epoch: 8 ******************************
Batch: 1/231	Loss: 0.209
Batch: 24/231	Loss: 0.443
Batch: 47/231	Loss: 0.322
Batch: 70/231	Loss: 0.143
Batch: 93/231	Loss: 0.201
Batch: 116/231	Loss: 0.137
Batch: 139/231	Loss: 0.415
Batch: 162/231	Loss: 0.201
Batch: 185/231	Loss: 0.111
Batch: 208/231	Loss: 0.140
Batch: 231/231	Loss: 0.279
Epoch: 8	Train Loss: 0.283	Val F1: 0.311
Best Epoch: 8	Best Val F1: 0.311

****************************** Epoch: 9 ******************************
Batch: 1/231	Loss: 0.295
Batch: 24/231	Loss: 0.336
Batch: 47/231	Loss: 0.292
Batch: 70/231	Loss: 0.572
Batch: 93/231	Loss: 0.293
Batch: 116/231	Loss: 0.243
Batch: 139/231	Loss: 0.450
Batch: 162/231	Loss: 0.540
Batch: 185/231	Loss: 0.097
Batch: 208/231	Loss: 0.342
Batch: 231/231	Loss: 0.318
Epoch: 9	Train Loss: 0.231	Val F1: 0.313
Best Epoch: 9	Best Val F1: 0.313

****************************** Epoch: 10 ******************************
Batch: 1/231	Loss: 0.203
Batch: 24/231	Loss: 0.072
Batch: 47/231	Loss: 0.090
Batch: 70/231	Loss: 0.068
Batch: 93/231	Loss: 0.118
Batch: 116/231	Loss: 0.066
Batch: 139/231	Loss: 0.022
Batch: 162/231	Loss: 0.129
Batch: 185/231	Loss: 0.778
Batch: 208/231	Loss: 0.048
Batch: 231/231	Loss: 0.098
Epoch: 10	Train Loss: 0.170	Val F1: 0.320
Best Epoch: 10	Best Val F1: 0.320

****************************** Epoch: 11 ******************************
Batch: 1/231	Loss: 0.107
Batch: 24/231	Loss: 0.057
Batch: 47/231	Loss: 0.042
Batch: 70/231	Loss: 0.021
Batch: 93/231	Loss: 0.182
Batch: 116/231	Loss: 0.425
Batch: 139/231	Loss: 0.552
Batch: 162/231	Loss: 0.077
Batch: 185/231	Loss: 0.079
Batch: 208/231	Loss: 0.212
Batch: 231/231	Loss: 0.010
Epoch: 11	Train Loss: 0.142	Val F1: 0.316
Best Epoch: 10	Best Val F1: 0.320

****************************** Epoch: 12 ******************************
Batch: 1/231	Loss: 0.100
Batch: 24/231	Loss: 0.029
Batch: 47/231	Loss: 0.070
Batch: 70/231	Loss: 0.133
Batch: 93/231	Loss: 0.216
Batch: 116/231	Loss: 0.200
Batch: 139/231	Loss: 0.032
Batch: 162/231	Loss: 0.135
Batch: 185/231	Loss: 0.029
Batch: 208/231	Loss: 0.077
Batch: 231/231	Loss: 0.005
Epoch: 12	Train Loss: 0.089	Val F1: 0.314
Best Epoch: 10	Best Val F1: 0.320

****************************** Epoch: 13 ******************************
Batch: 1/231	Loss: 0.083
Batch: 24/231	Loss: 0.009
Batch: 47/231	Loss: 0.014
Batch: 70/231	Loss: 0.076
Batch: 93/231	Loss: 0.019
Batch: 116/231	Loss: 0.170
Batch: 139/231	Loss: 0.017
Batch: 162/231	Loss: 0.025
Batch: 185/231	Loss: 0.011
Batch: 208/231	Loss: 0.008
Batch: 231/231	Loss: 0.066
Epoch: 13	Train Loss: 0.063	Val F1: 0.316
Best Epoch: 10	Best Val F1: 0.320

****************************** Epoch: 14 ******************************
Batch: 1/231	Loss: 0.043
Batch: 24/231	Loss: 0.097
Batch: 47/231	Loss: 0.028
Batch: 70/231	Loss: 0.055
Batch: 93/231	Loss: 0.019
Batch: 116/231	Loss: 0.007
Batch: 139/231	Loss: 0.149
Batch: 162/231	Loss: 0.019
Batch: 185/231	Loss: 0.238
Batch: 208/231	Loss: 0.005
Batch: 231/231	Loss: 0.076
Epoch: 14	Train Loss: 0.066	Val F1: 0.319
Best Epoch: 10	Best Val F1: 0.320

****************************** Epoch: 15 ******************************
Batch: 1/231	Loss: 0.016
Batch: 24/231	Loss: 0.139
Batch: 47/231	Loss: 0.006
Batch: 70/231	Loss: 0.019
Batch: 93/231	Loss: 0.042
Batch: 116/231	Loss: 0.007
Batch: 139/231	Loss: 0.023
Batch: 162/231	Loss: 0.013
Batch: 185/231	Loss: 0.005
Batch: 208/231	Loss: 0.396
Batch: 231/231	Loss: 0.029
Epoch: 15	Train Loss: 0.056	Val F1: 0.326
Best Epoch: 15	Best Val F1: 0.326

****************************** Epoch: 16 ******************************
Batch: 1/231	Loss: 0.044
Batch: 24/231	Loss: 0.008
Batch: 47/231	Loss: 0.017
Batch: 70/231	Loss: 0.013
Batch: 93/231	Loss: 0.122
Batch: 116/231	Loss: 0.005
Batch: 139/231	Loss: 0.003
Batch: 162/231	Loss: 0.006
Batch: 185/231	Loss: 0.024
Batch: 208/231	Loss: 0.082
Batch: 231/231	Loss: 0.011
Epoch: 16	Train Loss: 0.045	Val F1: 0.318
Best Epoch: 15	Best Val F1: 0.326

****************************** Epoch: 17 ******************************
Batch: 1/231	Loss: 0.028
Batch: 24/231	Loss: 0.008
Batch: 47/231	Loss: 0.124
Batch: 70/231	Loss: 0.005
Batch: 93/231	Loss: 0.077
Batch: 116/231	Loss: 0.006
Batch: 139/231	Loss: 0.036
Batch: 162/231	Loss: 0.021
Batch: 185/231	Loss: 0.016
Batch: 208/231	Loss: 0.088
Batch: 231/231	Loss: 0.009
Epoch: 17	Train Loss: 0.026	Val F1: 0.310
Best Epoch: 15	Best Val F1: 0.326

****************************** Epoch: 18 ******************************
Batch: 1/231	Loss: 0.006
Batch: 24/231	Loss: 0.001
Batch: 47/231	Loss: 0.003
Batch: 70/231	Loss: 0.011
Batch: 93/231	Loss: 0.013
Batch: 116/231	Loss: 0.026
Batch: 139/231	Loss: 0.024
Batch: 162/231	Loss: 0.003
Batch: 185/231	Loss: 0.009
Batch: 208/231	Loss: 0.003
Batch: 231/231	Loss: 0.165
Epoch: 18	Train Loss: 0.033	Val F1: 0.320
Best Epoch: 15	Best Val F1: 0.326

****************************** Epoch: 19 ******************************
Batch: 1/231	Loss: 0.009
Batch: 24/231	Loss: 0.003
Batch: 47/231	Loss: 0.004
Batch: 70/231	Loss: 0.014
Batch: 93/231	Loss: 0.027
Batch: 116/231	Loss: 0.006
Batch: 139/231	Loss: 0.011
Batch: 162/231	Loss: 0.003
Batch: 185/231	Loss: 0.022
Batch: 208/231	Loss: 0.017
Batch: 231/231	Loss: 0.010
Epoch: 19	Train Loss: 0.024	Val F1: 0.325
Best Epoch: 15	Best Val F1: 0.326

****************************** Epoch: 20 ******************************
Batch: 1/231	Loss: 0.013
Batch: 24/231	Loss: 0.004
Batch: 47/231	Loss: 0.001
Batch: 70/231	Loss: 0.006
Batch: 93/231	Loss: 0.001
Batch: 116/231	Loss: 0.003
Batch: 139/231	Loss: 0.031
Batch: 162/231	Loss: 0.007
Batch: 185/231	Loss: 0.006
Batch: 208/231	Loss: 0.009
Batch: 231/231	Loss: 0.054
Epoch: 20	Train Loss: 0.023	Val F1: 0.310
Best Epoch: 15	Best Val F1: 0.326

****************************** Epoch: 21 ******************************
Batch: 1/231	Loss: 0.031
Batch: 24/231	Loss: 0.002
Batch: 47/231	Loss: 0.004
Batch: 70/231	Loss: 0.028
Batch: 93/231	Loss: 0.009
Batch: 116/231	Loss: 0.002
Batch: 139/231	Loss: 0.055
Batch: 162/231	Loss: 0.004
Batch: 185/231	Loss: 0.002
Batch: 208/231	Loss: 0.010
Batch: 231/231	Loss: 0.020
Epoch: 21	Train Loss: 0.022	Val F1: 0.328
Best Epoch: 21	Best Val F1: 0.328

****************************** Epoch: 22 ******************************
Batch: 1/231	Loss: 0.004
Batch: 24/231	Loss: 0.001
Batch: 47/231	Loss: 0.001
Batch: 70/231	Loss: 0.013
Batch: 93/231	Loss: 0.003
Batch: 116/231	Loss: 0.001
Batch: 139/231	Loss: 0.058
Batch: 162/231	Loss: 0.009
Batch: 185/231	Loss: 0.015
Batch: 208/231	Loss: 0.002
Batch: 231/231	Loss: 0.015
Epoch: 22	Train Loss: 0.028	Val F1: 0.324
Best Epoch: 21	Best Val F1: 0.328

****************************** Epoch: 23 ******************************
Batch: 1/231	Loss: 0.071
Batch: 24/231	Loss: 0.008
Batch: 47/231	Loss: 0.004
Batch: 70/231	Loss: 0.039
Batch: 93/231	Loss: 0.004
Batch: 116/231	Loss: 0.002
Batch: 139/231	Loss: 0.001
Batch: 162/231	Loss: 0.046
Batch: 185/231	Loss: 0.006
Batch: 208/231	Loss: 0.022
Batch: 231/231	Loss: 0.013
Epoch: 23	Train Loss: 0.040	Val F1: 0.316
Best Epoch: 21	Best Val F1: 0.328

****************************** Epoch: 24 ******************************
Batch: 1/231	Loss: 0.006
Batch: 24/231	Loss: 0.002
Batch: 47/231	Loss: 0.005
Batch: 70/231	Loss: 0.003
Batch: 93/231	Loss: 0.031
Batch: 116/231	Loss: 0.006
Batch: 139/231	Loss: 0.114
Batch: 162/231	Loss: 0.001
Batch: 185/231	Loss: 0.030
Batch: 208/231	Loss: 0.003
Batch: 231/231	Loss: 0.023
Epoch: 24	Train Loss: 0.027	Val F1: 0.318
Best Epoch: 21	Best Val F1: 0.328

****************************** Epoch: 25 ******************************
Batch: 1/231	Loss: 0.009
Batch: 24/231	Loss: 0.013
Batch: 47/231	Loss: 0.001
Batch: 70/231	Loss: 0.004
Batch: 93/231	Loss: 0.001
Batch: 116/231	Loss: 0.029
Batch: 139/231	Loss: 0.003
Batch: 162/231	Loss: 0.002
Batch: 185/231	Loss: 0.001
Batch: 208/231	Loss: 0.039
Batch: 231/231	Loss: 0.047
Epoch: 25	Train Loss: 0.029	Val F1: 0.318
Best Epoch: 21	Best Val F1: 0.328

Saving the best checkpoint....
Inference...
Test F1: 0.358	Test F1_Few: 0.436	Test F1_Zero: 0.350
Starting training with config: {'batch_size': 64, 'epochs': 75, 'l2_reg': 0.0009408582660239944, 'lr': 8.478482376228277e-05, 'n_layers_freeze': 5, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 0.998
Batch: 5/29	Loss: 0.913
Batch: 7/29	Loss: 0.892
Batch: 9/29	Loss: 0.863
Batch: 11/29	Loss: 0.866
Batch: 13/29	Loss: 0.847
Batch: 15/29	Loss: 0.885
Batch: 17/29	Loss: 0.810
Batch: 19/29	Loss: 0.829
Batch: 21/29	Loss: 0.781
Batch: 23/29	Loss: 0.816
Batch: 25/29	Loss: 0.749
Batch: 27/29	Loss: 0.763
Batch: 29/29	Loss: 0.788
Epoch: 1	Train Loss: 0.855	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.185

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.769
Batch: 3/29	Loss: 0.778
Batch: 5/29	Loss: 0.848
Batch: 7/29	Loss: 0.759
Batch: 9/29	Loss: 0.806
Batch: 11/29	Loss: 0.720
Batch: 13/29	Loss: 0.734
Batch: 15/29	Loss: 0.764
Batch: 17/29	Loss: 0.765
Batch: 19/29	Loss: 0.846
Batch: 21/29	Loss: 0.747
Batch: 23/29	Loss: 0.760
Batch: 25/29	Loss: 0.730
Batch: 27/29	Loss: 0.848
Batch: 29/29	Loss: 0.729
Epoch: 2	Train Loss: 0.765	Val F1: 0.316
Best Epoch: 2	Best Val F1: 0.316

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.711
Batch: 3/29	Loss: 0.746
Batch: 5/29	Loss: 0.724
Batch: 7/29	Loss: 0.803
Batch: 9/29	Loss: 0.679
Batch: 11/29	Loss: 0.707
Batch: 13/29	Loss: 0.768
Batch: 15/29	Loss: 0.758
Batch: 17/29	Loss: 0.740
Batch: 19/29	Loss: 0.767
Batch: 21/29	Loss: 0.685
Batch: 23/29	Loss: 0.669
Batch: 25/29	Loss: 0.719
Batch: 27/29	Loss: 0.689
Batch: 29/29	Loss: 0.709
Epoch: 3	Train Loss: 0.728	Val F1: 0.323
Best Epoch: 3	Best Val F1: 0.323

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.673
Batch: 3/29	Loss: 0.675
Batch: 5/29	Loss: 0.692
Batch: 7/29	Loss: 0.742
Batch: 9/29	Loss: 0.688
Batch: 11/29	Loss: 0.600
Batch: 13/29	Loss: 0.617
Batch: 15/29	Loss: 0.660
Batch: 17/29	Loss: 0.660
Batch: 19/29	Loss: 0.738
Batch: 21/29	Loss: 0.684
Batch: 23/29	Loss: 0.684
Batch: 25/29	Loss: 0.658
Batch: 27/29	Loss: 0.681
Batch: 29/29	Loss: 0.633
Epoch: 4	Train Loss: 0.676	Val F1: 0.336
Best Epoch: 4	Best Val F1: 0.336

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.604
Batch: 3/29	Loss: 0.605
Batch: 5/29	Loss: 0.535
Batch: 7/29	Loss: 0.604
Batch: 9/29	Loss: 0.559
Batch: 11/29	Loss: 0.546
Batch: 13/29	Loss: 0.664
Batch: 15/29	Loss: 0.644
Batch: 17/29	Loss: 0.760
Batch: 19/29	Loss: 0.633
Batch: 21/29	Loss: 0.590
Batch: 23/29	Loss: 0.650
Batch: 25/29	Loss: 0.626
Batch: 27/29	Loss: 0.615
Batch: 29/29	Loss: 0.669
Epoch: 5	Train Loss: 0.631	Val F1: 0.303
Best Epoch: 4	Best Val F1: 0.336

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.630
Batch: 3/29	Loss: 0.653
Batch: 5/29	Loss: 0.510
Batch: 7/29	Loss: 0.646
Batch: 9/29	Loss: 0.531
Batch: 11/29	Loss: 0.587
Batch: 13/29	Loss: 0.528
Batch: 15/29	Loss: 0.523
Batch: 17/29	Loss: 0.537
Batch: 19/29	Loss: 0.528
Batch: 21/29	Loss: 0.614
Batch: 23/29	Loss: 0.622
Batch: 25/29	Loss: 0.571
Batch: 27/29	Loss: 0.567
Batch: 29/29	Loss: 0.520
Epoch: 6	Train Loss: 0.559	Val F1: 0.359
Best Epoch: 6	Best Val F1: 0.359

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.445
Batch: 3/29	Loss: 0.536
Batch: 5/29	Loss: 0.640
Batch: 7/29	Loss: 0.575
Batch: 9/29	Loss: 0.555
Batch: 11/29	Loss: 0.409
Batch: 13/29	Loss: 0.484
Batch: 15/29	Loss: 0.460
Batch: 17/29	Loss: 0.543
Batch: 19/29	Loss: 0.555
Batch: 21/29	Loss: 0.483
Batch: 23/29	Loss: 0.457
Batch: 25/29	Loss: 0.426
Batch: 27/29	Loss: 0.466
Batch: 29/29	Loss: 0.447
Epoch: 7	Train Loss: 0.495	Val F1: 0.353
Best Epoch: 6	Best Val F1: 0.359

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.463
Batch: 3/29	Loss: 0.392
Batch: 5/29	Loss: 0.467
Batch: 7/29	Loss: 0.451
Batch: 9/29	Loss: 0.366
Batch: 11/29	Loss: 0.473
Batch: 13/29	Loss: 0.541
Batch: 15/29	Loss: 0.428
Batch: 17/29	Loss: 0.545
Batch: 19/29	Loss: 0.372
Batch: 21/29	Loss: 0.434
Batch: 23/29	Loss: 0.573
Batch: 25/29	Loss: 0.571
Batch: 27/29	Loss: 0.465
Batch: 29/29	Loss: 0.466
Epoch: 8	Train Loss: 0.454	Val F1: 0.332
Best Epoch: 6	Best Val F1: 0.359

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.505
Batch: 3/29	Loss: 0.439
Batch: 5/29	Loss: 0.448
Batch: 7/29	Loss: 0.322
Batch: 9/29	Loss: 0.423
Batch: 11/29	Loss: 0.421
Batch: 13/29	Loss: 0.340
Batch: 15/29	Loss: 0.339
Batch: 17/29	Loss: 0.392
Batch: 19/29	Loss: 0.313
Batch: 21/29	Loss: 0.450
Batch: 23/29	Loss: 0.348
Batch: 25/29	Loss: 0.350
Batch: 27/29	Loss: 0.415
Batch: 29/29	Loss: 0.298
Epoch: 9	Train Loss: 0.393	Val F1: 0.341
Best Epoch: 6	Best Val F1: 0.359

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.300
Batch: 3/29	Loss: 0.347
Batch: 5/29	Loss: 0.321
Batch: 7/29	Loss: 0.330
Batch: 9/29	Loss: 0.317
Batch: 11/29	Loss: 0.302
Batch: 13/29	Loss: 0.388
Batch: 15/29	Loss: 0.333
Batch: 17/29	Loss: 0.435
Batch: 19/29	Loss: 0.236
Batch: 21/29	Loss: 0.398
Batch: 23/29	Loss: 0.464
Batch: 25/29	Loss: 0.502
Batch: 27/29	Loss: 0.350
Batch: 29/29	Loss: 0.454
Epoch: 10	Train Loss: 0.355	Val F1: 0.350
Best Epoch: 6	Best Val F1: 0.359

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.330
Batch: 3/29	Loss: 0.257
Batch: 5/29	Loss: 0.515
Batch: 7/29	Loss: 0.319
Batch: 9/29	Loss: 0.312
Batch: 11/29	Loss: 0.395
Batch: 13/29	Loss: 0.319
Batch: 15/29	Loss: 0.307
Batch: 17/29	Loss: 0.298
Batch: 19/29	Loss: 0.324
Batch: 21/29	Loss: 0.253
Batch: 23/29	Loss: 0.274
Batch: 25/29	Loss: 0.283
Batch: 27/29	Loss: 0.364
Batch: 29/29	Loss: 0.309
Epoch: 11	Train Loss: 0.331	Val F1: 0.324
Best Epoch: 6	Best Val F1: 0.359

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.322
Batch: 3/29	Loss: 0.281
Batch: 5/29	Loss: 0.278
Batch: 7/29	Loss: 0.280
Batch: 9/29	Loss: 0.302
Batch: 11/29	Loss: 0.291
Batch: 13/29	Loss: 0.334
Batch: 15/29	Loss: 0.305
Batch: 17/29	Loss: 0.242
Batch: 19/29	Loss: 0.244
Batch: 21/29	Loss: 0.280
Batch: 23/29	Loss: 0.298
Batch: 25/29	Loss: 0.217
Batch: 27/29	Loss: 0.362
Batch: 29/29	Loss: 0.261
Epoch: 12	Train Loss: 0.290	Val F1: 0.341
Best Epoch: 6	Best Val F1: 0.359

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.218
Batch: 3/29	Loss: 0.164
Batch: 5/29	Loss: 0.228
Batch: 7/29	Loss: 0.187
Batch: 9/29	Loss: 0.247
Batch: 11/29	Loss: 0.240
Batch: 13/29	Loss: 0.241
Batch: 15/29	Loss: 0.256
Batch: 17/29	Loss: 0.217
Batch: 19/29	Loss: 0.186
Batch: 21/29	Loss: 0.203
Batch: 23/29	Loss: 0.241
Batch: 25/29	Loss: 0.204
Batch: 27/29	Loss: 0.236
Batch: 29/29	Loss: 0.250
Epoch: 13	Train Loss: 0.242	Val F1: 0.328
Best Epoch: 6	Best Val F1: 0.359

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.256
Batch: 3/29	Loss: 0.239
Batch: 5/29	Loss: 0.209
Batch: 7/29	Loss: 0.217
Batch: 9/29	Loss: 0.245
Batch: 11/29	Loss: 0.207
Batch: 13/29	Loss: 0.189
Batch: 15/29	Loss: 0.174
Batch: 17/29	Loss: 0.222
Batch: 19/29	Loss: 0.242
Batch: 21/29	Loss: 0.132
Batch: 23/29	Loss: 0.181
Batch: 25/29	Loss: 0.219
Batch: 27/29	Loss: 0.184
Batch: 29/29	Loss: 0.157
Epoch: 14	Train Loss: 0.204	Val F1: 0.328
Best Epoch: 6	Best Val F1: 0.359

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.185
Batch: 3/29	Loss: 0.197
Batch: 5/29	Loss: 0.089
Batch: 7/29	Loss: 0.205
Batch: 9/29	Loss: 0.190
Batch: 11/29	Loss: 0.197
Batch: 13/29	Loss: 0.206
Batch: 15/29	Loss: 0.162
Batch: 17/29	Loss: 0.247
Batch: 19/29	Loss: 0.156
Batch: 21/29	Loss: 0.202
Batch: 23/29	Loss: 0.204
Batch: 25/29	Loss: 0.198
Batch: 27/29	Loss: 0.243
Batch: 29/29	Loss: 0.158
Epoch: 15	Train Loss: 0.184	Val F1: 0.344
Best Epoch: 6	Best Val F1: 0.359

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.194
Batch: 3/29	Loss: 0.132
Batch: 5/29	Loss: 0.185
Batch: 7/29	Loss: 0.153
Batch: 9/29	Loss: 0.251
Batch: 11/29	Loss: 0.088
Batch: 13/29	Loss: 0.139
Batch: 15/29	Loss: 0.139
Batch: 17/29	Loss: 0.122
Batch: 19/29	Loss: 0.146
Batch: 21/29	Loss: 0.137
Batch: 23/29	Loss: 0.114
Batch: 25/29	Loss: 0.172
Batch: 27/29	Loss: 0.139
Batch: 29/29	Loss: 0.096
Epoch: 16	Train Loss: 0.150	Val F1: 0.348
Best Epoch: 6	Best Val F1: 0.359

Saving the best checkpoint....
Inference...
Test F1: 0.375	Test F1_Few: 0.449	Test F1_Zero: 0.370
Starting training with config: {'batch_size': 64, 'epochs': 25, 'l2_reg': 0.0008360079436908452, 'lr': 9.06024786291994e-05, 'n_layers_freeze': 10, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.030
Batch: 5/29	Loss: 0.964
Batch: 7/29	Loss: 0.918
Batch: 9/29	Loss: 0.880
Batch: 11/29	Loss: 0.873
Batch: 13/29	Loss: 0.856
Batch: 15/29	Loss: 0.888
Batch: 17/29	Loss: 0.805
Batch: 19/29	Loss: 0.824
Batch: 21/29	Loss: 0.770
Batch: 23/29	Loss: 0.818
Batch: 25/29	Loss: 0.746
Batch: 27/29	Loss: 0.750
Batch: 29/29	Loss: 0.779
Epoch: 1	Train Loss: 0.862	Val F1: 0.220
Best Epoch: 1	Best Val F1: 0.220

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.763
Batch: 3/29	Loss: 0.770
Batch: 5/29	Loss: 0.845
Batch: 7/29	Loss: 0.753
Batch: 9/29	Loss: 0.799
Batch: 11/29	Loss: 0.712
Batch: 13/29	Loss: 0.721
Batch: 15/29	Loss: 0.749
Batch: 17/29	Loss: 0.739
Batch: 19/29	Loss: 0.834
Batch: 21/29	Loss: 0.720
Batch: 23/29	Loss: 0.721
Batch: 25/29	Loss: 0.710
Batch: 27/29	Loss: 0.832
Batch: 29/29	Loss: 0.694
Epoch: 2	Train Loss: 0.749	Val F1: 0.304
Best Epoch: 2	Best Val F1: 0.304

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.643
Batch: 3/29	Loss: 0.688
Batch: 5/29	Loss: 0.690
Batch: 7/29	Loss: 0.773
Batch: 9/29	Loss: 0.640
Batch: 11/29	Loss: 0.710
Batch: 13/29	Loss: 0.802
Batch: 15/29	Loss: 0.696
Batch: 17/29	Loss: 0.718
Batch: 19/29	Loss: 0.706
Batch: 21/29	Loss: 0.635
Batch: 23/29	Loss: 0.624
Batch: 25/29	Loss: 0.695
Batch: 27/29	Loss: 0.686
Batch: 29/29	Loss: 0.665
Epoch: 3	Train Loss: 0.692	Val F1: 0.315
Best Epoch: 3	Best Val F1: 0.315

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.649
Batch: 3/29	Loss: 0.625
Batch: 5/29	Loss: 0.704
Batch: 7/29	Loss: 0.716
Batch: 9/29	Loss: 0.652
Batch: 11/29	Loss: 0.556
Batch: 13/29	Loss: 0.594
Batch: 15/29	Loss: 0.641
Batch: 17/29	Loss: 0.601
Batch: 19/29	Loss: 0.700
Batch: 21/29	Loss: 0.656
Batch: 23/29	Loss: 0.634
Batch: 25/29	Loss: 0.547
Batch: 27/29	Loss: 0.603
Batch: 29/29	Loss: 0.621
Epoch: 4	Train Loss: 0.640	Val F1: 0.323
Best Epoch: 4	Best Val F1: 0.323

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.545
Batch: 3/29	Loss: 0.575
Batch: 5/29	Loss: 0.536
Batch: 7/29	Loss: 0.586
Batch: 9/29	Loss: 0.536
Batch: 11/29	Loss: 0.535
Batch: 13/29	Loss: 0.567
Batch: 15/29	Loss: 0.618
Batch: 17/29	Loss: 0.626
Batch: 19/29	Loss: 0.604
Batch: 21/29	Loss: 0.595
Batch: 23/29	Loss: 0.586
Batch: 25/29	Loss: 0.578
Batch: 27/29	Loss: 0.543
Batch: 29/29	Loss: 0.639
Epoch: 5	Train Loss: 0.585	Val F1: 0.312
Best Epoch: 4	Best Val F1: 0.323

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.593
Batch: 3/29	Loss: 0.590
Batch: 5/29	Loss: 0.479
Batch: 7/29	Loss: 0.634
Batch: 9/29	Loss: 0.517
Batch: 11/29	Loss: 0.523
Batch: 13/29	Loss: 0.490
Batch: 15/29	Loss: 0.539
Batch: 17/29	Loss: 0.518
Batch: 19/29	Loss: 0.477
Batch: 21/29	Loss: 0.611
Batch: 23/29	Loss: 0.547
Batch: 25/29	Loss: 0.615
Batch: 27/29	Loss: 0.619
Batch: 29/29	Loss: 0.451
Epoch: 6	Train Loss: 0.538	Val F1: 0.329
Best Epoch: 6	Best Val F1: 0.329

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.406
Batch: 3/29	Loss: 0.537
Batch: 5/29	Loss: 0.599
Batch: 7/29	Loss: 0.572
Batch: 9/29	Loss: 0.475
Batch: 11/29	Loss: 0.478
Batch: 13/29	Loss: 0.486
Batch: 15/29	Loss: 0.493
Batch: 17/29	Loss: 0.578
Batch: 19/29	Loss: 0.546
Batch: 21/29	Loss: 0.483
Batch: 23/29	Loss: 0.424
Batch: 25/29	Loss: 0.423
Batch: 27/29	Loss: 0.442
Batch: 29/29	Loss: 0.418
Epoch: 7	Train Loss: 0.480	Val F1: 0.322
Best Epoch: 6	Best Val F1: 0.329

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.387
Batch: 3/29	Loss: 0.459
Batch: 5/29	Loss: 0.452
Batch: 7/29	Loss: 0.442
Batch: 9/29	Loss: 0.415
Batch: 11/29	Loss: 0.459
Batch: 13/29	Loss: 0.417
Batch: 15/29	Loss: 0.443
Batch: 17/29	Loss: 0.485
Batch: 19/29	Loss: 0.454
Batch: 21/29	Loss: 0.444
Batch: 23/29	Loss: 0.458
Batch: 25/29	Loss: 0.479
Batch: 27/29	Loss: 0.418
Batch: 29/29	Loss: 0.474
Epoch: 8	Train Loss: 0.435	Val F1: 0.309
Best Epoch: 6	Best Val F1: 0.329

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.419
Batch: 3/29	Loss: 0.434
Batch: 5/29	Loss: 0.423
Batch: 7/29	Loss: 0.332
Batch: 9/29	Loss: 0.500
Batch: 11/29	Loss: 0.370
Batch: 13/29	Loss: 0.365
Batch: 15/29	Loss: 0.369
Batch: 17/29	Loss: 0.444
Batch: 19/29	Loss: 0.320
Batch: 21/29	Loss: 0.519
Batch: 23/29	Loss: 0.410
Batch: 25/29	Loss: 0.412
Batch: 27/29	Loss: 0.383
Batch: 29/29	Loss: 0.256
Epoch: 9	Train Loss: 0.405	Val F1: 0.322
Best Epoch: 6	Best Val F1: 0.329

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.348
Batch: 3/29	Loss: 0.381
Batch: 5/29	Loss: 0.352
Batch: 7/29	Loss: 0.410
Batch: 9/29	Loss: 0.311
Batch: 11/29	Loss: 0.295
Batch: 13/29	Loss: 0.462
Batch: 15/29	Loss: 0.345
Batch: 17/29	Loss: 0.384
Batch: 19/29	Loss: 0.269
Batch: 21/29	Loss: 0.392
Batch: 23/29	Loss: 0.444
Batch: 25/29	Loss: 0.446
Batch: 27/29	Loss: 0.361
Batch: 29/29	Loss: 0.436
Epoch: 10	Train Loss: 0.365	Val F1: 0.317
Best Epoch: 6	Best Val F1: 0.329

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.327
Batch: 3/29	Loss: 0.296
Batch: 5/29	Loss: 0.450
Batch: 7/29	Loss: 0.352
Batch: 9/29	Loss: 0.309
Batch: 11/29	Loss: 0.308
Batch: 13/29	Loss: 0.289
Batch: 15/29	Loss: 0.235
Batch: 17/29	Loss: 0.299
Batch: 19/29	Loss: 0.370
Batch: 21/29	Loss: 0.256
Batch: 23/29	Loss: 0.308
Batch: 25/29	Loss: 0.246
Batch: 27/29	Loss: 0.300
Batch: 29/29	Loss: 0.321
Epoch: 11	Train Loss: 0.308	Val F1: 0.320
Best Epoch: 6	Best Val F1: 0.329

Saving the best checkpoint....
Inference...
Test F1: 0.351	Test F1_Few: 0.409	Test F1_Zero: 0.354
Starting training with config: {'batch_size': 16, 'epochs': 50, 'l2_reg': 0.000629828681583051, 'lr': 2.9576589715743963e-05, 'n_layers_freeze': 1, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 0.947
Batch: 23/116	Loss: 0.883
Batch: 34/116	Loss: 0.863
Batch: 45/116	Loss: 0.819
Batch: 56/116	Loss: 0.826
Batch: 67/116	Loss: 0.762
Batch: 78/116	Loss: 0.770
Batch: 89/116	Loss: 0.876
Batch: 100/116	Loss: 0.740
Batch: 111/116	Loss: 0.765
Batch: 116/116	Loss: 0.746
Epoch: 1	Train Loss: 0.834	Val F1: 0.292
Best Epoch: 1	Best Val F1: 0.292

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.815
Batch: 12/116	Loss: 0.768
Batch: 23/116	Loss: 0.704
Batch: 34/116	Loss: 0.737
Batch: 45/116	Loss: 0.764
Batch: 56/116	Loss: 0.707
Batch: 67/116	Loss: 0.722
Batch: 78/116	Loss: 0.721
Batch: 89/116	Loss: 0.669
Batch: 100/116	Loss: 0.681
Batch: 111/116	Loss: 0.692
Batch: 116/116	Loss: 0.612
Epoch: 2	Train Loss: 0.736	Val F1: 0.339
Best Epoch: 2	Best Val F1: 0.339

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.636
Batch: 12/116	Loss: 0.541
Batch: 23/116	Loss: 0.625
Batch: 34/116	Loss: 0.709
Batch: 45/116	Loss: 0.738
Batch: 56/116	Loss: 0.708
Batch: 67/116	Loss: 0.604
Batch: 78/116	Loss: 0.647
Batch: 89/116	Loss: 0.713
Batch: 100/116	Loss: 0.864
Batch: 111/116	Loss: 0.906
Batch: 116/116	Loss: 0.716
Epoch: 3	Train Loss: 0.682	Val F1: 0.303
Best Epoch: 2	Best Val F1: 0.339

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.721
Batch: 12/116	Loss: 0.527
Batch: 23/116	Loss: 0.771
Batch: 34/116	Loss: 0.493
Batch: 45/116	Loss: 0.627
Batch: 56/116	Loss: 0.651
Batch: 67/116	Loss: 0.804
Batch: 78/116	Loss: 0.544
Batch: 89/116	Loss: 0.654
Batch: 100/116	Loss: 0.597
Batch: 111/116	Loss: 0.687
Batch: 116/116	Loss: 0.686
Epoch: 4	Train Loss: 0.631	Val F1: 0.309
Best Epoch: 2	Best Val F1: 0.339

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.390
Batch: 12/116	Loss: 0.525
Batch: 23/116	Loss: 0.497
Batch: 34/116	Loss: 0.613
Batch: 45/116	Loss: 0.644
Batch: 56/116	Loss: 0.494
Batch: 67/116	Loss: 0.587
Batch: 78/116	Loss: 0.661
Batch: 89/116	Loss: 0.658
Batch: 100/116	Loss: 0.617
Batch: 111/116	Loss: 0.571
Batch: 116/116	Loss: 0.464
Epoch: 5	Train Loss: 0.562	Val F1: 0.351
Best Epoch: 5	Best Val F1: 0.351

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.481
Batch: 12/116	Loss: 0.709
Batch: 23/116	Loss: 0.348
Batch: 34/116	Loss: 0.519
Batch: 45/116	Loss: 0.376
Batch: 56/116	Loss: 0.578
Batch: 67/116	Loss: 0.473
Batch: 78/116	Loss: 0.604
Batch: 89/116	Loss: 0.758
Batch: 100/116	Loss: 0.482
Batch: 111/116	Loss: 0.564
Batch: 116/116	Loss: 0.164
Epoch: 6	Train Loss: 0.476	Val F1: 0.348
Best Epoch: 5	Best Val F1: 0.351

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.368
Batch: 12/116	Loss: 0.653
Batch: 23/116	Loss: 0.568
Batch: 34/116	Loss: 0.633
Batch: 45/116	Loss: 0.313
Batch: 56/116	Loss: 0.776
Batch: 67/116	Loss: 0.416
Batch: 78/116	Loss: 0.493
Batch: 89/116	Loss: 0.293
Batch: 100/116	Loss: 0.302
Batch: 111/116	Loss: 0.676
Batch: 116/116	Loss: 0.119
Epoch: 7	Train Loss: 0.412	Val F1: 0.341
Best Epoch: 5	Best Val F1: 0.351

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.380
Batch: 12/116	Loss: 0.468
Batch: 23/116	Loss: 0.252
Batch: 34/116	Loss: 0.287
Batch: 45/116	Loss: 0.352
Batch: 56/116	Loss: 0.210
Batch: 67/116	Loss: 0.513
Batch: 78/116	Loss: 0.338
Batch: 89/116	Loss: 0.211
Batch: 100/116	Loss: 0.455
Batch: 111/116	Loss: 0.270
Batch: 116/116	Loss: 0.370
Epoch: 8	Train Loss: 0.347	Val F1: 0.350
Best Epoch: 5	Best Val F1: 0.351

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.237
Batch: 12/116	Loss: 0.454
Batch: 23/116	Loss: 0.327
Batch: 34/116	Loss: 0.300
Batch: 45/116	Loss: 0.336
Batch: 56/116	Loss: 0.388
Batch: 67/116	Loss: 0.281
Batch: 78/116	Loss: 0.423
Batch: 89/116	Loss: 0.199
Batch: 100/116	Loss: 0.284
Batch: 111/116	Loss: 0.206
Batch: 116/116	Loss: 0.368
Epoch: 9	Train Loss: 0.317	Val F1: 0.355
Best Epoch: 9	Best Val F1: 0.355

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.319
Batch: 12/116	Loss: 0.226
Batch: 23/116	Loss: 0.204
Batch: 34/116	Loss: 0.326
Batch: 45/116	Loss: 0.156
Batch: 56/116	Loss: 0.286
Batch: 67/116	Loss: 0.301
Batch: 78/116	Loss: 0.253
Batch: 89/116	Loss: 0.190
Batch: 100/116	Loss: 0.351
Batch: 111/116	Loss: 0.143
Batch: 116/116	Loss: 0.204
Epoch: 10	Train Loss: 0.274	Val F1: 0.345
Best Epoch: 9	Best Val F1: 0.355

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.271
Batch: 12/116	Loss: 0.246
Batch: 23/116	Loss: 0.117
Batch: 34/116	Loss: 0.172
Batch: 45/116	Loss: 0.234
Batch: 56/116	Loss: 0.200
Batch: 67/116	Loss: 0.212
Batch: 78/116	Loss: 0.170
Batch: 89/116	Loss: 0.110
Batch: 100/116	Loss: 0.252
Batch: 111/116	Loss: 0.239
Batch: 116/116	Loss: 0.068
Epoch: 11	Train Loss: 0.235	Val F1: 0.334
Best Epoch: 9	Best Val F1: 0.355

****************************** Epoch: 12 ******************************
Batch: 1/116	Loss: 0.192
Batch: 12/116	Loss: 0.158
Batch: 23/116	Loss: 0.112
Batch: 34/116	Loss: 0.215
Batch: 45/116	Loss: 0.115
Batch: 56/116	Loss: 0.186
Batch: 67/116	Loss: 0.083
Batch: 78/116	Loss: 0.212
Batch: 89/116	Loss: 0.179
Batch: 100/116	Loss: 0.209
Batch: 111/116	Loss: 0.136
Batch: 116/116	Loss: 0.025
Epoch: 12	Train Loss: 0.187	Val F1: 0.346
Best Epoch: 9	Best Val F1: 0.355

****************************** Epoch: 13 ******************************
Batch: 1/116	Loss: 0.151
Batch: 12/116	Loss: 0.125
Batch: 23/116	Loss: 0.133
Batch: 34/116	Loss: 0.049
Batch: 45/116	Loss: 0.393
Batch: 56/116	Loss: 0.176
Batch: 67/116	Loss: 0.054
Batch: 78/116	Loss: 0.136
Batch: 89/116	Loss: 0.116
Batch: 100/116	Loss: 0.201
Batch: 111/116	Loss: 0.141
Batch: 116/116	Loss: 0.168
Epoch: 13	Train Loss: 0.151	Val F1: 0.332
Best Epoch: 9	Best Val F1: 0.355

****************************** Epoch: 14 ******************************
Batch: 1/116	Loss: 0.251
Batch: 12/116	Loss: 0.150
Batch: 23/116	Loss: 0.058
Batch: 34/116	Loss: 0.060
Batch: 45/116	Loss: 0.173
Batch: 56/116	Loss: 0.165
Batch: 67/116	Loss: 0.174
Batch: 78/116	Loss: 0.089
Batch: 89/116	Loss: 0.062
Batch: 100/116	Loss: 0.056
Batch: 111/116	Loss: 0.106
Batch: 116/116	Loss: 0.113
Epoch: 14	Train Loss: 0.116	Val F1: 0.347
Best Epoch: 9	Best Val F1: 0.355

Saving the best checkpoint....
Inference...
Test F1: 0.387	Test F1_Few: 0.391	Test F1_Zero: 0.378
Starting training with config: {'batch_size': 64, 'epochs': 75, 'l2_reg': 2.3826127995902165e-05, 'lr': 3.3886300530687576e-05, 'n_layers_freeze': 4, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.051
Batch: 5/29	Loss: 0.999
Batch: 7/29	Loss: 0.969
Batch: 9/29	Loss: 0.938
Batch: 11/29	Loss: 0.931
Batch: 13/29	Loss: 0.918
Batch: 15/29	Loss: 0.930
Batch: 17/29	Loss: 0.879
Batch: 19/29	Loss: 0.883
Batch: 21/29	Loss: 0.854
Batch: 23/29	Loss: 0.871
Batch: 25/29	Loss: 0.828
Batch: 27/29	Loss: 0.827
Batch: 29/29	Loss: 0.839
Epoch: 1	Train Loss: 0.918	Val F1: 0.195
Best Epoch: 1	Best Val F1: 0.195

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.829
Batch: 3/29	Loss: 0.828
Batch: 5/29	Loss: 0.868
Batch: 7/29	Loss: 0.813
Batch: 9/29	Loss: 0.836
Batch: 11/29	Loss: 0.780
Batch: 13/29	Loss: 0.783
Batch: 15/29	Loss: 0.808
Batch: 17/29	Loss: 0.800
Batch: 19/29	Loss: 0.846
Batch: 21/29	Loss: 0.784
Batch: 23/29	Loss: 0.797
Batch: 25/29	Loss: 0.766
Batch: 27/29	Loss: 0.845
Batch: 29/29	Loss: 0.771
Epoch: 2	Train Loss: 0.805	Val F1: 0.209
Best Epoch: 2	Best Val F1: 0.209

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.757
Batch: 3/29	Loss: 0.789
Batch: 5/29	Loss: 0.770
Batch: 7/29	Loss: 0.814
Batch: 9/29	Loss: 0.748
Batch: 11/29	Loss: 0.750
Batch: 13/29	Loss: 0.804
Batch: 15/29	Loss: 0.768
Batch: 17/29	Loss: 0.788
Batch: 19/29	Loss: 0.774
Batch: 21/29	Loss: 0.742
Batch: 23/29	Loss: 0.730
Batch: 25/29	Loss: 0.771
Batch: 27/29	Loss: 0.743
Batch: 29/29	Loss: 0.744
Epoch: 3	Train Loss: 0.768	Val F1: 0.309
Best Epoch: 3	Best Val F1: 0.309

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.706
Batch: 3/29	Loss: 0.725
Batch: 5/29	Loss: 0.715
Batch: 7/29	Loss: 0.774
Batch: 9/29	Loss: 0.725
Batch: 11/29	Loss: 0.664
Batch: 13/29	Loss: 0.694
Batch: 15/29	Loss: 0.663
Batch: 17/29	Loss: 0.682
Batch: 19/29	Loss: 0.722
Batch: 21/29	Loss: 0.717
Batch: 23/29	Loss: 0.699
Batch: 25/29	Loss: 0.678
Batch: 27/29	Loss: 0.720
Batch: 29/29	Loss: 0.694
Epoch: 4	Train Loss: 0.710	Val F1: 0.342
Best Epoch: 4	Best Val F1: 0.342

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.645
Batch: 3/29	Loss: 0.617
Batch: 5/29	Loss: 0.602
Batch: 7/29	Loss: 0.642
Batch: 9/29	Loss: 0.585
Batch: 11/29	Loss: 0.607
Batch: 13/29	Loss: 0.654
Batch: 15/29	Loss: 0.676
Batch: 17/29	Loss: 0.742
Batch: 19/29	Loss: 0.709
Batch: 21/29	Loss: 0.639
Batch: 23/29	Loss: 0.635
Batch: 25/29	Loss: 0.650
Batch: 27/29	Loss: 0.639
Batch: 29/29	Loss: 0.659
Epoch: 5	Train Loss: 0.657	Val F1: 0.347
Best Epoch: 5	Best Val F1: 0.347

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.625
Batch: 3/29	Loss: 0.686
Batch: 5/29	Loss: 0.525
Batch: 7/29	Loss: 0.696
Batch: 9/29	Loss: 0.616
Batch: 11/29	Loss: 0.591
Batch: 13/29	Loss: 0.567
Batch: 15/29	Loss: 0.539
Batch: 17/29	Loss: 0.567
Batch: 19/29	Loss: 0.526
Batch: 21/29	Loss: 0.666
Batch: 23/29	Loss: 0.649
Batch: 25/29	Loss: 0.632
Batch: 27/29	Loss: 0.627
Batch: 29/29	Loss: 0.580
Epoch: 6	Train Loss: 0.599	Val F1: 0.338
Best Epoch: 5	Best Val F1: 0.347

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.538
Batch: 3/29	Loss: 0.601
Batch: 5/29	Loss: 0.648
Batch: 7/29	Loss: 0.562
Batch: 9/29	Loss: 0.559
Batch: 11/29	Loss: 0.441
Batch: 13/29	Loss: 0.536
Batch: 15/29	Loss: 0.536
Batch: 17/29	Loss: 0.580
Batch: 19/29	Loss: 0.581
Batch: 21/29	Loss: 0.572
Batch: 23/29	Loss: 0.512
Batch: 25/29	Loss: 0.458
Batch: 27/29	Loss: 0.516
Batch: 29/29	Loss: 0.501
Epoch: 7	Train Loss: 0.543	Val F1: 0.355
Best Epoch: 7	Best Val F1: 0.355

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.514
Batch: 3/29	Loss: 0.430
Batch: 5/29	Loss: 0.586
Batch: 7/29	Loss: 0.531
Batch: 9/29	Loss: 0.475
Batch: 11/29	Loss: 0.551
Batch: 13/29	Loss: 0.539
Batch: 15/29	Loss: 0.487
Batch: 17/29	Loss: 0.500
Batch: 19/29	Loss: 0.417
Batch: 21/29	Loss: 0.481
Batch: 23/29	Loss: 0.509
Batch: 25/29	Loss: 0.574
Batch: 27/29	Loss: 0.559
Batch: 29/29	Loss: 0.472
Epoch: 8	Train Loss: 0.499	Val F1: 0.339
Best Epoch: 7	Best Val F1: 0.355

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.578
Batch: 3/29	Loss: 0.513
Batch: 5/29	Loss: 0.513
Batch: 7/29	Loss: 0.368
Batch: 9/29	Loss: 0.487
Batch: 11/29	Loss: 0.441
Batch: 13/29	Loss: 0.416
Batch: 15/29	Loss: 0.408
Batch: 17/29	Loss: 0.464
Batch: 19/29	Loss: 0.384
Batch: 21/29	Loss: 0.512
Batch: 23/29	Loss: 0.470
Batch: 25/29	Loss: 0.457
Batch: 27/29	Loss: 0.481
Batch: 29/29	Loss: 0.323
Epoch: 9	Train Loss: 0.456	Val F1: 0.343
Best Epoch: 7	Best Val F1: 0.355

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.331
Batch: 3/29	Loss: 0.418
Batch: 5/29	Loss: 0.405
Batch: 7/29	Loss: 0.494
Batch: 9/29	Loss: 0.365
Batch: 11/29	Loss: 0.401
Batch: 13/29	Loss: 0.447
Batch: 15/29	Loss: 0.421
Batch: 17/29	Loss: 0.492
Batch: 19/29	Loss: 0.304
Batch: 21/29	Loss: 0.522
Batch: 23/29	Loss: 0.504
Batch: 25/29	Loss: 0.546
Batch: 27/29	Loss: 0.413
Batch: 29/29	Loss: 0.531
Epoch: 10	Train Loss: 0.425	Val F1: 0.353
Best Epoch: 7	Best Val F1: 0.355

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.435
Batch: 3/29	Loss: 0.329
Batch: 5/29	Loss: 0.547
Batch: 7/29	Loss: 0.404
Batch: 9/29	Loss: 0.387
Batch: 11/29	Loss: 0.412
Batch: 13/29	Loss: 0.378
Batch: 15/29	Loss: 0.317
Batch: 17/29	Loss: 0.409
Batch: 19/29	Loss: 0.428
Batch: 21/29	Loss: 0.364
Batch: 23/29	Loss: 0.332
Batch: 25/29	Loss: 0.308
Batch: 27/29	Loss: 0.372
Batch: 29/29	Loss: 0.404
Epoch: 11	Train Loss: 0.396	Val F1: 0.339
Best Epoch: 7	Best Val F1: 0.355

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.438
Batch: 3/29	Loss: 0.357
Batch: 5/29	Loss: 0.335
Batch: 7/29	Loss: 0.361
Batch: 9/29	Loss: 0.379
Batch: 11/29	Loss: 0.364
Batch: 13/29	Loss: 0.370
Batch: 15/29	Loss: 0.390
Batch: 17/29	Loss: 0.364
Batch: 19/29	Loss: 0.308
Batch: 21/29	Loss: 0.331
Batch: 23/29	Loss: 0.402
Batch: 25/29	Loss: 0.342
Batch: 27/29	Loss: 0.456
Batch: 29/29	Loss: 0.287
Epoch: 12	Train Loss: 0.362	Val F1: 0.341
Best Epoch: 7	Best Val F1: 0.355

Saving the best checkpoint....
Inference...
Test F1: 0.377	Test F1_Few: 0.457	Test F1_Zero: 0.367
Starting training with config: {'batch_size': 8, 'epochs': 25, 'l2_reg': 0.00023539141838265865, 'lr': 6.871753081042246e-05, 'n_layers_freeze': 3, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/231	Loss: 1.080
Batch: 24/231	Loss: 0.823
Batch: 47/231	Loss: 0.753
Batch: 70/231	Loss: 0.764
Batch: 93/231	Loss: 0.719
Batch: 116/231	Loss: 0.869
Batch: 139/231	Loss: 0.813
Batch: 162/231	Loss: 0.868
Batch: 185/231	Loss: 0.666
Batch: 208/231	Loss: 0.690
Batch: 231/231	Loss: 0.665
Epoch: 1	Train Loss: 0.778	Val F1: 0.303
Best Epoch: 1	Best Val F1: 0.303

****************************** Epoch: 2 ******************************
Batch: 1/231	Loss: 0.808
Batch: 24/231	Loss: 0.757
Batch: 47/231	Loss: 0.901
Batch: 70/231	Loss: 0.973
Batch: 93/231	Loss: 0.751
Batch: 116/231	Loss: 0.614
Batch: 139/231	Loss: 1.081
Batch: 162/231	Loss: 0.672
Batch: 185/231	Loss: 0.627
Batch: 208/231	Loss: 0.782
Batch: 231/231	Loss: 0.723
Epoch: 2	Train Loss: 0.710	Val F1: 0.329
Best Epoch: 2	Best Val F1: 0.329

****************************** Epoch: 3 ******************************
Batch: 1/231	Loss: 0.440
Batch: 24/231	Loss: 0.691
Batch: 47/231	Loss: 0.640
Batch: 70/231	Loss: 0.533
Batch: 93/231	Loss: 0.594
Batch: 116/231	Loss: 0.433
Batch: 139/231	Loss: 0.590
Batch: 162/231	Loss: 0.547
Batch: 185/231	Loss: 0.596
Batch: 208/231	Loss: 0.558
Batch: 231/231	Loss: 0.764
Epoch: 3	Train Loss: 0.666	Val F1: 0.279
Best Epoch: 2	Best Val F1: 0.329

****************************** Epoch: 4 ******************************
Batch: 1/231	Loss: 0.984
Batch: 24/231	Loss: 0.455
Batch: 47/231	Loss: 0.682
Batch: 70/231	Loss: 0.861
Batch: 93/231	Loss: 0.795
Batch: 116/231	Loss: 0.474
Batch: 139/231	Loss: 1.707
Batch: 162/231	Loss: 0.743
Batch: 185/231	Loss: 0.444
Batch: 208/231	Loss: 0.515
Batch: 231/231	Loss: 0.659
Epoch: 4	Train Loss: 0.611	Val F1: 0.341
Best Epoch: 4	Best Val F1: 0.341

****************************** Epoch: 5 ******************************
Batch: 1/231	Loss: 0.313
Batch: 24/231	Loss: 0.412
Batch: 47/231	Loss: 0.683
Batch: 70/231	Loss: 0.600
Batch: 93/231	Loss: 0.695
Batch: 116/231	Loss: 0.346
Batch: 139/231	Loss: 0.869
Batch: 162/231	Loss: 0.634
Batch: 185/231	Loss: 0.634
Batch: 208/231	Loss: 0.431
Batch: 231/231	Loss: 0.475
Epoch: 5	Train Loss: 0.559	Val F1: 0.339
Best Epoch: 4	Best Val F1: 0.341

****************************** Epoch: 6 ******************************
Batch: 1/231	Loss: 0.432
Batch: 24/231	Loss: 0.687
Batch: 47/231	Loss: 0.331
Batch: 70/231	Loss: 0.534
Batch: 93/231	Loss: 0.251
Batch: 116/231	Loss: 0.791
Batch: 139/231	Loss: 0.684
Batch: 162/231	Loss: 0.542
Batch: 185/231	Loss: 0.604
Batch: 208/231	Loss: 0.509
Batch: 231/231	Loss: 0.385
Epoch: 6	Train Loss: 0.508	Val F1: 0.335
Best Epoch: 4	Best Val F1: 0.341

****************************** Epoch: 7 ******************************
Batch: 1/231	Loss: 0.512
Batch: 24/231	Loss: 0.610
Batch: 47/231	Loss: 0.300
Batch: 70/231	Loss: 0.540
Batch: 93/231	Loss: 0.639
Batch: 116/231	Loss: 0.355
Batch: 139/231	Loss: 0.188
Batch: 162/231	Loss: 0.432
Batch: 185/231	Loss: 0.211
Batch: 208/231	Loss: 0.908
Batch: 231/231	Loss: 0.252
Epoch: 7	Train Loss: 0.443	Val F1: 0.332
Best Epoch: 4	Best Val F1: 0.341

****************************** Epoch: 8 ******************************
Batch: 1/231	Loss: 0.529
Batch: 24/231	Loss: 0.229
Batch: 47/231	Loss: 0.480
Batch: 70/231	Loss: 0.396
Batch: 93/231	Loss: 0.357
Batch: 116/231	Loss: 0.155
Batch: 139/231	Loss: 0.423
Batch: 162/231	Loss: 0.337
Batch: 185/231	Loss: 0.374
Batch: 208/231	Loss: 0.228
Batch: 231/231	Loss: 0.435
Epoch: 8	Train Loss: 0.415	Val F1: 0.339
Best Epoch: 4	Best Val F1: 0.341

****************************** Epoch: 9 ******************************
Batch: 1/231	Loss: 0.368
Batch: 24/231	Loss: 0.793
Batch: 47/231	Loss: 0.542
Batch: 70/231	Loss: 0.719
Batch: 93/231	Loss: 0.429
Batch: 116/231	Loss: 0.349
Batch: 139/231	Loss: 0.575
Batch: 162/231	Loss: 0.525
Batch: 185/231	Loss: 0.131
Batch: 208/231	Loss: 0.429
Batch: 231/231	Loss: 0.492
Epoch: 9	Train Loss: 0.366	Val F1: 0.347
Best Epoch: 9	Best Val F1: 0.347

****************************** Epoch: 10 ******************************
Batch: 1/231	Loss: 0.397
Batch: 24/231	Loss: 0.327
Batch: 47/231	Loss: 0.440
Batch: 70/231	Loss: 0.143
Batch: 93/231	Loss: 0.499
Batch: 116/231	Loss: 0.093
Batch: 139/231	Loss: 0.172
Batch: 162/231	Loss: 0.346
Batch: 185/231	Loss: 0.579
Batch: 208/231	Loss: 0.301
Batch: 231/231	Loss: 0.151
Epoch: 10	Train Loss: 0.337	Val F1: 0.338
Best Epoch: 9	Best Val F1: 0.347

****************************** Epoch: 11 ******************************
Batch: 1/231	Loss: 0.378
Batch: 24/231	Loss: 0.190
Batch: 47/231	Loss: 0.129
Batch: 70/231	Loss: 0.172
Batch: 93/231	Loss: 0.401
Batch: 116/231	Loss: 0.162
Batch: 139/231	Loss: 0.380
Batch: 162/231	Loss: 0.362
Batch: 185/231	Loss: 0.261
Batch: 208/231	Loss: 0.240
Batch: 231/231	Loss: 0.194
Epoch: 11	Train Loss: 0.306	Val F1: 0.348
Best Epoch: 11	Best Val F1: 0.348

****************************** Epoch: 12 ******************************
Batch: 1/231	Loss: 0.369
Batch: 24/231	Loss: 0.278
Batch: 47/231	Loss: 0.242
Batch: 70/231	Loss: 0.266
Batch: 93/231	Loss: 0.265
Batch: 116/231	Loss: 0.073
Batch: 139/231	Loss: 0.246
Batch: 162/231	Loss: 0.446
Batch: 185/231	Loss: 0.335
Batch: 208/231	Loss: 0.274
Batch: 231/231	Loss: 0.065
Epoch: 12	Train Loss: 0.316	Val F1: 0.340
Best Epoch: 11	Best Val F1: 0.348

****************************** Epoch: 13 ******************************
Batch: 1/231	Loss: 0.347
Batch: 24/231	Loss: 0.269
Batch: 47/231	Loss: 0.302
Batch: 70/231	Loss: 0.344
Batch: 93/231	Loss: 0.441
Batch: 116/231	Loss: 0.372
Batch: 139/231	Loss: 0.152
Batch: 162/231	Loss: 0.160
Batch: 185/231	Loss: 0.284
Batch: 208/231	Loss: 0.107
Batch: 231/231	Loss: 0.107
Epoch: 13	Train Loss: 0.301	Val F1: 0.332
Best Epoch: 11	Best Val F1: 0.348

****************************** Epoch: 14 ******************************
Batch: 1/231	Loss: 0.630
Batch: 24/231	Loss: 0.486
Batch: 47/231	Loss: 0.194
Batch: 70/231	Loss: 0.407
Batch: 93/231	Loss: 0.216
Batch: 116/231	Loss: 0.080
Batch: 139/231	Loss: 0.168
Batch: 162/231	Loss: 0.075
Batch: 185/231	Loss: 0.602
Batch: 208/231	Loss: 0.223
Batch: 231/231	Loss: 0.409
Epoch: 14	Train Loss: 0.309	Val F1: 0.337
Best Epoch: 11	Best Val F1: 0.348

****************************** Epoch: 15 ******************************
Batch: 1/231	Loss: 0.162
Batch: 24/231	Loss: 0.724
Batch: 47/231	Loss: 0.041
Batch: 70/231	Loss: 0.327
Batch: 93/231	Loss: 0.634
Batch: 116/231	Loss: 0.205
Batch: 139/231	Loss: 0.658
Batch: 162/231	Loss: 0.443
Batch: 185/231	Loss: 0.306
Batch: 208/231	Loss: 0.489
Batch: 231/231	Loss: 0.029
Epoch: 15	Train Loss: 0.309	Val F1: 0.331
Best Epoch: 11	Best Val F1: 0.348

****************************** Epoch: 16 ******************************
Batch: 1/231	Loss: 0.286
Batch: 24/231	Loss: 0.229
Batch: 47/231	Loss: 0.224
Batch: 70/231	Loss: 0.318
Batch: 93/231	Loss: 0.245
Batch: 116/231	Loss: 0.052
Batch: 139/231	Loss: 0.063
Batch: 162/231	Loss: 0.243
Batch: 185/231	Loss: 0.253
Batch: 208/231	Loss: 0.208
Batch: 231/231	Loss: 0.564
Epoch: 16	Train Loss: 0.243	Val F1: 0.343
Best Epoch: 11	Best Val F1: 0.348

Saving the best checkpoint....
Inference...
Test F1: 0.373	Test F1_Few: 0.385	Test F1_Zero: 0.360
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0004780155080393184, 'lr': 3.1108694146551966e-05, 'n_layers_freeze': 4, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.055
Batch: 5/29	Loss: 1.007
Batch: 7/29	Loss: 0.978
Batch: 9/29	Loss: 0.946
Batch: 11/29	Loss: 0.938
Batch: 13/29	Loss: 0.926
Batch: 15/29	Loss: 0.936
Batch: 17/29	Loss: 0.886
Batch: 19/29	Loss: 0.888
Batch: 21/29	Loss: 0.862
Batch: 23/29	Loss: 0.876
Batch: 25/29	Loss: 0.835
Batch: 27/29	Loss: 0.834
Batch: 29/29	Loss: 0.845
Epoch: 1	Train Loss: 0.925	Val F1: 0.194
Best Epoch: 1	Best Val F1: 0.194

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.835
Batch: 3/29	Loss: 0.834
Batch: 5/29	Loss: 0.872
Batch: 7/29	Loss: 0.820
Batch: 9/29	Loss: 0.841
Batch: 11/29	Loss: 0.786
Batch: 13/29	Loss: 0.789
Batch: 15/29	Loss: 0.814
Batch: 17/29	Loss: 0.805
Batch: 19/29	Loss: 0.849
Batch: 21/29	Loss: 0.789
Batch: 23/29	Loss: 0.802
Batch: 25/29	Loss: 0.772
Batch: 27/29	Loss: 0.847
Batch: 29/29	Loss: 0.777
Epoch: 2	Train Loss: 0.810	Val F1: 0.192
Best Epoch: 1	Best Val F1: 0.194

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.763
Batch: 3/29	Loss: 0.793
Batch: 5/29	Loss: 0.775
Batch: 7/29	Loss: 0.817
Batch: 9/29	Loss: 0.754
Batch: 11/29	Loss: 0.755
Batch: 13/29	Loss: 0.807
Batch: 15/29	Loss: 0.772
Batch: 17/29	Loss: 0.791
Batch: 19/29	Loss: 0.779
Batch: 21/29	Loss: 0.749
Batch: 23/29	Loss: 0.735
Batch: 25/29	Loss: 0.775
Batch: 27/29	Loss: 0.734
Batch: 29/29	Loss: 0.747
Epoch: 3	Train Loss: 0.772	Val F1: 0.311
Best Epoch: 3	Best Val F1: 0.311

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.715
Batch: 3/29	Loss: 0.729
Batch: 5/29	Loss: 0.714
Batch: 7/29	Loss: 0.778
Batch: 9/29	Loss: 0.731
Batch: 11/29	Loss: 0.669
Batch: 13/29	Loss: 0.715
Batch: 15/29	Loss: 0.691
Batch: 17/29	Loss: 0.682
Batch: 19/29	Loss: 0.755
Batch: 21/29	Loss: 0.722
Batch: 23/29	Loss: 0.722
Batch: 25/29	Loss: 0.708
Batch: 27/29	Loss: 0.711
Batch: 29/29	Loss: 0.703
Epoch: 4	Train Loss: 0.722	Val F1: 0.327
Best Epoch: 4	Best Val F1: 0.327

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.671
Batch: 3/29	Loss: 0.648
Batch: 5/29	Loss: 0.632
Batch: 7/29	Loss: 0.676
Batch: 9/29	Loss: 0.630
Batch: 11/29	Loss: 0.728
Batch: 13/29	Loss: 0.633
Batch: 15/29	Loss: 0.706
Batch: 17/29	Loss: 0.723
Batch: 19/29	Loss: 0.662
Batch: 21/29	Loss: 0.632
Batch: 23/29	Loss: 0.674
Batch: 25/29	Loss: 0.663
Batch: 27/29	Loss: 0.651
Batch: 29/29	Loss: 0.696
Epoch: 5	Train Loss: 0.681	Val F1: 0.357
Best Epoch: 5	Best Val F1: 0.357

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.663
Batch: 3/29	Loss: 0.722
Batch: 5/29	Loss: 0.561
Batch: 7/29	Loss: 0.719
Batch: 9/29	Loss: 0.637
Batch: 11/29	Loss: 0.598
Batch: 13/29	Loss: 0.654
Batch: 15/29	Loss: 0.552
Batch: 17/29	Loss: 0.603
Batch: 19/29	Loss: 0.555
Batch: 21/29	Loss: 0.713
Batch: 23/29	Loss: 0.653
Batch: 25/29	Loss: 0.627
Batch: 27/29	Loss: 0.608
Batch: 29/29	Loss: 0.589
Epoch: 6	Train Loss: 0.626	Val F1: 0.351
Best Epoch: 5	Best Val F1: 0.357

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.556
Batch: 3/29	Loss: 0.639
Batch: 5/29	Loss: 0.709
Batch: 7/29	Loss: 0.583
Batch: 9/29	Loss: 0.618
Batch: 11/29	Loss: 0.509
Batch: 13/29	Loss: 0.548
Batch: 15/29	Loss: 0.532
Batch: 17/29	Loss: 0.613
Batch: 19/29	Loss: 0.635
Batch: 21/29	Loss: 0.590
Batch: 23/29	Loss: 0.521
Batch: 25/29	Loss: 0.477
Batch: 27/29	Loss: 0.552
Batch: 29/29	Loss: 0.549
Epoch: 7	Train Loss: 0.573	Val F1: 0.346
Best Epoch: 5	Best Val F1: 0.357

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.505
Batch: 3/29	Loss: 0.463
Batch: 5/29	Loss: 0.579
Batch: 7/29	Loss: 0.543
Batch: 9/29	Loss: 0.501
Batch: 11/29	Loss: 0.563
Batch: 13/29	Loss: 0.536
Batch: 15/29	Loss: 0.540
Batch: 17/29	Loss: 0.552
Batch: 19/29	Loss: 0.455
Batch: 21/29	Loss: 0.517
Batch: 23/29	Loss: 0.508
Batch: 25/29	Loss: 0.580
Batch: 27/29	Loss: 0.605
Batch: 29/29	Loss: 0.497
Epoch: 8	Train Loss: 0.522	Val F1: 0.335
Best Epoch: 5	Best Val F1: 0.357

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.548
Batch: 3/29	Loss: 0.537
Batch: 5/29	Loss: 0.497
Batch: 7/29	Loss: 0.409
Batch: 9/29	Loss: 0.487
Batch: 11/29	Loss: 0.515
Batch: 13/29	Loss: 0.447
Batch: 15/29	Loss: 0.414
Batch: 17/29	Loss: 0.460
Batch: 19/29	Loss: 0.394
Batch: 21/29	Loss: 0.511
Batch: 23/29	Loss: 0.451
Batch: 25/29	Loss: 0.476
Batch: 27/29	Loss: 0.457
Batch: 29/29	Loss: 0.373
Epoch: 9	Train Loss: 0.473	Val F1: 0.352
Best Epoch: 5	Best Val F1: 0.357

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.361
Batch: 3/29	Loss: 0.456
Batch: 5/29	Loss: 0.393
Batch: 7/29	Loss: 0.508
Batch: 9/29	Loss: 0.406
Batch: 11/29	Loss: 0.372
Batch: 13/29	Loss: 0.475
Batch: 15/29	Loss: 0.481
Batch: 17/29	Loss: 0.497
Batch: 19/29	Loss: 0.322
Batch: 21/29	Loss: 0.548
Batch: 23/29	Loss: 0.500
Batch: 25/29	Loss: 0.545
Batch: 27/29	Loss: 0.426
Batch: 29/29	Loss: 0.498
Epoch: 10	Train Loss: 0.442	Val F1: 0.347
Best Epoch: 5	Best Val F1: 0.357

Saving the best checkpoint....
Inference...
Test F1: 0.375	Test F1_Few: 0.446	Test F1_Zero: 0.372
Starting training with config: {'batch_size': 8, 'epochs': 25, 'l2_reg': 2.2136677665857348e-05, 'lr': 3.168845356500972e-05, 'n_layers_freeze': 8, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/231	Loss: 1.080
Batch: 24/231	Loss: 0.883
Batch: 47/231	Loss: 0.812
Batch: 70/231	Loss: 0.800
Batch: 93/231	Loss: 0.739
Batch: 116/231	Loss: 0.874
Batch: 139/231	Loss: 0.806
Batch: 162/231	Loss: 0.867
Batch: 185/231	Loss: 0.702
Batch: 208/231	Loss: 0.732
Batch: 231/231	Loss: 0.640
Epoch: 1	Train Loss: 0.799	Val F1: 0.286
Best Epoch: 1	Best Val F1: 0.286

****************************** Epoch: 2 ******************************
Batch: 1/231	Loss: 0.742
Batch: 24/231	Loss: 0.752
Batch: 47/231	Loss: 0.766
Batch: 70/231	Loss: 0.902
Batch: 93/231	Loss: 0.724
Batch: 116/231	Loss: 0.627
Batch: 139/231	Loss: 0.995
Batch: 162/231	Loss: 0.514
Batch: 185/231	Loss: 0.779
Batch: 208/231	Loss: 0.714
Batch: 231/231	Loss: 0.619
Epoch: 2	Train Loss: 0.696	Val F1: 0.306
Best Epoch: 2	Best Val F1: 0.306

****************************** Epoch: 3 ******************************
Batch: 1/231	Loss: 0.569
Batch: 24/231	Loss: 0.545
Batch: 47/231	Loss: 0.658
Batch: 70/231	Loss: 0.614
Batch: 93/231	Loss: 0.586
Batch: 116/231	Loss: 0.415
Batch: 139/231	Loss: 0.568
Batch: 162/231	Loss: 0.585
Batch: 185/231	Loss: 0.700
Batch: 208/231	Loss: 0.647
Batch: 231/231	Loss: 0.736
Epoch: 3	Train Loss: 0.644	Val F1: 0.280
Best Epoch: 2	Best Val F1: 0.306

****************************** Epoch: 4 ******************************
Batch: 1/231	Loss: 0.860
Batch: 24/231	Loss: 0.390
Batch: 47/231	Loss: 0.583
Batch: 70/231	Loss: 0.763
Batch: 93/231	Loss: 0.648
Batch: 116/231	Loss: 0.507
Batch: 139/231	Loss: 1.321
Batch: 162/231	Loss: 0.711
Batch: 185/231	Loss: 0.399
Batch: 208/231	Loss: 0.469
Batch: 231/231	Loss: 0.623
Epoch: 4	Train Loss: 0.590	Val F1: 0.319
Best Epoch: 4	Best Val F1: 0.319

****************************** Epoch: 5 ******************************
Batch: 1/231	Loss: 0.300
Batch: 24/231	Loss: 0.597
Batch: 47/231	Loss: 0.766
Batch: 70/231	Loss: 0.637
Batch: 93/231	Loss: 0.494
Batch: 116/231	Loss: 0.321
Batch: 139/231	Loss: 0.923
Batch: 162/231	Loss: 0.729
Batch: 185/231	Loss: 0.612
Batch: 208/231	Loss: 0.316
Batch: 231/231	Loss: 0.597
Epoch: 5	Train Loss: 0.535	Val F1: 0.327
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 6 ******************************
Batch: 1/231	Loss: 0.392
Batch: 24/231	Loss: 0.646
Batch: 47/231	Loss: 0.359
Batch: 70/231	Loss: 0.439
Batch: 93/231	Loss: 0.256
Batch: 116/231	Loss: 0.844
Batch: 139/231	Loss: 0.663
Batch: 162/231	Loss: 0.660
Batch: 185/231	Loss: 0.561
Batch: 208/231	Loss: 0.439
Batch: 231/231	Loss: 0.173
Epoch: 6	Train Loss: 0.466	Val F1: 0.318
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 7 ******************************
Batch: 1/231	Loss: 0.442
Batch: 24/231	Loss: 0.588
Batch: 47/231	Loss: 0.286
Batch: 70/231	Loss: 0.477
Batch: 93/231	Loss: 0.285
Batch: 116/231	Loss: 0.439
Batch: 139/231	Loss: 0.159
Batch: 162/231	Loss: 0.484
Batch: 185/231	Loss: 0.170
Batch: 208/231	Loss: 0.556
Batch: 231/231	Loss: 0.314
Epoch: 7	Train Loss: 0.407	Val F1: 0.316
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 8 ******************************
Batch: 1/231	Loss: 0.495
Batch: 24/231	Loss: 0.312
Batch: 47/231	Loss: 0.385
Batch: 70/231	Loss: 0.337
Batch: 93/231	Loss: 0.419
Batch: 116/231	Loss: 0.510
Batch: 139/231	Loss: 0.376
Batch: 162/231	Loss: 0.277
Batch: 185/231	Loss: 0.327
Batch: 208/231	Loss: 0.143
Batch: 231/231	Loss: 0.409
Epoch: 8	Train Loss: 0.359	Val F1: 0.313
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 9 ******************************
Batch: 1/231	Loss: 0.365
Batch: 24/231	Loss: 0.382
Batch: 47/231	Loss: 0.581
Batch: 70/231	Loss: 0.773
Batch: 93/231	Loss: 0.508
Batch: 116/231	Loss: 0.298
Batch: 139/231	Loss: 0.471
Batch: 162/231	Loss: 0.462
Batch: 185/231	Loss: 0.154
Batch: 208/231	Loss: 0.505
Batch: 231/231	Loss: 0.378
Epoch: 9	Train Loss: 0.301	Val F1: 0.317
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 10 ******************************
Batch: 1/231	Loss: 0.272
Batch: 24/231	Loss: 0.151
Batch: 47/231	Loss: 0.192
Batch: 70/231	Loss: 0.087
Batch: 93/231	Loss: 0.193
Batch: 116/231	Loss: 0.068
Batch: 139/231	Loss: 0.117
Batch: 162/231	Loss: 0.205
Batch: 185/231	Loss: 0.607
Batch: 208/231	Loss: 0.236
Batch: 231/231	Loss: 0.126
Epoch: 10	Train Loss: 0.254	Val F1: 0.311
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 11 ******************************
Batch: 1/231	Loss: 0.164
Batch: 24/231	Loss: 0.074
Batch: 47/231	Loss: 0.086
Batch: 70/231	Loss: 0.118
Batch: 93/231	Loss: 0.228
Batch: 116/231	Loss: 0.448
Batch: 139/231	Loss: 0.413
Batch: 162/231	Loss: 0.111
Batch: 185/231	Loss: 0.146
Batch: 208/231	Loss: 0.285
Batch: 231/231	Loss: 0.050
Epoch: 11	Train Loss: 0.211	Val F1: 0.324
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 12 ******************************
Batch: 1/231	Loss: 0.168
Batch: 24/231	Loss: 0.150
Batch: 47/231	Loss: 0.133
Batch: 70/231	Loss: 0.084
Batch: 93/231	Loss: 0.104
Batch: 116/231	Loss: 0.219
Batch: 139/231	Loss: 0.074
Batch: 162/231	Loss: 0.153
Batch: 185/231	Loss: 0.152
Batch: 208/231	Loss: 0.128
Batch: 231/231	Loss: 0.172
Epoch: 12	Train Loss: 0.150	Val F1: 0.319
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 13 ******************************
Batch: 1/231	Loss: 0.036
Batch: 24/231	Loss: 0.057
Batch: 47/231	Loss: 0.056
Batch: 70/231	Loss: 0.146
Batch: 93/231	Loss: 0.062
Batch: 116/231	Loss: 0.124
Batch: 139/231	Loss: 0.090
Batch: 162/231	Loss: 0.033
Batch: 185/231	Loss: 0.081
Batch: 208/231	Loss: 0.013
Batch: 231/231	Loss: 0.041
Epoch: 13	Train Loss: 0.119	Val F1: 0.319
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 14 ******************************
Batch: 1/231	Loss: 0.192
Batch: 24/231	Loss: 0.239
Batch: 47/231	Loss: 0.062
Batch: 70/231	Loss: 0.070
Batch: 93/231	Loss: 0.121
Batch: 116/231	Loss: 0.054
Batch: 139/231	Loss: 0.055
Batch: 162/231	Loss: 0.040
Batch: 185/231	Loss: 0.278
Batch: 208/231	Loss: 0.026
Batch: 231/231	Loss: 0.101
Epoch: 14	Train Loss: 0.101	Val F1: 0.314
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 15 ******************************
Batch: 1/231	Loss: 0.071
Batch: 24/231	Loss: 0.137
Batch: 47/231	Loss: 0.023
Batch: 70/231	Loss: 0.096
Batch: 93/231	Loss: 0.112
Batch: 116/231	Loss: 0.015
Batch: 139/231	Loss: 0.041
Batch: 162/231	Loss: 0.140
Batch: 185/231	Loss: 0.048
Batch: 208/231	Loss: 0.085
Batch: 231/231	Loss: 0.007
Epoch: 15	Train Loss: 0.076	Val F1: 0.317
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 16 ******************************
Batch: 1/231	Loss: 0.018
Batch: 24/231	Loss: 0.015
Batch: 47/231	Loss: 0.033
Batch: 70/231	Loss: 0.149
Batch: 93/231	Loss: 0.043
Batch: 116/231	Loss: 0.021
Batch: 139/231	Loss: 0.015
Batch: 162/231	Loss: 0.031
Batch: 185/231	Loss: 0.047
Batch: 208/231	Loss: 0.009
Batch: 231/231	Loss: 0.036
Epoch: 16	Train Loss: 0.047	Val F1: 0.314
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 17 ******************************
Batch: 1/231	Loss: 0.047
Batch: 24/231	Loss: 0.034
Batch: 47/231	Loss: 0.028
Batch: 70/231	Loss: 0.011
Batch: 93/231	Loss: 0.063
Batch: 116/231	Loss: 0.030
Batch: 139/231	Loss: 0.018
Batch: 162/231	Loss: 0.054
Batch: 185/231	Loss: 0.012
Batch: 208/231	Loss: 0.152
Batch: 231/231	Loss: 0.020
Epoch: 17	Train Loss: 0.044	Val F1: 0.319
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 18 ******************************
Batch: 1/231	Loss: 0.110
Batch: 24/231	Loss: 0.014
Batch: 47/231	Loss: 0.026
Batch: 70/231	Loss: 0.042
Batch: 93/231	Loss: 0.008
Batch: 116/231	Loss: 0.037
Batch: 139/231	Loss: 0.045
Batch: 162/231	Loss: 0.010
Batch: 185/231	Loss: 0.026
Batch: 208/231	Loss: 0.210
Batch: 231/231	Loss: 0.054
Epoch: 18	Train Loss: 0.039	Val F1: 0.320
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 19 ******************************
Batch: 1/231	Loss: 0.010
Batch: 24/231	Loss: 0.002
Batch: 47/231	Loss: 0.051
Batch: 70/231	Loss: 0.022
Batch: 93/231	Loss: 0.017
Batch: 116/231	Loss: 0.009
Batch: 139/231	Loss: 0.009
Batch: 162/231	Loss: 0.002
Batch: 185/231	Loss: 0.105
Batch: 208/231	Loss: 0.085
Batch: 231/231	Loss: 0.007
Epoch: 19	Train Loss: 0.032	Val F1: 0.321
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 20 ******************************
Batch: 1/231	Loss: 0.007
Batch: 24/231	Loss: 0.023
Batch: 47/231	Loss: 0.003
Batch: 70/231	Loss: 0.069
Batch: 93/231	Loss: 0.002
Batch: 116/231	Loss: 0.021
Batch: 139/231	Loss: 0.024
Batch: 162/231	Loss: 0.004
Batch: 185/231	Loss: 0.013
Batch: 208/231	Loss: 0.127
Batch: 231/231	Loss: 0.059
Epoch: 20	Train Loss: 0.033	Val F1: 0.311
Best Epoch: 5	Best Val F1: 0.327

Saving the best checkpoint....
Inference...
Test F1: 0.376	Test F1_Few: 0.379	Test F1_Zero: 0.369
Starting training with config: {'batch_size': 16, 'epochs': 75, 'l2_reg': 0.0002184170775650266, 'lr': 5.4106407821974894e-05, 'n_layers_freeze': 2, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 0.904
Batch: 23/116	Loss: 0.835
Batch: 34/116	Loss: 0.822
Batch: 45/116	Loss: 0.774
Batch: 56/116	Loss: 0.806
Batch: 67/116	Loss: 0.723
Batch: 78/116	Loss: 0.724
Batch: 89/116	Loss: 0.869
Batch: 100/116	Loss: 0.719
Batch: 111/116	Loss: 0.740
Batch: 116/116	Loss: 0.688
Epoch: 1	Train Loss: 0.804	Val F1: 0.222
Best Epoch: 1	Best Val F1: 0.222

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.854
Batch: 12/116	Loss: 0.769
Batch: 23/116	Loss: 0.693
Batch: 34/116	Loss: 0.719
Batch: 45/116	Loss: 0.738
Batch: 56/116	Loss: 0.685
Batch: 67/116	Loss: 0.743
Batch: 78/116	Loss: 0.727
Batch: 89/116	Loss: 0.690
Batch: 100/116	Loss: 0.725
Batch: 111/116	Loss: 0.675
Batch: 116/116	Loss: 0.721
Epoch: 2	Train Loss: 0.733	Val F1: 0.306
Best Epoch: 2	Best Val F1: 0.306

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.618
Batch: 12/116	Loss: 0.536
Batch: 23/116	Loss: 0.593
Batch: 34/116	Loss: 0.797
Batch: 45/116	Loss: 0.776
Batch: 56/116	Loss: 0.733
Batch: 67/116	Loss: 0.575
Batch: 78/116	Loss: 0.631
Batch: 89/116	Loss: 0.710
Batch: 100/116	Loss: 0.894
Batch: 111/116	Loss: 0.910
Batch: 116/116	Loss: 0.629
Epoch: 3	Train Loss: 0.685	Val F1: 0.316
Best Epoch: 3	Best Val F1: 0.316

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.698
Batch: 12/116	Loss: 0.544
Batch: 23/116	Loss: 0.818
Batch: 34/116	Loss: 0.560
Batch: 45/116	Loss: 0.727
Batch: 56/116	Loss: 0.759
Batch: 67/116	Loss: 0.724
Batch: 78/116	Loss: 0.527
Batch: 89/116	Loss: 0.607
Batch: 100/116	Loss: 0.644
Batch: 111/116	Loss: 0.665
Batch: 116/116	Loss: 0.702
Epoch: 4	Train Loss: 0.640	Val F1: 0.288
Best Epoch: 3	Best Val F1: 0.316

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.378
Batch: 12/116	Loss: 0.534
Batch: 23/116	Loss: 0.512
Batch: 34/116	Loss: 0.602
Batch: 45/116	Loss: 0.664
Batch: 56/116	Loss: 0.646
Batch: 67/116	Loss: 0.592
Batch: 78/116	Loss: 0.737
Batch: 89/116	Loss: 0.615
Batch: 100/116	Loss: 0.601
Batch: 111/116	Loss: 0.596
Batch: 116/116	Loss: 0.467
Epoch: 5	Train Loss: 0.584	Val F1: 0.320
Best Epoch: 5	Best Val F1: 0.320

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.487
Batch: 12/116	Loss: 0.684
Batch: 23/116	Loss: 0.383
Batch: 34/116	Loss: 0.521
Batch: 45/116	Loss: 0.384
Batch: 56/116	Loss: 0.585
Batch: 67/116	Loss: 0.423
Batch: 78/116	Loss: 0.631
Batch: 89/116	Loss: 0.769
Batch: 100/116	Loss: 0.640
Batch: 111/116	Loss: 0.609
Batch: 116/116	Loss: 0.233
Epoch: 6	Train Loss: 0.507	Val F1: 0.331
Best Epoch: 6	Best Val F1: 0.331

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.409
Batch: 12/116	Loss: 0.853
Batch: 23/116	Loss: 0.416
Batch: 34/116	Loss: 0.659
Batch: 45/116	Loss: 0.353
Batch: 56/116	Loss: 0.802
Batch: 67/116	Loss: 0.466
Batch: 78/116	Loss: 0.485
Batch: 89/116	Loss: 0.411
Batch: 100/116	Loss: 0.351
Batch: 111/116	Loss: 0.749
Batch: 116/116	Loss: 0.185
Epoch: 7	Train Loss: 0.438	Val F1: 0.320
Best Epoch: 6	Best Val F1: 0.331

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.531
Batch: 12/116	Loss: 0.376
Batch: 23/116	Loss: 0.167
Batch: 34/116	Loss: 0.343
Batch: 45/116	Loss: 0.364
Batch: 56/116	Loss: 0.263
Batch: 67/116	Loss: 0.591
Batch: 78/116	Loss: 0.331
Batch: 89/116	Loss: 0.210
Batch: 100/116	Loss: 0.695
Batch: 111/116	Loss: 0.301
Batch: 116/116	Loss: 0.399
Epoch: 8	Train Loss: 0.383	Val F1: 0.316
Best Epoch: 6	Best Val F1: 0.331

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.250
Batch: 12/116	Loss: 0.344
Batch: 23/116	Loss: 0.257
Batch: 34/116	Loss: 0.273
Batch: 45/116	Loss: 0.306
Batch: 56/116	Loss: 0.344
Batch: 67/116	Loss: 0.246
Batch: 78/116	Loss: 0.351
Batch: 89/116	Loss: 0.211
Batch: 100/116	Loss: 0.285
Batch: 111/116	Loss: 0.287
Batch: 116/116	Loss: 0.368
Epoch: 9	Train Loss: 0.319	Val F1: 0.333
Best Epoch: 9	Best Val F1: 0.333

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.280
Batch: 12/116	Loss: 0.195
Batch: 23/116	Loss: 0.213
Batch: 34/116	Loss: 0.393
Batch: 45/116	Loss: 0.131
Batch: 56/116	Loss: 0.319
Batch: 67/116	Loss: 0.304
Batch: 78/116	Loss: 0.295
Batch: 89/116	Loss: 0.186
Batch: 100/116	Loss: 0.436
Batch: 111/116	Loss: 0.156
Batch: 116/116	Loss: 0.239
Epoch: 10	Train Loss: 0.273	Val F1: 0.335
Best Epoch: 10	Best Val F1: 0.335

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.245
Batch: 12/116	Loss: 0.109
Batch: 23/116	Loss: 0.107
Batch: 34/116	Loss: 0.136
Batch: 45/116	Loss: 0.191
Batch: 56/116	Loss: 0.249
Batch: 67/116	Loss: 0.223
Batch: 78/116	Loss: 0.145
Batch: 89/116	Loss: 0.139
Batch: 100/116	Loss: 0.253
Batch: 111/116	Loss: 0.342
Batch: 116/116	Loss: 0.059
Epoch: 11	Train Loss: 0.219	Val F1: 0.340
Best Epoch: 11	Best Val F1: 0.340

****************************** Epoch: 12 ******************************
Batch: 1/116	Loss: 0.194
Batch: 12/116	Loss: 0.096
Batch: 23/116	Loss: 0.123
Batch: 34/116	Loss: 0.169
Batch: 45/116	Loss: 0.057
Batch: 56/116	Loss: 0.215
Batch: 67/116	Loss: 0.079
Batch: 78/116	Loss: 0.197
Batch: 89/116	Loss: 0.163
Batch: 100/116	Loss: 0.245
Batch: 111/116	Loss: 0.119
Batch: 116/116	Loss: 0.142
Epoch: 12	Train Loss: 0.154	Val F1: 0.334
Best Epoch: 11	Best Val F1: 0.340

****************************** Epoch: 13 ******************************
Batch: 1/116	Loss: 0.070
Batch: 12/116	Loss: 0.039
Batch: 23/116	Loss: 0.272
Batch: 34/116	Loss: 0.040
Batch: 45/116	Loss: 0.136
Batch: 56/116	Loss: 0.085
Batch: 67/116	Loss: 0.069
Batch: 78/116	Loss: 0.098
Batch: 89/116	Loss: 0.116
Batch: 100/116	Loss: 0.248
Batch: 111/116	Loss: 0.129
Batch: 116/116	Loss: 0.158
Epoch: 13	Train Loss: 0.123	Val F1: 0.337
Best Epoch: 11	Best Val F1: 0.340

****************************** Epoch: 14 ******************************
Batch: 1/116	Loss: 0.336
Batch: 12/116	Loss: 0.167
Batch: 23/116	Loss: 0.130
Batch: 34/116	Loss: 0.034
Batch: 45/116	Loss: 0.087
Batch: 56/116	Loss: 0.132
Batch: 67/116	Loss: 0.074
Batch: 78/116	Loss: 0.231
Batch: 89/116	Loss: 0.059
Batch: 100/116	Loss: 0.076
Batch: 111/116	Loss: 0.057
Batch: 116/116	Loss: 0.037
Epoch: 14	Train Loss: 0.111	Val F1: 0.327
Best Epoch: 11	Best Val F1: 0.340

****************************** Epoch: 15 ******************************
Batch: 1/116	Loss: 0.054
Batch: 12/116	Loss: 0.189
Batch: 23/116	Loss: 0.107
Batch: 34/116	Loss: 0.026
Batch: 45/116	Loss: 0.055
Batch: 56/116	Loss: 0.034
Batch: 67/116	Loss: 0.204
Batch: 78/116	Loss: 0.039
Batch: 89/116	Loss: 0.121
Batch: 100/116	Loss: 0.136
Batch: 111/116	Loss: 0.095
Batch: 116/116	Loss: 0.026
Epoch: 15	Train Loss: 0.081	Val F1: 0.325
Best Epoch: 11	Best Val F1: 0.340

****************************** Epoch: 16 ******************************
Batch: 1/116	Loss: 0.108
Batch: 12/116	Loss: 0.037
Batch: 23/116	Loss: 0.020
Batch: 34/116	Loss: 0.023
Batch: 45/116	Loss: 0.071
Batch: 56/116	Loss: 0.042
Batch: 67/116	Loss: 0.096
Batch: 78/116	Loss: 0.053
Batch: 89/116	Loss: 0.068
Batch: 100/116	Loss: 0.084
Batch: 111/116	Loss: 0.022
Batch: 116/116	Loss: 0.062
Epoch: 16	Train Loss: 0.065	Val F1: 0.329
Best Epoch: 11	Best Val F1: 0.340

****************************** Epoch: 17 ******************************
Batch: 1/116	Loss: 0.051
Batch: 12/116	Loss: 0.013
Batch: 23/116	Loss: 0.030
Batch: 34/116	Loss: 0.013
Batch: 45/116	Loss: 0.072
Batch: 56/116	Loss: 0.032
Batch: 67/116	Loss: 0.032
Batch: 78/116	Loss: 0.026
Batch: 89/116	Loss: 0.067
Batch: 100/116	Loss: 0.009
Batch: 111/116	Loss: 0.154
Batch: 116/116	Loss: 0.057
Epoch: 17	Train Loss: 0.047	Val F1: 0.330
Best Epoch: 11	Best Val F1: 0.340

****************************** Epoch: 18 ******************************
Batch: 1/116	Loss: 0.131
Batch: 12/116	Loss: 0.027
Batch: 23/116	Loss: 0.016
Batch: 34/116	Loss: 0.027
Batch: 45/116	Loss: 0.005
Batch: 56/116	Loss: 0.080
Batch: 67/116	Loss: 0.046
Batch: 78/116	Loss: 0.070
Batch: 89/116	Loss: 0.052
Batch: 100/116	Loss: 0.013
Batch: 111/116	Loss: 0.009
Batch: 116/116	Loss: 0.090
Epoch: 18	Train Loss: 0.038	Val F1: 0.334
Best Epoch: 11	Best Val F1: 0.340

****************************** Epoch: 19 ******************************
Batch: 1/116	Loss: 0.009
Batch: 12/116	Loss: 0.008
Batch: 23/116	Loss: 0.007
Batch: 34/116	Loss: 0.015
Batch: 45/116	Loss: 0.010
Batch: 56/116	Loss: 0.030
Batch: 67/116	Loss: 0.071
Batch: 78/116	Loss: 0.032
Batch: 89/116	Loss: 0.011
Batch: 100/116	Loss: 0.042
Batch: 111/116	Loss: 0.011
Batch: 116/116	Loss: 0.011
Epoch: 19	Train Loss: 0.031	Val F1: 0.343
Best Epoch: 19	Best Val F1: 0.343

****************************** Epoch: 20 ******************************
Batch: 1/116	Loss: 0.034
Batch: 12/116	Loss: 0.030
Batch: 23/116	Loss: 0.101
Batch: 34/116	Loss: 0.007
Batch: 45/116	Loss: 0.043
Batch: 56/116	Loss: 0.008
Batch: 67/116	Loss: 0.010
Batch: 78/116	Loss: 0.006
Batch: 89/116	Loss: 0.006
Batch: 100/116	Loss: 0.006
Batch: 111/116	Loss: 0.018
Batch: 116/116	Loss: 0.005
Epoch: 20	Train Loss: 0.026	Val F1: 0.323
Best Epoch: 19	Best Val F1: 0.343

****************************** Epoch: 21 ******************************
Batch: 1/116	Loss: 0.047
Batch: 12/116	Loss: 0.005
Batch: 23/116	Loss: 0.010
Batch: 34/116	Loss: 0.016
Batch: 45/116	Loss: 0.023
Batch: 56/116	Loss: 0.015
Batch: 67/116	Loss: 0.014
Batch: 78/116	Loss: 0.073
Batch: 89/116	Loss: 0.065
Batch: 100/116	Loss: 0.085
Batch: 111/116	Loss: 0.046
Batch: 116/116	Loss: 0.033
Epoch: 21	Train Loss: 0.038	Val F1: 0.326
Best Epoch: 19	Best Val F1: 0.343

****************************** Epoch: 22 ******************************
Batch: 1/116	Loss: 0.043
Batch: 12/116	Loss: 0.002
Batch: 23/116	Loss: 0.086
Batch: 34/116	Loss: 0.019
Batch: 45/116	Loss: 0.154
Batch: 56/116	Loss: 0.007
Batch: 67/116	Loss: 0.034
Batch: 78/116	Loss: 0.013
Batch: 89/116	Loss: 0.006
Batch: 100/116	Loss: 0.008
Batch: 111/116	Loss: 0.033
Batch: 116/116	Loss: 0.082
Epoch: 22	Train Loss: 0.033	Val F1: 0.332
Best Epoch: 19	Best Val F1: 0.343

****************************** Epoch: 23 ******************************
Batch: 1/116	Loss: 0.005
Batch: 12/116	Loss: 0.045
Batch: 23/116	Loss: 0.029
Batch: 34/116	Loss: 0.044
Batch: 45/116	Loss: 0.037
Batch: 56/116	Loss: 0.013
Batch: 67/116	Loss: 0.007
Batch: 78/116	Loss: 0.006
Batch: 89/116	Loss: 0.005
Batch: 100/116	Loss: 0.005
Batch: 111/116	Loss: 0.013
Batch: 116/116	Loss: 0.161
Epoch: 23	Train Loss: 0.018	Val F1: 0.327
Best Epoch: 19	Best Val F1: 0.343

****************************** Epoch: 24 ******************************
Batch: 1/116	Loss: 0.008
Batch: 12/116	Loss: 0.004
Batch: 23/116	Loss: 0.055
Batch: 34/116	Loss: 0.013
Batch: 45/116	Loss: 0.034
Batch: 56/116	Loss: 0.007
Batch: 67/116	Loss: 0.007
Batch: 78/116	Loss: 0.005
Batch: 89/116	Loss: 0.057
Batch: 100/116	Loss: 0.074
Batch: 111/116	Loss: 0.032
Batch: 116/116	Loss: 0.016
Epoch: 24	Train Loss: 0.021	Val F1: 0.324
Best Epoch: 19	Best Val F1: 0.343

****************************** Epoch: 25 ******************************
Batch: 1/116	Loss: 0.073
Batch: 12/116	Loss: 0.005
Batch: 23/116	Loss: 0.006
Batch: 34/116	Loss: 0.003
Batch: 45/116	Loss: 0.013
Batch: 56/116	Loss: 0.001
Batch: 67/116	Loss: 0.079
Batch: 78/116	Loss: 0.010
Batch: 89/116	Loss: 0.010
Batch: 100/116	Loss: 0.004
Batch: 111/116	Loss: 0.003
Batch: 116/116	Loss: 0.058
Epoch: 25	Train Loss: 0.018	Val F1: 0.327
Best Epoch: 19	Best Val F1: 0.343

****************************** Epoch: 26 ******************************
Batch: 1/116	Loss: 0.026
Batch: 12/116	Loss: 0.023
Batch: 23/116	Loss: 0.029
Batch: 34/116	Loss: 0.017
Batch: 45/116	Loss: 0.096
Batch: 56/116	Loss: 0.032
Batch: 67/116	Loss: 0.035
Batch: 78/116	Loss: 0.005
Batch: 89/116	Loss: 0.003
Batch: 100/116	Loss: 0.174
Batch: 111/116	Loss: 0.002
Batch: 116/116	Loss: 0.006
Epoch: 26	Train Loss: 0.034	Val F1: 0.337
Best Epoch: 19	Best Val F1: 0.343

****************************** Epoch: 27 ******************************
Batch: 1/116	Loss: 0.004
Batch: 12/116	Loss: 0.009
Batch: 23/116	Loss: 0.084
Batch: 34/116	Loss: 0.021
Batch: 45/116	Loss: 0.038
Batch: 56/116	Loss: 0.019
Batch: 67/116	Loss: 0.047
Batch: 78/116	Loss: 0.004
Batch: 89/116	Loss: 0.002
Batch: 100/116	Loss: 0.107
Batch: 111/116	Loss: 0.002
Batch: 116/116	Loss: 0.004
Epoch: 27	Train Loss: 0.029	Val F1: 0.319
Best Epoch: 19	Best Val F1: 0.343

****************************** Epoch: 28 ******************************
Batch: 1/116	Loss: 0.005
Batch: 12/116	Loss: 0.018
Batch: 23/116	Loss: 0.003
Batch: 34/116	Loss: 0.009
Batch: 45/116	Loss: 0.002
Batch: 56/116	Loss: 0.008
Batch: 67/116	Loss: 0.014
Batch: 78/116	Loss: 0.005
Batch: 89/116	Loss: 0.003
Batch: 100/116	Loss: 0.013
Batch: 111/116	Loss: 0.016
Batch: 116/116	Loss: 0.007
Epoch: 28	Train Loss: 0.012	Val F1: 0.325
Best Epoch: 19	Best Val F1: 0.343

****************************** Epoch: 29 ******************************
Batch: 1/116	Loss: 0.024
Batch: 12/116	Loss: 0.013
Batch: 23/116	Loss: 0.004
Batch: 34/116	Loss: 0.002
Batch: 45/116	Loss: 0.007
Batch: 56/116	Loss: 0.002
Batch: 67/116	Loss: 0.018
Batch: 78/116	Loss: 0.001
Batch: 89/116	Loss: 0.007
Batch: 100/116	Loss: 0.009
Batch: 111/116	Loss: 0.019
Batch: 116/116	Loss: 0.017
Epoch: 29	Train Loss: 0.009	Val F1: 0.322
Best Epoch: 19	Best Val F1: 0.343

Saving the best checkpoint....
Inference...
Test F1: 0.377	Test F1_Few: 0.389	Test F1_Zero: 0.362
Starting training with config: {'batch_size': 64, 'epochs': 75, 'l2_reg': 8.066143704623787e-05, 'lr': 3.363320811460275e-05, 'n_layers_freeze': 5, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.053
Batch: 5/29	Loss: 1.004
Batch: 7/29	Loss: 0.974
Batch: 9/29	Loss: 0.942
Batch: 11/29	Loss: 0.933
Batch: 13/29	Loss: 0.920
Batch: 15/29	Loss: 0.932
Batch: 17/29	Loss: 0.881
Batch: 19/29	Loss: 0.884
Batch: 21/29	Loss: 0.855
Batch: 23/29	Loss: 0.871
Batch: 25/29	Loss: 0.829
Batch: 27/29	Loss: 0.828
Batch: 29/29	Loss: 0.840
Epoch: 1	Train Loss: 0.920	Val F1: 0.213
Best Epoch: 1	Best Val F1: 0.213

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.829
Batch: 3/29	Loss: 0.828
Batch: 5/29	Loss: 0.868
Batch: 7/29	Loss: 0.814
Batch: 9/29	Loss: 0.836
Batch: 11/29	Loss: 0.780
Batch: 13/29	Loss: 0.782
Batch: 15/29	Loss: 0.809
Batch: 17/29	Loss: 0.799
Batch: 19/29	Loss: 0.847
Batch: 21/29	Loss: 0.784
Batch: 23/29	Loss: 0.797
Batch: 25/29	Loss: 0.766
Batch: 27/29	Loss: 0.845
Batch: 29/29	Loss: 0.771
Epoch: 2	Train Loss: 0.805	Val F1: 0.208
Best Epoch: 1	Best Val F1: 0.213

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.757
Batch: 3/29	Loss: 0.788
Batch: 5/29	Loss: 0.770
Batch: 7/29	Loss: 0.815
Batch: 9/29	Loss: 0.748
Batch: 11/29	Loss: 0.749
Batch: 13/29	Loss: 0.806
Batch: 15/29	Loss: 0.762
Batch: 17/29	Loss: 0.783
Batch: 19/29	Loss: 0.765
Batch: 21/29	Loss: 0.741
Batch: 23/29	Loss: 0.734
Batch: 25/29	Loss: 0.770
Batch: 27/29	Loss: 0.747
Batch: 29/29	Loss: 0.743
Epoch: 3	Train Loss: 0.765	Val F1: 0.302
Best Epoch: 3	Best Val F1: 0.302

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.703
Batch: 3/29	Loss: 0.727
Batch: 5/29	Loss: 0.711
Batch: 7/29	Loss: 0.776
Batch: 9/29	Loss: 0.726
Batch: 11/29	Loss: 0.637
Batch: 13/29	Loss: 0.695
Batch: 15/29	Loss: 0.668
Batch: 17/29	Loss: 0.679
Batch: 19/29	Loss: 0.731
Batch: 21/29	Loss: 0.716
Batch: 23/29	Loss: 0.705
Batch: 25/29	Loss: 0.677
Batch: 27/29	Loss: 0.718
Batch: 29/29	Loss: 0.703
Epoch: 4	Train Loss: 0.709	Val F1: 0.321
Best Epoch: 4	Best Val F1: 0.321

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.647
Batch: 3/29	Loss: 0.633
Batch: 5/29	Loss: 0.640
Batch: 7/29	Loss: 0.636
Batch: 9/29	Loss: 0.620
Batch: 11/29	Loss: 0.633
Batch: 13/29	Loss: 0.718
Batch: 15/29	Loss: 0.654
Batch: 17/29	Loss: 0.820
Batch: 19/29	Loss: 0.676
Batch: 21/29	Loss: 0.606
Batch: 23/29	Loss: 0.766
Batch: 25/29	Loss: 0.683
Batch: 27/29	Loss: 0.646
Batch: 29/29	Loss: 0.721
Epoch: 5	Train Loss: 0.679	Val F1: 0.345
Best Epoch: 5	Best Val F1: 0.345

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.668
Batch: 3/29	Loss: 0.701
Batch: 5/29	Loss: 0.563
Batch: 7/29	Loss: 0.709
Batch: 9/29	Loss: 0.630
Batch: 11/29	Loss: 0.601
Batch: 13/29	Loss: 0.639
Batch: 15/29	Loss: 0.562
Batch: 17/29	Loss: 0.594
Batch: 19/29	Loss: 0.537
Batch: 21/29	Loss: 0.745
Batch: 23/29	Loss: 0.622
Batch: 25/29	Loss: 0.588
Batch: 27/29	Loss: 0.637
Batch: 29/29	Loss: 0.594
Epoch: 6	Train Loss: 0.624	Val F1: 0.323
Best Epoch: 5	Best Val F1: 0.345

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.574
Batch: 3/29	Loss: 0.648
Batch: 5/29	Loss: 0.671
Batch: 7/29	Loss: 0.601
Batch: 9/29	Loss: 0.608
Batch: 11/29	Loss: 0.523
Batch: 13/29	Loss: 0.550
Batch: 15/29	Loss: 0.533
Batch: 17/29	Loss: 0.607
Batch: 19/29	Loss: 0.605
Batch: 21/29	Loss: 0.570
Batch: 23/29	Loss: 0.539
Batch: 25/29	Loss: 0.490
Batch: 27/29	Loss: 0.534
Batch: 29/29	Loss: 0.618
Epoch: 7	Train Loss: 0.576	Val F1: 0.319
Best Epoch: 5	Best Val F1: 0.345

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.583
Batch: 3/29	Loss: 0.509
Batch: 5/29	Loss: 0.608
Batch: 7/29	Loss: 0.565
Batch: 9/29	Loss: 0.535
Batch: 11/29	Loss: 0.547
Batch: 13/29	Loss: 0.574
Batch: 15/29	Loss: 0.486
Batch: 17/29	Loss: 0.567
Batch: 19/29	Loss: 0.498
Batch: 21/29	Loss: 0.481
Batch: 23/29	Loss: 0.562
Batch: 25/29	Loss: 0.677
Batch: 27/29	Loss: 0.598
Batch: 29/29	Loss: 0.557
Epoch: 8	Train Loss: 0.537	Val F1: 0.327
Best Epoch: 5	Best Val F1: 0.345

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.554
Batch: 3/29	Loss: 0.541
Batch: 5/29	Loss: 0.533
Batch: 7/29	Loss: 0.437
Batch: 9/29	Loss: 0.549
Batch: 11/29	Loss: 0.554
Batch: 13/29	Loss: 0.443
Batch: 15/29	Loss: 0.486
Batch: 17/29	Loss: 0.482
Batch: 19/29	Loss: 0.520
Batch: 21/29	Loss: 0.559
Batch: 23/29	Loss: 0.481
Batch: 25/29	Loss: 0.551
Batch: 27/29	Loss: 0.479
Batch: 29/29	Loss: 0.429
Epoch: 9	Train Loss: 0.509	Val F1: 0.326
Best Epoch: 5	Best Val F1: 0.345

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.419
Batch: 3/29	Loss: 0.497
Batch: 5/29	Loss: 0.446
Batch: 7/29	Loss: 0.488
Batch: 9/29	Loss: 0.443
Batch: 11/29	Loss: 0.402
Batch: 13/29	Loss: 0.565
Batch: 15/29	Loss: 0.569
Batch: 17/29	Loss: 0.563
Batch: 19/29	Loss: 0.420
Batch: 21/29	Loss: 0.572
Batch: 23/29	Loss: 0.543
Batch: 25/29	Loss: 0.559
Batch: 27/29	Loss: 0.450
Batch: 29/29	Loss: 0.497
Epoch: 10	Train Loss: 0.476	Val F1: 0.330
Best Epoch: 5	Best Val F1: 0.345

Saving the best checkpoint....
Inference...
Test F1: 0.374	Test F1_Few: 0.426	Test F1_Zero: 0.392
Starting training with config: {'batch_size': 64, 'epochs': 25, 'l2_reg': 0.000882230155542473, 'lr': 2.8241526410434163e-05, 'n_layers_freeze': 2, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.056
Batch: 5/29	Loss: 1.009
Batch: 7/29	Loss: 0.982
Batch: 9/29	Loss: 0.951
Batch: 11/29	Loss: 0.942
Batch: 13/29	Loss: 0.928
Batch: 15/29	Loss: 0.939
Batch: 17/29	Loss: 0.892
Batch: 19/29	Loss: 0.894
Batch: 21/29	Loss: 0.868
Batch: 23/29	Loss: 0.882
Batch: 25/29	Loss: 0.842
Batch: 27/29	Loss: 0.842
Batch: 29/29	Loss: 0.852
Epoch: 1	Train Loss: 0.929	Val F1: 0.186
Best Epoch: 1	Best Val F1: 0.186

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.842
Batch: 3/29	Loss: 0.840
Batch: 5/29	Loss: 0.876
Batch: 7/29	Loss: 0.827
Batch: 9/29	Loss: 0.846
Batch: 11/29	Loss: 0.795
Batch: 13/29	Loss: 0.797
Batch: 15/29	Loss: 0.821
Batch: 17/29	Loss: 0.811
Batch: 19/29	Loss: 0.853
Batch: 21/29	Loss: 0.796
Batch: 23/29	Loss: 0.806
Batch: 25/29	Loss: 0.779
Batch: 27/29	Loss: 0.851
Batch: 29/29	Loss: 0.782
Epoch: 2	Train Loss: 0.817	Val F1: 0.190
Best Epoch: 2	Best Val F1: 0.190

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.770
Batch: 3/29	Loss: 0.797
Batch: 5/29	Loss: 0.780
Batch: 7/29	Loss: 0.821
Batch: 9/29	Loss: 0.760
Batch: 11/29	Loss: 0.760
Batch: 13/29	Loss: 0.811
Batch: 15/29	Loss: 0.771
Batch: 17/29	Loss: 0.786
Batch: 19/29	Loss: 0.774
Batch: 21/29	Loss: 0.751
Batch: 23/29	Loss: 0.753
Batch: 25/29	Loss: 0.774
Batch: 27/29	Loss: 0.737
Batch: 29/29	Loss: 0.760
Epoch: 3	Train Loss: 0.775	Val F1: 0.280
Best Epoch: 3	Best Val F1: 0.280

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.727
Batch: 3/29	Loss: 0.735
Batch: 5/29	Loss: 0.716
Batch: 7/29	Loss: 0.781
Batch: 9/29	Loss: 0.742
Batch: 11/29	Loss: 0.692
Batch: 13/29	Loss: 0.691
Batch: 15/29	Loss: 0.703
Batch: 17/29	Loss: 0.679
Batch: 19/29	Loss: 0.730
Batch: 21/29	Loss: 0.712
Batch: 23/29	Loss: 0.710
Batch: 25/29	Loss: 0.698
Batch: 27/29	Loss: 0.703
Batch: 29/29	Loss: 0.692
Epoch: 4	Train Loss: 0.720	Val F1: 0.336
Best Epoch: 4	Best Val F1: 0.336

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.659
Batch: 3/29	Loss: 0.657
Batch: 5/29	Loss: 0.609
Batch: 7/29	Loss: 0.680
Batch: 9/29	Loss: 0.624
Batch: 11/29	Loss: 0.721
Batch: 13/29	Loss: 0.640
Batch: 15/29	Loss: 0.687
Batch: 17/29	Loss: 0.707
Batch: 19/29	Loss: 0.675
Batch: 21/29	Loss: 0.641
Batch: 23/29	Loss: 0.651
Batch: 25/29	Loss: 0.679
Batch: 27/29	Loss: 0.645
Batch: 29/29	Loss: 0.674
Epoch: 5	Train Loss: 0.678	Val F1: 0.343
Best Epoch: 5	Best Val F1: 0.343

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.635
Batch: 3/29	Loss: 0.711
Batch: 5/29	Loss: 0.565
Batch: 7/29	Loss: 0.748
Batch: 9/29	Loss: 0.625
Batch: 11/29	Loss: 0.582
Batch: 13/29	Loss: 0.638
Batch: 15/29	Loss: 0.572
Batch: 17/29	Loss: 0.587
Batch: 19/29	Loss: 0.529
Batch: 21/29	Loss: 0.700
Batch: 23/29	Loss: 0.653
Batch: 25/29	Loss: 0.619
Batch: 27/29	Loss: 0.617
Batch: 29/29	Loss: 0.636
Epoch: 6	Train Loss: 0.624	Val F1: 0.344
Best Epoch: 6	Best Val F1: 0.344

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.552
Batch: 3/29	Loss: 0.684
Batch: 5/29	Loss: 0.664
Batch: 7/29	Loss: 0.608
Batch: 9/29	Loss: 0.609
Batch: 11/29	Loss: 0.472
Batch: 13/29	Loss: 0.578
Batch: 15/29	Loss: 0.552
Batch: 17/29	Loss: 0.669
Batch: 19/29	Loss: 0.572
Batch: 21/29	Loss: 0.561
Batch: 23/29	Loss: 0.523
Batch: 25/29	Loss: 0.479
Batch: 27/29	Loss: 0.507
Batch: 29/29	Loss: 0.554
Epoch: 7	Train Loss: 0.572	Val F1: 0.346
Best Epoch: 7	Best Val F1: 0.346

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.529
Batch: 3/29	Loss: 0.535
Batch: 5/29	Loss: 0.559
Batch: 7/29	Loss: 0.524
Batch: 9/29	Loss: 0.495
Batch: 11/29	Loss: 0.544
Batch: 13/29	Loss: 0.552
Batch: 15/29	Loss: 0.494
Batch: 17/29	Loss: 0.560
Batch: 19/29	Loss: 0.503
Batch: 21/29	Loss: 0.509
Batch: 23/29	Loss: 0.537
Batch: 25/29	Loss: 0.596
Batch: 27/29	Loss: 0.584
Batch: 29/29	Loss: 0.504
Epoch: 8	Train Loss: 0.515	Val F1: 0.338
Best Epoch: 7	Best Val F1: 0.346

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.531
Batch: 3/29	Loss: 0.499
Batch: 5/29	Loss: 0.473
Batch: 7/29	Loss: 0.419
Batch: 9/29	Loss: 0.506
Batch: 11/29	Loss: 0.501
Batch: 13/29	Loss: 0.447
Batch: 15/29	Loss: 0.387
Batch: 17/29	Loss: 0.415
Batch: 19/29	Loss: 0.362
Batch: 21/29	Loss: 0.521
Batch: 23/29	Loss: 0.409
Batch: 25/29	Loss: 0.396
Batch: 27/29	Loss: 0.473
Batch: 29/29	Loss: 0.322
Epoch: 9	Train Loss: 0.447	Val F1: 0.355
Best Epoch: 9	Best Val F1: 0.355

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.367
Batch: 3/29	Loss: 0.428
Batch: 5/29	Loss: 0.430
Batch: 7/29	Loss: 0.386
Batch: 9/29	Loss: 0.379
Batch: 11/29	Loss: 0.383
Batch: 13/29	Loss: 0.493
Batch: 15/29	Loss: 0.428
Batch: 17/29	Loss: 0.470
Batch: 19/29	Loss: 0.309
Batch: 21/29	Loss: 0.477
Batch: 23/29	Loss: 0.467
Batch: 25/29	Loss: 0.491
Batch: 27/29	Loss: 0.394
Batch: 29/29	Loss: 0.517
Epoch: 10	Train Loss: 0.419	Val F1: 0.371
Best Epoch: 10	Best Val F1: 0.371

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.425
Batch: 3/29	Loss: 0.337
Batch: 5/29	Loss: 0.531
Batch: 7/29	Loss: 0.378
Batch: 9/29	Loss: 0.443
Batch: 11/29	Loss: 0.390
Batch: 13/29	Loss: 0.404
Batch: 15/29	Loss: 0.319
Batch: 17/29	Loss: 0.418
Batch: 19/29	Loss: 0.418
Batch: 21/29	Loss: 0.313
Batch: 23/29	Loss: 0.323
Batch: 25/29	Loss: 0.325
Batch: 27/29	Loss: 0.353
Batch: 29/29	Loss: 0.384
Epoch: 11	Train Loss: 0.387	Val F1: 0.333
Best Epoch: 10	Best Val F1: 0.371

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.488
Batch: 3/29	Loss: 0.343
Batch: 5/29	Loss: 0.356
Batch: 7/29	Loss: 0.405
Batch: 9/29	Loss: 0.391
Batch: 11/29	Loss: 0.415
Batch: 13/29	Loss: 0.360
Batch: 15/29	Loss: 0.361
Batch: 17/29	Loss: 0.342
Batch: 19/29	Loss: 0.351
Batch: 21/29	Loss: 0.349
Batch: 23/29	Loss: 0.366
Batch: 25/29	Loss: 0.340
Batch: 27/29	Loss: 0.469
Batch: 29/29	Loss: 0.254
Epoch: 12	Train Loss: 0.363	Val F1: 0.354
Best Epoch: 10	Best Val F1: 0.371

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.397
Batch: 3/29	Loss: 0.255
Batch: 5/29	Loss: 0.352
Batch: 7/29	Loss: 0.305
Batch: 9/29	Loss: 0.350
Batch: 11/29	Loss: 0.352
Batch: 13/29	Loss: 0.338
Batch: 15/29	Loss: 0.330
Batch: 17/29	Loss: 0.290
Batch: 19/29	Loss: 0.193
Batch: 21/29	Loss: 0.298
Batch: 23/29	Loss: 0.349
Batch: 25/29	Loss: 0.237
Batch: 27/29	Loss: 0.391
Batch: 29/29	Loss: 0.389
Epoch: 13	Train Loss: 0.333	Val F1: 0.345
Best Epoch: 10	Best Val F1: 0.371

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.362
Batch: 3/29	Loss: 0.337
Batch: 5/29	Loss: 0.251
Batch: 7/29	Loss: 0.344
Batch: 9/29	Loss: 0.325
Batch: 11/29	Loss: 0.269
Batch: 13/29	Loss: 0.295
Batch: 15/29	Loss: 0.242
Batch: 17/29	Loss: 0.352
Batch: 19/29	Loss: 0.338
Batch: 21/29	Loss: 0.193
Batch: 23/29	Loss: 0.267
Batch: 25/29	Loss: 0.321
Batch: 27/29	Loss: 0.307
Batch: 29/29	Loss: 0.289
Epoch: 14	Train Loss: 0.304	Val F1: 0.345
Best Epoch: 10	Best Val F1: 0.371

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.283
Batch: 3/29	Loss: 0.303
Batch: 5/29	Loss: 0.195
Batch: 7/29	Loss: 0.275
Batch: 9/29	Loss: 0.326
Batch: 11/29	Loss: 0.281
Batch: 13/29	Loss: 0.281
Batch: 15/29	Loss: 0.285
Batch: 17/29	Loss: 0.330
Batch: 19/29	Loss: 0.292
Batch: 21/29	Loss: 0.297
Batch: 23/29	Loss: 0.270
Batch: 25/29	Loss: 0.317
Batch: 27/29	Loss: 0.256
Batch: 29/29	Loss: 0.327
Epoch: 15	Train Loss: 0.286	Val F1: 0.359
Best Epoch: 10	Best Val F1: 0.371

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.326
Batch: 3/29	Loss: 0.323
Batch: 5/29	Loss: 0.323
Batch: 7/29	Loss: 0.244
Batch: 9/29	Loss: 0.275
Batch: 11/29	Loss: 0.257
Batch: 13/29	Loss: 0.250
Batch: 15/29	Loss: 0.202
Batch: 17/29	Loss: 0.253
Batch: 19/29	Loss: 0.307
Batch: 21/29	Loss: 0.234
Batch: 23/29	Loss: 0.333
Batch: 25/29	Loss: 0.374
Batch: 27/29	Loss: 0.256
Batch: 29/29	Loss: 0.243
Epoch: 16	Train Loss: 0.274	Val F1: 0.346
Best Epoch: 10	Best Val F1: 0.371

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.256
Batch: 3/29	Loss: 0.298
Batch: 5/29	Loss: 0.275
Batch: 7/29	Loss: 0.219
Batch: 9/29	Loss: 0.150
Batch: 11/29	Loss: 0.256
Batch: 13/29	Loss: 0.316
Batch: 15/29	Loss: 0.292
Batch: 17/29	Loss: 0.353
Batch: 19/29	Loss: 0.231
Batch: 21/29	Loss: 0.345
Batch: 23/29	Loss: 0.372
Batch: 25/29	Loss: 0.150
Batch: 27/29	Loss: 0.231
Batch: 29/29	Loss: 0.288
Epoch: 17	Train Loss: 0.263	Val F1: 0.342
Best Epoch: 10	Best Val F1: 0.371

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.237
Batch: 3/29	Loss: 0.319
Batch: 5/29	Loss: 0.292
Batch: 7/29	Loss: 0.194
Batch: 9/29	Loss: 0.291
Batch: 11/29	Loss: 0.203
Batch: 13/29	Loss: 0.196
Batch: 15/29	Loss: 0.256
Batch: 17/29	Loss: 0.234
Batch: 19/29	Loss: 0.181
Batch: 21/29	Loss: 0.254
Batch: 23/29	Loss: 0.275
Batch: 25/29	Loss: 0.224
Batch: 27/29	Loss: 0.211
Batch: 29/29	Loss: 0.233
Epoch: 18	Train Loss: 0.237	Val F1: 0.351
Best Epoch: 10	Best Val F1: 0.371

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.160
Batch: 3/29	Loss: 0.171
Batch: 5/29	Loss: 0.264
Batch: 7/29	Loss: 0.231
Batch: 9/29	Loss: 0.195
Batch: 11/29	Loss: 0.302
Batch: 13/29	Loss: 0.233
Batch: 15/29	Loss: 0.203
Batch: 17/29	Loss: 0.176
Batch: 19/29	Loss: 0.258
Batch: 21/29	Loss: 0.190
Batch: 23/29	Loss: 0.220
Batch: 25/29	Loss: 0.231
Batch: 27/29	Loss: 0.150
Batch: 29/29	Loss: 0.235
Epoch: 19	Train Loss: 0.205	Val F1: 0.344
Best Epoch: 10	Best Val F1: 0.371

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.240
Batch: 3/29	Loss: 0.220
Batch: 5/29	Loss: 0.162
Batch: 7/29	Loss: 0.176
Batch: 9/29	Loss: 0.185
Batch: 11/29	Loss: 0.217
Batch: 13/29	Loss: 0.220
Batch: 15/29	Loss: 0.218
Batch: 17/29	Loss: 0.280
Batch: 19/29	Loss: 0.163
Batch: 21/29	Loss: 0.163
Batch: 23/29	Loss: 0.187
Batch: 25/29	Loss: 0.141
Batch: 27/29	Loss: 0.203
Batch: 29/29	Loss: 0.195
Epoch: 20	Train Loss: 0.198	Val F1: 0.352
Best Epoch: 10	Best Val F1: 0.371

Saving the best checkpoint....
Inference...
Test F1: 0.365	Test F1_Few: 0.441	Test F1_Zero: 0.355
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0008062881753955189, 'lr': 1.3665808037114128e-05, 'n_layers_freeze': 1, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.076
Batch: 5/29	Loss: 1.053
Batch: 7/29	Loss: 1.035
Batch: 9/29	Loss: 1.015
Batch: 11/29	Loss: 0.999
Batch: 13/29	Loss: 0.985
Batch: 15/29	Loss: 0.985
Batch: 17/29	Loss: 0.949
Batch: 19/29	Loss: 0.944
Batch: 21/29	Loss: 0.927
Batch: 23/29	Loss: 0.929
Batch: 25/29	Loss: 0.902
Batch: 27/29	Loss: 0.897
Batch: 29/29	Loss: 0.902
Epoch: 1	Train Loss: 0.978	Val F1: 0.186
Best Epoch: 1	Best Val F1: 0.186

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.894
Batch: 3/29	Loss: 0.892
Batch: 5/29	Loss: 0.914
Batch: 7/29	Loss: 0.880
Batch: 9/29	Loss: 0.891
Batch: 11/29	Loss: 0.854
Batch: 13/29	Loss: 0.853
Batch: 15/29	Loss: 0.873
Batch: 17/29	Loss: 0.861
Batch: 19/29	Loss: 0.887
Batch: 21/29	Loss: 0.848
Batch: 23/29	Loss: 0.854
Batch: 25/29	Loss: 0.834
Batch: 27/29	Loss: 0.884
Batch: 29/29	Loss: 0.836
Epoch: 2	Train Loss: 0.867	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.186

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.827
Batch: 3/29	Loss: 0.843
Batch: 5/29	Loss: 0.833
Batch: 7/29	Loss: 0.858
Batch: 9/29	Loss: 0.817
Batch: 11/29	Loss: 0.816
Batch: 13/29	Loss: 0.851
Batch: 15/29	Loss: 0.821
Batch: 17/29	Loss: 0.836
Batch: 19/29	Loss: 0.830
Batch: 21/29	Loss: 0.811
Batch: 23/29	Loss: 0.805
Batch: 25/29	Loss: 0.822
Batch: 27/29	Loss: 0.798
Batch: 29/29	Loss: 0.807
Epoch: 3	Train Loss: 0.826	Val F1: 0.213
Best Epoch: 3	Best Val F1: 0.213

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.791
Batch: 3/29	Loss: 0.805
Batch: 5/29	Loss: 0.787
Batch: 7/29	Loss: 0.831
Batch: 9/29	Loss: 0.813
Batch: 11/29	Loss: 0.771
Batch: 13/29	Loss: 0.779
Batch: 15/29	Loss: 0.765
Batch: 17/29	Loss: 0.772
Batch: 19/29	Loss: 0.795
Batch: 21/29	Loss: 0.798
Batch: 23/29	Loss: 0.783
Batch: 25/29	Loss: 0.776
Batch: 27/29	Loss: 0.800
Batch: 29/29	Loss: 0.785
Epoch: 4	Train Loss: 0.792	Val F1: 0.289
Best Epoch: 4	Best Val F1: 0.289

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.750
Batch: 3/29	Loss: 0.744
Batch: 5/29	Loss: 0.727
Batch: 7/29	Loss: 0.727
Batch: 9/29	Loss: 0.710
Batch: 11/29	Loss: 0.727
Batch: 13/29	Loss: 0.768
Batch: 15/29	Loss: 0.753
Batch: 17/29	Loss: 0.805
Batch: 19/29	Loss: 0.756
Batch: 21/29	Loss: 0.718
Batch: 23/29	Loss: 0.751
Batch: 25/29	Loss: 0.741
Batch: 27/29	Loss: 0.714
Batch: 29/29	Loss: 0.745
Epoch: 5	Train Loss: 0.748	Val F1: 0.314
Best Epoch: 5	Best Val F1: 0.314

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.737
Batch: 3/29	Loss: 0.767
Batch: 5/29	Loss: 0.664
Batch: 7/29	Loss: 0.782
Batch: 9/29	Loss: 0.694
Batch: 11/29	Loss: 0.709
Batch: 13/29	Loss: 0.704
Batch: 15/29	Loss: 0.646
Batch: 17/29	Loss: 0.671
Batch: 19/29	Loss: 0.660
Batch: 21/29	Loss: 0.747
Batch: 23/29	Loss: 0.706
Batch: 25/29	Loss: 0.677
Batch: 27/29	Loss: 0.675
Batch: 29/29	Loss: 0.691
Epoch: 6	Train Loss: 0.700	Val F1: 0.332
Best Epoch: 6	Best Val F1: 0.332

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.655
Batch: 3/29	Loss: 0.760
Batch: 5/29	Loss: 0.740
Batch: 7/29	Loss: 0.681
Batch: 9/29	Loss: 0.691
Batch: 11/29	Loss: 0.610
Batch: 13/29	Loss: 0.634
Batch: 15/29	Loss: 0.596
Batch: 17/29	Loss: 0.681
Batch: 19/29	Loss: 0.683
Batch: 21/29	Loss: 0.629
Batch: 23/29	Loss: 0.626
Batch: 25/29	Loss: 0.608
Batch: 27/29	Loss: 0.638
Batch: 29/29	Loss: 0.629
Epoch: 7	Train Loss: 0.656	Val F1: 0.339
Best Epoch: 7	Best Val F1: 0.339

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.638
Batch: 3/29	Loss: 0.593
Batch: 5/29	Loss: 0.630
Batch: 7/29	Loss: 0.607
Batch: 9/29	Loss: 0.581
Batch: 11/29	Loss: 0.629
Batch: 13/29	Loss: 0.650
Batch: 15/29	Loss: 0.599
Batch: 17/29	Loss: 0.625
Batch: 19/29	Loss: 0.620
Batch: 21/29	Loss: 0.673
Batch: 23/29	Loss: 0.619
Batch: 25/29	Loss: 0.727
Batch: 27/29	Loss: 0.618
Batch: 29/29	Loss: 0.610
Epoch: 8	Train Loss: 0.619	Val F1: 0.333
Best Epoch: 7	Best Val F1: 0.339

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.642
Batch: 3/29	Loss: 0.581
Batch: 5/29	Loss: 0.590
Batch: 7/29	Loss: 0.551
Batch: 9/29	Loss: 0.646
Batch: 11/29	Loss: 0.595
Batch: 13/29	Loss: 0.602
Batch: 15/29	Loss: 0.600
Batch: 17/29	Loss: 0.546
Batch: 19/29	Loss: 0.524
Batch: 21/29	Loss: 0.681
Batch: 23/29	Loss: 0.542
Batch: 25/29	Loss: 0.549
Batch: 27/29	Loss: 0.731
Batch: 29/29	Loss: 0.509
Epoch: 9	Train Loss: 0.586	Val F1: 0.350
Best Epoch: 9	Best Val F1: 0.350

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.484
Batch: 3/29	Loss: 0.614
Batch: 5/29	Loss: 0.510
Batch: 7/29	Loss: 0.495
Batch: 9/29	Loss: 0.527
Batch: 11/29	Loss: 0.449
Batch: 13/29	Loss: 0.685
Batch: 15/29	Loss: 0.592
Batch: 17/29	Loss: 0.722
Batch: 19/29	Loss: 0.420
Batch: 21/29	Loss: 0.669
Batch: 23/29	Loss: 0.618
Batch: 25/29	Loss: 0.599
Batch: 27/29	Loss: 0.534
Batch: 29/29	Loss: 0.578
Epoch: 10	Train Loss: 0.566	Val F1: 0.349
Best Epoch: 9	Best Val F1: 0.350

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.538
Batch: 3/29	Loss: 0.488
Batch: 5/29	Loss: 0.634
Batch: 7/29	Loss: 0.547
Batch: 9/29	Loss: 0.496
Batch: 11/29	Loss: 0.509
Batch: 13/29	Loss: 0.473
Batch: 15/29	Loss: 0.401
Batch: 17/29	Loss: 0.573
Batch: 19/29	Loss: 0.510
Batch: 21/29	Loss: 0.470
Batch: 23/29	Loss: 0.399
Batch: 25/29	Loss: 0.422
Batch: 27/29	Loss: 0.445
Batch: 29/29	Loss: 0.500
Epoch: 11	Train Loss: 0.506	Val F1: 0.351
Best Epoch: 11	Best Val F1: 0.351

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.556
Batch: 3/29	Loss: 0.427
Batch: 5/29	Loss: 0.452
Batch: 7/29	Loss: 0.448
Batch: 9/29	Loss: 0.470
Batch: 11/29	Loss: 0.498
Batch: 13/29	Loss: 0.458
Batch: 15/29	Loss: 0.498
Batch: 17/29	Loss: 0.457
Batch: 19/29	Loss: 0.461
Batch: 21/29	Loss: 0.430
Batch: 23/29	Loss: 0.454
Batch: 25/29	Loss: 0.468
Batch: 27/29	Loss: 0.542
Batch: 29/29	Loss: 0.375
Epoch: 12	Train Loss: 0.468	Val F1: 0.344
Best Epoch: 11	Best Val F1: 0.351

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.491
Batch: 3/29	Loss: 0.404
Batch: 5/29	Loss: 0.532
Batch: 7/29	Loss: 0.418
Batch: 9/29	Loss: 0.494
Batch: 11/29	Loss: 0.457
Batch: 13/29	Loss: 0.458
Batch: 15/29	Loss: 0.448
Batch: 17/29	Loss: 0.367
Batch: 19/29	Loss: 0.301
Batch: 21/29	Loss: 0.418
Batch: 23/29	Loss: 0.454
Batch: 25/29	Loss: 0.322
Batch: 27/29	Loss: 0.448
Batch: 29/29	Loss: 0.544
Epoch: 13	Train Loss: 0.446	Val F1: 0.343
Best Epoch: 11	Best Val F1: 0.351

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.441
Batch: 3/29	Loss: 0.505
Batch: 5/29	Loss: 0.333
Batch: 7/29	Loss: 0.427
Batch: 9/29	Loss: 0.419
Batch: 11/29	Loss: 0.418
Batch: 13/29	Loss: 0.384
Batch: 15/29	Loss: 0.347
Batch: 17/29	Loss: 0.489
Batch: 19/29	Loss: 0.481
Batch: 21/29	Loss: 0.320
Batch: 23/29	Loss: 0.318
Batch: 25/29	Loss: 0.459
Batch: 27/29	Loss: 0.427
Batch: 29/29	Loss: 0.472
Epoch: 14	Train Loss: 0.423	Val F1: 0.348
Best Epoch: 11	Best Val F1: 0.351

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.377
Batch: 3/29	Loss: 0.415
Batch: 5/29	Loss: 0.287
Batch: 7/29	Loss: 0.389
Batch: 9/29	Loss: 0.436
Batch: 11/29	Loss: 0.357
Batch: 13/29	Loss: 0.395
Batch: 15/29	Loss: 0.378
Batch: 17/29	Loss: 0.446
Batch: 19/29	Loss: 0.421
Batch: 21/29	Loss: 0.457
Batch: 23/29	Loss: 0.444
Batch: 25/29	Loss: 0.466
Batch: 27/29	Loss: 0.394
Batch: 29/29	Loss: 0.492
Epoch: 15	Train Loss: 0.410	Val F1: 0.343
Best Epoch: 11	Best Val F1: 0.351

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.432
Batch: 3/29	Loss: 0.395
Batch: 5/29	Loss: 0.442
Batch: 7/29	Loss: 0.358
Batch: 9/29	Loss: 0.441
Batch: 11/29	Loss: 0.347
Batch: 13/29	Loss: 0.330
Batch: 15/29	Loss: 0.301
Batch: 17/29	Loss: 0.382
Batch: 19/29	Loss: 0.421
Batch: 21/29	Loss: 0.296
Batch: 23/29	Loss: 0.413
Batch: 25/29	Loss: 0.462
Batch: 27/29	Loss: 0.351
Batch: 29/29	Loss: 0.390
Epoch: 16	Train Loss: 0.392	Val F1: 0.349
Best Epoch: 11	Best Val F1: 0.351

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.348
Batch: 3/29	Loss: 0.517
Batch: 5/29	Loss: 0.396
Batch: 7/29	Loss: 0.364
Batch: 9/29	Loss: 0.309
Batch: 11/29	Loss: 0.419
Batch: 13/29	Loss: 0.425
Batch: 15/29	Loss: 0.401
Batch: 17/29	Loss: 0.456
Batch: 19/29	Loss: 0.350
Batch: 21/29	Loss: 0.382
Batch: 23/29	Loss: 0.438
Batch: 25/29	Loss: 0.250
Batch: 27/29	Loss: 0.385
Batch: 29/29	Loss: 0.394
Epoch: 17	Train Loss: 0.383	Val F1: 0.348
Best Epoch: 11	Best Val F1: 0.351

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.421
Batch: 3/29	Loss: 0.404
Batch: 5/29	Loss: 0.352
Batch: 7/29	Loss: 0.300
Batch: 9/29	Loss: 0.458
Batch: 11/29	Loss: 0.314
Batch: 13/29	Loss: 0.280
Batch: 15/29	Loss: 0.357
Batch: 17/29	Loss: 0.334
Batch: 19/29	Loss: 0.319
Batch: 21/29	Loss: 0.368
Batch: 23/29	Loss: 0.383
Batch: 25/29	Loss: 0.372
Batch: 27/29	Loss: 0.276
Batch: 29/29	Loss: 0.410
Epoch: 18	Train Loss: 0.360	Val F1: 0.351
Best Epoch: 18	Best Val F1: 0.351

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.250
Batch: 3/29	Loss: 0.269
Batch: 5/29	Loss: 0.347
Batch: 7/29	Loss: 0.380
Batch: 9/29	Loss: 0.269
Batch: 11/29	Loss: 0.447
Batch: 13/29	Loss: 0.486
Batch: 15/29	Loss: 0.342
Batch: 17/29	Loss: 0.313
Batch: 19/29	Loss: 0.405
Batch: 21/29	Loss: 0.363
Batch: 23/29	Loss: 0.348
Batch: 25/29	Loss: 0.375
Batch: 27/29	Loss: 0.294
Batch: 29/29	Loss: 0.296
Epoch: 19	Train Loss: 0.351	Val F1: 0.346
Best Epoch: 18	Best Val F1: 0.351

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.405
Batch: 3/29	Loss: 0.374
Batch: 5/29	Loss: 0.316
Batch: 7/29	Loss: 0.272
Batch: 9/29	Loss: 0.381
Batch: 11/29	Loss: 0.350
Batch: 13/29	Loss: 0.378
Batch: 15/29	Loss: 0.349
Batch: 17/29	Loss: 0.402
Batch: 19/29	Loss: 0.292
Batch: 21/29	Loss: 0.336
Batch: 23/29	Loss: 0.338
Batch: 25/29	Loss: 0.291
Batch: 27/29	Loss: 0.335
Batch: 29/29	Loss: 0.378
Epoch: 20	Train Loss: 0.337	Val F1: 0.350
Best Epoch: 18	Best Val F1: 0.351

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.313
Batch: 3/29	Loss: 0.276
Batch: 5/29	Loss: 0.314
Batch: 7/29	Loss: 0.564
Batch: 9/29	Loss: 0.282
Batch: 11/29	Loss: 0.280
Batch: 13/29	Loss: 0.372
Batch: 15/29	Loss: 0.372
Batch: 17/29	Loss: 0.260
Batch: 19/29	Loss: 0.285
Batch: 21/29	Loss: 0.283
Batch: 23/29	Loss: 0.261
Batch: 25/29	Loss: 0.303
Batch: 27/29	Loss: 0.302
Batch: 29/29	Loss: 0.340
Epoch: 21	Train Loss: 0.327	Val F1: 0.344
Best Epoch: 18	Best Val F1: 0.351

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.327
Batch: 3/29	Loss: 0.266
Batch: 5/29	Loss: 0.326
Batch: 7/29	Loss: 0.342
Batch: 9/29	Loss: 0.275
Batch: 11/29	Loss: 0.300
Batch: 13/29	Loss: 0.272
Batch: 15/29	Loss: 0.279
Batch: 17/29	Loss: 0.371
Batch: 19/29	Loss: 0.421
Batch: 21/29	Loss: 0.396
Batch: 23/29	Loss: 0.331
Batch: 25/29	Loss: 0.305
Batch: 27/29	Loss: 0.269
Batch: 29/29	Loss: 0.307
Epoch: 22	Train Loss: 0.308	Val F1: 0.341
Best Epoch: 18	Best Val F1: 0.351

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.294
Batch: 3/29	Loss: 0.307
Batch: 5/29	Loss: 0.340
Batch: 7/29	Loss: 0.386
Batch: 9/29	Loss: 0.274
Batch: 11/29	Loss: 0.300
Batch: 13/29	Loss: 0.281
Batch: 15/29	Loss: 0.302
Batch: 17/29	Loss: 0.300
Batch: 19/29	Loss: 0.305
Batch: 21/29	Loss: 0.277
Batch: 23/29	Loss: 0.233
Batch: 25/29	Loss: 0.274
Batch: 27/29	Loss: 0.250
Batch: 29/29	Loss: 0.265
Epoch: 23	Train Loss: 0.297	Val F1: 0.346
Best Epoch: 18	Best Val F1: 0.351

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.276
Batch: 3/29	Loss: 0.247
Batch: 5/29	Loss: 0.330
Batch: 7/29	Loss: 0.267
Batch: 9/29	Loss: 0.334
Batch: 11/29	Loss: 0.384
Batch: 13/29	Loss: 0.281
Batch: 15/29	Loss: 0.288
Batch: 17/29	Loss: 0.259
Batch: 19/29	Loss: 0.350
Batch: 21/29	Loss: 0.360
Batch: 23/29	Loss: 0.254
Batch: 25/29	Loss: 0.311
Batch: 27/29	Loss: 0.244
Batch: 29/29	Loss: 0.237
Epoch: 24	Train Loss: 0.292	Val F1: 0.341
Best Epoch: 18	Best Val F1: 0.351

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.297
Batch: 3/29	Loss: 0.287
Batch: 5/29	Loss: 0.353
Batch: 7/29	Loss: 0.357
Batch: 9/29	Loss: 0.359
Batch: 11/29	Loss: 0.267
Batch: 13/29	Loss: 0.324
Batch: 15/29	Loss: 0.314
Batch: 17/29	Loss: 0.306
Batch: 19/29	Loss: 0.222
Batch: 21/29	Loss: 0.249
Batch: 23/29	Loss: 0.287
Batch: 25/29	Loss: 0.255
Batch: 27/29	Loss: 0.299
Batch: 29/29	Loss: 0.215
Epoch: 25	Train Loss: 0.275	Val F1: 0.355
Best Epoch: 25	Best Val F1: 0.355

****************************** Epoch: 26 ******************************
Batch: 1/29	Loss: 0.244
Batch: 3/29	Loss: 0.231
Batch: 5/29	Loss: 0.291
Batch: 7/29	Loss: 0.303
Batch: 9/29	Loss: 0.273
Batch: 11/29	Loss: 0.284
Batch: 13/29	Loss: 0.267
Batch: 15/29	Loss: 0.246
Batch: 17/29	Loss: 0.207
Batch: 19/29	Loss: 0.283
Batch: 21/29	Loss: 0.371
Batch: 23/29	Loss: 0.163
Batch: 25/29	Loss: 0.302
Batch: 27/29	Loss: 0.208
Batch: 29/29	Loss: 0.294
Epoch: 26	Train Loss: 0.264	Val F1: 0.343
Best Epoch: 25	Best Val F1: 0.355

****************************** Epoch: 27 ******************************
Batch: 1/29	Loss: 0.233
Batch: 3/29	Loss: 0.293
Batch: 5/29	Loss: 0.384
Batch: 7/29	Loss: 0.182
Batch: 9/29	Loss: 0.340
Batch: 11/29	Loss: 0.216
Batch: 13/29	Loss: 0.321
Batch: 15/29	Loss: 0.278
Batch: 17/29	Loss: 0.224
Batch: 19/29	Loss: 0.247
Batch: 21/29	Loss: 0.288
Batch: 23/29	Loss: 0.203
Batch: 25/29	Loss: 0.222
Batch: 27/29	Loss: 0.260
Batch: 29/29	Loss: 0.296
Epoch: 27	Train Loss: 0.252	Val F1: 0.341
Best Epoch: 25	Best Val F1: 0.355

****************************** Epoch: 28 ******************************
Batch: 1/29	Loss: 0.282
Batch: 3/29	Loss: 0.250
Batch: 5/29	Loss: 0.272
Batch: 7/29	Loss: 0.234
Batch: 9/29	Loss: 0.268
Batch: 11/29	Loss: 0.277
Batch: 13/29	Loss: 0.211
Batch: 15/29	Loss: 0.316
Batch: 17/29	Loss: 0.303
Batch: 19/29	Loss: 0.234
Batch: 21/29	Loss: 0.187
Batch: 23/29	Loss: 0.301
Batch: 25/29	Loss: 0.305
Batch: 27/29	Loss: 0.215
Batch: 29/29	Loss: 0.239
Epoch: 28	Train Loss: 0.258	Val F1: 0.340
Best Epoch: 25	Best Val F1: 0.355

****************************** Epoch: 29 ******************************
Batch: 1/29	Loss: 0.264
Batch: 3/29	Loss: 0.266
Batch: 5/29	Loss: 0.232
Batch: 7/29	Loss: 0.215
Batch: 9/29	Loss: 0.191
Batch: 11/29	Loss: 0.297
Batch: 13/29	Loss: 0.329
Batch: 15/29	Loss: 0.145
Batch: 17/29	Loss: 0.251
Batch: 19/29	Loss: 0.192
Batch: 21/29	Loss: 0.308
Batch: 23/29	Loss: 0.261
Batch: 25/29	Loss: 0.266
Batch: 27/29	Loss: 0.271
Batch: 29/29	Loss: 0.226
Epoch: 29	Train Loss: 0.247	Val F1: 0.340
Best Epoch: 25	Best Val F1: 0.355

****************************** Epoch: 30 ******************************
Batch: 1/29	Loss: 0.177
Batch: 3/29	Loss: 0.226
Batch: 5/29	Loss: 0.302
Batch: 7/29	Loss: 0.209
Batch: 9/29	Loss: 0.230
Batch: 11/29	Loss: 0.218
Batch: 13/29	Loss: 0.264
Batch: 15/29	Loss: 0.181
Batch: 17/29	Loss: 0.210
Batch: 19/29	Loss: 0.215
Batch: 21/29	Loss: 0.252
Batch: 23/29	Loss: 0.243
Batch: 25/29	Loss: 0.228
Batch: 27/29	Loss: 0.252
Batch: 29/29	Loss: 0.192
Epoch: 30	Train Loss: 0.233	Val F1: 0.341
Best Epoch: 25	Best Val F1: 0.355

****************************** Epoch: 31 ******************************
Batch: 1/29	Loss: 0.202
Batch: 3/29	Loss: 0.203
Batch: 5/29	Loss: 0.191
Batch: 7/29	Loss: 0.185
Batch: 9/29	Loss: 0.226
Batch: 11/29	Loss: 0.208
Batch: 13/29	Loss: 0.245
Batch: 15/29	Loss: 0.176
Batch: 17/29	Loss: 0.236
Batch: 19/29	Loss: 0.183
Batch: 21/29	Loss: 0.226
Batch: 23/29	Loss: 0.202
Batch: 25/29	Loss: 0.276
Batch: 27/29	Loss: 0.171
Batch: 29/29	Loss: 0.187
Epoch: 31	Train Loss: 0.208	Val F1: 0.346
Best Epoch: 25	Best Val F1: 0.355

****************************** Epoch: 32 ******************************
Batch: 1/29	Loss: 0.244
Batch: 3/29	Loss: 0.177
Batch: 5/29	Loss: 0.192
Batch: 7/29	Loss: 0.160
Batch: 9/29	Loss: 0.180
Batch: 11/29	Loss: 0.210
Batch: 13/29	Loss: 0.182
Batch: 15/29	Loss: 0.100
Batch: 17/29	Loss: 0.214
Batch: 19/29	Loss: 0.274
Batch: 21/29	Loss: 0.159
Batch: 23/29	Loss: 0.212
Batch: 25/29	Loss: 0.208
Batch: 27/29	Loss: 0.120
Batch: 29/29	Loss: 0.210
Epoch: 32	Train Loss: 0.205	Val F1: 0.349
Best Epoch: 25	Best Val F1: 0.355

****************************** Epoch: 33 ******************************
Batch: 1/29	Loss: 0.234
Batch: 3/29	Loss: 0.245
Batch: 5/29	Loss: 0.229
Batch: 7/29	Loss: 0.220
Batch: 9/29	Loss: 0.222
Batch: 11/29	Loss: 0.171
Batch: 13/29	Loss: 0.250
Batch: 15/29	Loss: 0.229
Batch: 17/29	Loss: 0.206
Batch: 19/29	Loss: 0.198
Batch: 21/29	Loss: 0.143
Batch: 23/29	Loss: 0.152
Batch: 25/29	Loss: 0.252
Batch: 27/29	Loss: 0.213
Batch: 29/29	Loss: 0.154
Epoch: 33	Train Loss: 0.199	Val F1: 0.339
Best Epoch: 25	Best Val F1: 0.355

****************************** Epoch: 34 ******************************
Batch: 1/29	Loss: 0.157
Batch: 3/29	Loss: 0.184
Batch: 5/29	Loss: 0.173
Batch: 7/29	Loss: 0.180
Batch: 9/29	Loss: 0.197
Batch: 11/29	Loss: 0.224
Batch: 13/29	Loss: 0.127
Batch: 15/29	Loss: 0.162
Batch: 17/29	Loss: 0.198
Batch: 19/29	Loss: 0.134
Batch: 21/29	Loss: 0.252
Batch: 23/29	Loss: 0.127
Batch: 25/29	Loss: 0.183
Batch: 27/29	Loss: 0.153
Batch: 29/29	Loss: 0.176
Epoch: 34	Train Loss: 0.188	Val F1: 0.351
Best Epoch: 25	Best Val F1: 0.355

****************************** Epoch: 35 ******************************
Batch: 1/29	Loss: 0.151
Batch: 3/29	Loss: 0.226
Batch: 5/29	Loss: 0.168
Batch: 7/29	Loss: 0.152
Batch: 9/29	Loss: 0.177
Batch: 11/29	Loss: 0.115
Batch: 13/29	Loss: 0.203
Batch: 15/29	Loss: 0.185
Batch: 17/29	Loss: 0.178
Batch: 19/29	Loss: 0.213
Batch: 21/29	Loss: 0.186
Batch: 23/29	Loss: 0.205
Batch: 25/29	Loss: 0.197
Batch: 27/29	Loss: 0.148
Batch: 29/29	Loss: 0.152
Epoch: 35	Train Loss: 0.182	Val F1: 0.345
Best Epoch: 25	Best Val F1: 0.355

Saving the best checkpoint....
Inference...
Test F1: 0.370	Test F1_Few: 0.450	Test F1_Zero: 0.361
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0007197426660608856, 'lr': 4.2457507538090504e-05, 'n_layers_freeze': 2, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.038
Batch: 5/29	Loss: 0.974
Batch: 7/29	Loss: 0.945
Batch: 9/29	Loss: 0.917
Batch: 11/29	Loss: 0.914
Batch: 13/29	Loss: 0.898
Batch: 15/29	Loss: 0.917
Batch: 17/29	Loss: 0.862
Batch: 19/29	Loss: 0.869
Batch: 21/29	Loss: 0.836
Batch: 23/29	Loss: 0.856
Batch: 25/29	Loss: 0.808
Batch: 27/29	Loss: 0.811
Batch: 29/29	Loss: 0.824
Epoch: 1	Train Loss: 0.901	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.185

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.812
Batch: 3/29	Loss: 0.812
Batch: 5/29	Loss: 0.858
Batch: 7/29	Loss: 0.796
Batch: 9/29	Loss: 0.824
Batch: 11/29	Loss: 0.761
Batch: 13/29	Loss: 0.767
Batch: 15/29	Loss: 0.793
Batch: 17/29	Loss: 0.786
Batch: 19/29	Loss: 0.842
Batch: 21/29	Loss: 0.770
Batch: 23/29	Loss: 0.784
Batch: 25/29	Loss: 0.751
Batch: 27/29	Loss: 0.842
Batch: 29/29	Loss: 0.754
Epoch: 2	Train Loss: 0.791	Val F1: 0.260
Best Epoch: 2	Best Val F1: 0.260

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.739
Batch: 3/29	Loss: 0.770
Batch: 5/29	Loss: 0.747
Batch: 7/29	Loss: 0.799
Batch: 9/29	Loss: 0.730
Batch: 11/29	Loss: 0.750
Batch: 13/29	Loss: 0.781
Batch: 15/29	Loss: 0.739
Batch: 17/29	Loss: 0.753
Batch: 19/29	Loss: 0.770
Batch: 21/29	Loss: 0.715
Batch: 23/29	Loss: 0.691
Batch: 25/29	Loss: 0.735
Batch: 27/29	Loss: 0.725
Batch: 29/29	Loss: 0.735
Epoch: 3	Train Loss: 0.747	Val F1: 0.323
Best Epoch: 3	Best Val F1: 0.323

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.710
Batch: 3/29	Loss: 0.709
Batch: 5/29	Loss: 0.697
Batch: 7/29	Loss: 0.768
Batch: 9/29	Loss: 0.729
Batch: 11/29	Loss: 0.639
Batch: 13/29	Loss: 0.659
Batch: 15/29	Loss: 0.650
Batch: 17/29	Loss: 0.696
Batch: 19/29	Loss: 0.706
Batch: 21/29	Loss: 0.681
Batch: 23/29	Loss: 0.678
Batch: 25/29	Loss: 0.652
Batch: 27/29	Loss: 0.691
Batch: 29/29	Loss: 0.671
Epoch: 4	Train Loss: 0.693	Val F1: 0.341
Best Epoch: 4	Best Val F1: 0.341

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.625
Batch: 3/29	Loss: 0.614
Batch: 5/29	Loss: 0.573
Batch: 7/29	Loss: 0.676
Batch: 9/29	Loss: 0.568
Batch: 11/29	Loss: 0.629
Batch: 13/29	Loss: 0.641
Batch: 15/29	Loss: 0.683
Batch: 17/29	Loss: 0.681
Batch: 19/29	Loss: 0.666
Batch: 21/29	Loss: 0.617
Batch: 23/29	Loss: 0.789
Batch: 25/29	Loss: 0.671
Batch: 27/29	Loss: 0.644
Batch: 29/29	Loss: 0.722
Epoch: 5	Train Loss: 0.661	Val F1: 0.345
Best Epoch: 5	Best Val F1: 0.345

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.632
Batch: 3/29	Loss: 0.714
Batch: 5/29	Loss: 0.562
Batch: 7/29	Loss: 0.723
Batch: 9/29	Loss: 0.703
Batch: 11/29	Loss: 0.599
Batch: 13/29	Loss: 0.664
Batch: 15/29	Loss: 0.660
Batch: 17/29	Loss: 0.599
Batch: 19/29	Loss: 0.573
Batch: 21/29	Loss: 0.675
Batch: 23/29	Loss: 0.621
Batch: 25/29	Loss: 0.680
Batch: 27/29	Loss: 0.615
Batch: 29/29	Loss: 0.575
Epoch: 6	Train Loss: 0.636	Val F1: 0.355
Best Epoch: 6	Best Val F1: 0.355

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.546
Batch: 3/29	Loss: 0.650
Batch: 5/29	Loss: 0.761
Batch: 7/29	Loss: 0.668
Batch: 9/29	Loss: 0.675
Batch: 11/29	Loss: 0.551
Batch: 13/29	Loss: 0.568
Batch: 15/29	Loss: 0.608
Batch: 17/29	Loss: 0.657
Batch: 19/29	Loss: 0.623
Batch: 21/29	Loss: 0.561
Batch: 23/29	Loss: 0.527
Batch: 25/29	Loss: 0.499
Batch: 27/29	Loss: 0.560
Batch: 29/29	Loss: 0.544
Epoch: 7	Train Loss: 0.591	Val F1: 0.333
Best Epoch: 6	Best Val F1: 0.355

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.584
Batch: 3/29	Loss: 0.495
Batch: 5/29	Loss: 0.561
Batch: 7/29	Loss: 0.575
Batch: 9/29	Loss: 0.499
Batch: 11/29	Loss: 0.631
Batch: 13/29	Loss: 0.578
Batch: 15/29	Loss: 0.547
Batch: 17/29	Loss: 0.587
Batch: 19/29	Loss: 0.492
Batch: 21/29	Loss: 0.588
Batch: 23/29	Loss: 0.588
Batch: 25/29	Loss: 0.639
Batch: 27/29	Loss: 0.629
Batch: 29/29	Loss: 0.567
Epoch: 8	Train Loss: 0.565	Val F1: 0.374
Best Epoch: 8	Best Val F1: 0.374

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.636
Batch: 3/29	Loss: 0.551
Batch: 5/29	Loss: 0.552
Batch: 7/29	Loss: 0.542
Batch: 9/29	Loss: 0.597
Batch: 11/29	Loss: 0.581
Batch: 13/29	Loss: 0.578
Batch: 15/29	Loss: 0.511
Batch: 17/29	Loss: 0.568
Batch: 19/29	Loss: 0.430
Batch: 21/29	Loss: 0.598
Batch: 23/29	Loss: 0.491
Batch: 25/29	Loss: 0.505
Batch: 27/29	Loss: 0.501
Batch: 29/29	Loss: 0.469
Epoch: 9	Train Loss: 0.532	Val F1: 0.357
Best Epoch: 8	Best Val F1: 0.374

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.402
Batch: 3/29	Loss: 0.491
Batch: 5/29	Loss: 0.462
Batch: 7/29	Loss: 0.436
Batch: 9/29	Loss: 0.445
Batch: 11/29	Loss: 0.406
Batch: 13/29	Loss: 0.547
Batch: 15/29	Loss: 0.548
Batch: 17/29	Loss: 0.541
Batch: 19/29	Loss: 0.427
Batch: 21/29	Loss: 0.521
Batch: 23/29	Loss: 0.569
Batch: 25/29	Loss: 0.613
Batch: 27/29	Loss: 0.401
Batch: 29/29	Loss: 0.526
Epoch: 10	Train Loss: 0.480	Val F1: 0.355
Best Epoch: 8	Best Val F1: 0.374

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.458
Batch: 3/29	Loss: 0.393
Batch: 5/29	Loss: 0.632
Batch: 7/29	Loss: 0.421
Batch: 9/29	Loss: 0.396
Batch: 11/29	Loss: 0.414
Batch: 13/29	Loss: 0.445
Batch: 15/29	Loss: 0.360
Batch: 17/29	Loss: 0.508
Batch: 19/29	Loss: 0.491
Batch: 21/29	Loss: 0.384
Batch: 23/29	Loss: 0.364
Batch: 25/29	Loss: 0.360
Batch: 27/29	Loss: 0.404
Batch: 29/29	Loss: 0.466
Epoch: 11	Train Loss: 0.442	Val F1: 0.357
Best Epoch: 8	Best Val F1: 0.374

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.491
Batch: 3/29	Loss: 0.391
Batch: 5/29	Loss: 0.390
Batch: 7/29	Loss: 0.414
Batch: 9/29	Loss: 0.458
Batch: 11/29	Loss: 0.464
Batch: 13/29	Loss: 0.420
Batch: 15/29	Loss: 0.350
Batch: 17/29	Loss: 0.410
Batch: 19/29	Loss: 0.464
Batch: 21/29	Loss: 0.414
Batch: 23/29	Loss: 0.472
Batch: 25/29	Loss: 0.452
Batch: 27/29	Loss: 0.573
Batch: 29/29	Loss: 0.338
Epoch: 12	Train Loss: 0.420	Val F1: 0.359
Best Epoch: 8	Best Val F1: 0.374

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.471
Batch: 3/29	Loss: 0.289
Batch: 5/29	Loss: 0.437
Batch: 7/29	Loss: 0.335
Batch: 9/29	Loss: 0.456
Batch: 11/29	Loss: 0.438
Batch: 13/29	Loss: 0.462
Batch: 15/29	Loss: 0.361
Batch: 17/29	Loss: 0.355
Batch: 19/29	Loss: 0.271
Batch: 21/29	Loss: 0.349
Batch: 23/29	Loss: 0.430
Batch: 25/29	Loss: 0.292
Batch: 27/29	Loss: 0.446
Batch: 29/29	Loss: 0.471
Epoch: 13	Train Loss: 0.402	Val F1: 0.351
Best Epoch: 8	Best Val F1: 0.374

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.389
Batch: 3/29	Loss: 0.436
Batch: 5/29	Loss: 0.297
Batch: 7/29	Loss: 0.413
Batch: 9/29	Loss: 0.397
Batch: 11/29	Loss: 0.346
Batch: 13/29	Loss: 0.337
Batch: 15/29	Loss: 0.293
Batch: 17/29	Loss: 0.473
Batch: 19/29	Loss: 0.437
Batch: 21/29	Loss: 0.216
Batch: 23/29	Loss: 0.308
Batch: 25/29	Loss: 0.385
Batch: 27/29	Loss: 0.372
Batch: 29/29	Loss: 0.329
Epoch: 14	Train Loss: 0.371	Val F1: 0.347
Best Epoch: 8	Best Val F1: 0.374

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.308
Batch: 3/29	Loss: 0.363
Batch: 5/29	Loss: 0.253
Batch: 7/29	Loss: 0.329
Batch: 9/29	Loss: 0.423
Batch: 11/29	Loss: 0.363
Batch: 13/29	Loss: 0.322
Batch: 15/29	Loss: 0.322
Batch: 17/29	Loss: 0.383
Batch: 19/29	Loss: 0.307
Batch: 21/29	Loss: 0.330
Batch: 23/29	Loss: 0.382
Batch: 25/29	Loss: 0.391
Batch: 27/29	Loss: 0.318
Batch: 29/29	Loss: 0.444
Epoch: 15	Train Loss: 0.352	Val F1: 0.353
Best Epoch: 8	Best Val F1: 0.374

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.365
Batch: 3/29	Loss: 0.390
Batch: 5/29	Loss: 0.388
Batch: 7/29	Loss: 0.295
Batch: 9/29	Loss: 0.303
Batch: 11/29	Loss: 0.325
Batch: 13/29	Loss: 0.276
Batch: 15/29	Loss: 0.247
Batch: 17/29	Loss: 0.293
Batch: 19/29	Loss: 0.436
Batch: 21/29	Loss: 0.249
Batch: 23/29	Loss: 0.314
Batch: 25/29	Loss: 0.365
Batch: 27/29	Loss: 0.306
Batch: 29/29	Loss: 0.329
Epoch: 16	Train Loss: 0.333	Val F1: 0.351
Best Epoch: 8	Best Val F1: 0.374

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.271
Batch: 3/29	Loss: 0.397
Batch: 5/29	Loss: 0.300
Batch: 7/29	Loss: 0.274
Batch: 9/29	Loss: 0.178
Batch: 11/29	Loss: 0.382
Batch: 13/29	Loss: 0.415
Batch: 15/29	Loss: 0.377
Batch: 17/29	Loss: 0.347
Batch: 19/29	Loss: 0.274
Batch: 21/29	Loss: 0.320
Batch: 23/29	Loss: 0.393
Batch: 25/29	Loss: 0.197
Batch: 27/29	Loss: 0.315
Batch: 29/29	Loss: 0.365
Epoch: 17	Train Loss: 0.311	Val F1: 0.342
Best Epoch: 8	Best Val F1: 0.374

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.360
Batch: 3/29	Loss: 0.376
Batch: 5/29	Loss: 0.290
Batch: 7/29	Loss: 0.306
Batch: 9/29	Loss: 0.428
Batch: 11/29	Loss: 0.216
Batch: 13/29	Loss: 0.207
Batch: 15/29	Loss: 0.276
Batch: 17/29	Loss: 0.271
Batch: 19/29	Loss: 0.225
Batch: 21/29	Loss: 0.300
Batch: 23/29	Loss: 0.282
Batch: 25/29	Loss: 0.315
Batch: 27/29	Loss: 0.217
Batch: 29/29	Loss: 0.293
Epoch: 18	Train Loss: 0.289	Val F1: 0.348
Best Epoch: 8	Best Val F1: 0.374

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.209
Batch: 3/29	Loss: 0.197
Batch: 5/29	Loss: 0.265
Batch: 7/29	Loss: 0.350
Batch: 9/29	Loss: 0.233
Batch: 11/29	Loss: 0.321
Batch: 13/29	Loss: 0.377
Batch: 15/29	Loss: 0.250
Batch: 17/29	Loss: 0.218
Batch: 19/29	Loss: 0.356
Batch: 21/29	Loss: 0.283
Batch: 23/29	Loss: 0.277
Batch: 25/29	Loss: 0.310
Batch: 27/29	Loss: 0.200
Batch: 29/29	Loss: 0.268
Epoch: 19	Train Loss: 0.274	Val F1: 0.354
Best Epoch: 8	Best Val F1: 0.374

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.352
Batch: 3/29	Loss: 0.252
Batch: 5/29	Loss: 0.214
Batch: 7/29	Loss: 0.215
Batch: 9/29	Loss: 0.226
Batch: 11/29	Loss: 0.329
Batch: 13/29	Loss: 0.272
Batch: 15/29	Loss: 0.255
Batch: 17/29	Loss: 0.312
Batch: 19/29	Loss: 0.251
Batch: 21/29	Loss: 0.208
Batch: 23/29	Loss: 0.351
Batch: 25/29	Loss: 0.233
Batch: 27/29	Loss: 0.229
Batch: 29/29	Loss: 0.360
Epoch: 20	Train Loss: 0.267	Val F1: 0.361
Best Epoch: 8	Best Val F1: 0.374

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.183
Batch: 3/29	Loss: 0.191
Batch: 5/29	Loss: 0.205
Batch: 7/29	Loss: 0.398
Batch: 9/29	Loss: 0.180
Batch: 11/29	Loss: 0.166
Batch: 13/29	Loss: 0.252
Batch: 15/29	Loss: 0.251
Batch: 17/29	Loss: 0.165
Batch: 19/29	Loss: 0.255
Batch: 21/29	Loss: 0.206
Batch: 23/29	Loss: 0.225
Batch: 25/29	Loss: 0.223
Batch: 27/29	Loss: 0.199
Batch: 29/29	Loss: 0.197
Epoch: 21	Train Loss: 0.224	Val F1: 0.344
Best Epoch: 8	Best Val F1: 0.374

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.158
Batch: 3/29	Loss: 0.169
Batch: 5/29	Loss: 0.204
Batch: 7/29	Loss: 0.232
Batch: 9/29	Loss: 0.139
Batch: 11/29	Loss: 0.195
Batch: 13/29	Loss: 0.141
Batch: 15/29	Loss: 0.142
Batch: 17/29	Loss: 0.151
Batch: 19/29	Loss: 0.284
Batch: 21/29	Loss: 0.298
Batch: 23/29	Loss: 0.175
Batch: 25/29	Loss: 0.170
Batch: 27/29	Loss: 0.103
Batch: 29/29	Loss: 0.170
Epoch: 22	Train Loss: 0.173	Val F1: 0.339
Best Epoch: 8	Best Val F1: 0.374

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.121
Batch: 3/29	Loss: 0.122
Batch: 5/29	Loss: 0.161
Batch: 7/29	Loss: 0.215
Batch: 9/29	Loss: 0.122
Batch: 11/29	Loss: 0.087
Batch: 13/29	Loss: 0.115
Batch: 15/29	Loss: 0.142
Batch: 17/29	Loss: 0.285
Batch: 19/29	Loss: 0.189
Batch: 21/29	Loss: 0.124
Batch: 23/29	Loss: 0.101
Batch: 25/29	Loss: 0.120
Batch: 27/29	Loss: 0.160
Batch: 29/29	Loss: 0.213
Epoch: 23	Train Loss: 0.149	Val F1: 0.355
Best Epoch: 8	Best Val F1: 0.374

Saving the best checkpoint....
Inference...
Test F1: 0.386	Test F1_Few: 0.456	Test F1_Zero: 0.388
Starting training with config: {'batch_size': 32, 'epochs': 50, 'l2_reg': 0.0007941193583549672, 'lr': 1.504665937365641e-05, 'n_layers_freeze': 0, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 1.048
Batch: 11/58	Loss: 0.991
Batch: 16/58	Loss: 0.933
Batch: 21/58	Loss: 0.930
Batch: 26/58	Loss: 0.919
Batch: 31/58	Loss: 0.890
Batch: 36/58	Loss: 0.909
Batch: 41/58	Loss: 0.861
Batch: 46/58	Loss: 0.845
Batch: 51/58	Loss: 0.832
Batch: 56/58	Loss: 0.836
Batch: 58/58	Loss: 0.842
Epoch: 1	Train Loss: 0.924	Val F1: 0.199
Best Epoch: 1	Best Val F1: 0.199

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.848
Batch: 6/58	Loss: 0.853
Batch: 11/58	Loss: 0.856
Batch: 16/58	Loss: 0.800
Batch: 21/58	Loss: 0.796
Batch: 26/58	Loss: 0.801
Batch: 31/58	Loss: 0.836
Batch: 36/58	Loss: 0.832
Batch: 41/58	Loss: 0.788
Batch: 46/58	Loss: 0.783
Batch: 51/58	Loss: 0.786
Batch: 56/58	Loss: 0.784
Batch: 58/58	Loss: 0.762
Epoch: 2	Train Loss: 0.814	Val F1: 0.315
Best Epoch: 2	Best Val F1: 0.315

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.760
Batch: 6/58	Loss: 0.747
Batch: 11/58	Loss: 0.815
Batch: 16/58	Loss: 0.744
Batch: 21/58	Loss: 0.765
Batch: 26/58	Loss: 0.735
Batch: 31/58	Loss: 0.878
Batch: 36/58	Loss: 0.774
Batch: 41/58	Loss: 0.703
Batch: 46/58	Loss: 0.707
Batch: 51/58	Loss: 0.768
Batch: 56/58	Loss: 0.706
Batch: 58/58	Loss: 0.770
Epoch: 3	Train Loss: 0.763	Val F1: 0.307
Best Epoch: 2	Best Val F1: 0.315

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.753
Batch: 6/58	Loss: 0.709
Batch: 11/58	Loss: 0.669
Batch: 16/58	Loss: 0.658
Batch: 21/58	Loss: 0.609
Batch: 26/58	Loss: 0.600
Batch: 31/58	Loss: 0.625
Batch: 36/58	Loss: 0.747
Batch: 41/58	Loss: 0.721
Batch: 46/58	Loss: 0.679
Batch: 51/58	Loss: 0.698
Batch: 56/58	Loss: 0.620
Batch: 58/58	Loss: 0.654
Epoch: 4	Train Loss: 0.697	Val F1: 0.340
Best Epoch: 4	Best Val F1: 0.340

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.613
Batch: 6/58	Loss: 0.606
Batch: 11/58	Loss: 0.615
Batch: 16/58	Loss: 0.606
Batch: 21/58	Loss: 0.506
Batch: 26/58	Loss: 0.545
Batch: 31/58	Loss: 0.752
Batch: 36/58	Loss: 0.678
Batch: 41/58	Loss: 0.656
Batch: 46/58	Loss: 0.677
Batch: 51/58	Loss: 0.804
Batch: 56/58	Loss: 0.753
Batch: 58/58	Loss: 0.805
Epoch: 5	Train Loss: 0.644	Val F1: 0.348
Best Epoch: 5	Best Val F1: 0.348

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.581
Batch: 6/58	Loss: 0.762
Batch: 11/58	Loss: 0.640
Batch: 16/58	Loss: 0.645
Batch: 21/58	Loss: 0.635
Batch: 26/58	Loss: 0.527
Batch: 31/58	Loss: 0.535
Batch: 36/58	Loss: 0.493
Batch: 41/58	Loss: 0.579
Batch: 46/58	Loss: 0.584
Batch: 51/58	Loss: 0.555
Batch: 56/58	Loss: 0.605
Batch: 58/58	Loss: 0.470
Epoch: 6	Train Loss: 0.601	Val F1: 0.327
Best Epoch: 5	Best Val F1: 0.348

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.465
Batch: 6/58	Loss: 0.646
Batch: 11/58	Loss: 0.716
Batch: 16/58	Loss: 0.459
Batch: 21/58	Loss: 0.452
Batch: 26/58	Loss: 0.525
Batch: 31/58	Loss: 0.586
Batch: 36/58	Loss: 0.474
Batch: 41/58	Loss: 0.513
Batch: 46/58	Loss: 0.517
Batch: 51/58	Loss: 0.427
Batch: 56/58	Loss: 0.560
Batch: 58/58	Loss: 0.422
Epoch: 7	Train Loss: 0.547	Val F1: 0.353
Best Epoch: 7	Best Val F1: 0.353

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.505
Batch: 6/58	Loss: 0.506
Batch: 11/58	Loss: 0.464
Batch: 16/58	Loss: 0.420
Batch: 21/58	Loss: 0.515
Batch: 26/58	Loss: 0.403
Batch: 31/58	Loss: 0.524
Batch: 36/58	Loss: 0.369
Batch: 41/58	Loss: 0.602
Batch: 46/58	Loss: 0.532
Batch: 51/58	Loss: 0.449
Batch: 56/58	Loss: 0.428
Batch: 58/58	Loss: 0.552
Epoch: 8	Train Loss: 0.493	Val F1: 0.348
Best Epoch: 7	Best Val F1: 0.353

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.492
Batch: 6/58	Loss: 0.613
Batch: 11/58	Loss: 0.491
Batch: 16/58	Loss: 0.345
Batch: 21/58	Loss: 0.383
Batch: 26/58	Loss: 0.397
Batch: 31/58	Loss: 0.444
Batch: 36/58	Loss: 0.458
Batch: 41/58	Loss: 0.466
Batch: 46/58	Loss: 0.394
Batch: 51/58	Loss: 0.599
Batch: 56/58	Loss: 0.358
Batch: 58/58	Loss: 0.389
Epoch: 9	Train Loss: 0.444	Val F1: 0.366
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.370
Batch: 6/58	Loss: 0.447
Batch: 11/58	Loss: 0.415
Batch: 16/58	Loss: 0.491
Batch: 21/58	Loss: 0.317
Batch: 26/58	Loss: 0.414
Batch: 31/58	Loss: 0.306
Batch: 36/58	Loss: 0.617
Batch: 41/58	Loss: 0.473
Batch: 46/58	Loss: 0.520
Batch: 51/58	Loss: 0.376
Batch: 56/58	Loss: 0.337
Batch: 58/58	Loss: 0.462
Epoch: 10	Train Loss: 0.403	Val F1: 0.343
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.374
Batch: 6/58	Loss: 0.355
Batch: 11/58	Loss: 0.283
Batch: 16/58	Loss: 0.398
Batch: 21/58	Loss: 0.372
Batch: 26/58	Loss: 0.531
Batch: 31/58	Loss: 0.415
Batch: 36/58	Loss: 0.430
Batch: 41/58	Loss: 0.308
Batch: 46/58	Loss: 0.310
Batch: 51/58	Loss: 0.371
Batch: 56/58	Loss: 0.410
Batch: 58/58	Loss: 0.369
Epoch: 11	Train Loss: 0.379	Val F1: 0.360
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.410
Batch: 6/58	Loss: 0.292
Batch: 11/58	Loss: 0.342
Batch: 16/58	Loss: 0.309
Batch: 21/58	Loss: 0.446
Batch: 26/58	Loss: 0.311
Batch: 31/58	Loss: 0.451
Batch: 36/58	Loss: 0.303
Batch: 41/58	Loss: 0.322
Batch: 46/58	Loss: 0.375
Batch: 51/58	Loss: 0.444
Batch: 56/58	Loss: 0.289
Batch: 58/58	Loss: 0.210
Epoch: 12	Train Loss: 0.361	Val F1: 0.353
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 13 ******************************
Batch: 1/58	Loss: 0.388
Batch: 6/58	Loss: 0.257
Batch: 11/58	Loss: 0.333
Batch: 16/58	Loss: 0.340
Batch: 21/58	Loss: 0.336
Batch: 26/58	Loss: 0.301
Batch: 31/58	Loss: 0.359
Batch: 36/58	Loss: 0.311
Batch: 41/58	Loss: 0.260
Batch: 46/58	Loss: 0.403
Batch: 51/58	Loss: 0.258
Batch: 56/58	Loss: 0.415
Batch: 58/58	Loss: 0.205
Epoch: 13	Train Loss: 0.336	Val F1: 0.351
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 14 ******************************
Batch: 1/58	Loss: 0.365
Batch: 6/58	Loss: 0.407
Batch: 11/58	Loss: 0.356
Batch: 16/58	Loss: 0.392
Batch: 21/58	Loss: 0.295
Batch: 26/58	Loss: 0.328
Batch: 31/58	Loss: 0.276
Batch: 36/58	Loss: 0.274
Batch: 41/58	Loss: 0.185
Batch: 46/58	Loss: 0.262
Batch: 51/58	Loss: 0.368
Batch: 56/58	Loss: 0.239
Batch: 58/58	Loss: 0.374
Epoch: 14	Train Loss: 0.311	Val F1: 0.349
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 15 ******************************
Batch: 1/58	Loss: 0.218
Batch: 6/58	Loss: 0.331
Batch: 11/58	Loss: 0.357
Batch: 16/58	Loss: 0.293
Batch: 21/58	Loss: 0.373
Batch: 26/58	Loss: 0.275
Batch: 31/58	Loss: 0.256
Batch: 36/58	Loss: 0.324
Batch: 41/58	Loss: 0.299
Batch: 46/58	Loss: 0.223
Batch: 51/58	Loss: 0.216
Batch: 56/58	Loss: 0.232
Batch: 58/58	Loss: 0.326
Epoch: 15	Train Loss: 0.294	Val F1: 0.356
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 16 ******************************
Batch: 1/58	Loss: 0.290
Batch: 6/58	Loss: 0.191
Batch: 11/58	Loss: 0.219
Batch: 16/58	Loss: 0.238
Batch: 21/58	Loss: 0.207
Batch: 26/58	Loss: 0.244
Batch: 31/58	Loss: 0.254
Batch: 36/58	Loss: 0.265
Batch: 41/58	Loss: 0.212
Batch: 46/58	Loss: 0.264
Batch: 51/58	Loss: 0.405
Batch: 56/58	Loss: 0.253
Batch: 58/58	Loss: 0.228
Epoch: 16	Train Loss: 0.276	Val F1: 0.349
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 17 ******************************
Batch: 1/58	Loss: 0.208
Batch: 6/58	Loss: 0.301
Batch: 11/58	Loss: 0.222
Batch: 16/58	Loss: 0.299
Batch: 21/58	Loss: 0.318
Batch: 26/58	Loss: 0.313
Batch: 31/58	Loss: 0.224
Batch: 36/58	Loss: 0.228
Batch: 41/58	Loss: 0.279
Batch: 46/58	Loss: 0.406
Batch: 51/58	Loss: 0.200
Batch: 56/58	Loss: 0.216
Batch: 58/58	Loss: 0.303
Epoch: 17	Train Loss: 0.263	Val F1: 0.338
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 18 ******************************
Batch: 1/58	Loss: 0.457
Batch: 6/58	Loss: 0.282
Batch: 11/58	Loss: 0.244
Batch: 16/58	Loss: 0.285
Batch: 21/58	Loss: 0.220
Batch: 26/58	Loss: 0.241
Batch: 31/58	Loss: 0.191
Batch: 36/58	Loss: 0.234
Batch: 41/58	Loss: 0.181
Batch: 46/58	Loss: 0.239
Batch: 51/58	Loss: 0.199
Batch: 56/58	Loss: 0.219
Batch: 58/58	Loss: 0.407
Epoch: 18	Train Loss: 0.246	Val F1: 0.349
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 19 ******************************
Batch: 1/58	Loss: 0.172
Batch: 6/58	Loss: 0.238
Batch: 11/58	Loss: 0.223
Batch: 16/58	Loss: 0.088
Batch: 21/58	Loss: 0.253
Batch: 26/58	Loss: 0.328
Batch: 31/58	Loss: 0.170
Batch: 36/58	Loss: 0.205
Batch: 41/58	Loss: 0.150
Batch: 46/58	Loss: 0.353
Batch: 51/58	Loss: 0.230
Batch: 56/58	Loss: 0.284
Batch: 58/58	Loss: 0.187
Epoch: 19	Train Loss: 0.243	Val F1: 0.342
Best Epoch: 9	Best Val F1: 0.366

Saving the best checkpoint....
Inference...
Test F1: 0.380	Test F1_Few: 0.452	Test F1_Zero: 0.378
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0009779768220570951, 'lr': 2.2572814985645203e-05, 'n_layers_freeze': 3, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.065
Batch: 5/29	Loss: 1.028
Batch: 7/29	Loss: 1.003
Batch: 9/29	Loss: 0.974
Batch: 11/29	Loss: 0.960
Batch: 13/29	Loss: 0.947
Batch: 15/29	Loss: 0.953
Batch: 17/29	Loss: 0.910
Batch: 19/29	Loss: 0.909
Batch: 21/29	Loss: 0.887
Batch: 23/29	Loss: 0.896
Batch: 25/29	Loss: 0.861
Batch: 27/29	Loss: 0.858
Batch: 29/29	Loss: 0.867
Epoch: 1	Train Loss: 0.946	Val F1: 0.201
Best Epoch: 1	Best Val F1: 0.201

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.858
Batch: 3/29	Loss: 0.857
Batch: 5/29	Loss: 0.888
Batch: 7/29	Loss: 0.843
Batch: 9/29	Loss: 0.860
Batch: 11/29	Loss: 0.814
Batch: 13/29	Loss: 0.814
Batch: 15/29	Loss: 0.837
Batch: 17/29	Loss: 0.827
Batch: 19/29	Loss: 0.862
Batch: 21/29	Loss: 0.811
Batch: 23/29	Loss: 0.820
Batch: 25/29	Loss: 0.796
Batch: 27/29	Loss: 0.860
Batch: 29/29	Loss: 0.798
Epoch: 2	Train Loss: 0.832	Val F1: 0.187
Best Epoch: 1	Best Val F1: 0.201

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.787
Batch: 3/29	Loss: 0.810
Batch: 5/29	Loss: 0.796
Batch: 7/29	Loss: 0.831
Batch: 9/29	Loss: 0.777
Batch: 11/29	Loss: 0.777
Batch: 13/29	Loss: 0.821
Batch: 15/29	Loss: 0.787
Batch: 17/29	Loss: 0.804
Batch: 19/29	Loss: 0.797
Batch: 21/29	Loss: 0.773
Batch: 23/29	Loss: 0.760
Batch: 25/29	Loss: 0.788
Batch: 27/29	Loss: 0.752
Batch: 29/29	Loss: 0.770
Epoch: 3	Train Loss: 0.791	Val F1: 0.275
Best Epoch: 3	Best Val F1: 0.275

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.743
Batch: 3/29	Loss: 0.757
Batch: 5/29	Loss: 0.737
Batch: 7/29	Loss: 0.801
Batch: 9/29	Loss: 0.769
Batch: 11/29	Loss: 0.710
Batch: 13/29	Loss: 0.727
Batch: 15/29	Loss: 0.721
Batch: 17/29	Loss: 0.707
Batch: 19/29	Loss: 0.757
Batch: 21/29	Loss: 0.742
Batch: 23/29	Loss: 0.745
Batch: 25/29	Loss: 0.731
Batch: 27/29	Loss: 0.753
Batch: 29/29	Loss: 0.726
Epoch: 4	Train Loss: 0.748	Val F1: 0.286
Best Epoch: 4	Best Val F1: 0.286

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.699
Batch: 3/29	Loss: 0.726
Batch: 5/29	Loss: 0.668
Batch: 7/29	Loss: 0.700
Batch: 9/29	Loss: 0.690
Batch: 11/29	Loss: 0.683
Batch: 13/29	Loss: 0.656
Batch: 15/29	Loss: 0.709
Batch: 17/29	Loss: 0.762
Batch: 19/29	Loss: 0.715
Batch: 21/29	Loss: 0.685
Batch: 23/29	Loss: 0.748
Batch: 25/29	Loss: 0.705
Batch: 27/29	Loss: 0.683
Batch: 29/29	Loss: 0.716
Epoch: 5	Train Loss: 0.712	Val F1: 0.342
Best Epoch: 5	Best Val F1: 0.342

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.711
Batch: 3/29	Loss: 0.753
Batch: 5/29	Loss: 0.609
Batch: 7/29	Loss: 0.756
Batch: 9/29	Loss: 0.658
Batch: 11/29	Loss: 0.625
Batch: 13/29	Loss: 0.719
Batch: 15/29	Loss: 0.584
Batch: 17/29	Loss: 0.639
Batch: 19/29	Loss: 0.582
Batch: 21/29	Loss: 0.738
Batch: 23/29	Loss: 0.647
Batch: 25/29	Loss: 0.651
Batch: 27/29	Loss: 0.654
Batch: 29/29	Loss: 0.627
Epoch: 6	Train Loss: 0.667	Val F1: 0.312
Best Epoch: 5	Best Val F1: 0.342

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.633
Batch: 3/29	Loss: 0.681
Batch: 5/29	Loss: 0.724
Batch: 7/29	Loss: 0.649
Batch: 9/29	Loss: 0.644
Batch: 11/29	Loss: 0.548
Batch: 13/29	Loss: 0.609
Batch: 15/29	Loss: 0.549
Batch: 17/29	Loss: 0.648
Batch: 19/29	Loss: 0.664
Batch: 21/29	Loss: 0.599
Batch: 23/29	Loss: 0.571
Batch: 25/29	Loss: 0.515
Batch: 27/29	Loss: 0.599
Batch: 29/29	Loss: 0.615
Epoch: 7	Train Loss: 0.617	Val F1: 0.334
Best Epoch: 5	Best Val F1: 0.342

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.599
Batch: 3/29	Loss: 0.574
Batch: 5/29	Loss: 0.603
Batch: 7/29	Loss: 0.605
Batch: 9/29	Loss: 0.554
Batch: 11/29	Loss: 0.581
Batch: 13/29	Loss: 0.614
Batch: 15/29	Loss: 0.550
Batch: 17/29	Loss: 0.594
Batch: 19/29	Loss: 0.544
Batch: 21/29	Loss: 0.622
Batch: 23/29	Loss: 0.566
Batch: 25/29	Loss: 0.699
Batch: 27/29	Loss: 0.586
Batch: 29/29	Loss: 0.556
Epoch: 8	Train Loss: 0.580	Val F1: 0.350
Best Epoch: 8	Best Val F1: 0.350

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.605
Batch: 3/29	Loss: 0.539
Batch: 5/29	Loss: 0.566
Batch: 7/29	Loss: 0.505
Batch: 9/29	Loss: 0.559
Batch: 11/29	Loss: 0.542
Batch: 13/29	Loss: 0.546
Batch: 15/29	Loss: 0.466
Batch: 17/29	Loss: 0.516
Batch: 19/29	Loss: 0.439
Batch: 21/29	Loss: 0.567
Batch: 23/29	Loss: 0.501
Batch: 25/29	Loss: 0.489
Batch: 27/29	Loss: 0.528
Batch: 29/29	Loss: 0.497
Epoch: 9	Train Loss: 0.524	Val F1: 0.346
Best Epoch: 8	Best Val F1: 0.350

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.411
Batch: 3/29	Loss: 0.473
Batch: 5/29	Loss: 0.486
Batch: 7/29	Loss: 0.545
Batch: 9/29	Loss: 0.444
Batch: 11/29	Loss: 0.457
Batch: 13/29	Loss: 0.555
Batch: 15/29	Loss: 0.562
Batch: 17/29	Loss: 0.587
Batch: 19/29	Loss: 0.355
Batch: 21/29	Loss: 0.549
Batch: 23/29	Loss: 0.538
Batch: 25/29	Loss: 0.569
Batch: 27/29	Loss: 0.486
Batch: 29/29	Loss: 0.563
Epoch: 10	Train Loss: 0.489	Val F1: 0.354
Best Epoch: 10	Best Val F1: 0.354

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.512
Batch: 3/29	Loss: 0.404
Batch: 5/29	Loss: 0.591
Batch: 7/29	Loss: 0.474
Batch: 9/29	Loss: 0.414
Batch: 11/29	Loss: 0.426
Batch: 13/29	Loss: 0.420
Batch: 15/29	Loss: 0.436
Batch: 17/29	Loss: 0.502
Batch: 19/29	Loss: 0.550
Batch: 21/29	Loss: 0.406
Batch: 23/29	Loss: 0.419
Batch: 25/29	Loss: 0.378
Batch: 27/29	Loss: 0.412
Batch: 29/29	Loss: 0.440
Epoch: 11	Train Loss: 0.459	Val F1: 0.338
Best Epoch: 10	Best Val F1: 0.354

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.546
Batch: 3/29	Loss: 0.343
Batch: 5/29	Loss: 0.381
Batch: 7/29	Loss: 0.426
Batch: 9/29	Loss: 0.428
Batch: 11/29	Loss: 0.433
Batch: 13/29	Loss: 0.401
Batch: 15/29	Loss: 0.405
Batch: 17/29	Loss: 0.462
Batch: 19/29	Loss: 0.362
Batch: 21/29	Loss: 0.367
Batch: 23/29	Loss: 0.455
Batch: 25/29	Loss: 0.409
Batch: 27/29	Loss: 0.493
Batch: 29/29	Loss: 0.330
Epoch: 12	Train Loss: 0.412	Val F1: 0.340
Best Epoch: 10	Best Val F1: 0.354

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.412
Batch: 3/29	Loss: 0.333
Batch: 5/29	Loss: 0.404
Batch: 7/29	Loss: 0.370
Batch: 9/29	Loss: 0.401
Batch: 11/29	Loss: 0.424
Batch: 13/29	Loss: 0.377
Batch: 15/29	Loss: 0.377
Batch: 17/29	Loss: 0.320
Batch: 19/29	Loss: 0.239
Batch: 21/29	Loss: 0.359
Batch: 23/29	Loss: 0.387
Batch: 25/29	Loss: 0.294
Batch: 27/29	Loss: 0.407
Batch: 29/29	Loss: 0.460
Epoch: 13	Train Loss: 0.386	Val F1: 0.331
Best Epoch: 10	Best Val F1: 0.354

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.414
Batch: 3/29	Loss: 0.407
Batch: 5/29	Loss: 0.296
Batch: 7/29	Loss: 0.385
Batch: 9/29	Loss: 0.398
Batch: 11/29	Loss: 0.312
Batch: 13/29	Loss: 0.332
Batch: 15/29	Loss: 0.293
Batch: 17/29	Loss: 0.440
Batch: 19/29	Loss: 0.424
Batch: 21/29	Loss: 0.271
Batch: 23/29	Loss: 0.310
Batch: 25/29	Loss: 0.368
Batch: 27/29	Loss: 0.360
Batch: 29/29	Loss: 0.347
Epoch: 14	Train Loss: 0.363	Val F1: 0.333
Best Epoch: 10	Best Val F1: 0.354

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.322
Batch: 3/29	Loss: 0.335
Batch: 5/29	Loss: 0.241
Batch: 7/29	Loss: 0.319
Batch: 9/29	Loss: 0.378
Batch: 11/29	Loss: 0.355
Batch: 13/29	Loss: 0.341
Batch: 15/29	Loss: 0.327
Batch: 17/29	Loss: 0.391
Batch: 19/29	Loss: 0.317
Batch: 21/29	Loss: 0.348
Batch: 23/29	Loss: 0.352
Batch: 25/29	Loss: 0.391
Batch: 27/29	Loss: 0.291
Batch: 29/29	Loss: 0.399
Epoch: 15	Train Loss: 0.341	Val F1: 0.354
Best Epoch: 10	Best Val F1: 0.354

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.384
Batch: 3/29	Loss: 0.350
Batch: 5/29	Loss: 0.369
Batch: 7/29	Loss: 0.270
Batch: 9/29	Loss: 0.326
Batch: 11/29	Loss: 0.330
Batch: 13/29	Loss: 0.296
Batch: 15/29	Loss: 0.255
Batch: 17/29	Loss: 0.297
Batch: 19/29	Loss: 0.413
Batch: 21/29	Loss: 0.253
Batch: 23/29	Loss: 0.376
Batch: 25/29	Loss: 0.339
Batch: 27/29	Loss: 0.353
Batch: 29/29	Loss: 0.369
Epoch: 16	Train Loss: 0.331	Val F1: 0.343
Best Epoch: 10	Best Val F1: 0.354

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.375
Batch: 3/29	Loss: 0.365
Batch: 5/29	Loss: 0.328
Batch: 7/29	Loss: 0.327
Batch: 9/29	Loss: 0.211
Batch: 11/29	Loss: 0.366
Batch: 13/29	Loss: 0.389
Batch: 15/29	Loss: 0.341
Batch: 17/29	Loss: 0.332
Batch: 19/29	Loss: 0.326
Batch: 21/29	Loss: 0.388
Batch: 23/29	Loss: 0.451
Batch: 25/29	Loss: 0.190
Batch: 27/29	Loss: 0.335
Batch: 29/29	Loss: 0.334
Epoch: 17	Train Loss: 0.326	Val F1: 0.353
Best Epoch: 10	Best Val F1: 0.354

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.317
Batch: 3/29	Loss: 0.381
Batch: 5/29	Loss: 0.319
Batch: 7/29	Loss: 0.269
Batch: 9/29	Loss: 0.414
Batch: 11/29	Loss: 0.255
Batch: 13/29	Loss: 0.238
Batch: 15/29	Loss: 0.320
Batch: 17/29	Loss: 0.273
Batch: 19/29	Loss: 0.234
Batch: 21/29	Loss: 0.318
Batch: 23/29	Loss: 0.338
Batch: 25/29	Loss: 0.335
Batch: 27/29	Loss: 0.240
Batch: 29/29	Loss: 0.347
Epoch: 18	Train Loss: 0.304	Val F1: 0.344
Best Epoch: 10	Best Val F1: 0.354

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.174
Batch: 3/29	Loss: 0.206
Batch: 5/29	Loss: 0.300
Batch: 7/29	Loss: 0.335
Batch: 9/29	Loss: 0.227
Batch: 11/29	Loss: 0.349
Batch: 13/29	Loss: 0.354
Batch: 15/29	Loss: 0.286
Batch: 17/29	Loss: 0.231
Batch: 19/29	Loss: 0.338
Batch: 21/29	Loss: 0.246
Batch: 23/29	Loss: 0.305
Batch: 25/29	Loss: 0.280
Batch: 27/29	Loss: 0.245
Batch: 29/29	Loss: 0.277
Epoch: 19	Train Loss: 0.278	Val F1: 0.357
Best Epoch: 19	Best Val F1: 0.357

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.271
Batch: 3/29	Loss: 0.267
Batch: 5/29	Loss: 0.247
Batch: 7/29	Loss: 0.189
Batch: 9/29	Loss: 0.259
Batch: 11/29	Loss: 0.288
Batch: 13/29	Loss: 0.230
Batch: 15/29	Loss: 0.254
Batch: 17/29	Loss: 0.307
Batch: 19/29	Loss: 0.221
Batch: 21/29	Loss: 0.203
Batch: 23/29	Loss: 0.307
Batch: 25/29	Loss: 0.232
Batch: 27/29	Loss: 0.289
Batch: 29/29	Loss: 0.294
Epoch: 20	Train Loss: 0.259	Val F1: 0.332
Best Epoch: 19	Best Val F1: 0.357

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.233
Batch: 3/29	Loss: 0.195
Batch: 5/29	Loss: 0.259
Batch: 7/29	Loss: 0.419
Batch: 9/29	Loss: 0.226
Batch: 11/29	Loss: 0.200
Batch: 13/29	Loss: 0.256
Batch: 15/29	Loss: 0.292
Batch: 17/29	Loss: 0.195
Batch: 19/29	Loss: 0.227
Batch: 21/29	Loss: 0.227
Batch: 23/29	Loss: 0.236
Batch: 25/29	Loss: 0.238
Batch: 27/29	Loss: 0.358
Batch: 29/29	Loss: 0.308
Epoch: 21	Train Loss: 0.254	Val F1: 0.319
Best Epoch: 19	Best Val F1: 0.357

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.251
Batch: 3/29	Loss: 0.185
Batch: 5/29	Loss: 0.292
Batch: 7/29	Loss: 0.289
Batch: 9/29	Loss: 0.238
Batch: 11/29	Loss: 0.257
Batch: 13/29	Loss: 0.183
Batch: 15/29	Loss: 0.240
Batch: 17/29	Loss: 0.263
Batch: 19/29	Loss: 0.273
Batch: 21/29	Loss: 0.339
Batch: 23/29	Loss: 0.263
Batch: 25/29	Loss: 0.216
Batch: 27/29	Loss: 0.242
Batch: 29/29	Loss: 0.205
Epoch: 22	Train Loss: 0.241	Val F1: 0.322
Best Epoch: 19	Best Val F1: 0.357

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.268
Batch: 3/29	Loss: 0.201
Batch: 5/29	Loss: 0.267
Batch: 7/29	Loss: 0.274
Batch: 9/29	Loss: 0.164
Batch: 11/29	Loss: 0.220
Batch: 13/29	Loss: 0.231
Batch: 15/29	Loss: 0.221
Batch: 17/29	Loss: 0.260
Batch: 19/29	Loss: 0.295
Batch: 21/29	Loss: 0.202
Batch: 23/29	Loss: 0.183
Batch: 25/29	Loss: 0.214
Batch: 27/29	Loss: 0.239
Batch: 29/29	Loss: 0.175
Epoch: 23	Train Loss: 0.227	Val F1: 0.335
Best Epoch: 19	Best Val F1: 0.357

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.153
Batch: 3/29	Loss: 0.195
Batch: 5/29	Loss: 0.219
Batch: 7/29	Loss: 0.168
Batch: 9/29	Loss: 0.201
Batch: 11/29	Loss: 0.252
Batch: 13/29	Loss: 0.156
Batch: 15/29	Loss: 0.270
Batch: 17/29	Loss: 0.197
Batch: 19/29	Loss: 0.202
Batch: 21/29	Loss: 0.262
Batch: 23/29	Loss: 0.168
Batch: 25/29	Loss: 0.188
Batch: 27/29	Loss: 0.171
Batch: 29/29	Loss: 0.181
Epoch: 24	Train Loss: 0.192	Val F1: 0.328
Best Epoch: 19	Best Val F1: 0.357

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.207
Batch: 3/29	Loss: 0.208
Batch: 5/29	Loss: 0.222
Batch: 7/29	Loss: 0.163
Batch: 9/29	Loss: 0.226
Batch: 11/29	Loss: 0.136
Batch: 13/29	Loss: 0.214
Batch: 15/29	Loss: 0.174
Batch: 17/29	Loss: 0.191
Batch: 19/29	Loss: 0.106
Batch: 21/29	Loss: 0.167
Batch: 23/29	Loss: 0.123
Batch: 25/29	Loss: 0.187
Batch: 27/29	Loss: 0.168
Batch: 29/29	Loss: 0.133
Epoch: 25	Train Loss: 0.169	Val F1: 0.342
Best Epoch: 19	Best Val F1: 0.357

****************************** Epoch: 26 ******************************
Batch: 1/29	Loss: 0.124
Batch: 3/29	Loss: 0.103
Batch: 5/29	Loss: 0.160
Batch: 7/29	Loss: 0.219
Batch: 9/29	Loss: 0.128
Batch: 11/29	Loss: 0.158
Batch: 13/29	Loss: 0.157
Batch: 15/29	Loss: 0.129
Batch: 17/29	Loss: 0.110
Batch: 19/29	Loss: 0.148
Batch: 21/29	Loss: 0.141
Batch: 23/29	Loss: 0.070
Batch: 25/29	Loss: 0.136
Batch: 27/29	Loss: 0.094
Batch: 29/29	Loss: 0.130
Epoch: 26	Train Loss: 0.137	Val F1: 0.345
Best Epoch: 19	Best Val F1: 0.357

****************************** Epoch: 27 ******************************
Batch: 1/29	Loss: 0.089
Batch: 3/29	Loss: 0.135
Batch: 5/29	Loss: 0.182
Batch: 7/29	Loss: 0.087
Batch: 9/29	Loss: 0.146
Batch: 11/29	Loss: 0.070
Batch: 13/29	Loss: 0.183
Batch: 15/29	Loss: 0.142
Batch: 17/29	Loss: 0.105
Batch: 19/29	Loss: 0.108
Batch: 21/29	Loss: 0.125
Batch: 23/29	Loss: 0.067
Batch: 25/29	Loss: 0.115
Batch: 27/29	Loss: 0.138
Batch: 29/29	Loss: 0.140
Epoch: 27	Train Loss: 0.117	Val F1: 0.340
Best Epoch: 19	Best Val F1: 0.357

****************************** Epoch: 28 ******************************
Batch: 1/29	Loss: 0.100
Batch: 3/29	Loss: 0.088
Batch: 5/29	Loss: 0.143
Batch: 7/29	Loss: 0.138
Batch: 9/29	Loss: 0.139
Batch: 11/29	Loss: 0.114
Batch: 13/29	Loss: 0.125
Batch: 15/29	Loss: 0.124
Batch: 17/29	Loss: 0.108
Batch: 19/29	Loss: 0.087
Batch: 21/29	Loss: 0.136
Batch: 23/29	Loss: 0.118
Batch: 25/29	Loss: 0.110
Batch: 27/29	Loss: 0.087
Batch: 29/29	Loss: 0.094
Epoch: 28	Train Loss: 0.110	Val F1: 0.336
Best Epoch: 19	Best Val F1: 0.357

****************************** Epoch: 29 ******************************
Batch: 1/29	Loss: 0.112
Batch: 3/29	Loss: 0.089
Batch: 5/29	Loss: 0.114
Batch: 7/29	Loss: 0.065
Batch: 9/29	Loss: 0.062
Batch: 11/29	Loss: 0.091
Batch: 13/29	Loss: 0.095
Batch: 15/29	Loss: 0.051
Batch: 17/29	Loss: 0.107
Batch: 19/29	Loss: 0.056
Batch: 21/29	Loss: 0.093
Batch: 23/29	Loss: 0.120
Batch: 25/29	Loss: 0.090
Batch: 27/29	Loss: 0.082
Batch: 29/29	Loss: 0.111
Epoch: 29	Train Loss: 0.088	Val F1: 0.341
Best Epoch: 19	Best Val F1: 0.357

Saving the best checkpoint....
Inference...
Test F1: 0.373	Test F1_Few: 0.439	Test F1_Zero: 0.374
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0007433988588883468, 'lr': 3.977964498799502e-05, 'n_layers_freeze': 1, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.040
Batch: 5/29	Loss: 0.978
Batch: 7/29	Loss: 0.950
Batch: 9/29	Loss: 0.921
Batch: 11/29	Loss: 0.919
Batch: 13/29	Loss: 0.903
Batch: 15/29	Loss: 0.920
Batch: 17/29	Loss: 0.867
Batch: 19/29	Loss: 0.873
Batch: 21/29	Loss: 0.841
Batch: 23/29	Loss: 0.861
Batch: 25/29	Loss: 0.813
Batch: 27/29	Loss: 0.816
Batch: 29/29	Loss: 0.829
Epoch: 1	Train Loss: 0.905	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.185

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.816
Batch: 3/29	Loss: 0.817
Batch: 5/29	Loss: 0.860
Batch: 7/29	Loss: 0.801
Batch: 9/29	Loss: 0.827
Batch: 11/29	Loss: 0.767
Batch: 13/29	Loss: 0.771
Batch: 15/29	Loss: 0.797
Batch: 17/29	Loss: 0.789
Batch: 19/29	Loss: 0.843
Batch: 21/29	Loss: 0.773
Batch: 23/29	Loss: 0.787
Batch: 25/29	Loss: 0.754
Batch: 27/29	Loss: 0.842
Batch: 29/29	Loss: 0.758
Epoch: 2	Train Loss: 0.794	Val F1: 0.249
Best Epoch: 2	Best Val F1: 0.249

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.743
Batch: 3/29	Loss: 0.775
Batch: 5/29	Loss: 0.752
Batch: 7/29	Loss: 0.806
Batch: 9/29	Loss: 0.730
Batch: 11/29	Loss: 0.745
Batch: 13/29	Loss: 0.785
Batch: 15/29	Loss: 0.752
Batch: 17/29	Loss: 0.761
Batch: 19/29	Loss: 0.772
Batch: 21/29	Loss: 0.718
Batch: 23/29	Loss: 0.697
Batch: 25/29	Loss: 0.741
Batch: 27/29	Loss: 0.716
Batch: 29/29	Loss: 0.729
Epoch: 3	Train Loss: 0.751	Val F1: 0.328
Best Epoch: 3	Best Val F1: 0.328

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.700
Batch: 3/29	Loss: 0.702
Batch: 5/29	Loss: 0.711
Batch: 7/29	Loss: 0.755
Batch: 9/29	Loss: 0.691
Batch: 11/29	Loss: 0.633
Batch: 13/29	Loss: 0.617
Batch: 15/29	Loss: 0.679
Batch: 17/29	Loss: 0.686
Batch: 19/29	Loss: 0.701
Batch: 21/29	Loss: 0.710
Batch: 23/29	Loss: 0.683
Batch: 25/29	Loss: 0.644
Batch: 27/29	Loss: 0.684
Batch: 29/29	Loss: 0.672
Epoch: 4	Train Loss: 0.686	Val F1: 0.351
Best Epoch: 4	Best Val F1: 0.351

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.609
Batch: 3/29	Loss: 0.597
Batch: 5/29	Loss: 0.558
Batch: 7/29	Loss: 0.626
Batch: 9/29	Loss: 0.593
Batch: 11/29	Loss: 0.608
Batch: 13/29	Loss: 0.634
Batch: 15/29	Loss: 0.658
Batch: 17/29	Loss: 0.692
Batch: 19/29	Loss: 0.700
Batch: 21/29	Loss: 0.614
Batch: 23/29	Loss: 0.624
Batch: 25/29	Loss: 0.633
Batch: 27/29	Loss: 0.631
Batch: 29/29	Loss: 0.661
Epoch: 5	Train Loss: 0.641	Val F1: 0.335
Best Epoch: 4	Best Val F1: 0.351

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.597
Batch: 3/29	Loss: 0.682
Batch: 5/29	Loss: 0.513
Batch: 7/29	Loss: 0.691
Batch: 9/29	Loss: 0.660
Batch: 11/29	Loss: 0.553
Batch: 13/29	Loss: 0.639
Batch: 15/29	Loss: 0.527
Batch: 17/29	Loss: 0.571
Batch: 19/29	Loss: 0.525
Batch: 21/29	Loss: 0.775
Batch: 23/29	Loss: 0.589
Batch: 25/29	Loss: 0.597
Batch: 27/29	Loss: 0.624
Batch: 29/29	Loss: 0.653
Epoch: 6	Train Loss: 0.606	Val F1: 0.295
Best Epoch: 4	Best Val F1: 0.351

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.575
Batch: 3/29	Loss: 0.623
Batch: 5/29	Loss: 0.661
Batch: 7/29	Loss: 0.610
Batch: 9/29	Loss: 0.587
Batch: 11/29	Loss: 0.456
Batch: 13/29	Loss: 0.521
Batch: 15/29	Loss: 0.533
Batch: 17/29	Loss: 0.601
Batch: 19/29	Loss: 0.564
Batch: 21/29	Loss: 0.548
Batch: 23/29	Loss: 0.480
Batch: 25/29	Loss: 0.479
Batch: 27/29	Loss: 0.484
Batch: 29/29	Loss: 0.506
Epoch: 7	Train Loss: 0.547	Val F1: 0.360
Best Epoch: 7	Best Val F1: 0.360

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.486
Batch: 3/29	Loss: 0.515
Batch: 5/29	Loss: 0.503
Batch: 7/29	Loss: 0.487
Batch: 9/29	Loss: 0.434
Batch: 11/29	Loss: 0.517
Batch: 13/29	Loss: 0.536
Batch: 15/29	Loss: 0.480
Batch: 17/29	Loss: 0.570
Batch: 19/29	Loss: 0.561
Batch: 21/29	Loss: 0.525
Batch: 23/29	Loss: 0.550
Batch: 25/29	Loss: 0.508
Batch: 27/29	Loss: 0.582
Batch: 29/29	Loss: 0.505
Epoch: 8	Train Loss: 0.502	Val F1: 0.347
Best Epoch: 7	Best Val F1: 0.360

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.514
Batch: 3/29	Loss: 0.589
Batch: 5/29	Loss: 0.496
Batch: 7/29	Loss: 0.474
Batch: 9/29	Loss: 0.495
Batch: 11/29	Loss: 0.441
Batch: 13/29	Loss: 0.470
Batch: 15/29	Loss: 0.408
Batch: 17/29	Loss: 0.392
Batch: 19/29	Loss: 0.354
Batch: 21/29	Loss: 0.524
Batch: 23/29	Loss: 0.404
Batch: 25/29	Loss: 0.374
Batch: 27/29	Loss: 0.436
Batch: 29/29	Loss: 0.351
Epoch: 9	Train Loss: 0.456	Val F1: 0.335
Best Epoch: 7	Best Val F1: 0.360

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.336
Batch: 3/29	Loss: 0.421
Batch: 5/29	Loss: 0.354
Batch: 7/29	Loss: 0.386
Batch: 9/29	Loss: 0.354
Batch: 11/29	Loss: 0.367
Batch: 13/29	Loss: 0.488
Batch: 15/29	Loss: 0.421
Batch: 17/29	Loss: 0.475
Batch: 19/29	Loss: 0.278
Batch: 21/29	Loss: 0.524
Batch: 23/29	Loss: 0.502
Batch: 25/29	Loss: 0.533
Batch: 27/29	Loss: 0.325
Batch: 29/29	Loss: 0.416
Epoch: 10	Train Loss: 0.400	Val F1: 0.346
Best Epoch: 7	Best Val F1: 0.360

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.380
Batch: 3/29	Loss: 0.309
Batch: 5/29	Loss: 0.476
Batch: 7/29	Loss: 0.379
Batch: 9/29	Loss: 0.377
Batch: 11/29	Loss: 0.402
Batch: 13/29	Loss: 0.392
Batch: 15/29	Loss: 0.315
Batch: 17/29	Loss: 0.377
Batch: 19/29	Loss: 0.407
Batch: 21/29	Loss: 0.301
Batch: 23/29	Loss: 0.299
Batch: 25/29	Loss: 0.309
Batch: 27/29	Loss: 0.338
Batch: 29/29	Loss: 0.376
Epoch: 11	Train Loss: 0.365	Val F1: 0.363
Best Epoch: 11	Best Val F1: 0.363

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.427
Batch: 3/29	Loss: 0.313
Batch: 5/29	Loss: 0.322
Batch: 7/29	Loss: 0.312
Batch: 9/29	Loss: 0.344
Batch: 11/29	Loss: 0.345
Batch: 13/29	Loss: 0.319
Batch: 15/29	Loss: 0.315
Batch: 17/29	Loss: 0.309
Batch: 19/29	Loss: 0.294
Batch: 21/29	Loss: 0.317
Batch: 23/29	Loss: 0.359
Batch: 25/29	Loss: 0.339
Batch: 27/29	Loss: 0.497
Batch: 29/29	Loss: 0.242
Epoch: 12	Train Loss: 0.337	Val F1: 0.351
Best Epoch: 11	Best Val F1: 0.363

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.367
Batch: 3/29	Loss: 0.243
Batch: 5/29	Loss: 0.337
Batch: 7/29	Loss: 0.272
Batch: 9/29	Loss: 0.326
Batch: 11/29	Loss: 0.333
Batch: 13/29	Loss: 0.332
Batch: 15/29	Loss: 0.273
Batch: 17/29	Loss: 0.261
Batch: 19/29	Loss: 0.197
Batch: 21/29	Loss: 0.269
Batch: 23/29	Loss: 0.277
Batch: 25/29	Loss: 0.243
Batch: 27/29	Loss: 0.336
Batch: 29/29	Loss: 0.355
Epoch: 13	Train Loss: 0.309	Val F1: 0.352
Best Epoch: 11	Best Val F1: 0.363

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.319
Batch: 3/29	Loss: 0.323
Batch: 5/29	Loss: 0.234
Batch: 7/29	Loss: 0.306
Batch: 9/29	Loss: 0.288
Batch: 11/29	Loss: 0.255
Batch: 13/29	Loss: 0.296
Batch: 15/29	Loss: 0.229
Batch: 17/29	Loss: 0.350
Batch: 19/29	Loss: 0.337
Batch: 21/29	Loss: 0.168
Batch: 23/29	Loss: 0.259
Batch: 25/29	Loss: 0.289
Batch: 27/29	Loss: 0.263
Batch: 29/29	Loss: 0.250
Epoch: 14	Train Loss: 0.284	Val F1: 0.355
Best Epoch: 11	Best Val F1: 0.363

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.274
Batch: 3/29	Loss: 0.282
Batch: 5/29	Loss: 0.174
Batch: 7/29	Loss: 0.301
Batch: 9/29	Loss: 0.265
Batch: 11/29	Loss: 0.272
Batch: 13/29	Loss: 0.271
Batch: 15/29	Loss: 0.264
Batch: 17/29	Loss: 0.313
Batch: 19/29	Loss: 0.222
Batch: 21/29	Loss: 0.258
Batch: 23/29	Loss: 0.233
Batch: 25/29	Loss: 0.303
Batch: 27/29	Loss: 0.222
Batch: 29/29	Loss: 0.287
Epoch: 15	Train Loss: 0.264	Val F1: 0.353
Best Epoch: 11	Best Val F1: 0.363

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.287
Batch: 3/29	Loss: 0.296
Batch: 5/29	Loss: 0.292
Batch: 7/29	Loss: 0.198
Batch: 9/29	Loss: 0.251
Batch: 11/29	Loss: 0.218
Batch: 13/29	Loss: 0.228
Batch: 15/29	Loss: 0.165
Batch: 17/29	Loss: 0.243
Batch: 19/29	Loss: 0.357
Batch: 21/29	Loss: 0.196
Batch: 23/29	Loss: 0.319
Batch: 25/29	Loss: 0.319
Batch: 27/29	Loss: 0.253
Batch: 29/29	Loss: 0.270
Epoch: 16	Train Loss: 0.252	Val F1: 0.343
Best Epoch: 11	Best Val F1: 0.363

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.226
Batch: 3/29	Loss: 0.284
Batch: 5/29	Loss: 0.228
Batch: 7/29	Loss: 0.245
Batch: 9/29	Loss: 0.121
Batch: 11/29	Loss: 0.258
Batch: 13/29	Loss: 0.274
Batch: 15/29	Loss: 0.259
Batch: 17/29	Loss: 0.269
Batch: 19/29	Loss: 0.234
Batch: 21/29	Loss: 0.259
Batch: 23/29	Loss: 0.397
Batch: 25/29	Loss: 0.149
Batch: 27/29	Loss: 0.244
Batch: 29/29	Loss: 0.292
Epoch: 17	Train Loss: 0.243	Val F1: 0.345
Best Epoch: 11	Best Val F1: 0.363

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.234
Batch: 3/29	Loss: 0.260
Batch: 5/29	Loss: 0.297
Batch: 7/29	Loss: 0.151
Batch: 9/29	Loss: 0.319
Batch: 11/29	Loss: 0.180
Batch: 13/29	Loss: 0.250
Batch: 15/29	Loss: 0.239
Batch: 17/29	Loss: 0.274
Batch: 19/29	Loss: 0.166
Batch: 21/29	Loss: 0.236
Batch: 23/29	Loss: 0.252
Batch: 25/29	Loss: 0.222
Batch: 27/29	Loss: 0.196
Batch: 29/29	Loss: 0.233
Epoch: 18	Train Loss: 0.231	Val F1: 0.327
Best Epoch: 11	Best Val F1: 0.363

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.176
Batch: 3/29	Loss: 0.195
Batch: 5/29	Loss: 0.207
Batch: 7/29	Loss: 0.229
Batch: 9/29	Loss: 0.198
Batch: 11/29	Loss: 0.228
Batch: 13/29	Loss: 0.219
Batch: 15/29	Loss: 0.195
Batch: 17/29	Loss: 0.163
Batch: 19/29	Loss: 0.281
Batch: 21/29	Loss: 0.161
Batch: 23/29	Loss: 0.187
Batch: 25/29	Loss: 0.180
Batch: 27/29	Loss: 0.098
Batch: 29/29	Loss: 0.164
Epoch: 19	Train Loss: 0.194	Val F1: 0.342
Best Epoch: 11	Best Val F1: 0.363

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.152
Batch: 3/29	Loss: 0.176
Batch: 5/29	Loss: 0.156
Batch: 7/29	Loss: 0.111
Batch: 9/29	Loss: 0.148
Batch: 11/29	Loss: 0.171
Batch: 13/29	Loss: 0.113
Batch: 15/29	Loss: 0.139
Batch: 17/29	Loss: 0.204
Batch: 19/29	Loss: 0.144
Batch: 21/29	Loss: 0.110
Batch: 23/29	Loss: 0.154
Batch: 25/29	Loss: 0.123
Batch: 27/29	Loss: 0.175
Batch: 29/29	Loss: 0.152
Epoch: 20	Train Loss: 0.149	Val F1: 0.341
Best Epoch: 11	Best Val F1: 0.363

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.107
Batch: 3/29	Loss: 0.063
Batch: 5/29	Loss: 0.128
Batch: 7/29	Loss: 0.207
Batch: 9/29	Loss: 0.104
Batch: 11/29	Loss: 0.120
Batch: 13/29	Loss: 0.128
Batch: 15/29	Loss: 0.114
Batch: 17/29	Loss: 0.080
Batch: 19/29	Loss: 0.116
Batch: 21/29	Loss: 0.085
Batch: 23/29	Loss: 0.134
Batch: 25/29	Loss: 0.101
Batch: 27/29	Loss: 0.098
Batch: 29/29	Loss: 0.111
Epoch: 21	Train Loss: 0.111	Val F1: 0.334
Best Epoch: 11	Best Val F1: 0.363

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.077
Batch: 3/29	Loss: 0.069
Batch: 5/29	Loss: 0.094
Batch: 7/29	Loss: 0.121
Batch: 9/29	Loss: 0.077
Batch: 11/29	Loss: 0.119
Batch: 13/29	Loss: 0.060
Batch: 15/29	Loss: 0.091
Batch: 17/29	Loss: 0.112
Batch: 19/29	Loss: 0.083
Batch: 21/29	Loss: 0.137
Batch: 23/29	Loss: 0.134
Batch: 25/29	Loss: 0.082
Batch: 27/29	Loss: 0.091
Batch: 29/29	Loss: 0.108
Epoch: 22	Train Loss: 0.096	Val F1: 0.340
Best Epoch: 11	Best Val F1: 0.363

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.061
Batch: 3/29	Loss: 0.088
Batch: 5/29	Loss: 0.093
Batch: 7/29	Loss: 0.126
Batch: 9/29	Loss: 0.081
Batch: 11/29	Loss: 0.048
Batch: 13/29	Loss: 0.118
Batch: 15/29	Loss: 0.078
Batch: 17/29	Loss: 0.106
Batch: 19/29	Loss: 0.108
Batch: 21/29	Loss: 0.082
Batch: 23/29	Loss: 0.088
Batch: 25/29	Loss: 0.089
Batch: 27/29	Loss: 0.071
Batch: 29/29	Loss: 0.080
Epoch: 23	Train Loss: 0.086	Val F1: 0.333
Best Epoch: 11	Best Val F1: 0.363

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.087
Batch: 3/29	Loss: 0.060
Batch: 5/29	Loss: 0.142
Batch: 7/29	Loss: 0.084
Batch: 9/29	Loss: 0.072
Batch: 11/29	Loss: 0.163
Batch: 13/29	Loss: 0.047
Batch: 15/29	Loss: 0.114
Batch: 17/29	Loss: 0.055
Batch: 19/29	Loss: 0.088
Batch: 21/29	Loss: 0.076
Batch: 23/29	Loss: 0.049
Batch: 25/29	Loss: 0.086
Batch: 27/29	Loss: 0.077
Batch: 29/29	Loss: 0.074
Epoch: 24	Train Loss: 0.082	Val F1: 0.344
Best Epoch: 11	Best Val F1: 0.363

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.114
Batch: 3/29	Loss: 0.112
Batch: 5/29	Loss: 0.085
Batch: 7/29	Loss: 0.084
Batch: 9/29	Loss: 0.084
Batch: 11/29	Loss: 0.050
Batch: 13/29	Loss: 0.105
Batch: 15/29	Loss: 0.054
Batch: 17/29	Loss: 0.054
Batch: 19/29	Loss: 0.039
Batch: 21/29	Loss: 0.053
Batch: 23/29	Loss: 0.039
Batch: 25/29	Loss: 0.049
Batch: 27/29	Loss: 0.054
Batch: 29/29	Loss: 0.043
Epoch: 25	Train Loss: 0.062	Val F1: 0.334
Best Epoch: 11	Best Val F1: 0.363

****************************** Epoch: 26 ******************************
Batch: 1/29	Loss: 0.029
Batch: 3/29	Loss: 0.077
Batch: 5/29	Loss: 0.045
Batch: 7/29	Loss: 0.086
Batch: 9/29	Loss: 0.038
Batch: 11/29	Loss: 0.072
Batch: 13/29	Loss: 0.072
Batch: 15/29	Loss: 0.047
Batch: 17/29	Loss: 0.052
Batch: 19/29	Loss: 0.034
Batch: 21/29	Loss: 0.078
Batch: 23/29	Loss: 0.017
Batch: 25/29	Loss: 0.094
Batch: 27/29	Loss: 0.101
Batch: 29/29	Loss: 0.046
Epoch: 26	Train Loss: 0.060	Val F1: 0.337
Best Epoch: 11	Best Val F1: 0.363

Saving the best checkpoint....
Inference...
Test F1: 0.373	Test F1_Few: 0.448	Test F1_Zero: 0.361
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0007100765117717336, 'lr': 2.0405461230285497e-05, 'n_layers_freeze': 2, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.067
Batch: 5/29	Loss: 1.032
Batch: 7/29	Loss: 1.009
Batch: 9/29	Loss: 0.981
Batch: 11/29	Loss: 0.967
Batch: 13/29	Loss: 0.953
Batch: 15/29	Loss: 0.958
Batch: 17/29	Loss: 0.917
Batch: 19/29	Loss: 0.915
Batch: 21/29	Loss: 0.895
Batch: 23/29	Loss: 0.902
Batch: 25/29	Loss: 0.869
Batch: 27/29	Loss: 0.866
Batch: 29/29	Loss: 0.874
Epoch: 1	Train Loss: 0.952	Val F1: 0.201
Best Epoch: 1	Best Val F1: 0.201

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.865
Batch: 3/29	Loss: 0.864
Batch: 5/29	Loss: 0.893
Batch: 7/29	Loss: 0.851
Batch: 9/29	Loss: 0.866
Batch: 11/29	Loss: 0.822
Batch: 13/29	Loss: 0.822
Batch: 15/29	Loss: 0.845
Batch: 17/29	Loss: 0.834
Batch: 19/29	Loss: 0.867
Batch: 21/29	Loss: 0.819
Batch: 23/29	Loss: 0.827
Batch: 25/29	Loss: 0.804
Batch: 27/29	Loss: 0.864
Batch: 29/29	Loss: 0.806
Epoch: 2	Train Loss: 0.839	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.201

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.796
Batch: 3/29	Loss: 0.817
Batch: 5/29	Loss: 0.803
Batch: 7/29	Loss: 0.836
Batch: 9/29	Loss: 0.785
Batch: 11/29	Loss: 0.785
Batch: 13/29	Loss: 0.827
Batch: 15/29	Loss: 0.795
Batch: 17/29	Loss: 0.812
Batch: 19/29	Loss: 0.805
Batch: 21/29	Loss: 0.782
Batch: 23/29	Loss: 0.774
Batch: 25/29	Loss: 0.795
Batch: 27/29	Loss: 0.766
Batch: 29/29	Loss: 0.780
Epoch: 3	Train Loss: 0.799	Val F1: 0.271
Best Epoch: 3	Best Val F1: 0.271

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.757
Batch: 3/29	Loss: 0.772
Batch: 5/29	Loss: 0.745
Batch: 7/29	Loss: 0.811
Batch: 9/29	Loss: 0.787
Batch: 11/29	Loss: 0.731
Batch: 13/29	Loss: 0.745
Batch: 15/29	Loss: 0.738
Batch: 17/29	Loss: 0.746
Batch: 19/29	Loss: 0.769
Batch: 21/29	Loss: 0.765
Batch: 23/29	Loss: 0.751
Batch: 25/29	Loss: 0.752
Batch: 27/29	Loss: 0.750
Batch: 29/29	Loss: 0.741
Epoch: 4	Train Loss: 0.761	Val F1: 0.289
Best Epoch: 4	Best Val F1: 0.289

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.710
Batch: 3/29	Loss: 0.698
Batch: 5/29	Loss: 0.690
Batch: 7/29	Loss: 0.687
Batch: 9/29	Loss: 0.672
Batch: 11/29	Loss: 0.705
Batch: 13/29	Loss: 0.739
Batch: 15/29	Loss: 0.706
Batch: 17/29	Loss: 0.765
Batch: 19/29	Loss: 0.723
Batch: 21/29	Loss: 0.694
Batch: 23/29	Loss: 0.710
Batch: 25/29	Loss: 0.706
Batch: 27/29	Loss: 0.660
Batch: 29/29	Loss: 0.716
Epoch: 5	Train Loss: 0.716	Val F1: 0.335
Best Epoch: 5	Best Val F1: 0.335

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.683
Batch: 3/29	Loss: 0.724
Batch: 5/29	Loss: 0.608
Batch: 7/29	Loss: 0.783
Batch: 9/29	Loss: 0.642
Batch: 11/29	Loss: 0.636
Batch: 13/29	Loss: 0.692
Batch: 15/29	Loss: 0.621
Batch: 17/29	Loss: 0.656
Batch: 19/29	Loss: 0.621
Batch: 21/29	Loss: 0.760
Batch: 23/29	Loss: 0.661
Batch: 25/29	Loss: 0.672
Batch: 27/29	Loss: 0.678
Batch: 29/29	Loss: 0.642
Epoch: 6	Train Loss: 0.676	Val F1: 0.288
Best Epoch: 5	Best Val F1: 0.335

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.629
Batch: 3/29	Loss: 0.714
Batch: 5/29	Loss: 0.723
Batch: 7/29	Loss: 0.662
Batch: 9/29	Loss: 0.632
Batch: 11/29	Loss: 0.572
Batch: 13/29	Loss: 0.638
Batch: 15/29	Loss: 0.589
Batch: 17/29	Loss: 0.686
Batch: 19/29	Loss: 0.667
Batch: 21/29	Loss: 0.622
Batch: 23/29	Loss: 0.610
Batch: 25/29	Loss: 0.566
Batch: 27/29	Loss: 0.589
Batch: 29/29	Loss: 0.579
Epoch: 7	Train Loss: 0.635	Val F1: 0.334
Best Epoch: 5	Best Val F1: 0.335

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.611
Batch: 3/29	Loss: 0.599
Batch: 5/29	Loss: 0.635
Batch: 7/29	Loss: 0.605
Batch: 9/29	Loss: 0.568
Batch: 11/29	Loss: 0.609
Batch: 13/29	Loss: 0.644
Batch: 15/29	Loss: 0.531
Batch: 17/29	Loss: 0.596
Batch: 19/29	Loss: 0.603
Batch: 21/29	Loss: 0.659
Batch: 23/29	Loss: 0.611
Batch: 25/29	Loss: 0.737
Batch: 27/29	Loss: 0.593
Batch: 29/29	Loss: 0.583
Epoch: 8	Train Loss: 0.598	Val F1: 0.349
Best Epoch: 8	Best Val F1: 0.349

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.619
Batch: 3/29	Loss: 0.563
Batch: 5/29	Loss: 0.572
Batch: 7/29	Loss: 0.482
Batch: 9/29	Loss: 0.628
Batch: 11/29	Loss: 0.593
Batch: 13/29	Loss: 0.625
Batch: 15/29	Loss: 0.558
Batch: 17/29	Loss: 0.514
Batch: 19/29	Loss: 0.438
Batch: 21/29	Loss: 0.652
Batch: 23/29	Loss: 0.565
Batch: 25/29	Loss: 0.490
Batch: 27/29	Loss: 0.656
Batch: 29/29	Loss: 0.502
Epoch: 9	Train Loss: 0.560	Val F1: 0.338
Best Epoch: 8	Best Val F1: 0.349

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.482
Batch: 3/29	Loss: 0.522
Batch: 5/29	Loss: 0.513
Batch: 7/29	Loss: 0.562
Batch: 9/29	Loss: 0.481
Batch: 11/29	Loss: 0.525
Batch: 13/29	Loss: 0.653
Batch: 15/29	Loss: 0.605
Batch: 17/29	Loss: 0.613
Batch: 19/29	Loss: 0.416
Batch: 21/29	Loss: 0.572
Batch: 23/29	Loss: 0.533
Batch: 25/29	Loss: 0.587
Batch: 27/29	Loss: 0.495
Batch: 29/29	Loss: 0.592
Epoch: 10	Train Loss: 0.523	Val F1: 0.359
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.507
Batch: 3/29	Loss: 0.426
Batch: 5/29	Loss: 0.613
Batch: 7/29	Loss: 0.523
Batch: 9/29	Loss: 0.460
Batch: 11/29	Loss: 0.476
Batch: 13/29	Loss: 0.485
Batch: 15/29	Loss: 0.368
Batch: 17/29	Loss: 0.538
Batch: 19/29	Loss: 0.496
Batch: 21/29	Loss: 0.437
Batch: 23/29	Loss: 0.388
Batch: 25/29	Loss: 0.403
Batch: 27/29	Loss: 0.419
Batch: 29/29	Loss: 0.471
Epoch: 11	Train Loss: 0.473	Val F1: 0.348
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.496
Batch: 3/29	Loss: 0.369
Batch: 5/29	Loss: 0.438
Batch: 7/29	Loss: 0.453
Batch: 9/29	Loss: 0.449
Batch: 11/29	Loss: 0.441
Batch: 13/29	Loss: 0.456
Batch: 15/29	Loss: 0.384
Batch: 17/29	Loss: 0.418
Batch: 19/29	Loss: 0.440
Batch: 21/29	Loss: 0.375
Batch: 23/29	Loss: 0.503
Batch: 25/29	Loss: 0.436
Batch: 27/29	Loss: 0.528
Batch: 29/29	Loss: 0.345
Epoch: 12	Train Loss: 0.430	Val F1: 0.341
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.424
Batch: 3/29	Loss: 0.348
Batch: 5/29	Loss: 0.453
Batch: 7/29	Loss: 0.396
Batch: 9/29	Loss: 0.453
Batch: 11/29	Loss: 0.446
Batch: 13/29	Loss: 0.399
Batch: 15/29	Loss: 0.410
Batch: 17/29	Loss: 0.361
Batch: 19/29	Loss: 0.273
Batch: 21/29	Loss: 0.345
Batch: 23/29	Loss: 0.405
Batch: 25/29	Loss: 0.321
Batch: 27/29	Loss: 0.444
Batch: 29/29	Loss: 0.441
Epoch: 13	Train Loss: 0.404	Val F1: 0.342
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.402
Batch: 3/29	Loss: 0.415
Batch: 5/29	Loss: 0.324
Batch: 7/29	Loss: 0.374
Batch: 9/29	Loss: 0.478
Batch: 11/29	Loss: 0.357
Batch: 13/29	Loss: 0.364
Batch: 15/29	Loss: 0.315
Batch: 17/29	Loss: 0.443
Batch: 19/29	Loss: 0.482
Batch: 21/29	Loss: 0.240
Batch: 23/29	Loss: 0.330
Batch: 25/29	Loss: 0.481
Batch: 27/29	Loss: 0.368
Batch: 29/29	Loss: 0.414
Epoch: 14	Train Loss: 0.397	Val F1: 0.352
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.366
Batch: 3/29	Loss: 0.361
Batch: 5/29	Loss: 0.261
Batch: 7/29	Loss: 0.347
Batch: 9/29	Loss: 0.407
Batch: 11/29	Loss: 0.363
Batch: 13/29	Loss: 0.342
Batch: 15/29	Loss: 0.402
Batch: 17/29	Loss: 0.401
Batch: 19/29	Loss: 0.362
Batch: 21/29	Loss: 0.382
Batch: 23/29	Loss: 0.411
Batch: 25/29	Loss: 0.415
Batch: 27/29	Loss: 0.342
Batch: 29/29	Loss: 0.396
Epoch: 15	Train Loss: 0.372	Val F1: 0.350
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.397
Batch: 3/29	Loss: 0.358
Batch: 5/29	Loss: 0.426
Batch: 7/29	Loss: 0.293
Batch: 9/29	Loss: 0.366
Batch: 11/29	Loss: 0.345
Batch: 13/29	Loss: 0.330
Batch: 15/29	Loss: 0.270
Batch: 17/29	Loss: 0.299
Batch: 19/29	Loss: 0.414
Batch: 21/29	Loss: 0.293
Batch: 23/29	Loss: 0.384
Batch: 25/29	Loss: 0.359
Batch: 27/29	Loss: 0.347
Batch: 29/29	Loss: 0.362
Epoch: 16	Train Loss: 0.347	Val F1: 0.349
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.292
Batch: 3/29	Loss: 0.382
Batch: 5/29	Loss: 0.328
Batch: 7/29	Loss: 0.311
Batch: 9/29	Loss: 0.238
Batch: 11/29	Loss: 0.377
Batch: 13/29	Loss: 0.422
Batch: 15/29	Loss: 0.368
Batch: 17/29	Loss: 0.367
Batch: 19/29	Loss: 0.346
Batch: 21/29	Loss: 0.331
Batch: 23/29	Loss: 0.412
Batch: 25/29	Loss: 0.199
Batch: 27/29	Loss: 0.386
Batch: 29/29	Loss: 0.379
Epoch: 17	Train Loss: 0.336	Val F1: 0.342
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.317
Batch: 3/29	Loss: 0.388
Batch: 5/29	Loss: 0.294
Batch: 7/29	Loss: 0.268
Batch: 9/29	Loss: 0.435
Batch: 11/29	Loss: 0.251
Batch: 13/29	Loss: 0.249
Batch: 15/29	Loss: 0.309
Batch: 17/29	Loss: 0.286
Batch: 19/29	Loss: 0.254
Batch: 21/29	Loss: 0.328
Batch: 23/29	Loss: 0.354
Batch: 25/29	Loss: 0.326
Batch: 27/29	Loss: 0.227
Batch: 29/29	Loss: 0.344
Epoch: 18	Train Loss: 0.315	Val F1: 0.340
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.224
Batch: 3/29	Loss: 0.241
Batch: 5/29	Loss: 0.320
Batch: 7/29	Loss: 0.376
Batch: 9/29	Loss: 0.272
Batch: 11/29	Loss: 0.350
Batch: 13/29	Loss: 0.404
Batch: 15/29	Loss: 0.317
Batch: 17/29	Loss: 0.238
Batch: 19/29	Loss: 0.376
Batch: 21/29	Loss: 0.290
Batch: 23/29	Loss: 0.294
Batch: 25/29	Loss: 0.347
Batch: 27/29	Loss: 0.268
Batch: 29/29	Loss: 0.267
Epoch: 19	Train Loss: 0.307	Val F1: 0.350
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.313
Batch: 3/29	Loss: 0.298
Batch: 5/29	Loss: 0.272
Batch: 7/29	Loss: 0.227
Batch: 9/29	Loss: 0.327
Batch: 11/29	Loss: 0.335
Batch: 13/29	Loss: 0.295
Batch: 15/29	Loss: 0.297
Batch: 17/29	Loss: 0.347
Batch: 19/29	Loss: 0.245
Batch: 21/29	Loss: 0.263
Batch: 23/29	Loss: 0.317
Batch: 25/29	Loss: 0.302
Batch: 27/29	Loss: 0.343
Batch: 29/29	Loss: 0.333
Epoch: 20	Train Loss: 0.290	Val F1: 0.336
Best Epoch: 10	Best Val F1: 0.359

Saving the best checkpoint....
Inference...
Test F1: 0.378	Test F1_Few: 0.453	Test F1_Zero: 0.371
Starting training with config: {'batch_size': 32, 'epochs': 50, 'l2_reg': 0.0008056928648074674, 'lr': 3.595793881658753e-05, 'n_layers_freeze': 3, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 0.991
Batch: 11/58	Loss: 0.915
Batch: 16/58	Loss: 0.846
Batch: 21/58	Loss: 0.868
Batch: 26/58	Loss: 0.859
Batch: 31/58	Loss: 0.821
Batch: 36/58	Loss: 0.860
Batch: 41/58	Loss: 0.796
Batch: 46/58	Loss: 0.775
Batch: 51/58	Loss: 0.761
Batch: 56/58	Loss: 0.773
Batch: 58/58	Loss: 0.782
Epoch: 1	Train Loss: 0.864	Val F1: 0.180
Best Epoch: 1	Best Val F1: 0.180

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.797
Batch: 6/58	Loss: 0.812
Batch: 11/58	Loss: 0.814
Batch: 16/58	Loss: 0.727
Batch: 21/58	Loss: 0.735
Batch: 26/58	Loss: 0.725
Batch: 31/58	Loss: 0.807
Batch: 36/58	Loss: 0.777
Batch: 41/58	Loss: 0.716
Batch: 46/58	Loss: 0.754
Batch: 51/58	Loss: 0.734
Batch: 56/58	Loss: 0.736
Batch: 58/58	Loss: 0.710
Epoch: 2	Train Loss: 0.760	Val F1: 0.340
Best Epoch: 2	Best Val F1: 0.340

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.661
Batch: 6/58	Loss: 0.640
Batch: 11/58	Loss: 0.744
Batch: 16/58	Loss: 0.651
Batch: 21/58	Loss: 0.676
Batch: 26/58	Loss: 0.642
Batch: 31/58	Loss: 0.884
Batch: 36/58	Loss: 0.742
Batch: 41/58	Loss: 0.581
Batch: 46/58	Loss: 0.641
Batch: 51/58	Loss: 0.717
Batch: 56/58	Loss: 0.790
Batch: 58/58	Loss: 0.714
Epoch: 3	Train Loss: 0.694	Val F1: 0.347
Best Epoch: 3	Best Val F1: 0.347

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.668
Batch: 6/58	Loss: 0.599
Batch: 11/58	Loss: 0.611
Batch: 16/58	Loss: 0.618
Batch: 21/58	Loss: 0.475
Batch: 26/58	Loss: 0.545
Batch: 31/58	Loss: 0.557
Batch: 36/58	Loss: 0.719
Batch: 41/58	Loss: 0.708
Batch: 46/58	Loss: 0.610
Batch: 51/58	Loss: 0.483
Batch: 56/58	Loss: 0.515
Batch: 58/58	Loss: 0.516
Epoch: 4	Train Loss: 0.637	Val F1: 0.357
Best Epoch: 4	Best Val F1: 0.357

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.527
Batch: 6/58	Loss: 0.511
Batch: 11/58	Loss: 0.523
Batch: 16/58	Loss: 0.521
Batch: 21/58	Loss: 0.452
Batch: 26/58	Loss: 0.453
Batch: 31/58	Loss: 0.691
Batch: 36/58	Loss: 0.633
Batch: 41/58	Loss: 0.606
Batch: 46/58	Loss: 0.764
Batch: 51/58	Loss: 0.904
Batch: 56/58	Loss: 0.665
Batch: 58/58	Loss: 0.881
Epoch: 5	Train Loss: 0.590	Val F1: 0.338
Best Epoch: 4	Best Val F1: 0.357

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.505
Batch: 6/58	Loss: 0.693
Batch: 11/58	Loss: 0.528
Batch: 16/58	Loss: 0.566
Batch: 21/58	Loss: 0.559
Batch: 26/58	Loss: 0.433
Batch: 31/58	Loss: 0.520
Batch: 36/58	Loss: 0.357
Batch: 41/58	Loss: 0.480
Batch: 46/58	Loss: 0.518
Batch: 51/58	Loss: 0.454
Batch: 56/58	Loss: 0.534
Batch: 58/58	Loss: 0.422
Epoch: 6	Train Loss: 0.524	Val F1: 0.341
Best Epoch: 4	Best Val F1: 0.357

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.357
Batch: 6/58	Loss: 0.540
Batch: 11/58	Loss: 0.497
Batch: 16/58	Loss: 0.373
Batch: 21/58	Loss: 0.411
Batch: 26/58	Loss: 0.478
Batch: 31/58	Loss: 0.476
Batch: 36/58	Loss: 0.427
Batch: 41/58	Loss: 0.445
Batch: 46/58	Loss: 0.349
Batch: 51/58	Loss: 0.421
Batch: 56/58	Loss: 0.467
Batch: 58/58	Loss: 0.228
Epoch: 7	Train Loss: 0.443	Val F1: 0.357
Best Epoch: 7	Best Val F1: 0.357

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.459
Batch: 6/58	Loss: 0.357
Batch: 11/58	Loss: 0.335
Batch: 16/58	Loss: 0.389
Batch: 21/58	Loss: 0.369
Batch: 26/58	Loss: 0.321
Batch: 31/58	Loss: 0.325
Batch: 36/58	Loss: 0.351
Batch: 41/58	Loss: 0.488
Batch: 46/58	Loss: 0.460
Batch: 51/58	Loss: 0.386
Batch: 56/58	Loss: 0.373
Batch: 58/58	Loss: 0.479
Epoch: 8	Train Loss: 0.401	Val F1: 0.351
Best Epoch: 7	Best Val F1: 0.357

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.472
Batch: 6/58	Loss: 0.479
Batch: 11/58	Loss: 0.461
Batch: 16/58	Loss: 0.326
Batch: 21/58	Loss: 0.327
Batch: 26/58	Loss: 0.304
Batch: 31/58	Loss: 0.309
Batch: 36/58	Loss: 0.295
Batch: 41/58	Loss: 0.403
Batch: 46/58	Loss: 0.311
Batch: 51/58	Loss: 0.392
Batch: 56/58	Loss: 0.255
Batch: 58/58	Loss: 0.324
Epoch: 9	Train Loss: 0.352	Val F1: 0.366
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.309
Batch: 6/58	Loss: 0.346
Batch: 11/58	Loss: 0.359
Batch: 16/58	Loss: 0.467
Batch: 21/58	Loss: 0.268
Batch: 26/58	Loss: 0.377
Batch: 31/58	Loss: 0.250
Batch: 36/58	Loss: 0.458
Batch: 41/58	Loss: 0.460
Batch: 46/58	Loss: 0.489
Batch: 51/58	Loss: 0.248
Batch: 56/58	Loss: 0.269
Batch: 58/58	Loss: 0.394
Epoch: 10	Train Loss: 0.328	Val F1: 0.359
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.303
Batch: 6/58	Loss: 0.232
Batch: 11/58	Loss: 0.229
Batch: 16/58	Loss: 0.289
Batch: 21/58	Loss: 0.290
Batch: 26/58	Loss: 0.306
Batch: 31/58	Loss: 0.307
Batch: 36/58	Loss: 0.336
Batch: 41/58	Loss: 0.254
Batch: 46/58	Loss: 0.305
Batch: 51/58	Loss: 0.325
Batch: 56/58	Loss: 0.324
Batch: 58/58	Loss: 0.273
Epoch: 11	Train Loss: 0.293	Val F1: 0.345
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.274
Batch: 6/58	Loss: 0.189
Batch: 11/58	Loss: 0.239
Batch: 16/58	Loss: 0.262
Batch: 21/58	Loss: 0.294
Batch: 26/58	Loss: 0.258
Batch: 31/58	Loss: 0.366
Batch: 36/58	Loss: 0.294
Batch: 41/58	Loss: 0.253
Batch: 46/58	Loss: 0.271
Batch: 51/58	Loss: 0.368
Batch: 56/58	Loss: 0.163
Batch: 58/58	Loss: 0.128
Epoch: 12	Train Loss: 0.257	Val F1: 0.338
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 13 ******************************
Batch: 1/58	Loss: 0.158
Batch: 6/58	Loss: 0.248
Batch: 11/58	Loss: 0.246
Batch: 16/58	Loss: 0.169
Batch: 21/58	Loss: 0.218
Batch: 26/58	Loss: 0.168
Batch: 31/58	Loss: 0.183
Batch: 36/58	Loss: 0.218
Batch: 41/58	Loss: 0.178
Batch: 46/58	Loss: 0.243
Batch: 51/58	Loss: 0.145
Batch: 56/58	Loss: 0.305
Batch: 58/58	Loss: 0.115
Epoch: 13	Train Loss: 0.223	Val F1: 0.350
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 14 ******************************
Batch: 1/58	Loss: 0.275
Batch: 6/58	Loss: 0.214
Batch: 11/58	Loss: 0.173
Batch: 16/58	Loss: 0.205
Batch: 21/58	Loss: 0.170
Batch: 26/58	Loss: 0.193
Batch: 31/58	Loss: 0.204
Batch: 36/58	Loss: 0.226
Batch: 41/58	Loss: 0.140
Batch: 46/58	Loss: 0.224
Batch: 51/58	Loss: 0.238
Batch: 56/58	Loss: 0.135
Batch: 58/58	Loss: 0.166
Epoch: 14	Train Loss: 0.194	Val F1: 0.364
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 15 ******************************
Batch: 1/58	Loss: 0.124
Batch: 6/58	Loss: 0.219
Batch: 11/58	Loss: 0.132
Batch: 16/58	Loss: 0.123
Batch: 21/58	Loss: 0.252
Batch: 26/58	Loss: 0.123
Batch: 31/58	Loss: 0.142
Batch: 36/58	Loss: 0.184
Batch: 41/58	Loss: 0.145
Batch: 46/58	Loss: 0.112
Batch: 51/58	Loss: 0.133
Batch: 56/58	Loss: 0.164
Batch: 58/58	Loss: 0.155
Epoch: 15	Train Loss: 0.160	Val F1: 0.341
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 16 ******************************
Batch: 1/58	Loss: 0.136
Batch: 6/58	Loss: 0.062
Batch: 11/58	Loss: 0.101
Batch: 16/58	Loss: 0.194
Batch: 21/58	Loss: 0.131
Batch: 26/58	Loss: 0.084
Batch: 31/58	Loss: 0.113
Batch: 36/58	Loss: 0.121
Batch: 41/58	Loss: 0.088
Batch: 46/58	Loss: 0.143
Batch: 51/58	Loss: 0.112
Batch: 56/58	Loss: 0.081
Batch: 58/58	Loss: 0.053
Epoch: 16	Train Loss: 0.132	Val F1: 0.348
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 17 ******************************
Batch: 1/58	Loss: 0.095
Batch: 6/58	Loss: 0.082
Batch: 11/58	Loss: 0.102
Batch: 16/58	Loss: 0.120
Batch: 21/58	Loss: 0.177
Batch: 26/58	Loss: 0.123
Batch: 31/58	Loss: 0.081
Batch: 36/58	Loss: 0.072
Batch: 41/58	Loss: 0.108
Batch: 46/58	Loss: 0.102
Batch: 51/58	Loss: 0.051
Batch: 56/58	Loss: 0.125
Batch: 58/58	Loss: 0.100
Epoch: 17	Train Loss: 0.100	Val F1: 0.355
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 18 ******************************
Batch: 1/58	Loss: 0.088
Batch: 6/58	Loss: 0.164
Batch: 11/58	Loss: 0.154
Batch: 16/58	Loss: 0.160
Batch: 21/58	Loss: 0.095
Batch: 26/58	Loss: 0.066
Batch: 31/58	Loss: 0.051
Batch: 36/58	Loss: 0.072
Batch: 41/58	Loss: 0.100
Batch: 46/58	Loss: 0.150
Batch: 51/58	Loss: 0.186
Batch: 56/58	Loss: 0.131
Batch: 58/58	Loss: 0.212
Epoch: 18	Train Loss: 0.097	Val F1: 0.343
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 19 ******************************
Batch: 1/58	Loss: 0.085
Batch: 6/58	Loss: 0.087
Batch: 11/58	Loss: 0.135
Batch: 16/58	Loss: 0.050
Batch: 21/58	Loss: 0.082
Batch: 26/58	Loss: 0.065
Batch: 31/58	Loss: 0.032
Batch: 36/58	Loss: 0.034
Batch: 41/58	Loss: 0.023
Batch: 46/58	Loss: 0.085
Batch: 51/58	Loss: 0.095
Batch: 56/58	Loss: 0.086
Batch: 58/58	Loss: 0.055
Epoch: 19	Train Loss: 0.080	Val F1: 0.344
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 20 ******************************
Batch: 1/58	Loss: 0.046
Batch: 6/58	Loss: 0.068
Batch: 11/58	Loss: 0.028
Batch: 16/58	Loss: 0.095
Batch: 21/58	Loss: 0.089
Batch: 26/58	Loss: 0.153
Batch: 31/58	Loss: 0.080
Batch: 36/58	Loss: 0.071
Batch: 41/58	Loss: 0.020
Batch: 46/58	Loss: 0.041
Batch: 51/58	Loss: 0.048
Batch: 56/58	Loss: 0.020
Batch: 58/58	Loss: 0.058
Epoch: 20	Train Loss: 0.066	Val F1: 0.355
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 21 ******************************
Batch: 1/58	Loss: 0.058
Batch: 6/58	Loss: 0.023
Batch: 11/58	Loss: 0.027
Batch: 16/58	Loss: 0.024
Batch: 21/58	Loss: 0.024
Batch: 26/58	Loss: 0.041
Batch: 31/58	Loss: 0.028
Batch: 36/58	Loss: 0.053
Batch: 41/58	Loss: 0.039
Batch: 46/58	Loss: 0.040
Batch: 51/58	Loss: 0.018
Batch: 56/58	Loss: 0.011
Batch: 58/58	Loss: 0.016
Epoch: 21	Train Loss: 0.043	Val F1: 0.347
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 22 ******************************
Batch: 1/58	Loss: 0.033
Batch: 6/58	Loss: 0.026
Batch: 11/58	Loss: 0.059
Batch: 16/58	Loss: 0.016
Batch: 21/58	Loss: 0.038
Batch: 26/58	Loss: 0.039
Batch: 31/58	Loss: 0.018
Batch: 36/58	Loss: 0.016
Batch: 41/58	Loss: 0.050
Batch: 46/58	Loss: 0.022
Batch: 51/58	Loss: 0.013
Batch: 56/58	Loss: 0.079
Batch: 58/58	Loss: 0.082
Epoch: 22	Train Loss: 0.036	Val F1: 0.340
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 23 ******************************
Batch: 1/58	Loss: 0.049
Batch: 6/58	Loss: 0.037
Batch: 11/58	Loss: 0.013
Batch: 16/58	Loss: 0.032
Batch: 21/58	Loss: 0.025
Batch: 26/58	Loss: 0.020
Batch: 31/58	Loss: 0.021
Batch: 36/58	Loss: 0.058
Batch: 41/58	Loss: 0.047
Batch: 46/58	Loss: 0.059
Batch: 51/58	Loss: 0.009
Batch: 56/58	Loss: 0.024
Batch: 58/58	Loss: 0.040
Epoch: 23	Train Loss: 0.035	Val F1: 0.338
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 24 ******************************
Batch: 1/58	Loss: 0.031
Batch: 6/58	Loss: 0.028
Batch: 11/58	Loss: 0.052
Batch: 16/58	Loss: 0.192
Batch: 21/58	Loss: 0.160
Batch: 26/58	Loss: 0.051
Batch: 31/58	Loss: 0.020
Batch: 36/58	Loss: 0.047
Batch: 41/58	Loss: 0.011
Batch: 46/58	Loss: 0.012
Batch: 51/58	Loss: 0.048
Batch: 56/58	Loss: 0.026
Batch: 58/58	Loss: 0.063
Epoch: 24	Train Loss: 0.036	Val F1: 0.343
Best Epoch: 9	Best Val F1: 0.366

Saving the best checkpoint....
Inference...
Test F1: 0.382	Test F1_Few: 0.455	Test F1_Zero: 0.380
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0008680068717888347, 'lr': 1.688964449230227e-05, 'n_layers_freeze': 3, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.073
Batch: 5/29	Loss: 1.046
Batch: 7/29	Loss: 1.025
Batch: 9/29	Loss: 1.001
Batch: 11/29	Loss: 0.985
Batch: 13/29	Loss: 0.971
Batch: 15/29	Loss: 0.972
Batch: 17/29	Loss: 0.933
Batch: 19/29	Loss: 0.930
Batch: 21/29	Loss: 0.911
Batch: 23/29	Loss: 0.916
Batch: 25/29	Loss: 0.885
Batch: 27/29	Loss: 0.881
Batch: 29/29	Loss: 0.887
Epoch: 1	Train Loss: 0.966	Val F1: 0.192
Best Epoch: 1	Best Val F1: 0.192

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.879
Batch: 3/29	Loss: 0.877
Batch: 5/29	Loss: 0.903
Batch: 7/29	Loss: 0.865
Batch: 9/29	Loss: 0.878
Batch: 11/29	Loss: 0.837
Batch: 13/29	Loss: 0.837
Batch: 15/29	Loss: 0.858
Batch: 17/29	Loss: 0.847
Batch: 19/29	Loss: 0.876
Batch: 21/29	Loss: 0.832
Batch: 23/29	Loss: 0.840
Batch: 25/29	Loss: 0.818
Batch: 27/29	Loss: 0.873
Batch: 29/29	Loss: 0.820
Epoch: 2	Train Loss: 0.852	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.192

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.810
Batch: 3/29	Loss: 0.828
Batch: 5/29	Loss: 0.817
Batch: 7/29	Loss: 0.846
Batch: 9/29	Loss: 0.800
Batch: 11/29	Loss: 0.800
Batch: 13/29	Loss: 0.838
Batch: 15/29	Loss: 0.807
Batch: 17/29	Loss: 0.823
Batch: 19/29	Loss: 0.816
Batch: 21/29	Loss: 0.795
Batch: 23/29	Loss: 0.788
Batch: 25/29	Loss: 0.807
Batch: 27/29	Loss: 0.780
Batch: 29/29	Loss: 0.791
Epoch: 3	Train Loss: 0.811	Val F1: 0.261
Best Epoch: 3	Best Val F1: 0.261

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.771
Batch: 3/29	Loss: 0.785
Batch: 5/29	Loss: 0.766
Batch: 7/29	Loss: 0.821
Batch: 9/29	Loss: 0.792
Batch: 11/29	Loss: 0.748
Batch: 13/29	Loss: 0.754
Batch: 15/29	Loss: 0.747
Batch: 17/29	Loss: 0.747
Batch: 19/29	Loss: 0.782
Batch: 21/29	Loss: 0.772
Batch: 23/29	Loss: 0.769
Batch: 25/29	Loss: 0.751
Batch: 27/29	Loss: 0.772
Batch: 29/29	Loss: 0.762
Epoch: 4	Train Loss: 0.774	Val F1: 0.273
Best Epoch: 4	Best Val F1: 0.273

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.736
Batch: 3/29	Loss: 0.746
Batch: 5/29	Loss: 0.703
Batch: 7/29	Loss: 0.737
Batch: 9/29	Loss: 0.715
Batch: 11/29	Loss: 0.720
Batch: 13/29	Loss: 0.688
Batch: 15/29	Loss: 0.737
Batch: 17/29	Loss: 0.778
Batch: 19/29	Loss: 0.734
Batch: 21/29	Loss: 0.705
Batch: 23/29	Loss: 0.751
Batch: 25/29	Loss: 0.722
Batch: 27/29	Loss: 0.699
Batch: 29/29	Loss: 0.737
Epoch: 5	Train Loss: 0.735	Val F1: 0.336
Best Epoch: 5	Best Val F1: 0.336

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.734
Batch: 3/29	Loss: 0.768
Batch: 5/29	Loss: 0.643
Batch: 7/29	Loss: 0.766
Batch: 9/29	Loss: 0.685
Batch: 11/29	Loss: 0.662
Batch: 13/29	Loss: 0.727
Batch: 15/29	Loss: 0.638
Batch: 17/29	Loss: 0.665
Batch: 19/29	Loss: 0.621
Batch: 21/29	Loss: 0.759
Batch: 23/29	Loss: 0.682
Batch: 25/29	Loss: 0.679
Batch: 27/29	Loss: 0.698
Batch: 29/29	Loss: 0.651
Epoch: 6	Train Loss: 0.694	Val F1: 0.328
Best Epoch: 5	Best Val F1: 0.336

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.642
Batch: 3/29	Loss: 0.688
Batch: 5/29	Loss: 0.756
Batch: 7/29	Loss: 0.659
Batch: 9/29	Loss: 0.710
Batch: 11/29	Loss: 0.597
Batch: 13/29	Loss: 0.675
Batch: 15/29	Loss: 0.648
Batch: 17/29	Loss: 0.695
Batch: 19/29	Loss: 0.682
Batch: 21/29	Loss: 0.637
Batch: 23/29	Loss: 0.636
Batch: 25/29	Loss: 0.574
Batch: 27/29	Loss: 0.645
Batch: 29/29	Loss: 0.601
Epoch: 7	Train Loss: 0.654	Val F1: 0.332
Best Epoch: 5	Best Val F1: 0.336

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.633
Batch: 3/29	Loss: 0.581
Batch: 5/29	Loss: 0.638
Batch: 7/29	Loss: 0.614
Batch: 9/29	Loss: 0.600
Batch: 11/29	Loss: 0.645
Batch: 13/29	Loss: 0.651
Batch: 15/29	Loss: 0.572
Batch: 17/29	Loss: 0.651
Batch: 19/29	Loss: 0.596
Batch: 21/29	Loss: 0.628
Batch: 23/29	Loss: 0.643
Batch: 25/29	Loss: 0.707
Batch: 27/29	Loss: 0.647
Batch: 29/29	Loss: 0.646
Epoch: 8	Train Loss: 0.613	Val F1: 0.331
Best Epoch: 5	Best Val F1: 0.336

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.595
Batch: 3/29	Loss: 0.611
Batch: 5/29	Loss: 0.590
Batch: 7/29	Loss: 0.549
Batch: 9/29	Loss: 0.606
Batch: 11/29	Loss: 0.635
Batch: 13/29	Loss: 0.598
Batch: 15/29	Loss: 0.611
Batch: 17/29	Loss: 0.546
Batch: 19/29	Loss: 0.559
Batch: 21/29	Loss: 0.636
Batch: 23/29	Loss: 0.522
Batch: 25/29	Loss: 0.535
Batch: 27/29	Loss: 0.534
Batch: 29/29	Loss: 0.523
Epoch: 9	Train Loss: 0.576	Val F1: 0.343
Best Epoch: 9	Best Val F1: 0.343

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.461
Batch: 3/29	Loss: 0.538
Batch: 5/29	Loss: 0.516
Batch: 7/29	Loss: 0.511
Batch: 9/29	Loss: 0.490
Batch: 11/29	Loss: 0.430
Batch: 13/29	Loss: 0.669
Batch: 15/29	Loss: 0.596
Batch: 17/29	Loss: 0.645
Batch: 19/29	Loss: 0.419
Batch: 21/29	Loss: 0.570
Batch: 23/29	Loss: 0.591
Batch: 25/29	Loss: 0.576
Batch: 27/29	Loss: 0.540
Batch: 29/29	Loss: 0.613
Epoch: 10	Train Loss: 0.538	Val F1: 0.360
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.549
Batch: 3/29	Loss: 0.455
Batch: 5/29	Loss: 0.662
Batch: 7/29	Loss: 0.553
Batch: 9/29	Loss: 0.510
Batch: 11/29	Loss: 0.470
Batch: 13/29	Loss: 0.444
Batch: 15/29	Loss: 0.393
Batch: 17/29	Loss: 0.542
Batch: 19/29	Loss: 0.522
Batch: 21/29	Loss: 0.446
Batch: 23/29	Loss: 0.416
Batch: 25/29	Loss: 0.400
Batch: 27/29	Loss: 0.441
Batch: 29/29	Loss: 0.473
Epoch: 11	Train Loss: 0.491	Val F1: 0.345
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.551
Batch: 3/29	Loss: 0.379
Batch: 5/29	Loss: 0.426
Batch: 7/29	Loss: 0.448
Batch: 9/29	Loss: 0.499
Batch: 11/29	Loss: 0.460
Batch: 13/29	Loss: 0.439
Batch: 15/29	Loss: 0.466
Batch: 17/29	Loss: 0.478
Batch: 19/29	Loss: 0.437
Batch: 21/29	Loss: 0.403
Batch: 23/29	Loss: 0.460
Batch: 25/29	Loss: 0.439
Batch: 27/29	Loss: 0.541
Batch: 29/29	Loss: 0.334
Epoch: 12	Train Loss: 0.449	Val F1: 0.342
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.479
Batch: 3/29	Loss: 0.341
Batch: 5/29	Loss: 0.486
Batch: 7/29	Loss: 0.365
Batch: 9/29	Loss: 0.482
Batch: 11/29	Loss: 0.513
Batch: 13/29	Loss: 0.444
Batch: 15/29	Loss: 0.398
Batch: 17/29	Loss: 0.393
Batch: 19/29	Loss: 0.263
Batch: 21/29	Loss: 0.412
Batch: 23/29	Loss: 0.424
Batch: 25/29	Loss: 0.302
Batch: 27/29	Loss: 0.454
Batch: 29/29	Loss: 0.535
Epoch: 13	Train Loss: 0.429	Val F1: 0.330
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.453
Batch: 3/29	Loss: 0.422
Batch: 5/29	Loss: 0.331
Batch: 7/29	Loss: 0.402
Batch: 9/29	Loss: 0.419
Batch: 11/29	Loss: 0.379
Batch: 13/29	Loss: 0.385
Batch: 15/29	Loss: 0.325
Batch: 17/29	Loss: 0.506
Batch: 19/29	Loss: 0.445
Batch: 21/29	Loss: 0.306
Batch: 23/29	Loss: 0.365
Batch: 25/29	Loss: 0.398
Batch: 27/29	Loss: 0.400
Batch: 29/29	Loss: 0.403
Epoch: 14	Train Loss: 0.401	Val F1: 0.354
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.358
Batch: 3/29	Loss: 0.360
Batch: 5/29	Loss: 0.293
Batch: 7/29	Loss: 0.390
Batch: 9/29	Loss: 0.456
Batch: 11/29	Loss: 0.407
Batch: 13/29	Loss: 0.398
Batch: 15/29	Loss: 0.363
Batch: 17/29	Loss: 0.416
Batch: 19/29	Loss: 0.351
Batch: 21/29	Loss: 0.402
Batch: 23/29	Loss: 0.384
Batch: 25/29	Loss: 0.431
Batch: 27/29	Loss: 0.360
Batch: 29/29	Loss: 0.474
Epoch: 15	Train Loss: 0.395	Val F1: 0.353
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.397
Batch: 3/29	Loss: 0.411
Batch: 5/29	Loss: 0.403
Batch: 7/29	Loss: 0.315
Batch: 9/29	Loss: 0.363
Batch: 11/29	Loss: 0.398
Batch: 13/29	Loss: 0.310
Batch: 15/29	Loss: 0.295
Batch: 17/29	Loss: 0.315
Batch: 19/29	Loss: 0.435
Batch: 21/29	Loss: 0.304
Batch: 23/29	Loss: 0.397
Batch: 25/29	Loss: 0.374
Batch: 27/29	Loss: 0.371
Batch: 29/29	Loss: 0.376
Epoch: 16	Train Loss: 0.373	Val F1: 0.360
Best Epoch: 16	Best Val F1: 0.360

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.362
Batch: 3/29	Loss: 0.448
Batch: 5/29	Loss: 0.385
Batch: 7/29	Loss: 0.326
Batch: 9/29	Loss: 0.249
Batch: 11/29	Loss: 0.385
Batch: 13/29	Loss: 0.430
Batch: 15/29	Loss: 0.378
Batch: 17/29	Loss: 0.403
Batch: 19/29	Loss: 0.327
Batch: 21/29	Loss: 0.459
Batch: 23/29	Loss: 0.450
Batch: 25/29	Loss: 0.242
Batch: 27/29	Loss: 0.376
Batch: 29/29	Loss: 0.412
Epoch: 17	Train Loss: 0.380	Val F1: 0.335
Best Epoch: 16	Best Val F1: 0.360

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.429
Batch: 3/29	Loss: 0.412
Batch: 5/29	Loss: 0.397
Batch: 7/29	Loss: 0.323
Batch: 9/29	Loss: 0.547
Batch: 11/29	Loss: 0.290
Batch: 13/29	Loss: 0.286
Batch: 15/29	Loss: 0.297
Batch: 17/29	Loss: 0.319
Batch: 19/29	Loss: 0.282
Batch: 21/29	Loss: 0.371
Batch: 23/29	Loss: 0.353
Batch: 25/29	Loss: 0.394
Batch: 27/29	Loss: 0.255
Batch: 29/29	Loss: 0.396
Epoch: 18	Train Loss: 0.358	Val F1: 0.352
Best Epoch: 16	Best Val F1: 0.360

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.242
Batch: 3/29	Loss: 0.293
Batch: 5/29	Loss: 0.337
Batch: 7/29	Loss: 0.392
Batch: 9/29	Loss: 0.270
Batch: 11/29	Loss: 0.416
Batch: 13/29	Loss: 0.403
Batch: 15/29	Loss: 0.308
Batch: 17/29	Loss: 0.281
Batch: 19/29	Loss: 0.414
Batch: 21/29	Loss: 0.361
Batch: 23/29	Loss: 0.338
Batch: 25/29	Loss: 0.353
Batch: 27/29	Loss: 0.294
Batch: 29/29	Loss: 0.311
Epoch: 19	Train Loss: 0.338	Val F1: 0.350
Best Epoch: 16	Best Val F1: 0.360

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.376
Batch: 3/29	Loss: 0.358
Batch: 5/29	Loss: 0.289
Batch: 7/29	Loss: 0.233
Batch: 9/29	Loss: 0.370
Batch: 11/29	Loss: 0.347
Batch: 13/29	Loss: 0.301
Batch: 15/29	Loss: 0.336
Batch: 17/29	Loss: 0.408
Batch: 19/29	Loss: 0.284
Batch: 21/29	Loss: 0.319
Batch: 23/29	Loss: 0.342
Batch: 25/29	Loss: 0.264
Batch: 27/29	Loss: 0.334
Batch: 29/29	Loss: 0.381
Epoch: 20	Train Loss: 0.324	Val F1: 0.351
Best Epoch: 16	Best Val F1: 0.360

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.300
Batch: 3/29	Loss: 0.257
Batch: 5/29	Loss: 0.271
Batch: 7/29	Loss: 0.539
Batch: 9/29	Loss: 0.257
Batch: 11/29	Loss: 0.233
Batch: 13/29	Loss: 0.355
Batch: 15/29	Loss: 0.322
Batch: 17/29	Loss: 0.266
Batch: 19/29	Loss: 0.276
Batch: 21/29	Loss: 0.303
Batch: 23/29	Loss: 0.245
Batch: 25/29	Loss: 0.275
Batch: 27/29	Loss: 0.279
Batch: 29/29	Loss: 0.317
Epoch: 21	Train Loss: 0.300	Val F1: 0.342
Best Epoch: 16	Best Val F1: 0.360

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.289
Batch: 3/29	Loss: 0.259
Batch: 5/29	Loss: 0.353
Batch: 7/29	Loss: 0.325
Batch: 9/29	Loss: 0.262
Batch: 11/29	Loss: 0.274
Batch: 13/29	Loss: 0.262
Batch: 15/29	Loss: 0.262
Batch: 17/29	Loss: 0.377
Batch: 19/29	Loss: 0.320
Batch: 21/29	Loss: 0.329
Batch: 23/29	Loss: 0.280
Batch: 25/29	Loss: 0.288
Batch: 27/29	Loss: 0.248
Batch: 29/29	Loss: 0.258
Epoch: 22	Train Loss: 0.286	Val F1: 0.350
Best Epoch: 16	Best Val F1: 0.360

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.285
Batch: 3/29	Loss: 0.303
Batch: 5/29	Loss: 0.309
Batch: 7/29	Loss: 0.388
Batch: 9/29	Loss: 0.222
Batch: 11/29	Loss: 0.291
Batch: 13/29	Loss: 0.256
Batch: 15/29	Loss: 0.264
Batch: 17/29	Loss: 0.312
Batch: 19/29	Loss: 0.289
Batch: 21/29	Loss: 0.275
Batch: 23/29	Loss: 0.216
Batch: 25/29	Loss: 0.276
Batch: 27/29	Loss: 0.211
Batch: 29/29	Loss: 0.219
Epoch: 23	Train Loss: 0.276	Val F1: 0.354
Best Epoch: 16	Best Val F1: 0.360

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.210
Batch: 3/29	Loss: 0.282
Batch: 5/29	Loss: 0.366
Batch: 7/29	Loss: 0.260
Batch: 9/29	Loss: 0.318
Batch: 11/29	Loss: 0.363
Batch: 13/29	Loss: 0.227
Batch: 15/29	Loss: 0.280
Batch: 17/29	Loss: 0.255
Batch: 19/29	Loss: 0.286
Batch: 21/29	Loss: 0.265
Batch: 23/29	Loss: 0.251
Batch: 25/29	Loss: 0.283
Batch: 27/29	Loss: 0.237
Batch: 29/29	Loss: 0.244
Epoch: 24	Train Loss: 0.264	Val F1: 0.344
Best Epoch: 16	Best Val F1: 0.360

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.263
Batch: 3/29	Loss: 0.267
Batch: 5/29	Loss: 0.284
Batch: 7/29	Loss: 0.253
Batch: 9/29	Loss: 0.320
Batch: 11/29	Loss: 0.245
Batch: 13/29	Loss: 0.276
Batch: 15/29	Loss: 0.253
Batch: 17/29	Loss: 0.265
Batch: 19/29	Loss: 0.183
Batch: 21/29	Loss: 0.302
Batch: 23/29	Loss: 0.235
Batch: 25/29	Loss: 0.244
Batch: 27/29	Loss: 0.289
Batch: 29/29	Loss: 0.195
Epoch: 25	Train Loss: 0.248	Val F1: 0.346
Best Epoch: 16	Best Val F1: 0.360

****************************** Epoch: 26 ******************************
Batch: 1/29	Loss: 0.190
Batch: 3/29	Loss: 0.177
Batch: 5/29	Loss: 0.226
Batch: 7/29	Loss: 0.292
Batch: 9/29	Loss: 0.175
Batch: 11/29	Loss: 0.231
Batch: 13/29	Loss: 0.236
Batch: 15/29	Loss: 0.190
Batch: 17/29	Loss: 0.228
Batch: 19/29	Loss: 0.210
Batch: 21/29	Loss: 0.273
Batch: 23/29	Loss: 0.135
Batch: 25/29	Loss: 0.295
Batch: 27/29	Loss: 0.236
Batch: 29/29	Loss: 0.258
Epoch: 26	Train Loss: 0.227	Val F1: 0.347
Best Epoch: 16	Best Val F1: 0.360

****************************** Epoch: 27 ******************************
Batch: 1/29	Loss: 0.186
Batch: 3/29	Loss: 0.233
Batch: 5/29	Loss: 0.329
Batch: 7/29	Loss: 0.120
Batch: 9/29	Loss: 0.379
Batch: 11/29	Loss: 0.178
Batch: 13/29	Loss: 0.391
Batch: 15/29	Loss: 0.295
Batch: 17/29	Loss: 0.208
Batch: 19/29	Loss: 0.236
Batch: 21/29	Loss: 0.200
Batch: 23/29	Loss: 0.172
Batch: 25/29	Loss: 0.249
Batch: 27/29	Loss: 0.229
Batch: 29/29	Loss: 0.285
Epoch: 27	Train Loss: 0.239	Val F1: 0.353
Best Epoch: 16	Best Val F1: 0.360

****************************** Epoch: 28 ******************************
Batch: 1/29	Loss: 0.227
Batch: 3/29	Loss: 0.192
Batch: 5/29	Loss: 0.203
Batch: 7/29	Loss: 0.201
Batch: 9/29	Loss: 0.255
Batch: 11/29	Loss: 0.168
Batch: 13/29	Loss: 0.165
Batch: 15/29	Loss: 0.250
Batch: 17/29	Loss: 0.207
Batch: 19/29	Loss: 0.152
Batch: 21/29	Loss: 0.244
Batch: 23/29	Loss: 0.248
Batch: 25/29	Loss: 0.235
Batch: 27/29	Loss: 0.183
Batch: 29/29	Loss: 0.211
Epoch: 28	Train Loss: 0.202	Val F1: 0.349
Best Epoch: 16	Best Val F1: 0.360

****************************** Epoch: 29 ******************************
Batch: 1/29	Loss: 0.192
Batch: 3/29	Loss: 0.174
Batch: 5/29	Loss: 0.172
Batch: 7/29	Loss: 0.141
Batch: 9/29	Loss: 0.142
Batch: 11/29	Loss: 0.206
Batch: 13/29	Loss: 0.212
Batch: 15/29	Loss: 0.106
Batch: 17/29	Loss: 0.221
Batch: 19/29	Loss: 0.137
Batch: 21/29	Loss: 0.213
Batch: 23/29	Loss: 0.235
Batch: 25/29	Loss: 0.219
Batch: 27/29	Loss: 0.163
Batch: 29/29	Loss: 0.178
Epoch: 29	Train Loss: 0.170	Val F1: 0.357
Best Epoch: 16	Best Val F1: 0.360

****************************** Epoch: 30 ******************************
Batch: 1/29	Loss: 0.121
Batch: 3/29	Loss: 0.166
Batch: 5/29	Loss: 0.175
Batch: 7/29	Loss: 0.133
Batch: 9/29	Loss: 0.170
Batch: 11/29	Loss: 0.137
Batch: 13/29	Loss: 0.157
Batch: 15/29	Loss: 0.116
Batch: 17/29	Loss: 0.144
Batch: 19/29	Loss: 0.167
Batch: 21/29	Loss: 0.167
Batch: 23/29	Loss: 0.202
Batch: 25/29	Loss: 0.172
Batch: 27/29	Loss: 0.161
Batch: 29/29	Loss: 0.168
Epoch: 30	Train Loss: 0.159	Val F1: 0.356
Best Epoch: 16	Best Val F1: 0.360

****************************** Epoch: 31 ******************************
Batch: 1/29	Loss: 0.111
Batch: 3/29	Loss: 0.121
Batch: 5/29	Loss: 0.102
Batch: 7/29	Loss: 0.132
Batch: 9/29	Loss: 0.138
Batch: 11/29	Loss: 0.189
Batch: 13/29	Loss: 0.191
Batch: 15/29	Loss: 0.121
Batch: 17/29	Loss: 0.148
Batch: 19/29	Loss: 0.154
Batch: 21/29	Loss: 0.183
Batch: 23/29	Loss: 0.148
Batch: 25/29	Loss: 0.151
Batch: 27/29	Loss: 0.128
Batch: 29/29	Loss: 0.138
Epoch: 31	Train Loss: 0.146	Val F1: 0.350
Best Epoch: 16	Best Val F1: 0.360

Saving the best checkpoint....
Inference...
Test F1: 0.362	Test F1_Few: 0.441	Test F1_Zero: 0.349
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0006470915463604823, 'lr': 2.9610863746433477e-05, 'n_layers_freeze': 4, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.057
Batch: 5/29	Loss: 1.011
Batch: 7/29	Loss: 0.982
Batch: 9/29	Loss: 0.950
Batch: 11/29	Loss: 0.940
Batch: 13/29	Loss: 0.927
Batch: 15/29	Loss: 0.938
Batch: 17/29	Loss: 0.889
Batch: 19/29	Loss: 0.891
Batch: 21/29	Loss: 0.866
Batch: 23/29	Loss: 0.879
Batch: 25/29	Loss: 0.839
Batch: 27/29	Loss: 0.838
Batch: 29/29	Loss: 0.849
Epoch: 1	Train Loss: 0.928	Val F1: 0.187
Best Epoch: 1	Best Val F1: 0.187

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.838
Batch: 3/29	Loss: 0.837
Batch: 5/29	Loss: 0.874
Batch: 7/29	Loss: 0.823
Batch: 9/29	Loss: 0.843
Batch: 11/29	Loss: 0.791
Batch: 13/29	Loss: 0.793
Batch: 15/29	Loss: 0.817
Batch: 17/29	Loss: 0.808
Batch: 19/29	Loss: 0.851
Batch: 21/29	Loss: 0.792
Batch: 23/29	Loss: 0.804
Batch: 25/29	Loss: 0.775
Batch: 27/29	Loss: 0.849
Batch: 29/29	Loss: 0.779
Epoch: 2	Train Loss: 0.813	Val F1: 0.192
Best Epoch: 2	Best Val F1: 0.192

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.766
Batch: 3/29	Loss: 0.794
Batch: 5/29	Loss: 0.778
Batch: 7/29	Loss: 0.819
Batch: 9/29	Loss: 0.757
Batch: 11/29	Loss: 0.757
Batch: 13/29	Loss: 0.809
Batch: 15/29	Loss: 0.770
Batch: 17/29	Loss: 0.789
Batch: 19/29	Loss: 0.775
Batch: 21/29	Loss: 0.750
Batch: 23/29	Loss: 0.740
Batch: 25/29	Loss: 0.773
Batch: 27/29	Loss: 0.749
Batch: 29/29	Loss: 0.750
Epoch: 3	Train Loss: 0.773	Val F1: 0.311
Best Epoch: 3	Best Val F1: 0.311

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.714
Batch: 3/29	Loss: 0.732
Batch: 5/29	Loss: 0.715
Batch: 7/29	Loss: 0.775
Batch: 9/29	Loss: 0.729
Batch: 11/29	Loss: 0.656
Batch: 13/29	Loss: 0.709
Batch: 15/29	Loss: 0.668
Batch: 17/29	Loss: 0.688
Batch: 19/29	Loss: 0.729
Batch: 21/29	Loss: 0.726
Batch: 23/29	Loss: 0.709
Batch: 25/29	Loss: 0.677
Batch: 27/29	Loss: 0.721
Batch: 29/29	Loss: 0.716
Epoch: 4	Train Loss: 0.716	Val F1: 0.338
Best Epoch: 4	Best Val F1: 0.338

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.647
Batch: 3/29	Loss: 0.628
Batch: 5/29	Loss: 0.611
Batch: 7/29	Loss: 0.658
Batch: 9/29	Loss: 0.604
Batch: 11/29	Loss: 0.614
Batch: 13/29	Loss: 0.687
Batch: 15/29	Loss: 0.687
Batch: 17/29	Loss: 0.805
Batch: 19/29	Loss: 0.667
Batch: 21/29	Loss: 0.619
Batch: 23/29	Loss: 0.661
Batch: 25/29	Loss: 0.660
Batch: 27/29	Loss: 0.653
Batch: 29/29	Loss: 0.674
Epoch: 5	Train Loss: 0.668	Val F1: 0.351
Best Epoch: 5	Best Val F1: 0.351

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.673
Batch: 3/29	Loss: 0.704
Batch: 5/29	Loss: 0.544
Batch: 7/29	Loss: 0.688
Batch: 9/29	Loss: 0.621
Batch: 11/29	Loss: 0.576
Batch: 13/29	Loss: 0.597
Batch: 15/29	Loss: 0.548
Batch: 17/29	Loss: 0.581
Batch: 19/29	Loss: 0.538
Batch: 21/29	Loss: 0.696
Batch: 23/29	Loss: 0.678
Batch: 25/29	Loss: 0.601
Batch: 27/29	Loss: 0.603
Batch: 29/29	Loss: 0.602
Epoch: 6	Train Loss: 0.613	Val F1: 0.346
Best Epoch: 5	Best Val F1: 0.351

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.568
Batch: 3/29	Loss: 0.630
Batch: 5/29	Loss: 0.675
Batch: 7/29	Loss: 0.594
Batch: 9/29	Loss: 0.621
Batch: 11/29	Loss: 0.531
Batch: 13/29	Loss: 0.547
Batch: 15/29	Loss: 0.524
Batch: 17/29	Loss: 0.594
Batch: 19/29	Loss: 0.589
Batch: 21/29	Loss: 0.589
Batch: 23/29	Loss: 0.541
Batch: 25/29	Loss: 0.496
Batch: 27/29	Loss: 0.528
Batch: 29/29	Loss: 0.582
Epoch: 7	Train Loss: 0.571	Val F1: 0.346
Best Epoch: 5	Best Val F1: 0.351

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.546
Batch: 3/29	Loss: 0.475
Batch: 5/29	Loss: 0.547
Batch: 7/29	Loss: 0.515
Batch: 9/29	Loss: 0.500
Batch: 11/29	Loss: 0.555
Batch: 13/29	Loss: 0.531
Batch: 15/29	Loss: 0.479
Batch: 17/29	Loss: 0.523
Batch: 19/29	Loss: 0.435
Batch: 21/29	Loss: 0.509
Batch: 23/29	Loss: 0.517
Batch: 25/29	Loss: 0.607
Batch: 27/29	Loss: 0.584
Batch: 29/29	Loss: 0.489
Epoch: 8	Train Loss: 0.517	Val F1: 0.356
Best Epoch: 8	Best Val F1: 0.356

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.546
Batch: 3/29	Loss: 0.505
Batch: 5/29	Loss: 0.469
Batch: 7/29	Loss: 0.376
Batch: 9/29	Loss: 0.518
Batch: 11/29	Loss: 0.491
Batch: 13/29	Loss: 0.447
Batch: 15/29	Loss: 0.450
Batch: 17/29	Loss: 0.459
Batch: 19/29	Loss: 0.433
Batch: 21/29	Loss: 0.514
Batch: 23/29	Loss: 0.459
Batch: 25/29	Loss: 0.486
Batch: 27/29	Loss: 0.491
Batch: 29/29	Loss: 0.372
Epoch: 9	Train Loss: 0.470	Val F1: 0.360
Best Epoch: 9	Best Val F1: 0.360

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.380
Batch: 3/29	Loss: 0.459
Batch: 5/29	Loss: 0.412
Batch: 7/29	Loss: 0.541
Batch: 9/29	Loss: 0.380
Batch: 11/29	Loss: 0.407
Batch: 13/29	Loss: 0.550
Batch: 15/29	Loss: 0.455
Batch: 17/29	Loss: 0.516
Batch: 19/29	Loss: 0.299
Batch: 21/29	Loss: 0.518
Batch: 23/29	Loss: 0.497
Batch: 25/29	Loss: 0.570
Batch: 27/29	Loss: 0.457
Batch: 29/29	Loss: 0.535
Epoch: 10	Train Loss: 0.448	Val F1: 0.360
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.474
Batch: 3/29	Loss: 0.404
Batch: 5/29	Loss: 0.552
Batch: 7/29	Loss: 0.422
Batch: 9/29	Loss: 0.397
Batch: 11/29	Loss: 0.426
Batch: 13/29	Loss: 0.405
Batch: 15/29	Loss: 0.333
Batch: 17/29	Loss: 0.425
Batch: 19/29	Loss: 0.466
Batch: 21/29	Loss: 0.355
Batch: 23/29	Loss: 0.343
Batch: 25/29	Loss: 0.331
Batch: 27/29	Loss: 0.381
Batch: 29/29	Loss: 0.406
Epoch: 11	Train Loss: 0.412	Val F1: 0.352
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.472
Batch: 3/29	Loss: 0.367
Batch: 5/29	Loss: 0.329
Batch: 7/29	Loss: 0.356
Batch: 9/29	Loss: 0.414
Batch: 11/29	Loss: 0.399
Batch: 13/29	Loss: 0.343
Batch: 15/29	Loss: 0.401
Batch: 17/29	Loss: 0.406
Batch: 19/29	Loss: 0.343
Batch: 21/29	Loss: 0.335
Batch: 23/29	Loss: 0.402
Batch: 25/29	Loss: 0.328
Batch: 27/29	Loss: 0.501
Batch: 29/29	Loss: 0.280
Epoch: 12	Train Loss: 0.378	Val F1: 0.352
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.395
Batch: 3/29	Loss: 0.292
Batch: 5/29	Loss: 0.396
Batch: 7/29	Loss: 0.328
Batch: 9/29	Loss: 0.394
Batch: 11/29	Loss: 0.430
Batch: 13/29	Loss: 0.396
Batch: 15/29	Loss: 0.344
Batch: 17/29	Loss: 0.311
Batch: 19/29	Loss: 0.216
Batch: 21/29	Loss: 0.344
Batch: 23/29	Loss: 0.314
Batch: 25/29	Loss: 0.242
Batch: 27/29	Loss: 0.384
Batch: 29/29	Loss: 0.412
Epoch: 13	Train Loss: 0.361	Val F1: 0.327
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.383
Batch: 3/29	Loss: 0.372
Batch: 5/29	Loss: 0.263
Batch: 7/29	Loss: 0.325
Batch: 9/29	Loss: 0.407
Batch: 11/29	Loss: 0.302
Batch: 13/29	Loss: 0.302
Batch: 15/29	Loss: 0.288
Batch: 17/29	Loss: 0.430
Batch: 19/29	Loss: 0.413
Batch: 21/29	Loss: 0.247
Batch: 23/29	Loss: 0.287
Batch: 25/29	Loss: 0.358
Batch: 27/29	Loss: 0.314
Batch: 29/29	Loss: 0.296
Epoch: 14	Train Loss: 0.340	Val F1: 0.336
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.319
Batch: 3/29	Loss: 0.323
Batch: 5/29	Loss: 0.235
Batch: 7/29	Loss: 0.281
Batch: 9/29	Loss: 0.359
Batch: 11/29	Loss: 0.313
Batch: 13/29	Loss: 0.293
Batch: 15/29	Loss: 0.288
Batch: 17/29	Loss: 0.401
Batch: 19/29	Loss: 0.305
Batch: 21/29	Loss: 0.342
Batch: 23/29	Loss: 0.358
Batch: 25/29	Loss: 0.362
Batch: 27/29	Loss: 0.310
Batch: 29/29	Loss: 0.365
Epoch: 15	Train Loss: 0.326	Val F1: 0.345
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.343
Batch: 3/29	Loss: 0.335
Batch: 5/29	Loss: 0.328
Batch: 7/29	Loss: 0.255
Batch: 9/29	Loss: 0.281
Batch: 11/29	Loss: 0.282
Batch: 13/29	Loss: 0.279
Batch: 15/29	Loss: 0.259
Batch: 17/29	Loss: 0.294
Batch: 19/29	Loss: 0.335
Batch: 21/29	Loss: 0.263
Batch: 23/29	Loss: 0.326
Batch: 25/29	Loss: 0.339
Batch: 27/29	Loss: 0.300
Batch: 29/29	Loss: 0.324
Epoch: 16	Train Loss: 0.302	Val F1: 0.349
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.266
Batch: 3/29	Loss: 0.325
Batch: 5/29	Loss: 0.334
Batch: 7/29	Loss: 0.278
Batch: 9/29	Loss: 0.181
Batch: 11/29	Loss: 0.258
Batch: 13/29	Loss: 0.329
Batch: 15/29	Loss: 0.328
Batch: 17/29	Loss: 0.336
Batch: 19/29	Loss: 0.274
Batch: 21/29	Loss: 0.307
Batch: 23/29	Loss: 0.409
Batch: 25/29	Loss: 0.160
Batch: 27/29	Loss: 0.252
Batch: 29/29	Loss: 0.304
Epoch: 17	Train Loss: 0.285	Val F1: 0.348
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.265
Batch: 3/29	Loss: 0.332
Batch: 5/29	Loss: 0.300
Batch: 7/29	Loss: 0.218
Batch: 9/29	Loss: 0.364
Batch: 11/29	Loss: 0.222
Batch: 13/29	Loss: 0.200
Batch: 15/29	Loss: 0.247
Batch: 17/29	Loss: 0.286
Batch: 19/29	Loss: 0.205
Batch: 21/29	Loss: 0.300
Batch: 23/29	Loss: 0.282
Batch: 25/29	Loss: 0.256
Batch: 27/29	Loss: 0.221
Batch: 29/29	Loss: 0.362
Epoch: 18	Train Loss: 0.265	Val F1: 0.347
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.171
Batch: 3/29	Loss: 0.183
Batch: 5/29	Loss: 0.286
Batch: 7/29	Loss: 0.329
Batch: 9/29	Loss: 0.211
Batch: 11/29	Loss: 0.318
Batch: 13/29	Loss: 0.305
Batch: 15/29	Loss: 0.253
Batch: 17/29	Loss: 0.198
Batch: 19/29	Loss: 0.297
Batch: 21/29	Loss: 0.248
Batch: 23/29	Loss: 0.292
Batch: 25/29	Loss: 0.277
Batch: 27/29	Loss: 0.223
Batch: 29/29	Loss: 0.249
Epoch: 19	Train Loss: 0.251	Val F1: 0.351
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.334
Batch: 3/29	Loss: 0.244
Batch: 5/29	Loss: 0.225
Batch: 7/29	Loss: 0.178
Batch: 9/29	Loss: 0.230
Batch: 11/29	Loss: 0.261
Batch: 13/29	Loss: 0.216
Batch: 15/29	Loss: 0.263
Batch: 17/29	Loss: 0.285
Batch: 19/29	Loss: 0.160
Batch: 21/29	Loss: 0.228
Batch: 23/29	Loss: 0.266
Batch: 25/29	Loss: 0.199
Batch: 27/29	Loss: 0.216
Batch: 29/29	Loss: 0.264
Epoch: 20	Train Loss: 0.235	Val F1: 0.335
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.210
Batch: 3/29	Loss: 0.210
Batch: 5/29	Loss: 0.230
Batch: 7/29	Loss: 0.344
Batch: 9/29	Loss: 0.146
Batch: 11/29	Loss: 0.175
Batch: 13/29	Loss: 0.249
Batch: 15/29	Loss: 0.250
Batch: 17/29	Loss: 0.140
Batch: 19/29	Loss: 0.201
Batch: 21/29	Loss: 0.265
Batch: 23/29	Loss: 0.213
Batch: 25/29	Loss: 0.239
Batch: 27/29	Loss: 0.227
Batch: 29/29	Loss: 0.263
Epoch: 21	Train Loss: 0.219	Val F1: 0.341
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.226
Batch: 3/29	Loss: 0.156
Batch: 5/29	Loss: 0.198
Batch: 7/29	Loss: 0.276
Batch: 9/29	Loss: 0.194
Batch: 11/29	Loss: 0.205
Batch: 13/29	Loss: 0.159
Batch: 15/29	Loss: 0.217
Batch: 17/29	Loss: 0.273
Batch: 19/29	Loss: 0.251
Batch: 21/29	Loss: 0.245
Batch: 23/29	Loss: 0.209
Batch: 25/29	Loss: 0.189
Batch: 27/29	Loss: 0.120
Batch: 29/29	Loss: 0.153
Epoch: 22	Train Loss: 0.199	Val F1: 0.344
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.182
Batch: 3/29	Loss: 0.208
Batch: 5/29	Loss: 0.189
Batch: 7/29	Loss: 0.278
Batch: 9/29	Loss: 0.124
Batch: 11/29	Loss: 0.180
Batch: 13/29	Loss: 0.171
Batch: 15/29	Loss: 0.229
Batch: 17/29	Loss: 0.225
Batch: 19/29	Loss: 0.259
Batch: 21/29	Loss: 0.184
Batch: 23/29	Loss: 0.190
Batch: 25/29	Loss: 0.284
Batch: 27/29	Loss: 0.116
Batch: 29/29	Loss: 0.179
Epoch: 23	Train Loss: 0.202	Val F1: 0.333
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.215
Batch: 3/29	Loss: 0.133
Batch: 5/29	Loss: 0.247
Batch: 7/29	Loss: 0.165
Batch: 9/29	Loss: 0.171
Batch: 11/29	Loss: 0.211
Batch: 13/29	Loss: 0.106
Batch: 15/29	Loss: 0.164
Batch: 17/29	Loss: 0.166
Batch: 19/29	Loss: 0.190
Batch: 21/29	Loss: 0.180
Batch: 23/29	Loss: 0.146
Batch: 25/29	Loss: 0.176
Batch: 27/29	Loss: 0.143
Batch: 29/29	Loss: 0.198
Epoch: 24	Train Loss: 0.167	Val F1: 0.352
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.162
Batch: 3/29	Loss: 0.143
Batch: 5/29	Loss: 0.129
Batch: 7/29	Loss: 0.130
Batch: 9/29	Loss: 0.136
Batch: 11/29	Loss: 0.126
Batch: 13/29	Loss: 0.146
Batch: 15/29	Loss: 0.154
Batch: 17/29	Loss: 0.148
Batch: 19/29	Loss: 0.099
Batch: 21/29	Loss: 0.150
Batch: 23/29	Loss: 0.103
Batch: 25/29	Loss: 0.164
Batch: 27/29	Loss: 0.150
Batch: 29/29	Loss: 0.156
Epoch: 25	Train Loss: 0.134	Val F1: 0.350
Best Epoch: 10	Best Val F1: 0.360

Saving the best checkpoint....
Inference...
Test F1: 0.372	Test F1_Few: 0.442	Test F1_Zero: 0.368
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0009014378643262936, 'lr': 1.7869221098590443e-05, 'n_layers_freeze': 0, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.069
Batch: 5/29	Loss: 1.037
Batch: 7/29	Loss: 1.015
Batch: 9/29	Loss: 0.990
Batch: 11/29	Loss: 0.975
Batch: 13/29	Loss: 0.962
Batch: 15/29	Loss: 0.965
Batch: 17/29	Loss: 0.926
Batch: 19/29	Loss: 0.924
Batch: 21/29	Loss: 0.904
Batch: 23/29	Loss: 0.911
Batch: 25/29	Loss: 0.879
Batch: 27/29	Loss: 0.876
Batch: 29/29	Loss: 0.882
Epoch: 1	Train Loss: 0.959	Val F1: 0.186
Best Epoch: 1	Best Val F1: 0.186

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.874
Batch: 3/29	Loss: 0.872
Batch: 5/29	Loss: 0.899
Batch: 7/29	Loss: 0.860
Batch: 9/29	Loss: 0.874
Batch: 11/29	Loss: 0.832
Batch: 13/29	Loss: 0.832
Batch: 15/29	Loss: 0.853
Batch: 17/29	Loss: 0.843
Batch: 19/29	Loss: 0.874
Batch: 21/29	Loss: 0.828
Batch: 23/29	Loss: 0.835
Batch: 25/29	Loss: 0.813
Batch: 27/29	Loss: 0.871
Batch: 29/29	Loss: 0.816
Epoch: 2	Train Loss: 0.848	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.186

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.806
Batch: 3/29	Loss: 0.825
Batch: 5/29	Loss: 0.813
Batch: 7/29	Loss: 0.843
Batch: 9/29	Loss: 0.795
Batch: 11/29	Loss: 0.795
Batch: 13/29	Loss: 0.834
Batch: 15/29	Loss: 0.803
Batch: 17/29	Loss: 0.818
Batch: 19/29	Loss: 0.812
Batch: 21/29	Loss: 0.788
Batch: 23/29	Loss: 0.779
Batch: 25/29	Loss: 0.800
Batch: 27/29	Loss: 0.772
Batch: 29/29	Loss: 0.785
Epoch: 3	Train Loss: 0.806	Val F1: 0.275
Best Epoch: 3	Best Val F1: 0.275

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.762
Batch: 3/29	Loss: 0.773
Batch: 5/29	Loss: 0.755
Batch: 7/29	Loss: 0.812
Batch: 9/29	Loss: 0.784
Batch: 11/29	Loss: 0.724
Batch: 13/29	Loss: 0.747
Batch: 15/29	Loss: 0.733
Batch: 17/29	Loss: 0.727
Batch: 19/29	Loss: 0.761
Batch: 21/29	Loss: 0.758
Batch: 23/29	Loss: 0.737
Batch: 25/29	Loss: 0.731
Batch: 27/29	Loss: 0.745
Batch: 29/29	Loss: 0.748
Epoch: 4	Train Loss: 0.759	Val F1: 0.256
Best Epoch: 3	Best Val F1: 0.275

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.714
Batch: 3/29	Loss: 0.707
Batch: 5/29	Loss: 0.682
Batch: 7/29	Loss: 0.725
Batch: 9/29	Loss: 0.672
Batch: 11/29	Loss: 0.743
Batch: 13/29	Loss: 0.666
Batch: 15/29	Loss: 0.708
Batch: 17/29	Loss: 0.736
Batch: 19/29	Loss: 0.724
Batch: 21/29	Loss: 0.674
Batch: 23/29	Loss: 0.723
Batch: 25/29	Loss: 0.705
Batch: 27/29	Loss: 0.685
Batch: 29/29	Loss: 0.711
Epoch: 5	Train Loss: 0.715	Val F1: 0.318
Best Epoch: 5	Best Val F1: 0.318

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.698
Batch: 3/29	Loss: 0.736
Batch: 5/29	Loss: 0.610
Batch: 7/29	Loss: 0.750
Batch: 9/29	Loss: 0.661
Batch: 11/29	Loss: 0.653
Batch: 13/29	Loss: 0.675
Batch: 15/29	Loss: 0.612
Batch: 17/29	Loss: 0.629
Batch: 19/29	Loss: 0.626
Batch: 21/29	Loss: 0.714
Batch: 23/29	Loss: 0.696
Batch: 25/29	Loss: 0.657
Batch: 27/29	Loss: 0.659
Batch: 29/29	Loss: 0.652
Epoch: 6	Train Loss: 0.665	Val F1: 0.354
Best Epoch: 6	Best Val F1: 0.354

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.604
Batch: 3/29	Loss: 0.692
Batch: 5/29	Loss: 0.695
Batch: 7/29	Loss: 0.654
Batch: 9/29	Loss: 0.637
Batch: 11/29	Loss: 0.552
Batch: 13/29	Loss: 0.610
Batch: 15/29	Loss: 0.555
Batch: 17/29	Loss: 0.636
Batch: 19/29	Loss: 0.653
Batch: 21/29	Loss: 0.583
Batch: 23/29	Loss: 0.565
Batch: 25/29	Loss: 0.540
Batch: 27/29	Loss: 0.579
Batch: 29/29	Loss: 0.567
Epoch: 7	Train Loss: 0.612	Val F1: 0.345
Best Epoch: 6	Best Val F1: 0.354

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.553
Batch: 3/29	Loss: 0.572
Batch: 5/29	Loss: 0.617
Batch: 7/29	Loss: 0.550
Batch: 9/29	Loss: 0.554
Batch: 11/29	Loss: 0.577
Batch: 13/29	Loss: 0.589
Batch: 15/29	Loss: 0.536
Batch: 17/29	Loss: 0.579
Batch: 19/29	Loss: 0.541
Batch: 21/29	Loss: 0.578
Batch: 23/29	Loss: 0.543
Batch: 25/29	Loss: 0.644
Batch: 27/29	Loss: 0.590
Batch: 29/29	Loss: 0.543
Epoch: 8	Train Loss: 0.576	Val F1: 0.348
Best Epoch: 6	Best Val F1: 0.354

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.599
Batch: 3/29	Loss: 0.562
Batch: 5/29	Loss: 0.554
Batch: 7/29	Loss: 0.490
Batch: 9/29	Loss: 0.567
Batch: 11/29	Loss: 0.533
Batch: 13/29	Loss: 0.516
Batch: 15/29	Loss: 0.469
Batch: 17/29	Loss: 0.484
Batch: 19/29	Loss: 0.428
Batch: 21/29	Loss: 0.594
Batch: 23/29	Loss: 0.529
Batch: 25/29	Loss: 0.456
Batch: 27/29	Loss: 0.608
Batch: 29/29	Loss: 0.439
Epoch: 9	Train Loss: 0.525	Val F1: 0.342
Best Epoch: 6	Best Val F1: 0.354

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.451
Batch: 3/29	Loss: 0.493
Batch: 5/29	Loss: 0.490
Batch: 7/29	Loss: 0.444
Batch: 9/29	Loss: 0.474
Batch: 11/29	Loss: 0.404
Batch: 13/29	Loss: 0.570
Batch: 15/29	Loss: 0.651
Batch: 17/29	Loss: 0.558
Batch: 19/29	Loss: 0.449
Batch: 21/29	Loss: 0.552
Batch: 23/29	Loss: 0.619
Batch: 25/29	Loss: 0.567
Batch: 27/29	Loss: 0.522
Batch: 29/29	Loss: 0.537
Epoch: 10	Train Loss: 0.506	Val F1: 0.366
Best Epoch: 10	Best Val F1: 0.366

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.499
Batch: 3/29	Loss: 0.438
Batch: 5/29	Loss: 0.610
Batch: 7/29	Loss: 0.499
Batch: 9/29	Loss: 0.427
Batch: 11/29	Loss: 0.454
Batch: 13/29	Loss: 0.456
Batch: 15/29	Loss: 0.350
Batch: 17/29	Loss: 0.515
Batch: 19/29	Loss: 0.471
Batch: 21/29	Loss: 0.427
Batch: 23/29	Loss: 0.365
Batch: 25/29	Loss: 0.381
Batch: 27/29	Loss: 0.430
Batch: 29/29	Loss: 0.456
Epoch: 11	Train Loss: 0.458	Val F1: 0.344
Best Epoch: 10	Best Val F1: 0.366

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.512
Batch: 3/29	Loss: 0.390
Batch: 5/29	Loss: 0.424
Batch: 7/29	Loss: 0.426
Batch: 9/29	Loss: 0.452
Batch: 11/29	Loss: 0.454
Batch: 13/29	Loss: 0.428
Batch: 15/29	Loss: 0.384
Batch: 17/29	Loss: 0.432
Batch: 19/29	Loss: 0.352
Batch: 21/29	Loss: 0.365
Batch: 23/29	Loss: 0.420
Batch: 25/29	Loss: 0.416
Batch: 27/29	Loss: 0.579
Batch: 29/29	Loss: 0.327
Epoch: 12	Train Loss: 0.425	Val F1: 0.351
Best Epoch: 10	Best Val F1: 0.366

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.479
Batch: 3/29	Loss: 0.306
Batch: 5/29	Loss: 0.459
Batch: 7/29	Loss: 0.392
Batch: 9/29	Loss: 0.446
Batch: 11/29	Loss: 0.422
Batch: 13/29	Loss: 0.405
Batch: 15/29	Loss: 0.422
Batch: 17/29	Loss: 0.360
Batch: 19/29	Loss: 0.240
Batch: 21/29	Loss: 0.346
Batch: 23/29	Loss: 0.387
Batch: 25/29	Loss: 0.335
Batch: 27/29	Loss: 0.390
Batch: 29/29	Loss: 0.534
Epoch: 13	Train Loss: 0.405	Val F1: 0.340
Best Epoch: 10	Best Val F1: 0.366

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.411
Batch: 3/29	Loss: 0.391
Batch: 5/29	Loss: 0.305
Batch: 7/29	Loss: 0.399
Batch: 9/29	Loss: 0.450
Batch: 11/29	Loss: 0.411
Batch: 13/29	Loss: 0.363
Batch: 15/29	Loss: 0.285
Batch: 17/29	Loss: 0.440
Batch: 19/29	Loss: 0.425
Batch: 21/29	Loss: 0.291
Batch: 23/29	Loss: 0.298
Batch: 25/29	Loss: 0.431
Batch: 27/29	Loss: 0.356
Batch: 29/29	Loss: 0.391
Epoch: 14	Train Loss: 0.389	Val F1: 0.348
Best Epoch: 10	Best Val F1: 0.366

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.330
Batch: 3/29	Loss: 0.361
Batch: 5/29	Loss: 0.249
Batch: 7/29	Loss: 0.339
Batch: 9/29	Loss: 0.380
Batch: 11/29	Loss: 0.345
Batch: 13/29	Loss: 0.343
Batch: 15/29	Loss: 0.340
Batch: 17/29	Loss: 0.408
Batch: 19/29	Loss: 0.358
Batch: 21/29	Loss: 0.372
Batch: 23/29	Loss: 0.394
Batch: 25/29	Loss: 0.425
Batch: 27/29	Loss: 0.325
Batch: 29/29	Loss: 0.451
Epoch: 15	Train Loss: 0.368	Val F1: 0.348
Best Epoch: 10	Best Val F1: 0.366

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.422
Batch: 3/29	Loss: 0.362
Batch: 5/29	Loss: 0.401
Batch: 7/29	Loss: 0.306
Batch: 9/29	Loss: 0.332
Batch: 11/29	Loss: 0.357
Batch: 13/29	Loss: 0.321
Batch: 15/29	Loss: 0.272
Batch: 17/29	Loss: 0.319
Batch: 19/29	Loss: 0.418
Batch: 21/29	Loss: 0.303
Batch: 23/29	Loss: 0.365
Batch: 25/29	Loss: 0.361
Batch: 27/29	Loss: 0.334
Batch: 29/29	Loss: 0.329
Epoch: 16	Train Loss: 0.349	Val F1: 0.356
Best Epoch: 10	Best Val F1: 0.366

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.305
Batch: 3/29	Loss: 0.433
Batch: 5/29	Loss: 0.320
Batch: 7/29	Loss: 0.304
Batch: 9/29	Loss: 0.260
Batch: 11/29	Loss: 0.384
Batch: 13/29	Loss: 0.451
Batch: 15/29	Loss: 0.342
Batch: 17/29	Loss: 0.393
Batch: 19/29	Loss: 0.288
Batch: 21/29	Loss: 0.345
Batch: 23/29	Loss: 0.447
Batch: 25/29	Loss: 0.209
Batch: 27/29	Loss: 0.326
Batch: 29/29	Loss: 0.392
Epoch: 17	Train Loss: 0.335	Val F1: 0.343
Best Epoch: 10	Best Val F1: 0.366

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.383
Batch: 3/29	Loss: 0.382
Batch: 5/29	Loss: 0.335
Batch: 7/29	Loss: 0.262
Batch: 9/29	Loss: 0.423
Batch: 11/29	Loss: 0.258
Batch: 13/29	Loss: 0.251
Batch: 15/29	Loss: 0.294
Batch: 17/29	Loss: 0.294
Batch: 19/29	Loss: 0.250
Batch: 21/29	Loss: 0.323
Batch: 23/29	Loss: 0.319
Batch: 25/29	Loss: 0.367
Batch: 27/29	Loss: 0.226
Batch: 29/29	Loss: 0.343
Epoch: 18	Train Loss: 0.314	Val F1: 0.353
Best Epoch: 10	Best Val F1: 0.366

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.215
Batch: 3/29	Loss: 0.233
Batch: 5/29	Loss: 0.306
Batch: 7/29	Loss: 0.328
Batch: 9/29	Loss: 0.234
Batch: 11/29	Loss: 0.345
Batch: 13/29	Loss: 0.474
Batch: 15/29	Loss: 0.310
Batch: 17/29	Loss: 0.266
Batch: 19/29	Loss: 0.372
Batch: 21/29	Loss: 0.334
Batch: 23/29	Loss: 0.296
Batch: 25/29	Loss: 0.316
Batch: 27/29	Loss: 0.236
Batch: 29/29	Loss: 0.240
Epoch: 19	Train Loss: 0.305	Val F1: 0.354
Best Epoch: 10	Best Val F1: 0.366

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.359
Batch: 3/29	Loss: 0.298
Batch: 5/29	Loss: 0.247
Batch: 7/29	Loss: 0.209
Batch: 9/29	Loss: 0.342
Batch: 11/29	Loss: 0.310
Batch: 13/29	Loss: 0.318
Batch: 15/29	Loss: 0.305
Batch: 17/29	Loss: 0.383
Batch: 19/29	Loss: 0.298
Batch: 21/29	Loss: 0.289
Batch: 23/29	Loss: 0.369
Batch: 25/29	Loss: 0.271
Batch: 27/29	Loss: 0.299
Batch: 29/29	Loss: 0.354
Epoch: 20	Train Loss: 0.298	Val F1: 0.352
Best Epoch: 10	Best Val F1: 0.366

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.258
Batch: 3/29	Loss: 0.244
Batch: 5/29	Loss: 0.261
Batch: 7/29	Loss: 0.449
Batch: 9/29	Loss: 0.286
Batch: 11/29	Loss: 0.194
Batch: 13/29	Loss: 0.329
Batch: 15/29	Loss: 0.329
Batch: 17/29	Loss: 0.271
Batch: 19/29	Loss: 0.255
Batch: 21/29	Loss: 0.255
Batch: 23/29	Loss: 0.299
Batch: 25/29	Loss: 0.268
Batch: 27/29	Loss: 0.297
Batch: 29/29	Loss: 0.297
Epoch: 21	Train Loss: 0.294	Val F1: 0.348
Best Epoch: 10	Best Val F1: 0.366

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.264
Batch: 3/29	Loss: 0.229
Batch: 5/29	Loss: 0.281
Batch: 7/29	Loss: 0.323
Batch: 9/29	Loss: 0.243
Batch: 11/29	Loss: 0.281
Batch: 13/29	Loss: 0.232
Batch: 15/29	Loss: 0.280
Batch: 17/29	Loss: 0.306
Batch: 19/29	Loss: 0.325
Batch: 21/29	Loss: 0.290
Batch: 23/29	Loss: 0.261
Batch: 25/29	Loss: 0.266
Batch: 27/29	Loss: 0.251
Batch: 29/29	Loss: 0.277
Epoch: 22	Train Loss: 0.276	Val F1: 0.350
Best Epoch: 10	Best Val F1: 0.366

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.236
Batch: 3/29	Loss: 0.283
Batch: 5/29	Loss: 0.284
Batch: 7/29	Loss: 0.357
Batch: 9/29	Loss: 0.211
Batch: 11/29	Loss: 0.288
Batch: 13/29	Loss: 0.282
Batch: 15/29	Loss: 0.269
Batch: 17/29	Loss: 0.275
Batch: 19/29	Loss: 0.322
Batch: 21/29	Loss: 0.225
Batch: 23/29	Loss: 0.260
Batch: 25/29	Loss: 0.299
Batch: 27/29	Loss: 0.184
Batch: 29/29	Loss: 0.237
Epoch: 23	Train Loss: 0.264	Val F1: 0.353
Best Epoch: 10	Best Val F1: 0.366

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.216
Batch: 3/29	Loss: 0.255
Batch: 5/29	Loss: 0.275
Batch: 7/29	Loss: 0.263
Batch: 9/29	Loss: 0.281
Batch: 11/29	Loss: 0.385
Batch: 13/29	Loss: 0.223
Batch: 15/29	Loss: 0.258
Batch: 17/29	Loss: 0.279
Batch: 19/29	Loss: 0.269
Batch: 21/29	Loss: 0.290
Batch: 23/29	Loss: 0.212
Batch: 25/29	Loss: 0.262
Batch: 27/29	Loss: 0.269
Batch: 29/29	Loss: 0.229
Epoch: 24	Train Loss: 0.257	Val F1: 0.355
Best Epoch: 10	Best Val F1: 0.366

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.244
Batch: 3/29	Loss: 0.260
Batch: 5/29	Loss: 0.288
Batch: 7/29	Loss: 0.272
Batch: 9/29	Loss: 0.348
Batch: 11/29	Loss: 0.250
Batch: 13/29	Loss: 0.278
Batch: 15/29	Loss: 0.250
Batch: 17/29	Loss: 0.274
Batch: 19/29	Loss: 0.198
Batch: 21/29	Loss: 0.197
Batch: 23/29	Loss: 0.227
Batch: 25/29	Loss: 0.215
Batch: 27/29	Loss: 0.240
Batch: 29/29	Loss: 0.202
Epoch: 25	Train Loss: 0.239	Val F1: 0.345
Best Epoch: 10	Best Val F1: 0.366

Saving the best checkpoint....
Inference...
Test F1: 0.384	Test F1_Few: 0.456	Test F1_Zero: 0.382
Starting training with config: {'batch_size': 32, 'epochs': 50, 'l2_reg': 0.0008133115954590044, 'lr': 2.086687129745577e-05, 'n_layers_freeze': 3, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 1.032
Batch: 11/58	Loss: 0.966
Batch: 16/58	Loss: 0.901
Batch: 21/58	Loss: 0.908
Batch: 26/58	Loss: 0.897
Batch: 31/58	Loss: 0.865
Batch: 36/58	Loss: 0.889
Batch: 41/58	Loss: 0.836
Batch: 46/58	Loss: 0.819
Batch: 51/58	Loss: 0.806
Batch: 56/58	Loss: 0.812
Batch: 58/58	Loss: 0.819
Epoch: 1	Train Loss: 0.902	Val F1: 0.215
Best Epoch: 1	Best Val F1: 0.215

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.826
Batch: 6/58	Loss: 0.835
Batch: 11/58	Loss: 0.837
Batch: 16/58	Loss: 0.772
Batch: 21/58	Loss: 0.772
Batch: 26/58	Loss: 0.775
Batch: 31/58	Loss: 0.818
Batch: 36/58	Loss: 0.805
Batch: 41/58	Loss: 0.759
Batch: 46/58	Loss: 0.765
Batch: 51/58	Loss: 0.763
Batch: 56/58	Loss: 0.758
Batch: 58/58	Loss: 0.734
Epoch: 2	Train Loss: 0.791	Val F1: 0.345
Best Epoch: 2	Best Val F1: 0.345

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.714
Batch: 6/58	Loss: 0.689
Batch: 11/58	Loss: 0.820
Batch: 16/58	Loss: 0.714
Batch: 21/58	Loss: 0.720
Batch: 26/58	Loss: 0.703
Batch: 31/58	Loss: 0.887
Batch: 36/58	Loss: 0.756
Batch: 41/58	Loss: 0.643
Batch: 46/58	Loss: 0.691
Batch: 51/58	Loss: 0.734
Batch: 56/58	Loss: 0.691
Batch: 58/58	Loss: 0.732
Epoch: 3	Train Loss: 0.727	Val F1: 0.328
Best Epoch: 2	Best Val F1: 0.345

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.723
Batch: 6/58	Loss: 0.657
Batch: 11/58	Loss: 0.622
Batch: 16/58	Loss: 0.631
Batch: 21/58	Loss: 0.506
Batch: 26/58	Loss: 0.582
Batch: 31/58	Loss: 0.597
Batch: 36/58	Loss: 0.729
Batch: 41/58	Loss: 0.730
Batch: 46/58	Loss: 0.618
Batch: 51/58	Loss: 0.707
Batch: 56/58	Loss: 0.655
Batch: 58/58	Loss: 0.677
Epoch: 4	Train Loss: 0.666	Val F1: 0.331
Best Epoch: 2	Best Val F1: 0.345

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.597
Batch: 6/58	Loss: 0.597
Batch: 11/58	Loss: 0.581
Batch: 16/58	Loss: 0.557
Batch: 21/58	Loss: 0.478
Batch: 26/58	Loss: 0.462
Batch: 31/58	Loss: 0.739
Batch: 36/58	Loss: 0.682
Batch: 41/58	Loss: 0.684
Batch: 46/58	Loss: 0.779
Batch: 51/58	Loss: 0.884
Batch: 56/58	Loss: 0.707
Batch: 58/58	Loss: 0.781
Epoch: 5	Train Loss: 0.626	Val F1: 0.341
Best Epoch: 2	Best Val F1: 0.345

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.527
Batch: 6/58	Loss: 0.718
Batch: 11/58	Loss: 0.621
Batch: 16/58	Loss: 0.619
Batch: 21/58	Loss: 0.563
Batch: 26/58	Loss: 0.485
Batch: 31/58	Loss: 0.574
Batch: 36/58	Loss: 0.447
Batch: 41/58	Loss: 0.549
Batch: 46/58	Loss: 0.565
Batch: 51/58	Loss: 0.508
Batch: 56/58	Loss: 0.596
Batch: 58/58	Loss: 0.488
Epoch: 6	Train Loss: 0.574	Val F1: 0.345
Best Epoch: 2	Best Val F1: 0.345

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.400
Batch: 6/58	Loss: 0.585
Batch: 11/58	Loss: 0.675
Batch: 16/58	Loss: 0.450
Batch: 21/58	Loss: 0.495
Batch: 26/58	Loss: 0.469
Batch: 31/58	Loss: 0.511
Batch: 36/58	Loss: 0.520
Batch: 41/58	Loss: 0.468
Batch: 46/58	Loss: 0.456
Batch: 51/58	Loss: 0.486
Batch: 56/58	Loss: 0.679
Batch: 58/58	Loss: 0.422
Epoch: 7	Train Loss: 0.521	Val F1: 0.354
Best Epoch: 7	Best Val F1: 0.354

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.483
Batch: 6/58	Loss: 0.377
Batch: 11/58	Loss: 0.429
Batch: 16/58	Loss: 0.495
Batch: 21/58	Loss: 0.528
Batch: 26/58	Loss: 0.412
Batch: 31/58	Loss: 0.400
Batch: 36/58	Loss: 0.399
Batch: 41/58	Loss: 0.491
Batch: 46/58	Loss: 0.486
Batch: 51/58	Loss: 0.465
Batch: 56/58	Loss: 0.476
Batch: 58/58	Loss: 0.601
Epoch: 8	Train Loss: 0.479	Val F1: 0.359
Best Epoch: 8	Best Val F1: 0.359

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.545
Batch: 6/58	Loss: 0.573
Batch: 11/58	Loss: 0.515
Batch: 16/58	Loss: 0.339
Batch: 21/58	Loss: 0.358
Batch: 26/58	Loss: 0.321
Batch: 31/58	Loss: 0.340
Batch: 36/58	Loss: 0.416
Batch: 41/58	Loss: 0.501
Batch: 46/58	Loss: 0.424
Batch: 51/58	Loss: 0.542
Batch: 56/58	Loss: 0.357
Batch: 58/58	Loss: 0.368
Epoch: 9	Train Loss: 0.432	Val F1: 0.366
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.346
Batch: 6/58	Loss: 0.330
Batch: 11/58	Loss: 0.426
Batch: 16/58	Loss: 0.501
Batch: 21/58	Loss: 0.314
Batch: 26/58	Loss: 0.512
Batch: 31/58	Loss: 0.297
Batch: 36/58	Loss: 0.641
Batch: 41/58	Loss: 0.593
Batch: 46/58	Loss: 0.458
Batch: 51/58	Loss: 0.401
Batch: 56/58	Loss: 0.341
Batch: 58/58	Loss: 0.521
Epoch: 10	Train Loss: 0.411	Val F1: 0.358
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.473
Batch: 6/58	Loss: 0.341
Batch: 11/58	Loss: 0.276
Batch: 16/58	Loss: 0.396
Batch: 21/58	Loss: 0.342
Batch: 26/58	Loss: 0.460
Batch: 31/58	Loss: 0.402
Batch: 36/58	Loss: 0.403
Batch: 41/58	Loss: 0.277
Batch: 46/58	Loss: 0.328
Batch: 51/58	Loss: 0.392
Batch: 56/58	Loss: 0.348
Batch: 58/58	Loss: 0.405
Epoch: 11	Train Loss: 0.369	Val F1: 0.348
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.409
Batch: 6/58	Loss: 0.263
Batch: 11/58	Loss: 0.315
Batch: 16/58	Loss: 0.356
Batch: 21/58	Loss: 0.430
Batch: 26/58	Loss: 0.309
Batch: 31/58	Loss: 0.404
Batch: 36/58	Loss: 0.323
Batch: 41/58	Loss: 0.315
Batch: 46/58	Loss: 0.366
Batch: 51/58	Loss: 0.492
Batch: 56/58	Loss: 0.278
Batch: 58/58	Loss: 0.168
Epoch: 12	Train Loss: 0.343	Val F1: 0.350
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 13 ******************************
Batch: 1/58	Loss: 0.322
Batch: 6/58	Loss: 0.253
Batch: 11/58	Loss: 0.403
Batch: 16/58	Loss: 0.292
Batch: 21/58	Loss: 0.362
Batch: 26/58	Loss: 0.289
Batch: 31/58	Loss: 0.321
Batch: 36/58	Loss: 0.291
Batch: 41/58	Loss: 0.246
Batch: 46/58	Loss: 0.296
Batch: 51/58	Loss: 0.241
Batch: 56/58	Loss: 0.391
Batch: 58/58	Loss: 0.193
Epoch: 13	Train Loss: 0.322	Val F1: 0.332
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 14 ******************************
Batch: 1/58	Loss: 0.411
Batch: 6/58	Loss: 0.382
Batch: 11/58	Loss: 0.337
Batch: 16/58	Loss: 0.357
Batch: 21/58	Loss: 0.284
Batch: 26/58	Loss: 0.343
Batch: 31/58	Loss: 0.316
Batch: 36/58	Loss: 0.295
Batch: 41/58	Loss: 0.208
Batch: 46/58	Loss: 0.249
Batch: 51/58	Loss: 0.372
Batch: 56/58	Loss: 0.253
Batch: 58/58	Loss: 0.409
Epoch: 14	Train Loss: 0.321	Val F1: 0.345
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 15 ******************************
Batch: 1/58	Loss: 0.234
Batch: 6/58	Loss: 0.325
Batch: 11/58	Loss: 0.236
Batch: 16/58	Loss: 0.289
Batch: 21/58	Loss: 0.451
Batch: 26/58	Loss: 0.251
Batch: 31/58	Loss: 0.252
Batch: 36/58	Loss: 0.337
Batch: 41/58	Loss: 0.292
Batch: 46/58	Loss: 0.176
Batch: 51/58	Loss: 0.215
Batch: 56/58	Loss: 0.238
Batch: 58/58	Loss: 0.335
Epoch: 15	Train Loss: 0.282	Val F1: 0.357
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 16 ******************************
Batch: 1/58	Loss: 0.256
Batch: 6/58	Loss: 0.174
Batch: 11/58	Loss: 0.187
Batch: 16/58	Loss: 0.214
Batch: 21/58	Loss: 0.191
Batch: 26/58	Loss: 0.284
Batch: 31/58	Loss: 0.229
Batch: 36/58	Loss: 0.192
Batch: 41/58	Loss: 0.176
Batch: 46/58	Loss: 0.254
Batch: 51/58	Loss: 0.267
Batch: 56/58	Loss: 0.189
Batch: 58/58	Loss: 0.243
Epoch: 16	Train Loss: 0.263	Val F1: 0.349
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 17 ******************************
Batch: 1/58	Loss: 0.213
Batch: 6/58	Loss: 0.276
Batch: 11/58	Loss: 0.229
Batch: 16/58	Loss: 0.250
Batch: 21/58	Loss: 0.199
Batch: 26/58	Loss: 0.272
Batch: 31/58	Loss: 0.211
Batch: 36/58	Loss: 0.196
Batch: 41/58	Loss: 0.260
Batch: 46/58	Loss: 0.420
Batch: 51/58	Loss: 0.226
Batch: 56/58	Loss: 0.177
Batch: 58/58	Loss: 0.239
Epoch: 17	Train Loss: 0.242	Val F1: 0.335
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 18 ******************************
Batch: 1/58	Loss: 0.246
Batch: 6/58	Loss: 0.293
Batch: 11/58	Loss: 0.263
Batch: 16/58	Loss: 0.269
Batch: 21/58	Loss: 0.249
Batch: 26/58	Loss: 0.309
Batch: 31/58	Loss: 0.137
Batch: 36/58	Loss: 0.176
Batch: 41/58	Loss: 0.203
Batch: 46/58	Loss: 0.261
Batch: 51/58	Loss: 0.140
Batch: 56/58	Loss: 0.218
Batch: 58/58	Loss: 0.282
Epoch: 18	Train Loss: 0.224	Val F1: 0.356
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 19 ******************************
Batch: 1/58	Loss: 0.176
Batch: 6/58	Loss: 0.213
Batch: 11/58	Loss: 0.220
Batch: 16/58	Loss: 0.087
Batch: 21/58	Loss: 0.209
Batch: 26/58	Loss: 0.269
Batch: 31/58	Loss: 0.135
Batch: 36/58	Loss: 0.163
Batch: 41/58	Loss: 0.113
Batch: 46/58	Loss: 0.215
Batch: 51/58	Loss: 0.163
Batch: 56/58	Loss: 0.195
Batch: 58/58	Loss: 0.156
Epoch: 19	Train Loss: 0.198	Val F1: 0.329
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 20 ******************************
Batch: 1/58	Loss: 0.179
Batch: 6/58	Loss: 0.184
Batch: 11/58	Loss: 0.166
Batch: 16/58	Loss: 0.196
Batch: 21/58	Loss: 0.199
Batch: 26/58	Loss: 0.174
Batch: 31/58	Loss: 0.221
Batch: 36/58	Loss: 0.131
Batch: 41/58	Loss: 0.096
Batch: 46/58	Loss: 0.259
Batch: 51/58	Loss: 0.108
Batch: 56/58	Loss: 0.131
Batch: 58/58	Loss: 0.193
Epoch: 20	Train Loss: 0.188	Val F1: 0.351
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 21 ******************************
Batch: 1/58	Loss: 0.188
Batch: 6/58	Loss: 0.107
Batch: 11/58	Loss: 0.158
Batch: 16/58	Loss: 0.194
Batch: 21/58	Loss: 0.111
Batch: 26/58	Loss: 0.133
Batch: 31/58	Loss: 0.060
Batch: 36/58	Loss: 0.202
Batch: 41/58	Loss: 0.131
Batch: 46/58	Loss: 0.157
Batch: 51/58	Loss: 0.074
Batch: 56/58	Loss: 0.066
Batch: 58/58	Loss: 0.139
Epoch: 21	Train Loss: 0.141	Val F1: 0.346
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 22 ******************************
Batch: 1/58	Loss: 0.124
Batch: 6/58	Loss: 0.128
Batch: 11/58	Loss: 0.166
Batch: 16/58	Loss: 0.098
Batch: 21/58	Loss: 0.137
Batch: 26/58	Loss: 0.145
Batch: 31/58	Loss: 0.112
Batch: 36/58	Loss: 0.095
Batch: 41/58	Loss: 0.134
Batch: 46/58	Loss: 0.110
Batch: 51/58	Loss: 0.087
Batch: 56/58	Loss: 0.114
Batch: 58/58	Loss: 0.205
Epoch: 22	Train Loss: 0.123	Val F1: 0.318
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 23 ******************************
Batch: 1/58	Loss: 0.210
Batch: 6/58	Loss: 0.157
Batch: 11/58	Loss: 0.173
Batch: 16/58	Loss: 0.102
Batch: 21/58	Loss: 0.075
Batch: 26/58	Loss: 0.064
Batch: 31/58	Loss: 0.089
Batch: 36/58	Loss: 0.183
Batch: 41/58	Loss: 0.089
Batch: 46/58	Loss: 0.091
Batch: 51/58	Loss: 0.040
Batch: 56/58	Loss: 0.106
Batch: 58/58	Loss: 0.046
Epoch: 23	Train Loss: 0.105	Val F1: 0.356
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 24 ******************************
Batch: 1/58	Loss: 0.079
Batch: 6/58	Loss: 0.106
Batch: 11/58	Loss: 0.084
Batch: 16/58	Loss: 0.092
Batch: 21/58	Loss: 0.207
Batch: 26/58	Loss: 0.116
Batch: 31/58	Loss: 0.073
Batch: 36/58	Loss: 0.092
Batch: 41/58	Loss: 0.063
Batch: 46/58	Loss: 0.083
Batch: 51/58	Loss: 0.075
Batch: 56/58	Loss: 0.062
Batch: 58/58	Loss: 0.122
Epoch: 24	Train Loss: 0.085	Val F1: 0.362
Best Epoch: 9	Best Val F1: 0.366

Saving the best checkpoint....
Inference...
Test F1: 0.377	Test F1_Few: 0.448	Test F1_Zero: 0.374
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.000857322224441116, 'lr': 1.0920749529139769e-05, 'n_layers_freeze': 4, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.082
Batch: 5/29	Loss: 1.066
Batch: 7/29	Loss: 1.052
Batch: 9/29	Loss: 1.038
Batch: 11/29	Loss: 1.023
Batch: 13/29	Loss: 1.011
Batch: 15/29	Loss: 1.009
Batch: 17/29	Loss: 0.976
Batch: 19/29	Loss: 0.969
Batch: 21/29	Loss: 0.953
Batch: 23/29	Loss: 0.950
Batch: 25/29	Loss: 0.928
Batch: 27/29	Loss: 0.920
Batch: 29/29	Loss: 0.923
Epoch: 1	Train Loss: 0.999	Val F1: 0.191
Best Epoch: 1	Best Val F1: 0.191

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.914
Batch: 3/29	Loss: 0.912
Batch: 5/29	Loss: 0.930
Batch: 7/29	Loss: 0.899
Batch: 9/29	Loss: 0.908
Batch: 11/29	Loss: 0.874
Batch: 13/29	Loss: 0.871
Batch: 15/29	Loss: 0.890
Batch: 17/29	Loss: 0.878
Batch: 19/29	Loss: 0.899
Batch: 21/29	Loss: 0.865
Batch: 23/29	Loss: 0.869
Batch: 25/29	Loss: 0.852
Batch: 27/29	Loss: 0.896
Batch: 29/29	Loss: 0.853
Epoch: 2	Train Loss: 0.884	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.191

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.845
Batch: 3/29	Loss: 0.857
Batch: 5/29	Loss: 0.850
Batch: 7/29	Loss: 0.871
Batch: 9/29	Loss: 0.835
Batch: 11/29	Loss: 0.834
Batch: 13/29	Loss: 0.865
Batch: 15/29	Loss: 0.836
Batch: 17/29	Loss: 0.850
Batch: 19/29	Loss: 0.846
Batch: 21/29	Loss: 0.829
Batch: 23/29	Loss: 0.824
Batch: 25/29	Loss: 0.838
Batch: 27/29	Loss: 0.816
Batch: 29/29	Loss: 0.824
Epoch: 3	Train Loss: 0.842	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.191

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.811
Batch: 3/29	Loss: 0.825
Batch: 5/29	Loss: 0.803
Batch: 7/29	Loss: 0.845
Batch: 9/29	Loss: 0.831
Batch: 11/29	Loss: 0.796
Batch: 13/29	Loss: 0.805
Batch: 15/29	Loss: 0.792
Batch: 17/29	Loss: 0.803
Batch: 19/29	Loss: 0.820
Batch: 21/29	Loss: 0.829
Batch: 23/29	Loss: 0.829
Batch: 25/29	Loss: 0.815
Batch: 27/29	Loss: 0.829
Batch: 29/29	Loss: 0.815
Epoch: 4	Train Loss: 0.816	Val F1: 0.265
Best Epoch: 4	Best Val F1: 0.265

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.798
Batch: 3/29	Loss: 0.791
Batch: 5/29	Loss: 0.781
Batch: 7/29	Loss: 0.776
Batch: 9/29	Loss: 0.773
Batch: 11/29	Loss: 0.774
Batch: 13/29	Loss: 0.770
Batch: 15/29	Loss: 0.794
Batch: 17/29	Loss: 0.833
Batch: 19/29	Loss: 0.775
Batch: 21/29	Loss: 0.756
Batch: 23/29	Loss: 0.778
Batch: 25/29	Loss: 0.781
Batch: 27/29	Loss: 0.749
Batch: 29/29	Loss: 0.773
Epoch: 5	Train Loss: 0.786	Val F1: 0.305
Best Epoch: 5	Best Val F1: 0.305

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.783
Batch: 3/29	Loss: 0.805
Batch: 5/29	Loss: 0.728
Batch: 7/29	Loss: 0.802
Batch: 9/29	Loss: 0.751
Batch: 11/29	Loss: 0.760
Batch: 13/29	Loss: 0.745
Batch: 15/29	Loss: 0.705
Batch: 17/29	Loss: 0.726
Batch: 19/29	Loss: 0.698
Batch: 21/29	Loss: 0.782
Batch: 23/29	Loss: 0.713
Batch: 25/29	Loss: 0.734
Batch: 27/29	Loss: 0.738
Batch: 29/29	Loss: 0.715
Epoch: 6	Train Loss: 0.746	Val F1: 0.312
Best Epoch: 6	Best Val F1: 0.312

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.718
Batch: 3/29	Loss: 0.769
Batch: 5/29	Loss: 0.780
Batch: 7/29	Loss: 0.708
Batch: 9/29	Loss: 0.738
Batch: 11/29	Loss: 0.686
Batch: 13/29	Loss: 0.706
Batch: 15/29	Loss: 0.667
Batch: 17/29	Loss: 0.725
Batch: 19/29	Loss: 0.739
Batch: 21/29	Loss: 0.673
Batch: 23/29	Loss: 0.655
Batch: 25/29	Loss: 0.642
Batch: 27/29	Loss: 0.682
Batch: 29/29	Loss: 0.684
Epoch: 7	Train Loss: 0.705	Val F1: 0.343
Best Epoch: 7	Best Val F1: 0.343

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.670
Batch: 3/29	Loss: 0.644
Batch: 5/29	Loss: 0.687
Batch: 7/29	Loss: 0.659
Batch: 9/29	Loss: 0.661
Batch: 11/29	Loss: 0.683
Batch: 13/29	Loss: 0.695
Batch: 15/29	Loss: 0.632
Batch: 17/29	Loss: 0.687
Batch: 19/29	Loss: 0.683
Batch: 21/29	Loss: 0.684
Batch: 23/29	Loss: 0.704
Batch: 25/29	Loss: 0.742
Batch: 27/29	Loss: 0.685
Batch: 29/29	Loss: 0.656
Epoch: 8	Train Loss: 0.670	Val F1: 0.340
Best Epoch: 7	Best Val F1: 0.343

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.683
Batch: 3/29	Loss: 0.625
Batch: 5/29	Loss: 0.636
Batch: 7/29	Loss: 0.605
Batch: 9/29	Loss: 0.687
Batch: 11/29	Loss: 0.647
Batch: 13/29	Loss: 0.668
Batch: 15/29	Loss: 0.700
Batch: 17/29	Loss: 0.597
Batch: 19/29	Loss: 0.611
Batch: 21/29	Loss: 0.718
Batch: 23/29	Loss: 0.596
Batch: 25/29	Loss: 0.624
Batch: 27/29	Loss: 0.634
Batch: 29/29	Loss: 0.569
Epoch: 9	Train Loss: 0.637	Val F1: 0.347
Best Epoch: 9	Best Val F1: 0.347

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.545
Batch: 3/29	Loss: 0.622
Batch: 5/29	Loss: 0.610
Batch: 7/29	Loss: 0.588
Batch: 9/29	Loss: 0.553
Batch: 11/29	Loss: 0.521
Batch: 13/29	Loss: 0.674
Batch: 15/29	Loss: 0.677
Batch: 17/29	Loss: 0.688
Batch: 19/29	Loss: 0.454
Batch: 21/29	Loss: 0.640
Batch: 23/29	Loss: 0.603
Batch: 25/29	Loss: 0.605
Batch: 27/29	Loss: 0.576
Batch: 29/29	Loss: 0.664
Epoch: 10	Train Loss: 0.598	Val F1: 0.353
Best Epoch: 10	Best Val F1: 0.353

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.596
Batch: 3/29	Loss: 0.502
Batch: 5/29	Loss: 0.673
Batch: 7/29	Loss: 0.605
Batch: 9/29	Loss: 0.575
Batch: 11/29	Loss: 0.597
Batch: 13/29	Loss: 0.507
Batch: 15/29	Loss: 0.460
Batch: 17/29	Loss: 0.607
Batch: 19/29	Loss: 0.583
Batch: 21/29	Loss: 0.505
Batch: 23/29	Loss: 0.492
Batch: 25/29	Loss: 0.505
Batch: 27/29	Loss: 0.563
Batch: 29/29	Loss: 0.524
Epoch: 11	Train Loss: 0.569	Val F1: 0.326
Best Epoch: 10	Best Val F1: 0.353

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.732
Batch: 3/29	Loss: 0.471
Batch: 5/29	Loss: 0.638
Batch: 7/29	Loss: 0.516
Batch: 9/29	Loss: 0.585
Batch: 11/29	Loss: 0.532
Batch: 13/29	Loss: 0.537
Batch: 15/29	Loss: 0.525
Batch: 17/29	Loss: 0.566
Batch: 19/29	Loss: 0.535
Batch: 21/29	Loss: 0.566
Batch: 23/29	Loss: 0.550
Batch: 25/29	Loss: 0.528
Batch: 27/29	Loss: 0.579
Batch: 29/29	Loss: 0.475
Epoch: 12	Train Loss: 0.550	Val F1: 0.336
Best Epoch: 10	Best Val F1: 0.353

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.558
Batch: 3/29	Loss: 0.420
Batch: 5/29	Loss: 0.536
Batch: 7/29	Loss: 0.455
Batch: 9/29	Loss: 0.520
Batch: 11/29	Loss: 0.521
Batch: 13/29	Loss: 0.575
Batch: 15/29	Loss: 0.516
Batch: 17/29	Loss: 0.456
Batch: 19/29	Loss: 0.392
Batch: 21/29	Loss: 0.483
Batch: 23/29	Loss: 0.584
Batch: 25/29	Loss: 0.360
Batch: 27/29	Loss: 0.520
Batch: 29/29	Loss: 0.627
Epoch: 13	Train Loss: 0.517	Val F1: 0.331
Best Epoch: 10	Best Val F1: 0.353

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.524
Batch: 3/29	Loss: 0.509
Batch: 5/29	Loss: 0.382
Batch: 7/29	Loss: 0.499
Batch: 9/29	Loss: 0.489
Batch: 11/29	Loss: 0.508
Batch: 13/29	Loss: 0.473
Batch: 15/29	Loss: 0.409
Batch: 17/29	Loss: 0.585
Batch: 19/29	Loss: 0.558
Batch: 21/29	Loss: 0.371
Batch: 23/29	Loss: 0.403
Batch: 25/29	Loss: 0.489
Batch: 27/29	Loss: 0.527
Batch: 29/29	Loss: 0.464
Epoch: 14	Train Loss: 0.492	Val F1: 0.324
Best Epoch: 10	Best Val F1: 0.353

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.496
Batch: 3/29	Loss: 0.445
Batch: 5/29	Loss: 0.537
Batch: 7/29	Loss: 0.411
Batch: 9/29	Loss: 0.556
Batch: 11/29	Loss: 0.457
Batch: 13/29	Loss: 0.473
Batch: 15/29	Loss: 0.555
Batch: 17/29	Loss: 0.481
Batch: 19/29	Loss: 0.434
Batch: 21/29	Loss: 0.429
Batch: 23/29	Loss: 0.525
Batch: 25/29	Loss: 0.461
Batch: 27/29	Loss: 0.434
Batch: 29/29	Loss: 0.569
Epoch: 15	Train Loss: 0.479	Val F1: 0.338
Best Epoch: 10	Best Val F1: 0.353

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.473
Batch: 3/29	Loss: 0.456
Batch: 5/29	Loss: 0.484
Batch: 7/29	Loss: 0.386
Batch: 9/29	Loss: 0.472
Batch: 11/29	Loss: 0.430
Batch: 13/29	Loss: 0.371
Batch: 15/29	Loss: 0.426
Batch: 17/29	Loss: 0.434
Batch: 19/29	Loss: 0.565
Batch: 21/29	Loss: 0.361
Batch: 23/29	Loss: 0.450
Batch: 25/29	Loss: 0.447
Batch: 27/29	Loss: 0.441
Batch: 29/29	Loss: 0.455
Epoch: 16	Train Loss: 0.449	Val F1: 0.352
Best Epoch: 10	Best Val F1: 0.353

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.409
Batch: 3/29	Loss: 0.502
Batch: 5/29	Loss: 0.505
Batch: 7/29	Loss: 0.416
Batch: 9/29	Loss: 0.391
Batch: 11/29	Loss: 0.456
Batch: 13/29	Loss: 0.483
Batch: 15/29	Loss: 0.446
Batch: 17/29	Loss: 0.436
Batch: 19/29	Loss: 0.398
Batch: 21/29	Loss: 0.429
Batch: 23/29	Loss: 0.511
Batch: 25/29	Loss: 0.276
Batch: 27/29	Loss: 0.406
Batch: 29/29	Loss: 0.432
Epoch: 17	Train Loss: 0.431	Val F1: 0.341
Best Epoch: 10	Best Val F1: 0.353

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.489
Batch: 3/29	Loss: 0.448
Batch: 5/29	Loss: 0.426
Batch: 7/29	Loss: 0.397
Batch: 9/29	Loss: 0.507
Batch: 11/29	Loss: 0.373
Batch: 13/29	Loss: 0.360
Batch: 15/29	Loss: 0.474
Batch: 17/29	Loss: 0.474
Batch: 19/29	Loss: 0.377
Batch: 21/29	Loss: 0.412
Batch: 23/29	Loss: 0.440
Batch: 25/29	Loss: 0.453
Batch: 27/29	Loss: 0.358
Batch: 29/29	Loss: 0.477
Epoch: 18	Train Loss: 0.425	Val F1: 0.347
Best Epoch: 10	Best Val F1: 0.353

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.275
Batch: 3/29	Loss: 0.306
Batch: 5/29	Loss: 0.423
Batch: 7/29	Loss: 0.453
Batch: 9/29	Loss: 0.312
Batch: 11/29	Loss: 0.482
Batch: 13/29	Loss: 0.475
Batch: 15/29	Loss: 0.421
Batch: 17/29	Loss: 0.384
Batch: 19/29	Loss: 0.444
Batch: 21/29	Loss: 0.422
Batch: 23/29	Loss: 0.398
Batch: 25/29	Loss: 0.483
Batch: 27/29	Loss: 0.340
Batch: 29/29	Loss: 0.362
Epoch: 19	Train Loss: 0.405	Val F1: 0.343
Best Epoch: 10	Best Val F1: 0.353

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.462
Batch: 3/29	Loss: 0.426
Batch: 5/29	Loss: 0.344
Batch: 7/29	Loss: 0.330
Batch: 9/29	Loss: 0.459
Batch: 11/29	Loss: 0.383
Batch: 13/29	Loss: 0.411
Batch: 15/29	Loss: 0.403
Batch: 17/29	Loss: 0.495
Batch: 19/29	Loss: 0.349
Batch: 21/29	Loss: 0.387
Batch: 23/29	Loss: 0.407
Batch: 25/29	Loss: 0.327
Batch: 27/29	Loss: 0.418
Batch: 29/29	Loss: 0.437
Epoch: 20	Train Loss: 0.392	Val F1: 0.340
Best Epoch: 10	Best Val F1: 0.353

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.346
Batch: 3/29	Loss: 0.328
Batch: 5/29	Loss: 0.340
Batch: 7/29	Loss: 0.581
Batch: 9/29	Loss: 0.313
Batch: 11/29	Loss: 0.308
Batch: 13/29	Loss: 0.426
Batch: 15/29	Loss: 0.486
Batch: 17/29	Loss: 0.328
Batch: 19/29	Loss: 0.353
Batch: 21/29	Loss: 0.354
Batch: 23/29	Loss: 0.312
Batch: 25/29	Loss: 0.356
Batch: 27/29	Loss: 0.365
Batch: 29/29	Loss: 0.449
Epoch: 21	Train Loss: 0.375	Val F1: 0.330
Best Epoch: 10	Best Val F1: 0.353

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.385
Batch: 3/29	Loss: 0.330
Batch: 5/29	Loss: 0.427
Batch: 7/29	Loss: 0.408
Batch: 9/29	Loss: 0.343
Batch: 11/29	Loss: 0.341
Batch: 13/29	Loss: 0.300
Batch: 15/29	Loss: 0.440
Batch: 17/29	Loss: 0.414
Batch: 19/29	Loss: 0.399
Batch: 21/29	Loss: 0.483
Batch: 23/29	Loss: 0.377
Batch: 25/29	Loss: 0.376
Batch: 27/29	Loss: 0.312
Batch: 29/29	Loss: 0.324
Epoch: 22	Train Loss: 0.373	Val F1: 0.349
Best Epoch: 10	Best Val F1: 0.353

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.332
Batch: 3/29	Loss: 0.419
Batch: 5/29	Loss: 0.402
Batch: 7/29	Loss: 0.477
Batch: 9/29	Loss: 0.342
Batch: 11/29	Loss: 0.431
Batch: 13/29	Loss: 0.313
Batch: 15/29	Loss: 0.356
Batch: 17/29	Loss: 0.380
Batch: 19/29	Loss: 0.370
Batch: 21/29	Loss: 0.346
Batch: 23/29	Loss: 0.316
Batch: 25/29	Loss: 0.377
Batch: 27/29	Loss: 0.305
Batch: 29/29	Loss: 0.295
Epoch: 23	Train Loss: 0.364	Val F1: 0.350
Best Epoch: 10	Best Val F1: 0.353

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.310
Batch: 3/29	Loss: 0.336
Batch: 5/29	Loss: 0.375
Batch: 7/29	Loss: 0.412
Batch: 9/29	Loss: 0.386
Batch: 11/29	Loss: 0.510
Batch: 13/29	Loss: 0.333
Batch: 15/29	Loss: 0.353
Batch: 17/29	Loss: 0.333
Batch: 19/29	Loss: 0.399
Batch: 21/29	Loss: 0.369
Batch: 23/29	Loss: 0.323
Batch: 25/29	Loss: 0.360
Batch: 27/29	Loss: 0.334
Batch: 29/29	Loss: 0.338
Epoch: 24	Train Loss: 0.353	Val F1: 0.340
Best Epoch: 10	Best Val F1: 0.353

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.413
Batch: 3/29	Loss: 0.410
Batch: 5/29	Loss: 0.374
Batch: 7/29	Loss: 0.376
Batch: 9/29	Loss: 0.468
Batch: 11/29	Loss: 0.354
Batch: 13/29	Loss: 0.370
Batch: 15/29	Loss: 0.367
Batch: 17/29	Loss: 0.350
Batch: 19/29	Loss: 0.278
Batch: 21/29	Loss: 0.375
Batch: 23/29	Loss: 0.351
Batch: 25/29	Loss: 0.332
Batch: 27/29	Loss: 0.346
Batch: 29/29	Loss: 0.339
Epoch: 25	Train Loss: 0.349	Val F1: 0.343
Best Epoch: 10	Best Val F1: 0.353

Saving the best checkpoint....
Inference...
Test F1: 0.376	Test F1_Few: 0.434	Test F1_Zero: 0.384
Starting training with config: {'batch_size': 64, 'epochs': 75, 'l2_reg': 0.0009940151360703438, 'lr': 8.754131905258999e-05, 'n_layers_freeze': 9, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.020
Batch: 5/29	Loss: 0.945
Batch: 7/29	Loss: 0.905
Batch: 9/29	Loss: 0.872
Batch: 11/29	Loss: 0.869
Batch: 13/29	Loss: 0.852
Batch: 15/29	Loss: 0.885
Batch: 17/29	Loss: 0.806
Batch: 19/29	Loss: 0.829
Batch: 21/29	Loss: 0.774
Batch: 23/29	Loss: 0.819
Batch: 25/29	Loss: 0.747
Batch: 27/29	Loss: 0.755
Batch: 29/29	Loss: 0.784
Epoch: 1	Train Loss: 0.860	Val F1: 0.195
Best Epoch: 1	Best Val F1: 0.195

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.765
Batch: 3/29	Loss: 0.772
Batch: 5/29	Loss: 0.847
Batch: 7/29	Loss: 0.756
Batch: 9/29	Loss: 0.801
Batch: 11/29	Loss: 0.716
Batch: 13/29	Loss: 0.727
Batch: 15/29	Loss: 0.751
Batch: 17/29	Loss: 0.739
Batch: 19/29	Loss: 0.827
Batch: 21/29	Loss: 0.715
Batch: 23/29	Loss: 0.715
Batch: 25/29	Loss: 0.719
Batch: 27/29	Loss: 0.818
Batch: 29/29	Loss: 0.693
Epoch: 2	Train Loss: 0.751	Val F1: 0.309
Best Epoch: 2	Best Val F1: 0.309

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.655
Batch: 3/29	Loss: 0.707
Batch: 5/29	Loss: 0.685
Batch: 7/29	Loss: 0.791
Batch: 9/29	Loss: 0.671
Batch: 11/29	Loss: 0.702
Batch: 13/29	Loss: 0.824
Batch: 15/29	Loss: 0.691
Batch: 17/29	Loss: 0.728
Batch: 19/29	Loss: 0.694
Batch: 21/29	Loss: 0.645
Batch: 23/29	Loss: 0.632
Batch: 25/29	Loss: 0.731
Batch: 27/29	Loss: 0.679
Batch: 29/29	Loss: 0.674
Epoch: 3	Train Loss: 0.700	Val F1: 0.309
Best Epoch: 3	Best Val F1: 0.309

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.649
Batch: 3/29	Loss: 0.646
Batch: 5/29	Loss: 0.729
Batch: 7/29	Loss: 0.715
Batch: 9/29	Loss: 0.670
Batch: 11/29	Loss: 0.573
Batch: 13/29	Loss: 0.572
Batch: 15/29	Loss: 0.639
Batch: 17/29	Loss: 0.612
Batch: 19/29	Loss: 0.696
Batch: 21/29	Loss: 0.673
Batch: 23/29	Loss: 0.626
Batch: 25/29	Loss: 0.553
Batch: 27/29	Loss: 0.625
Batch: 29/29	Loss: 0.631
Epoch: 4	Train Loss: 0.650	Val F1: 0.318
Best Epoch: 4	Best Val F1: 0.318

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.538
Batch: 3/29	Loss: 0.566
Batch: 5/29	Loss: 0.574
Batch: 7/29	Loss: 0.607
Batch: 9/29	Loss: 0.539
Batch: 11/29	Loss: 0.562
Batch: 13/29	Loss: 0.572
Batch: 15/29	Loss: 0.633
Batch: 17/29	Loss: 0.643
Batch: 19/29	Loss: 0.595
Batch: 21/29	Loss: 0.602
Batch: 23/29	Loss: 0.570
Batch: 25/29	Loss: 0.578
Batch: 27/29	Loss: 0.535
Batch: 29/29	Loss: 0.625
Epoch: 5	Train Loss: 0.591	Val F1: 0.309
Best Epoch: 4	Best Val F1: 0.318

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.589
Batch: 3/29	Loss: 0.590
Batch: 5/29	Loss: 0.492
Batch: 7/29	Loss: 0.620
Batch: 9/29	Loss: 0.498
Batch: 11/29	Loss: 0.514
Batch: 13/29	Loss: 0.459
Batch: 15/29	Loss: 0.551
Batch: 17/29	Loss: 0.505
Batch: 19/29	Loss: 0.498
Batch: 21/29	Loss: 0.625
Batch: 23/29	Loss: 0.543
Batch: 25/29	Loss: 0.637
Batch: 27/29	Loss: 0.629
Batch: 29/29	Loss: 0.464
Epoch: 6	Train Loss: 0.541	Val F1: 0.320
Best Epoch: 6	Best Val F1: 0.320

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.431
Batch: 3/29	Loss: 0.524
Batch: 5/29	Loss: 0.564
Batch: 7/29	Loss: 0.590
Batch: 9/29	Loss: 0.500
Batch: 11/29	Loss: 0.435
Batch: 13/29	Loss: 0.490
Batch: 15/29	Loss: 0.461
Batch: 17/29	Loss: 0.580
Batch: 19/29	Loss: 0.550
Batch: 21/29	Loss: 0.488
Batch: 23/29	Loss: 0.427
Batch: 25/29	Loss: 0.401
Batch: 27/29	Loss: 0.461
Batch: 29/29	Loss: 0.451
Epoch: 7	Train Loss: 0.479	Val F1: 0.319
Best Epoch: 6	Best Val F1: 0.320

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.413
Batch: 3/29	Loss: 0.414
Batch: 5/29	Loss: 0.445
Batch: 7/29	Loss: 0.424
Batch: 9/29	Loss: 0.447
Batch: 11/29	Loss: 0.447
Batch: 13/29	Loss: 0.415
Batch: 15/29	Loss: 0.407
Batch: 17/29	Loss: 0.433
Batch: 19/29	Loss: 0.412
Batch: 21/29	Loss: 0.423
Batch: 23/29	Loss: 0.430
Batch: 25/29	Loss: 0.461
Batch: 27/29	Loss: 0.412
Batch: 29/29	Loss: 0.504
Epoch: 8	Train Loss: 0.430	Val F1: 0.294
Best Epoch: 6	Best Val F1: 0.320

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.454
Batch: 3/29	Loss: 0.462
Batch: 5/29	Loss: 0.464
Batch: 7/29	Loss: 0.345
Batch: 9/29	Loss: 0.448
Batch: 11/29	Loss: 0.380
Batch: 13/29	Loss: 0.292
Batch: 15/29	Loss: 0.382
Batch: 17/29	Loss: 0.435
Batch: 19/29	Loss: 0.281
Batch: 21/29	Loss: 0.494
Batch: 23/29	Loss: 0.379
Batch: 25/29	Loss: 0.387
Batch: 27/29	Loss: 0.379
Batch: 29/29	Loss: 0.242
Epoch: 9	Train Loss: 0.393	Val F1: 0.315
Best Epoch: 6	Best Val F1: 0.320

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.353
Batch: 3/29	Loss: 0.340
Batch: 5/29	Loss: 0.324
Batch: 7/29	Loss: 0.306
Batch: 9/29	Loss: 0.294
Batch: 11/29	Loss: 0.319
Batch: 13/29	Loss: 0.371
Batch: 15/29	Loss: 0.381
Batch: 17/29	Loss: 0.361
Batch: 19/29	Loss: 0.266
Batch: 21/29	Loss: 0.395
Batch: 23/29	Loss: 0.443
Batch: 25/29	Loss: 0.457
Batch: 27/29	Loss: 0.360
Batch: 29/29	Loss: 0.424
Epoch: 10	Train Loss: 0.354	Val F1: 0.307
Best Epoch: 6	Best Val F1: 0.320

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.333
Batch: 3/29	Loss: 0.270
Batch: 5/29	Loss: 0.460
Batch: 7/29	Loss: 0.368
Batch: 9/29	Loss: 0.337
Batch: 11/29	Loss: 0.291
Batch: 13/29	Loss: 0.310
Batch: 15/29	Loss: 0.247
Batch: 17/29	Loss: 0.313
Batch: 19/29	Loss: 0.382
Batch: 21/29	Loss: 0.223
Batch: 23/29	Loss: 0.306
Batch: 25/29	Loss: 0.250
Batch: 27/29	Loss: 0.280
Batch: 29/29	Loss: 0.331
Epoch: 11	Train Loss: 0.312	Val F1: 0.313
Best Epoch: 6	Best Val F1: 0.320

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.292
Batch: 3/29	Loss: 0.235
Batch: 5/29	Loss: 0.222
Batch: 7/29	Loss: 0.261
Batch: 9/29	Loss: 0.304
Batch: 11/29	Loss: 0.237
Batch: 13/29	Loss: 0.285
Batch: 15/29	Loss: 0.238
Batch: 17/29	Loss: 0.276
Batch: 19/29	Loss: 0.208
Batch: 21/29	Loss: 0.328
Batch: 23/29	Loss: 0.276
Batch: 25/29	Loss: 0.248
Batch: 27/29	Loss: 0.320
Batch: 29/29	Loss: 0.198
Epoch: 12	Train Loss: 0.265	Val F1: 0.331
Best Epoch: 12	Best Val F1: 0.331

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.225
Batch: 3/29	Loss: 0.195
Batch: 5/29	Loss: 0.271
Batch: 7/29	Loss: 0.205
Batch: 9/29	Loss: 0.207
Batch: 11/29	Loss: 0.216
Batch: 13/29	Loss: 0.244
Batch: 15/29	Loss: 0.231
Batch: 17/29	Loss: 0.242
Batch: 19/29	Loss: 0.133
Batch: 21/29	Loss: 0.240
Batch: 23/29	Loss: 0.241
Batch: 25/29	Loss: 0.220
Batch: 27/29	Loss: 0.235
Batch: 29/29	Loss: 0.261
Epoch: 13	Train Loss: 0.237	Val F1: 0.320
Best Epoch: 12	Best Val F1: 0.331

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.263
Batch: 3/29	Loss: 0.201
Batch: 5/29	Loss: 0.208
Batch: 7/29	Loss: 0.220
Batch: 9/29	Loss: 0.191
Batch: 11/29	Loss: 0.233
Batch: 13/29	Loss: 0.174
Batch: 15/29	Loss: 0.178
Batch: 17/29	Loss: 0.234
Batch: 19/29	Loss: 0.257
Batch: 21/29	Loss: 0.139
Batch: 23/29	Loss: 0.149
Batch: 25/29	Loss: 0.270
Batch: 27/29	Loss: 0.209
Batch: 29/29	Loss: 0.137
Epoch: 14	Train Loss: 0.206	Val F1: 0.331
Best Epoch: 14	Best Val F1: 0.331

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.159
Batch: 3/29	Loss: 0.212
Batch: 5/29	Loss: 0.112
Batch: 7/29	Loss: 0.165
Batch: 9/29	Loss: 0.185
Batch: 11/29	Loss: 0.139
Batch: 13/29	Loss: 0.138
Batch: 15/29	Loss: 0.147
Batch: 17/29	Loss: 0.231
Batch: 19/29	Loss: 0.154
Batch: 21/29	Loss: 0.130
Batch: 23/29	Loss: 0.128
Batch: 25/29	Loss: 0.167
Batch: 27/29	Loss: 0.212
Batch: 29/29	Loss: 0.134
Epoch: 15	Train Loss: 0.164	Val F1: 0.319
Best Epoch: 14	Best Val F1: 0.331

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.210
Batch: 3/29	Loss: 0.123
Batch: 5/29	Loss: 0.161
Batch: 7/29	Loss: 0.133
Batch: 9/29	Loss: 0.184
Batch: 11/29	Loss: 0.152
Batch: 13/29	Loss: 0.106
Batch: 15/29	Loss: 0.133
Batch: 17/29	Loss: 0.110
Batch: 19/29	Loss: 0.151
Batch: 21/29	Loss: 0.085
Batch: 23/29	Loss: 0.168
Batch: 25/29	Loss: 0.103
Batch: 27/29	Loss: 0.152
Batch: 29/29	Loss: 0.182
Epoch: 16	Train Loss: 0.133	Val F1: 0.322
Best Epoch: 14	Best Val F1: 0.331

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.101
Batch: 3/29	Loss: 0.129
Batch: 5/29	Loss: 0.130
Batch: 7/29	Loss: 0.156
Batch: 9/29	Loss: 0.063
Batch: 11/29	Loss: 0.119
Batch: 13/29	Loss: 0.186
Batch: 15/29	Loss: 0.089
Batch: 17/29	Loss: 0.132
Batch: 19/29	Loss: 0.108
Batch: 21/29	Loss: 0.094
Batch: 23/29	Loss: 0.155
Batch: 25/29	Loss: 0.057
Batch: 27/29	Loss: 0.119
Batch: 29/29	Loss: 0.087
Epoch: 17	Train Loss: 0.112	Val F1: 0.324
Best Epoch: 14	Best Val F1: 0.331

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.125
Batch: 3/29	Loss: 0.154
Batch: 5/29	Loss: 0.087
Batch: 7/29	Loss: 0.101
Batch: 9/29	Loss: 0.077
Batch: 11/29	Loss: 0.134
Batch: 13/29	Loss: 0.080
Batch: 15/29	Loss: 0.068
Batch: 17/29	Loss: 0.104
Batch: 19/29	Loss: 0.046
Batch: 21/29	Loss: 0.109
Batch: 23/29	Loss: 0.102
Batch: 25/29	Loss: 0.113
Batch: 27/29	Loss: 0.070
Batch: 29/29	Loss: 0.103
Epoch: 18	Train Loss: 0.097	Val F1: 0.320
Best Epoch: 14	Best Val F1: 0.331

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.083
Batch: 3/29	Loss: 0.049
Batch: 5/29	Loss: 0.073
Batch: 7/29	Loss: 0.116
Batch: 9/29	Loss: 0.039
Batch: 11/29	Loss: 0.071
Batch: 13/29	Loss: 0.078
Batch: 15/29	Loss: 0.076
Batch: 17/29	Loss: 0.079
Batch: 19/29	Loss: 0.052
Batch: 21/29	Loss: 0.066
Batch: 23/29	Loss: 0.074
Batch: 25/29	Loss: 0.061
Batch: 27/29	Loss: 0.037
Batch: 29/29	Loss: 0.048
Epoch: 19	Train Loss: 0.073	Val F1: 0.336
Best Epoch: 19	Best Val F1: 0.336

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.080
Batch: 3/29	Loss: 0.057
Batch: 5/29	Loss: 0.048
Batch: 7/29	Loss: 0.030
Batch: 9/29	Loss: 0.073
Batch: 11/29	Loss: 0.060
Batch: 13/29	Loss: 0.052
Batch: 15/29	Loss: 0.036
Batch: 17/29	Loss: 0.095
Batch: 19/29	Loss: 0.050
Batch: 21/29	Loss: 0.045
Batch: 23/29	Loss: 0.080
Batch: 25/29	Loss: 0.051
Batch: 27/29	Loss: 0.066
Batch: 29/29	Loss: 0.075
Epoch: 20	Train Loss: 0.059	Val F1: 0.333
Best Epoch: 19	Best Val F1: 0.336

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.064
Batch: 3/29	Loss: 0.063
Batch: 5/29	Loss: 0.039
Batch: 7/29	Loss: 0.068
Batch: 9/29	Loss: 0.069
Batch: 11/29	Loss: 0.053
Batch: 13/29	Loss: 0.069
Batch: 15/29	Loss: 0.063
Batch: 17/29	Loss: 0.020
Batch: 19/29	Loss: 0.089
Batch: 21/29	Loss: 0.025
Batch: 23/29	Loss: 0.130
Batch: 25/29	Loss: 0.073
Batch: 27/29	Loss: 0.103
Batch: 29/29	Loss: 0.049
Epoch: 21	Train Loss: 0.057	Val F1: 0.336
Best Epoch: 21	Best Val F1: 0.336

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.039
Batch: 3/29	Loss: 0.035
Batch: 5/29	Loss: 0.044
Batch: 7/29	Loss: 0.033
Batch: 9/29	Loss: 0.046
Batch: 11/29	Loss: 0.045
Batch: 13/29	Loss: 0.038
Batch: 15/29	Loss: 0.035
Batch: 17/29	Loss: 0.070
Batch: 19/29	Loss: 0.044
Batch: 21/29	Loss: 0.039
Batch: 23/29	Loss: 0.039
Batch: 25/29	Loss: 0.050
Batch: 27/29	Loss: 0.038
Batch: 29/29	Loss: 0.033
Epoch: 22	Train Loss: 0.040	Val F1: 0.330
Best Epoch: 21	Best Val F1: 0.336

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.044
Batch: 3/29	Loss: 0.042
Batch: 5/29	Loss: 0.071
Batch: 7/29	Loss: 0.037
Batch: 9/29	Loss: 0.058
Batch: 11/29	Loss: 0.025
Batch: 13/29	Loss: 0.047
Batch: 15/29	Loss: 0.037
Batch: 17/29	Loss: 0.031
Batch: 19/29	Loss: 0.069
Batch: 21/29	Loss: 0.039
Batch: 23/29	Loss: 0.034
Batch: 25/29	Loss: 0.045
Batch: 27/29	Loss: 0.036
Batch: 29/29	Loss: 0.031
Epoch: 23	Train Loss: 0.038	Val F1: 0.326
Best Epoch: 21	Best Val F1: 0.336

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.026
Batch: 3/29	Loss: 0.024
Batch: 5/29	Loss: 0.030
Batch: 7/29	Loss: 0.033
Batch: 9/29	Loss: 0.034
Batch: 11/29	Loss: 0.055
Batch: 13/29	Loss: 0.028
Batch: 15/29	Loss: 0.036
Batch: 17/29	Loss: 0.062
Batch: 19/29	Loss: 0.041
Batch: 21/29	Loss: 0.051
Batch: 23/29	Loss: 0.027
Batch: 25/29	Loss: 0.044
Batch: 27/29	Loss: 0.053
Batch: 29/29	Loss: 0.024
Epoch: 24	Train Loss: 0.036	Val F1: 0.323
Best Epoch: 21	Best Val F1: 0.336

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.047
Batch: 3/29	Loss: 0.030
Batch: 5/29	Loss: 0.052
Batch: 7/29	Loss: 0.019
Batch: 9/29	Loss: 0.036
Batch: 11/29	Loss: 0.017
Batch: 13/29	Loss: 0.022
Batch: 15/29	Loss: 0.018
Batch: 17/29	Loss: 0.055
Batch: 19/29	Loss: 0.040
Batch: 21/29	Loss: 0.020
Batch: 23/29	Loss: 0.027
Batch: 25/29	Loss: 0.053
Batch: 27/29	Loss: 0.079
Batch: 29/29	Loss: 0.076
Epoch: 25	Train Loss: 0.036	Val F1: 0.328
Best Epoch: 21	Best Val F1: 0.336

****************************** Epoch: 26 ******************************
Batch: 1/29	Loss: 0.017
Batch: 3/29	Loss: 0.022
Batch: 5/29	Loss: 0.036
Batch: 7/29	Loss: 0.066
Batch: 9/29	Loss: 0.024
Batch: 11/29	Loss: 0.088
Batch: 13/29	Loss: 0.046
Batch: 15/29	Loss: 0.075
Batch: 17/29	Loss: 0.025
Batch: 19/29	Loss: 0.040
Batch: 21/29	Loss: 0.029
Batch: 23/29	Loss: 0.039
Batch: 25/29	Loss: 0.025
Batch: 27/29	Loss: 0.026
Batch: 29/29	Loss: 0.035
Epoch: 26	Train Loss: 0.036	Val F1: 0.330
Best Epoch: 21	Best Val F1: 0.336

****************************** Epoch: 27 ******************************
Batch: 1/29	Loss: 0.050
Batch: 3/29	Loss: 0.041
Batch: 5/29	Loss: 0.021
Batch: 7/29	Loss: 0.009
Batch: 9/29	Loss: 0.026
Batch: 11/29	Loss: 0.014
Batch: 13/29	Loss: 0.024
Batch: 15/29	Loss: 0.042
Batch: 17/29	Loss: 0.036
Batch: 19/29	Loss: 0.026
Batch: 21/29	Loss: 0.013
Batch: 23/29	Loss: 0.011
Batch: 25/29	Loss: 0.014
Batch: 27/29	Loss: 0.023
Batch: 29/29	Loss: 0.022
Epoch: 27	Train Loss: 0.021	Val F1: 0.330
Best Epoch: 21	Best Val F1: 0.336

****************************** Epoch: 28 ******************************
Batch: 1/29	Loss: 0.012
Batch: 3/29	Loss: 0.008
Batch: 5/29	Loss: 0.017
Batch: 7/29	Loss: 0.021
Batch: 9/29	Loss: 0.035
Batch: 11/29	Loss: 0.009
Batch: 13/29	Loss: 0.013
Batch: 15/29	Loss: 0.032
Batch: 17/29	Loss: 0.013
Batch: 19/29	Loss: 0.017
Batch: 21/29	Loss: 0.011
Batch: 23/29	Loss: 0.024
Batch: 25/29	Loss: 0.012
Batch: 27/29	Loss: 0.016
Batch: 29/29	Loss: 0.028
Epoch: 28	Train Loss: 0.019	Val F1: 0.324
Best Epoch: 21	Best Val F1: 0.336

****************************** Epoch: 29 ******************************
Batch: 1/29	Loss: 0.024
Batch: 3/29	Loss: 0.012
Batch: 5/29	Loss: 0.013
Batch: 7/29	Loss: 0.026
Batch: 9/29	Loss: 0.008
Batch: 11/29	Loss: 0.022
Batch: 13/29	Loss: 0.021
Batch: 15/29	Loss: 0.012
Batch: 17/29	Loss: 0.032
Batch: 19/29	Loss: 0.008
Batch: 21/29	Loss: 0.015
Batch: 23/29	Loss: 0.015
Batch: 25/29	Loss: 0.035
Batch: 27/29	Loss: 0.012
Batch: 29/29	Loss: 0.007
Epoch: 29	Train Loss: 0.015	Val F1: 0.334
Best Epoch: 21	Best Val F1: 0.336

****************************** Epoch: 30 ******************************
Batch: 1/29	Loss: 0.018
Batch: 3/29	Loss: 0.030
Batch: 5/29	Loss: 0.008
Batch: 7/29	Loss: 0.013
Batch: 9/29	Loss: 0.015
Batch: 11/29	Loss: 0.016
Batch: 13/29	Loss: 0.006
Batch: 15/29	Loss: 0.011
Batch: 17/29	Loss: 0.010
Batch: 19/29	Loss: 0.012
Batch: 21/29	Loss: 0.014
Batch: 23/29	Loss: 0.011
Batch: 25/29	Loss: 0.005
Batch: 27/29	Loss: 0.010
Batch: 29/29	Loss: 0.006
Epoch: 30	Train Loss: 0.012	Val F1: 0.326
Best Epoch: 21	Best Val F1: 0.336

****************************** Epoch: 31 ******************************
Batch: 1/29	Loss: 0.007
Batch: 3/29	Loss: 0.011
Batch: 5/29	Loss: 0.026
Batch: 7/29	Loss: 0.004
Batch: 9/29	Loss: 0.006
Batch: 11/29	Loss: 0.016
Batch: 13/29	Loss: 0.008
Batch: 15/29	Loss: 0.006
Batch: 17/29	Loss: 0.014
Batch: 19/29	Loss: 0.023
Batch: 21/29	Loss: 0.041
Batch: 23/29	Loss: 0.010
Batch: 25/29	Loss: 0.027
Batch: 27/29	Loss: 0.023
Batch: 29/29	Loss: 0.024
Epoch: 31	Train Loss: 0.017	Val F1: 0.320
Best Epoch: 21	Best Val F1: 0.336

Saving the best checkpoint....
Inference...
Test F1: 0.364	Test F1_Few: 0.372	Test F1_Zero: 0.357
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0008588406349783311, 'lr': 8.15033124640287e-06, 'n_layers_freeze': 2, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.086
Batch: 5/29	Loss: 1.072
Batch: 7/29	Loss: 1.061
Batch: 9/29	Loss: 1.050
Batch: 11/29	Loss: 1.037
Batch: 13/29	Loss: 1.026
Batch: 15/29	Loss: 1.024
Batch: 17/29	Loss: 0.996
Batch: 19/29	Loss: 0.989
Batch: 21/29	Loss: 0.975
Batch: 23/29	Loss: 0.971
Batch: 25/29	Loss: 0.952
Batch: 27/29	Loss: 0.941
Batch: 29/29	Loss: 0.943
Epoch: 1	Train Loss: 1.014	Val F1: 0.195
Best Epoch: 1	Best Val F1: 0.195

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.935
Batch: 3/29	Loss: 0.932
Batch: 5/29	Loss: 0.946
Batch: 7/29	Loss: 0.920
Batch: 9/29	Loss: 0.926
Batch: 11/29	Loss: 0.896
Batch: 13/29	Loss: 0.893
Batch: 15/29	Loss: 0.910
Batch: 17/29	Loss: 0.897
Batch: 19/29	Loss: 0.916
Batch: 21/29	Loss: 0.885
Batch: 23/29	Loss: 0.888
Batch: 25/29	Loss: 0.873
Batch: 27/29	Loss: 0.911
Batch: 29/29	Loss: 0.874
Epoch: 2	Train Loss: 0.904	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.195

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.866
Batch: 3/29	Loss: 0.876
Batch: 5/29	Loss: 0.870
Batch: 7/29	Loss: 0.888
Batch: 9/29	Loss: 0.856
Batch: 11/29	Loss: 0.855
Batch: 13/29	Loss: 0.883
Batch: 15/29	Loss: 0.856
Batch: 17/29	Loss: 0.868
Batch: 19/29	Loss: 0.865
Batch: 21/29	Loss: 0.849
Batch: 23/29	Loss: 0.845
Batch: 25/29	Loss: 0.857
Batch: 27/29	Loss: 0.838
Batch: 29/29	Loss: 0.844
Epoch: 3	Train Loss: 0.862	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.195

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.833
Batch: 3/29	Loss: 0.845
Batch: 5/29	Loss: 0.826
Batch: 7/29	Loss: 0.862
Batch: 9/29	Loss: 0.851
Batch: 11/29	Loss: 0.820
Batch: 13/29	Loss: 0.827
Batch: 15/29	Loss: 0.815
Batch: 17/29	Loss: 0.825
Batch: 19/29	Loss: 0.839
Batch: 21/29	Loss: 0.848
Batch: 23/29	Loss: 0.848
Batch: 25/29	Loss: 0.836
Batch: 27/29	Loss: 0.848
Batch: 29/29	Loss: 0.833
Epoch: 4	Train Loss: 0.836	Val F1: 0.222
Best Epoch: 4	Best Val F1: 0.222

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.821
Batch: 3/29	Loss: 0.815
Batch: 5/29	Loss: 0.806
Batch: 7/29	Loss: 0.802
Batch: 9/29	Loss: 0.799
Batch: 11/29	Loss: 0.807
Batch: 13/29	Loss: 0.798
Batch: 15/29	Loss: 0.820
Batch: 17/29	Loss: 0.839
Batch: 19/29	Loss: 0.811
Batch: 21/29	Loss: 0.791
Batch: 23/29	Loss: 0.809
Batch: 25/29	Loss: 0.822
Batch: 27/29	Loss: 0.786
Batch: 29/29	Loss: 0.801
Epoch: 5	Train Loss: 0.814	Val F1: 0.289
Best Epoch: 5	Best Val F1: 0.289

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.791
Batch: 3/29	Loss: 0.832
Batch: 5/29	Loss: 0.779
Batch: 7/29	Loss: 0.833
Batch: 9/29	Loss: 0.788
Batch: 11/29	Loss: 0.794
Batch: 13/29	Loss: 0.778
Batch: 15/29	Loss: 0.755
Batch: 17/29	Loss: 0.767
Batch: 19/29	Loss: 0.750
Batch: 21/29	Loss: 0.795
Batch: 23/29	Loss: 0.758
Batch: 25/29	Loss: 0.772
Batch: 27/29	Loss: 0.768
Batch: 29/29	Loss: 0.766
Epoch: 6	Train Loss: 0.782	Val F1: 0.313
Best Epoch: 6	Best Val F1: 0.313

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.745
Batch: 3/29	Loss: 0.815
Batch: 5/29	Loss: 0.808
Batch: 7/29	Loss: 0.769
Batch: 9/29	Loss: 0.773
Batch: 11/29	Loss: 0.736
Batch: 13/29	Loss: 0.736
Batch: 15/29	Loss: 0.757
Batch: 17/29	Loss: 0.765
Batch: 19/29	Loss: 0.767
Batch: 21/29	Loss: 0.717
Batch: 23/29	Loss: 0.706
Batch: 25/29	Loss: 0.688
Batch: 27/29	Loss: 0.730
Batch: 29/29	Loss: 0.701
Epoch: 7	Train Loss: 0.749	Val F1: 0.334
Best Epoch: 7	Best Val F1: 0.334

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.738
Batch: 3/29	Loss: 0.691
Batch: 5/29	Loss: 0.722
Batch: 7/29	Loss: 0.704
Batch: 9/29	Loss: 0.732
Batch: 11/29	Loss: 0.733
Batch: 13/29	Loss: 0.790
Batch: 15/29	Loss: 0.698
Batch: 17/29	Loss: 0.734
Batch: 19/29	Loss: 0.716
Batch: 21/29	Loss: 0.722
Batch: 23/29	Loss: 0.717
Batch: 25/29	Loss: 0.750
Batch: 27/29	Loss: 0.716
Batch: 29/29	Loss: 0.694
Epoch: 8	Train Loss: 0.719	Val F1: 0.345
Best Epoch: 8	Best Val F1: 0.345

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.722
Batch: 3/29	Loss: 0.652
Batch: 5/29	Loss: 0.685
Batch: 7/29	Loss: 0.665
Batch: 9/29	Loss: 0.713
Batch: 11/29	Loss: 0.687
Batch: 13/29	Loss: 0.710
Batch: 15/29	Loss: 0.660
Batch: 17/29	Loss: 0.714
Batch: 19/29	Loss: 0.633
Batch: 21/29	Loss: 0.730
Batch: 23/29	Loss: 0.652
Batch: 25/29	Loss: 0.630
Batch: 27/29	Loss: 0.743
Batch: 29/29	Loss: 0.624
Epoch: 9	Train Loss: 0.682	Val F1: 0.332
Best Epoch: 8	Best Val F1: 0.345

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.605
Batch: 3/29	Loss: 0.664
Batch: 5/29	Loss: 0.642
Batch: 7/29	Loss: 0.636
Batch: 9/29	Loss: 0.633
Batch: 11/29	Loss: 0.558
Batch: 13/29	Loss: 0.729
Batch: 15/29	Loss: 0.696
Batch: 17/29	Loss: 0.724
Batch: 19/29	Loss: 0.544
Batch: 21/29	Loss: 0.687
Batch: 23/29	Loss: 0.666
Batch: 25/29	Loss: 0.668
Batch: 27/29	Loss: 0.608
Batch: 29/29	Loss: 0.695
Epoch: 10	Train Loss: 0.649	Val F1: 0.340
Best Epoch: 8	Best Val F1: 0.345

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.649
Batch: 3/29	Loss: 0.601
Batch: 5/29	Loss: 0.721
Batch: 7/29	Loss: 0.625
Batch: 9/29	Loss: 0.633
Batch: 11/29	Loss: 0.608
Batch: 13/29	Loss: 0.609
Batch: 15/29	Loss: 0.511
Batch: 17/29	Loss: 0.667
Batch: 19/29	Loss: 0.615
Batch: 21/29	Loss: 0.612
Batch: 23/29	Loss: 0.588
Batch: 25/29	Loss: 0.581
Batch: 27/29	Loss: 0.619
Batch: 29/29	Loss: 0.602
Epoch: 11	Train Loss: 0.626	Val F1: 0.314
Best Epoch: 8	Best Val F1: 0.345

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.741
Batch: 3/29	Loss: 0.605
Batch: 5/29	Loss: 0.669
Batch: 7/29	Loss: 0.580
Batch: 9/29	Loss: 0.629
Batch: 11/29	Loss: 0.588
Batch: 13/29	Loss: 0.571
Batch: 15/29	Loss: 0.575
Batch: 17/29	Loss: 0.587
Batch: 19/29	Loss: 0.624
Batch: 21/29	Loss: 0.579
Batch: 23/29	Loss: 0.585
Batch: 25/29	Loss: 0.584
Batch: 27/29	Loss: 0.616
Batch: 29/29	Loss: 0.497
Epoch: 12	Train Loss: 0.600	Val F1: 0.342
Best Epoch: 8	Best Val F1: 0.345

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.609
Batch: 3/29	Loss: 0.507
Batch: 5/29	Loss: 0.599
Batch: 7/29	Loss: 0.580
Batch: 9/29	Loss: 0.558
Batch: 11/29	Loss: 0.559
Batch: 13/29	Loss: 0.580
Batch: 15/29	Loss: 0.578
Batch: 17/29	Loss: 0.513
Batch: 19/29	Loss: 0.450
Batch: 21/29	Loss: 0.562
Batch: 23/29	Loss: 0.571
Batch: 25/29	Loss: 0.440
Batch: 27/29	Loss: 0.655
Batch: 29/29	Loss: 0.639
Epoch: 13	Train Loss: 0.566	Val F1: 0.313
Best Epoch: 8	Best Val F1: 0.345

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.603
Batch: 3/29	Loss: 0.583
Batch: 5/29	Loss: 0.487
Batch: 7/29	Loss: 0.520
Batch: 9/29	Loss: 0.558
Batch: 11/29	Loss: 0.537
Batch: 13/29	Loss: 0.498
Batch: 15/29	Loss: 0.439
Batch: 17/29	Loss: 0.698
Batch: 19/29	Loss: 0.571
Batch: 21/29	Loss: 0.522
Batch: 23/29	Loss: 0.440
Batch: 25/29	Loss: 0.556
Batch: 27/29	Loss: 0.601
Batch: 29/29	Loss: 0.553
Epoch: 14	Train Loss: 0.547	Val F1: 0.343
Best Epoch: 8	Best Val F1: 0.345

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.489
Batch: 3/29	Loss: 0.507
Batch: 5/29	Loss: 0.437
Batch: 7/29	Loss: 0.479
Batch: 9/29	Loss: 0.541
Batch: 11/29	Loss: 0.461
Batch: 13/29	Loss: 0.558
Batch: 15/29	Loss: 0.577
Batch: 17/29	Loss: 0.538
Batch: 19/29	Loss: 0.523
Batch: 21/29	Loss: 0.476
Batch: 23/29	Loss: 0.598
Batch: 25/29	Loss: 0.525
Batch: 27/29	Loss: 0.453
Batch: 29/29	Loss: 0.578
Epoch: 15	Train Loss: 0.520	Val F1: 0.342
Best Epoch: 8	Best Val F1: 0.345

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.515
Batch: 3/29	Loss: 0.470
Batch: 5/29	Loss: 0.495
Batch: 7/29	Loss: 0.445
Batch: 9/29	Loss: 0.532
Batch: 11/29	Loss: 0.478
Batch: 13/29	Loss: 0.473
Batch: 15/29	Loss: 0.465
Batch: 17/29	Loss: 0.495
Batch: 19/29	Loss: 0.583
Batch: 21/29	Loss: 0.404
Batch: 23/29	Loss: 0.490
Batch: 25/29	Loss: 0.501
Batch: 27/29	Loss: 0.446
Batch: 29/29	Loss: 0.490
Epoch: 16	Train Loss: 0.492	Val F1: 0.349
Best Epoch: 16	Best Val F1: 0.349

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.431
Batch: 3/29	Loss: 0.608
Batch: 5/29	Loss: 0.505
Batch: 7/29	Loss: 0.431
Batch: 9/29	Loss: 0.406
Batch: 11/29	Loss: 0.474
Batch: 13/29	Loss: 0.515
Batch: 15/29	Loss: 0.483
Batch: 17/29	Loss: 0.488
Batch: 19/29	Loss: 0.462
Batch: 21/29	Loss: 0.488
Batch: 23/29	Loss: 0.507
Batch: 25/29	Loss: 0.349
Batch: 27/29	Loss: 0.499
Batch: 29/29	Loss: 0.523
Epoch: 17	Train Loss: 0.466	Val F1: 0.348
Best Epoch: 16	Best Val F1: 0.349

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.486
Batch: 3/29	Loss: 0.448
Batch: 5/29	Loss: 0.447
Batch: 7/29	Loss: 0.417
Batch: 9/29	Loss: 0.531
Batch: 11/29	Loss: 0.406
Batch: 13/29	Loss: 0.389
Batch: 15/29	Loss: 0.383
Batch: 17/29	Loss: 0.418
Batch: 19/29	Loss: 0.360
Batch: 21/29	Loss: 0.457
Batch: 23/29	Loss: 0.440
Batch: 25/29	Loss: 0.496
Batch: 27/29	Loss: 0.368
Batch: 29/29	Loss: 0.492
Epoch: 18	Train Loss: 0.445	Val F1: 0.338
Best Epoch: 16	Best Val F1: 0.349

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.415
Batch: 3/29	Loss: 0.321
Batch: 5/29	Loss: 0.459
Batch: 7/29	Loss: 0.488
Batch: 9/29	Loss: 0.338
Batch: 11/29	Loss: 0.515
Batch: 13/29	Loss: 0.471
Batch: 15/29	Loss: 0.437
Batch: 17/29	Loss: 0.434
Batch: 19/29	Loss: 0.582
Batch: 21/29	Loss: 0.435
Batch: 23/29	Loss: 0.467
Batch: 25/29	Loss: 0.418
Batch: 27/29	Loss: 0.393
Batch: 29/29	Loss: 0.384
Epoch: 19	Train Loss: 0.446	Val F1: 0.349
Best Epoch: 19	Best Val F1: 0.349

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.477
Batch: 3/29	Loss: 0.462
Batch: 5/29	Loss: 0.354
Batch: 7/29	Loss: 0.367
Batch: 9/29	Loss: 0.459
Batch: 11/29	Loss: 0.504
Batch: 13/29	Loss: 0.428
Batch: 15/29	Loss: 0.448
Batch: 17/29	Loss: 0.518
Batch: 19/29	Loss: 0.409
Batch: 21/29	Loss: 0.385
Batch: 23/29	Loss: 0.528
Batch: 25/29	Loss: 0.410
Batch: 27/29	Loss: 0.414
Batch: 29/29	Loss: 0.475
Epoch: 20	Train Loss: 0.430	Val F1: 0.343
Best Epoch: 19	Best Val F1: 0.349

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.425
Batch: 3/29	Loss: 0.392
Batch: 5/29	Loss: 0.396
Batch: 7/29	Loss: 0.580
Batch: 9/29	Loss: 0.382
Batch: 11/29	Loss: 0.352
Batch: 13/29	Loss: 0.412
Batch: 15/29	Loss: 0.473
Batch: 17/29	Loss: 0.366
Batch: 19/29	Loss: 0.362
Batch: 21/29	Loss: 0.400
Batch: 23/29	Loss: 0.325
Batch: 25/29	Loss: 0.418
Batch: 27/29	Loss: 0.415
Batch: 29/29	Loss: 0.402
Epoch: 21	Train Loss: 0.416	Val F1: 0.343
Best Epoch: 19	Best Val F1: 0.349

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.390
Batch: 3/29	Loss: 0.368
Batch: 5/29	Loss: 0.434
Batch: 7/29	Loss: 0.393
Batch: 9/29	Loss: 0.362
Batch: 11/29	Loss: 0.350
Batch: 13/29	Loss: 0.312
Batch: 15/29	Loss: 0.482
Batch: 17/29	Loss: 0.438
Batch: 19/29	Loss: 0.484
Batch: 21/29	Loss: 0.510
Batch: 23/29	Loss: 0.402
Batch: 25/29	Loss: 0.384
Batch: 27/29	Loss: 0.343
Batch: 29/29	Loss: 0.388
Epoch: 22	Train Loss: 0.397	Val F1: 0.345
Best Epoch: 19	Best Val F1: 0.349

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.368
Batch: 3/29	Loss: 0.410
Batch: 5/29	Loss: 0.393
Batch: 7/29	Loss: 0.492
Batch: 9/29	Loss: 0.418
Batch: 11/29	Loss: 0.451
Batch: 13/29	Loss: 0.414
Batch: 15/29	Loss: 0.391
Batch: 17/29	Loss: 0.421
Batch: 19/29	Loss: 0.452
Batch: 21/29	Loss: 0.396
Batch: 23/29	Loss: 0.345
Batch: 25/29	Loss: 0.398
Batch: 27/29	Loss: 0.343
Batch: 29/29	Loss: 0.512
Epoch: 23	Train Loss: 0.413	Val F1: 0.350
Best Epoch: 23	Best Val F1: 0.350

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.356
Batch: 3/29	Loss: 0.368
Batch: 5/29	Loss: 0.440
Batch: 7/29	Loss: 0.521
Batch: 9/29	Loss: 0.451
Batch: 11/29	Loss: 0.536
Batch: 13/29	Loss: 0.363
Batch: 15/29	Loss: 0.375
Batch: 17/29	Loss: 0.335
Batch: 19/29	Loss: 0.432
Batch: 21/29	Loss: 0.419
Batch: 23/29	Loss: 0.370
Batch: 25/29	Loss: 0.365
Batch: 27/29	Loss: 0.354
Batch: 29/29	Loss: 0.381
Epoch: 24	Train Loss: 0.402	Val F1: 0.341
Best Epoch: 23	Best Val F1: 0.350

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.468
Batch: 3/29	Loss: 0.396
Batch: 5/29	Loss: 0.443
Batch: 7/29	Loss: 0.413
Batch: 9/29	Loss: 0.436
Batch: 11/29	Loss: 0.387
Batch: 13/29	Loss: 0.439
Batch: 15/29	Loss: 0.403
Batch: 17/29	Loss: 0.406
Batch: 19/29	Loss: 0.326
Batch: 21/29	Loss: 0.370
Batch: 23/29	Loss: 0.379
Batch: 25/29	Loss: 0.371
Batch: 27/29	Loss: 0.373
Batch: 29/29	Loss: 0.364
Epoch: 25	Train Loss: 0.379	Val F1: 0.347
Best Epoch: 23	Best Val F1: 0.350

****************************** Epoch: 26 ******************************
Batch: 1/29	Loss: 0.314
Batch: 3/29	Loss: 0.317
Batch: 5/29	Loss: 0.387
Batch: 7/29	Loss: 0.439
Batch: 9/29	Loss: 0.369
Batch: 11/29	Loss: 0.384
Batch: 13/29	Loss: 0.364
Batch: 15/29	Loss: 0.376
Batch: 17/29	Loss: 0.312
Batch: 19/29	Loss: 0.480
Batch: 21/29	Loss: 0.502
Batch: 23/29	Loss: 0.261
Batch: 25/29	Loss: 0.431
Batch: 27/29	Loss: 0.351
Batch: 29/29	Loss: 0.423
Epoch: 26	Train Loss: 0.369	Val F1: 0.342
Best Epoch: 23	Best Val F1: 0.350

****************************** Epoch: 27 ******************************
Batch: 1/29	Loss: 0.322
Batch: 3/29	Loss: 0.392
Batch: 5/29	Loss: 0.507
Batch: 7/29	Loss: 0.257
Batch: 9/29	Loss: 0.479
Batch: 11/29	Loss: 0.280
Batch: 13/29	Loss: 0.492
Batch: 15/29	Loss: 0.390
Batch: 17/29	Loss: 0.387
Batch: 19/29	Loss: 0.341
Batch: 21/29	Loss: 0.387
Batch: 23/29	Loss: 0.303
Batch: 25/29	Loss: 0.312
Batch: 27/29	Loss: 0.371
Batch: 29/29	Loss: 0.394
Epoch: 27	Train Loss: 0.361	Val F1: 0.344
Best Epoch: 23	Best Val F1: 0.350

****************************** Epoch: 28 ******************************
Batch: 1/29	Loss: 0.350
Batch: 3/29	Loss: 0.369
Batch: 5/29	Loss: 0.351
Batch: 7/29	Loss: 0.383
Batch: 9/29	Loss: 0.393
Batch: 11/29	Loss: 0.361
Batch: 13/29	Loss: 0.308
Batch: 15/29	Loss: 0.408
Batch: 17/29	Loss: 0.421
Batch: 19/29	Loss: 0.307
Batch: 21/29	Loss: 0.350
Batch: 23/29	Loss: 0.413
Batch: 25/29	Loss: 0.405
Batch: 27/29	Loss: 0.280
Batch: 29/29	Loss: 0.373
Epoch: 28	Train Loss: 0.358	Val F1: 0.349
Best Epoch: 23	Best Val F1: 0.350

****************************** Epoch: 29 ******************************
Batch: 1/29	Loss: 0.387
Batch: 3/29	Loss: 0.379
Batch: 5/29	Loss: 0.299
Batch: 7/29	Loss: 0.327
Batch: 9/29	Loss: 0.269
Batch: 11/29	Loss: 0.415
Batch: 13/29	Loss: 0.428
Batch: 15/29	Loss: 0.293
Batch: 17/29	Loss: 0.408
Batch: 19/29	Loss: 0.322
Batch: 21/29	Loss: 0.388
Batch: 23/29	Loss: 0.353
Batch: 25/29	Loss: 0.396
Batch: 27/29	Loss: 0.355
Batch: 29/29	Loss: 0.357
Epoch: 29	Train Loss: 0.355	Val F1: 0.342
Best Epoch: 23	Best Val F1: 0.350

****************************** Epoch: 30 ******************************
Batch: 1/29	Loss: 0.273
Batch: 3/29	Loss: 0.342
Batch: 5/29	Loss: 0.382
Batch: 7/29	Loss: 0.388
Batch: 9/29	Loss: 0.347
Batch: 11/29	Loss: 0.317
Batch: 13/29	Loss: 0.390
Batch: 15/29	Loss: 0.275
Batch: 17/29	Loss: 0.348
Batch: 19/29	Loss: 0.326
Batch: 21/29	Loss: 0.367
Batch: 23/29	Loss: 0.355
Batch: 25/29	Loss: 0.326
Batch: 27/29	Loss: 0.300
Batch: 29/29	Loss: 0.326
Epoch: 30	Train Loss: 0.348	Val F1: 0.338
Best Epoch: 23	Best Val F1: 0.350

****************************** Epoch: 31 ******************************
Batch: 1/29	Loss: 0.297
Batch: 3/29	Loss: 0.285
Batch: 5/29	Loss: 0.293
Batch: 7/29	Loss: 0.323
Batch: 9/29	Loss: 0.297
Batch: 11/29	Loss: 0.346
Batch: 13/29	Loss: 0.330
Batch: 15/29	Loss: 0.288
Batch: 17/29	Loss: 0.344
Batch: 19/29	Loss: 0.285
Batch: 21/29	Loss: 0.392
Batch: 23/29	Loss: 0.330
Batch: 25/29	Loss: 0.392
Batch: 27/29	Loss: 0.295
Batch: 29/29	Loss: 0.274
Epoch: 31	Train Loss: 0.331	Val F1: 0.340
Best Epoch: 23	Best Val F1: 0.350

****************************** Epoch: 32 ******************************
Batch: 1/29	Loss: 0.426
Batch: 3/29	Loss: 0.323
Batch: 5/29	Loss: 0.292
Batch: 7/29	Loss: 0.303
Batch: 9/29	Loss: 0.294
Batch: 11/29	Loss: 0.335
Batch: 13/29	Loss: 0.341
Batch: 15/29	Loss: 0.213
Batch: 17/29	Loss: 0.385
Batch: 19/29	Loss: 0.391
Batch: 21/29	Loss: 0.308
Batch: 23/29	Loss: 0.345
Batch: 25/29	Loss: 0.344
Batch: 27/29	Loss: 0.215
Batch: 29/29	Loss: 0.382
Epoch: 32	Train Loss: 0.330	Val F1: 0.339
Best Epoch: 23	Best Val F1: 0.350

****************************** Epoch: 33 ******************************
Batch: 1/29	Loss: 0.384
Batch: 3/29	Loss: 0.308
Batch: 5/29	Loss: 0.333
Batch: 7/29	Loss: 0.337
Batch: 9/29	Loss: 0.449
Batch: 11/29	Loss: 0.260
Batch: 13/29	Loss: 0.356
Batch: 15/29	Loss: 0.357
Batch: 17/29	Loss: 0.327
Batch: 19/29	Loss: 0.317
Batch: 21/29	Loss: 0.274
Batch: 23/29	Loss: 0.310
Batch: 25/29	Loss: 0.339
Batch: 27/29	Loss: 0.355
Batch: 29/29	Loss: 0.352
Epoch: 33	Train Loss: 0.324	Val F1: 0.349
Best Epoch: 23	Best Val F1: 0.350

****************************** Epoch: 34 ******************************
Batch: 1/29	Loss: 0.246
Batch: 3/29	Loss: 0.300
Batch: 5/29	Loss: 0.288
Batch: 7/29	Loss: 0.263
Batch: 9/29	Loss: 0.349
Batch: 11/29	Loss: 0.366
Batch: 13/29	Loss: 0.308
Batch: 15/29	Loss: 0.346
Batch: 17/29	Loss: 0.414
Batch: 19/29	Loss: 0.273
Batch: 21/29	Loss: 0.367
Batch: 23/29	Loss: 0.277
Batch: 25/29	Loss: 0.280
Batch: 27/29	Loss: 0.259
Batch: 29/29	Loss: 0.324
Epoch: 34	Train Loss: 0.315	Val F1: 0.347
Best Epoch: 23	Best Val F1: 0.350

****************************** Epoch: 35 ******************************
Batch: 1/29	Loss: 0.246
Batch: 3/29	Loss: 0.323
Batch: 5/29	Loss: 0.314
Batch: 7/29	Loss: 0.312
Batch: 9/29	Loss: 0.370
Batch: 11/29	Loss: 0.238
Batch: 13/29	Loss: 0.252
Batch: 15/29	Loss: 0.284
Batch: 17/29	Loss: 0.360
Batch: 19/29	Loss: 0.263
Batch: 21/29	Loss: 0.325
Batch: 23/29	Loss: 0.350
Batch: 25/29	Loss: 0.270
Batch: 27/29	Loss: 0.307
Batch: 29/29	Loss: 0.246
Epoch: 35	Train Loss: 0.306	Val F1: 0.353
Best Epoch: 35	Best Val F1: 0.353

****************************** Epoch: 36 ******************************
Batch: 1/29	Loss: 0.294
Batch: 3/29	Loss: 0.267
Batch: 5/29	Loss: 0.251
Batch: 7/29	Loss: 0.283
Batch: 9/29	Loss: 0.252
Batch: 11/29	Loss: 0.226
Batch: 13/29	Loss: 0.353
Batch: 15/29	Loss: 0.365
Batch: 17/29	Loss: 0.343
Batch: 19/29	Loss: 0.298
Batch: 21/29	Loss: 0.308
Batch: 23/29	Loss: 0.287
Batch: 25/29	Loss: 0.236
Batch: 27/29	Loss: 0.314
Batch: 29/29	Loss: 0.248
Epoch: 36	Train Loss: 0.298	Val F1: 0.349
Best Epoch: 35	Best Val F1: 0.353

****************************** Epoch: 37 ******************************
Batch: 1/29	Loss: 0.241
Batch: 3/29	Loss: 0.359
Batch: 5/29	Loss: 0.299
Batch: 7/29	Loss: 0.269
Batch: 9/29	Loss: 0.262
Batch: 11/29	Loss: 0.363
Batch: 13/29	Loss: 0.296
Batch: 15/29	Loss: 0.254
Batch: 17/29	Loss: 0.295
Batch: 19/29	Loss: 0.292
Batch: 21/29	Loss: 0.301
Batch: 23/29	Loss: 0.276
Batch: 25/29	Loss: 0.216
Batch: 27/29	Loss: 0.230
Batch: 29/29	Loss: 0.333
Epoch: 37	Train Loss: 0.291	Val F1: 0.347
Best Epoch: 35	Best Val F1: 0.353

****************************** Epoch: 38 ******************************
Batch: 1/29	Loss: 0.257
Batch: 3/29	Loss: 0.346
Batch: 5/29	Loss: 0.242
Batch: 7/29	Loss: 0.305
Batch: 9/29	Loss: 0.304
Batch: 11/29	Loss: 0.263
Batch: 13/29	Loss: 0.277
Batch: 15/29	Loss: 0.317
Batch: 17/29	Loss: 0.289
Batch: 19/29	Loss: 0.300
Batch: 21/29	Loss: 0.248
Batch: 23/29	Loss: 0.269
Batch: 25/29	Loss: 0.278
Batch: 27/29	Loss: 0.337
Batch: 29/29	Loss: 0.315
Epoch: 38	Train Loss: 0.286	Val F1: 0.343
Best Epoch: 35	Best Val F1: 0.353

****************************** Epoch: 39 ******************************
Batch: 1/29	Loss: 0.232
Batch: 3/29	Loss: 0.331
Batch: 5/29	Loss: 0.284
Batch: 7/29	Loss: 0.302
Batch: 9/29	Loss: 0.255
Batch: 11/29	Loss: 0.212
Batch: 13/29	Loss: 0.260
Batch: 15/29	Loss: 0.305
Batch: 17/29	Loss: 0.242
Batch: 19/29	Loss: 0.224
Batch: 21/29	Loss: 0.202
Batch: 23/29	Loss: 0.249
Batch: 25/29	Loss: 0.328
Batch: 27/29	Loss: 0.329
Batch: 29/29	Loss: 0.332
Epoch: 39	Train Loss: 0.277	Val F1: 0.333
Best Epoch: 35	Best Val F1: 0.353

****************************** Epoch: 40 ******************************
Batch: 1/29	Loss: 0.378
Batch: 3/29	Loss: 0.238
Batch: 5/29	Loss: 0.308
Batch: 7/29	Loss: 0.321
Batch: 9/29	Loss: 0.286
Batch: 11/29	Loss: 0.213
Batch: 13/29	Loss: 0.283
Batch: 15/29	Loss: 0.276
Batch: 17/29	Loss: 0.313
Batch: 19/29	Loss: 0.292
Batch: 21/29	Loss: 0.275
Batch: 23/29	Loss: 0.241
Batch: 25/29	Loss: 0.221
Batch: 27/29	Loss: 0.204
Batch: 29/29	Loss: 0.307
Epoch: 40	Train Loss: 0.276	Val F1: 0.345
Best Epoch: 35	Best Val F1: 0.353

****************************** Epoch: 41 ******************************
Batch: 1/29	Loss: 0.220
Batch: 3/29	Loss: 0.302
Batch: 5/29	Loss: 0.234
Batch: 7/29	Loss: 0.317
Batch: 9/29	Loss: 0.197
Batch: 11/29	Loss: 0.297
Batch: 13/29	Loss: 0.245
Batch: 15/29	Loss: 0.249
Batch: 17/29	Loss: 0.235
Batch: 19/29	Loss: 0.233
Batch: 21/29	Loss: 0.192
Batch: 23/29	Loss: 0.298
Batch: 25/29	Loss: 0.266
Batch: 27/29	Loss: 0.304
Batch: 29/29	Loss: 0.297
Epoch: 41	Train Loss: 0.260	Val F1: 0.347
Best Epoch: 35	Best Val F1: 0.353

****************************** Epoch: 42 ******************************
Batch: 1/29	Loss: 0.305
Batch: 3/29	Loss: 0.333
Batch: 5/29	Loss: 0.234
Batch: 7/29	Loss: 0.224
Batch: 9/29	Loss: 0.284
Batch: 11/29	Loss: 0.282
Batch: 13/29	Loss: 0.299
Batch: 15/29	Loss: 0.196
Batch: 17/29	Loss: 0.255
Batch: 19/29	Loss: 0.218
Batch: 21/29	Loss: 0.254
Batch: 23/29	Loss: 0.286
Batch: 25/29	Loss: 0.245
Batch: 27/29	Loss: 0.284
Batch: 29/29	Loss: 0.188
Epoch: 42	Train Loss: 0.257	Val F1: 0.344
Best Epoch: 35	Best Val F1: 0.353

****************************** Epoch: 43 ******************************
Batch: 1/29	Loss: 0.274
Batch: 3/29	Loss: 0.221
Batch: 5/29	Loss: 0.286
Batch: 7/29	Loss: 0.266
Batch: 9/29	Loss: 0.306
Batch: 11/29	Loss: 0.235
Batch: 13/29	Loss: 0.283
Batch: 15/29	Loss: 0.235
Batch: 17/29	Loss: 0.234
Batch: 19/29	Loss: 0.198
Batch: 21/29	Loss: 0.238
Batch: 23/29	Loss: 0.202
Batch: 25/29	Loss: 0.229
Batch: 27/29	Loss: 0.259
Batch: 29/29	Loss: 0.236
Epoch: 43	Train Loss: 0.247	Val F1: 0.345
Best Epoch: 35	Best Val F1: 0.353

****************************** Epoch: 44 ******************************
Batch: 1/29	Loss: 0.289
Batch: 3/29	Loss: 0.218
Batch: 5/29	Loss: 0.227
Batch: 7/29	Loss: 0.226
Batch: 9/29	Loss: 0.280
Batch: 11/29	Loss: 0.218
Batch: 13/29	Loss: 0.159
Batch: 15/29	Loss: 0.212
Batch: 17/29	Loss: 0.212
Batch: 19/29	Loss: 0.284
Batch: 21/29	Loss: 0.277
Batch: 23/29	Loss: 0.218
Batch: 25/29	Loss: 0.244
Batch: 27/29	Loss: 0.183
Batch: 29/29	Loss: 0.210
Epoch: 44	Train Loss: 0.236	Val F1: 0.341
Best Epoch: 35	Best Val F1: 0.353

****************************** Epoch: 45 ******************************
Batch: 1/29	Loss: 0.144
Batch: 3/29	Loss: 0.179
Batch: 5/29	Loss: 0.317
Batch: 7/29	Loss: 0.223
Batch: 9/29	Loss: 0.230
Batch: 11/29	Loss: 0.218
Batch: 13/29	Loss: 0.251
Batch: 15/29	Loss: 0.196
Batch: 17/29	Loss: 0.230
Batch: 19/29	Loss: 0.153
Batch: 21/29	Loss: 0.189
Batch: 23/29	Loss: 0.231
Batch: 25/29	Loss: 0.220
Batch: 27/29	Loss: 0.206
Batch: 29/29	Loss: 0.273
Epoch: 45	Train Loss: 0.223	Val F1: 0.339
Best Epoch: 35	Best Val F1: 0.353

****************************** Epoch: 46 ******************************
Batch: 1/29	Loss: 0.217
Batch: 3/29	Loss: 0.170
Batch: 5/29	Loss: 0.213
Batch: 7/29	Loss: 0.235
Batch: 9/29	Loss: 0.201
Batch: 11/29	Loss: 0.174
Batch: 13/29	Loss: 0.275
Batch: 15/29	Loss: 0.170
Batch: 17/29	Loss: 0.223
Batch: 19/29	Loss: 0.217
Batch: 21/29	Loss: 0.206
Batch: 23/29	Loss: 0.183
Batch: 25/29	Loss: 0.217
Batch: 27/29	Loss: 0.249
Batch: 29/29	Loss: 0.206
Epoch: 46	Train Loss: 0.211	Val F1: 0.334
Best Epoch: 35	Best Val F1: 0.353

****************************** Epoch: 47 ******************************
Batch: 1/29	Loss: 0.228
Batch: 3/29	Loss: 0.203
Batch: 5/29	Loss: 0.229
Batch: 7/29	Loss: 0.237
Batch: 9/29	Loss: 0.191
Batch: 11/29	Loss: 0.229
Batch: 13/29	Loss: 0.224
Batch: 15/29	Loss: 0.236
Batch: 17/29	Loss: 0.156
Batch: 19/29	Loss: 0.229
Batch: 21/29	Loss: 0.266
Batch: 23/29	Loss: 0.222
Batch: 25/29	Loss: 0.201
Batch: 27/29	Loss: 0.158
Batch: 29/29	Loss: 0.264
Epoch: 47	Train Loss: 0.205	Val F1: 0.332
Best Epoch: 35	Best Val F1: 0.353

****************************** Epoch: 48 ******************************
Batch: 1/29	Loss: 0.252
Batch: 3/29	Loss: 0.197
Batch: 5/29	Loss: 0.298
Batch: 7/29	Loss: 0.192
Batch: 9/29	Loss: 0.202
Batch: 11/29	Loss: 0.224
Batch: 13/29	Loss: 0.232
Batch: 15/29	Loss: 0.240
Batch: 17/29	Loss: 0.169
Batch: 19/29	Loss: 0.156
Batch: 21/29	Loss: 0.190
Batch: 23/29	Loss: 0.192
Batch: 25/29	Loss: 0.206
Batch: 27/29	Loss: 0.160
Batch: 29/29	Loss: 0.155
Epoch: 48	Train Loss: 0.197	Val F1: 0.344
Best Epoch: 35	Best Val F1: 0.353

****************************** Epoch: 49 ******************************
Batch: 1/29	Loss: 0.203
Batch: 3/29	Loss: 0.161
Batch: 5/29	Loss: 0.204
Batch: 7/29	Loss: 0.194
Batch: 9/29	Loss: 0.193
Batch: 11/29	Loss: 0.233
Batch: 13/29	Loss: 0.222
Batch: 15/29	Loss: 0.168
Batch: 17/29	Loss: 0.166
Batch: 19/29	Loss: 0.245
Batch: 21/29	Loss: 0.161
Batch: 23/29	Loss: 0.167
Batch: 25/29	Loss: 0.173
Batch: 27/29	Loss: 0.167
Batch: 29/29	Loss: 0.179
Epoch: 49	Train Loss: 0.192	Val F1: 0.350
Best Epoch: 35	Best Val F1: 0.353

****************************** Epoch: 50 ******************************
Batch: 1/29	Loss: 0.164
Batch: 3/29	Loss: 0.245
Batch: 5/29	Loss: 0.195
Batch: 7/29	Loss: 0.143
Batch: 9/29	Loss: 0.171
Batch: 11/29	Loss: 0.219
Batch: 13/29	Loss: 0.193
Batch: 15/29	Loss: 0.187
Batch: 17/29	Loss: 0.191
Batch: 19/29	Loss: 0.170
Batch: 21/29	Loss: 0.205
Batch: 23/29	Loss: 0.138
Batch: 25/29	Loss: 0.136
Batch: 27/29	Loss: 0.252
Batch: 29/29	Loss: 0.235
Epoch: 50	Train Loss: 0.175	Val F1: 0.345
Best Epoch: 35	Best Val F1: 0.353

Saving the best checkpoint....
Inference...
Test F1: 0.371	Test F1_Few: 0.463	Test F1_Zero: 0.348
Starting training with config: {'batch_size': 16, 'epochs': 75, 'l2_reg': 0.0007654418714376541, 'lr': 1.4274061161363052e-05, 'n_layers_freeze': 3, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 1.006
Batch: 23/116	Loss: 0.935
Batch: 34/116	Loss: 0.915
Batch: 45/116	Loss: 0.875
Batch: 56/116	Loss: 0.865
Batch: 67/116	Loss: 0.820
Batch: 78/116	Loss: 0.825
Batch: 89/116	Loss: 0.889
Batch: 100/116	Loss: 0.789
Batch: 111/116	Loss: 0.816
Batch: 116/116	Loss: 0.779
Epoch: 1	Train Loss: 0.882	Val F1: 0.180
Best Epoch: 1	Best Val F1: 0.180

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.849
Batch: 12/116	Loss: 0.802
Batch: 23/116	Loss: 0.774
Batch: 34/116	Loss: 0.764
Batch: 45/116	Loss: 0.826
Batch: 56/116	Loss: 0.784
Batch: 67/116	Loss: 0.795
Batch: 78/116	Loss: 0.767
Batch: 89/116	Loss: 0.780
Batch: 100/116	Loss: 0.746
Batch: 111/116	Loss: 0.762
Batch: 116/116	Loss: 0.745
Epoch: 2	Train Loss: 0.782	Val F1: 0.326
Best Epoch: 2	Best Val F1: 0.326

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.691
Batch: 12/116	Loss: 0.654
Batch: 23/116	Loss: 0.681
Batch: 34/116	Loss: 0.763
Batch: 45/116	Loss: 0.765
Batch: 56/116	Loss: 0.750
Batch: 67/116	Loss: 0.722
Batch: 78/116	Loss: 0.681
Batch: 89/116	Loss: 0.717
Batch: 100/116	Loss: 0.870
Batch: 111/116	Loss: 0.846
Batch: 116/116	Loss: 0.623
Epoch: 3	Train Loss: 0.724	Val F1: 0.326
Best Epoch: 2	Best Val F1: 0.326

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.710
Batch: 12/116	Loss: 0.602
Batch: 23/116	Loss: 0.860
Batch: 34/116	Loss: 0.636
Batch: 45/116	Loss: 0.716
Batch: 56/116	Loss: 0.634
Batch: 67/116	Loss: 0.737
Batch: 78/116	Loss: 0.596
Batch: 89/116	Loss: 0.721
Batch: 100/116	Loss: 0.671
Batch: 111/116	Loss: 0.686
Batch: 116/116	Loss: 0.831
Epoch: 4	Train Loss: 0.674	Val F1: 0.318
Best Epoch: 2	Best Val F1: 0.326

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.492
Batch: 12/116	Loss: 0.601
Batch: 23/116	Loss: 0.633
Batch: 34/116	Loss: 0.585
Batch: 45/116	Loss: 0.652
Batch: 56/116	Loss: 0.593
Batch: 67/116	Loss: 0.573
Batch: 78/116	Loss: 0.691
Batch: 89/116	Loss: 0.735
Batch: 100/116	Loss: 0.655
Batch: 111/116	Loss: 0.619
Batch: 116/116	Loss: 0.546
Epoch: 5	Train Loss: 0.622	Val F1: 0.337
Best Epoch: 5	Best Val F1: 0.337

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.524
Batch: 12/116	Loss: 0.855
Batch: 23/116	Loss: 0.579
Batch: 34/116	Loss: 0.536
Batch: 45/116	Loss: 0.469
Batch: 56/116	Loss: 0.585
Batch: 67/116	Loss: 0.503
Batch: 78/116	Loss: 0.672
Batch: 89/116	Loss: 0.811
Batch: 100/116	Loss: 0.659
Batch: 111/116	Loss: 0.604
Batch: 116/116	Loss: 0.278
Epoch: 6	Train Loss: 0.554	Val F1: 0.366
Best Epoch: 6	Best Val F1: 0.366

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.393
Batch: 12/116	Loss: 0.666
Batch: 23/116	Loss: 0.670
Batch: 34/116	Loss: 0.783
Batch: 45/116	Loss: 0.324
Batch: 56/116	Loss: 0.774
Batch: 67/116	Loss: 0.520
Batch: 78/116	Loss: 0.527
Batch: 89/116	Loss: 0.433
Batch: 100/116	Loss: 0.367
Batch: 111/116	Loss: 0.708
Batch: 116/116	Loss: 0.468
Epoch: 7	Train Loss: 0.505	Val F1: 0.357
Best Epoch: 6	Best Val F1: 0.366

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.512
Batch: 12/116	Loss: 0.396
Batch: 23/116	Loss: 0.209
Batch: 34/116	Loss: 0.464
Batch: 45/116	Loss: 0.389
Batch: 56/116	Loss: 0.325
Batch: 67/116	Loss: 0.764
Batch: 78/116	Loss: 0.313
Batch: 89/116	Loss: 0.266
Batch: 100/116	Loss: 0.804
Batch: 111/116	Loss: 0.326
Batch: 116/116	Loss: 0.461
Epoch: 8	Train Loss: 0.456	Val F1: 0.349
Best Epoch: 6	Best Val F1: 0.366

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.432
Batch: 12/116	Loss: 0.457
Batch: 23/116	Loss: 0.361
Batch: 34/116	Loss: 0.299
Batch: 45/116	Loss: 0.353
Batch: 56/116	Loss: 0.396
Batch: 67/116	Loss: 0.316
Batch: 78/116	Loss: 0.355
Batch: 89/116	Loss: 0.271
Batch: 100/116	Loss: 0.405
Batch: 111/116	Loss: 0.261
Batch: 116/116	Loss: 0.419
Epoch: 9	Train Loss: 0.403	Val F1: 0.360
Best Epoch: 6	Best Val F1: 0.366

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.386
Batch: 12/116	Loss: 0.317
Batch: 23/116	Loss: 0.258
Batch: 34/116	Loss: 0.442
Batch: 45/116	Loss: 0.319
Batch: 56/116	Loss: 0.411
Batch: 67/116	Loss: 0.484
Batch: 78/116	Loss: 0.292
Batch: 89/116	Loss: 0.264
Batch: 100/116	Loss: 0.475
Batch: 111/116	Loss: 0.216
Batch: 116/116	Loss: 0.315
Epoch: 10	Train Loss: 0.372	Val F1: 0.340
Best Epoch: 6	Best Val F1: 0.366

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.471
Batch: 12/116	Loss: 0.218
Batch: 23/116	Loss: 0.203
Batch: 34/116	Loss: 0.240
Batch: 45/116	Loss: 0.387
Batch: 56/116	Loss: 0.376
Batch: 67/116	Loss: 0.341
Batch: 78/116	Loss: 0.324
Batch: 89/116	Loss: 0.253
Batch: 100/116	Loss: 0.291
Batch: 111/116	Loss: 0.366
Batch: 116/116	Loss: 0.187
Epoch: 11	Train Loss: 0.338	Val F1: 0.345
Best Epoch: 6	Best Val F1: 0.366

****************************** Epoch: 12 ******************************
Batch: 1/116	Loss: 0.494
Batch: 12/116	Loss: 0.294
Batch: 23/116	Loss: 0.255
Batch: 34/116	Loss: 0.332
Batch: 45/116	Loss: 0.233
Batch: 56/116	Loss: 0.331
Batch: 67/116	Loss: 0.195
Batch: 78/116	Loss: 0.386
Batch: 89/116	Loss: 0.408
Batch: 100/116	Loss: 0.592
Batch: 111/116	Loss: 0.259
Batch: 116/116	Loss: 0.232
Epoch: 12	Train Loss: 0.315	Val F1: 0.348
Best Epoch: 6	Best Val F1: 0.366

****************************** Epoch: 13 ******************************
Batch: 1/116	Loss: 0.311
Batch: 12/116	Loss: 0.186
Batch: 23/116	Loss: 0.354
Batch: 34/116	Loss: 0.161
Batch: 45/116	Loss: 0.537
Batch: 56/116	Loss: 0.325
Batch: 67/116	Loss: 0.190
Batch: 78/116	Loss: 0.341
Batch: 89/116	Loss: 0.321
Batch: 100/116	Loss: 0.312
Batch: 111/116	Loss: 0.284
Batch: 116/116	Loss: 0.279
Epoch: 13	Train Loss: 0.298	Val F1: 0.345
Best Epoch: 6	Best Val F1: 0.366

****************************** Epoch: 14 ******************************
Batch: 1/116	Loss: 0.566
Batch: 12/116	Loss: 0.451
Batch: 23/116	Loss: 0.198
Batch: 34/116	Loss: 0.189
Batch: 45/116	Loss: 0.325
Batch: 56/116	Loss: 0.292
Batch: 67/116	Loss: 0.490
Batch: 78/116	Loss: 0.379
Batch: 89/116	Loss: 0.222
Batch: 100/116	Loss: 0.272
Batch: 111/116	Loss: 0.230
Batch: 116/116	Loss: 0.242
Epoch: 14	Train Loss: 0.267	Val F1: 0.359
Best Epoch: 6	Best Val F1: 0.366

****************************** Epoch: 15 ******************************
Batch: 1/116	Loss: 0.179
Batch: 12/116	Loss: 0.412
Batch: 23/116	Loss: 0.116
Batch: 34/116	Loss: 0.287
Batch: 45/116	Loss: 0.282
Batch: 56/116	Loss: 0.240
Batch: 67/116	Loss: 0.261
Batch: 78/116	Loss: 0.239
Batch: 89/116	Loss: 0.217
Batch: 100/116	Loss: 0.390
Batch: 111/116	Loss: 0.217
Batch: 116/116	Loss: 0.046
Epoch: 15	Train Loss: 0.232	Val F1: 0.356
Best Epoch: 6	Best Val F1: 0.366

****************************** Epoch: 16 ******************************
Batch: 1/116	Loss: 0.480
Batch: 12/116	Loss: 0.105
Batch: 23/116	Loss: 0.196
Batch: 34/116	Loss: 0.143
Batch: 45/116	Loss: 0.102
Batch: 56/116	Loss: 0.269
Batch: 67/116	Loss: 0.311
Batch: 78/116	Loss: 0.223
Batch: 89/116	Loss: 0.174
Batch: 100/116	Loss: 0.242
Batch: 111/116	Loss: 0.083
Batch: 116/116	Loss: 0.217
Epoch: 16	Train Loss: 0.211	Val F1: 0.355
Best Epoch: 6	Best Val F1: 0.366

****************************** Epoch: 17 ******************************
Batch: 1/116	Loss: 0.152
Batch: 12/116	Loss: 0.172
Batch: 23/116	Loss: 0.208
Batch: 34/116	Loss: 0.083
Batch: 45/116	Loss: 0.164
Batch: 56/116	Loss: 0.146
Batch: 67/116	Loss: 0.212
Batch: 78/116	Loss: 0.128
Batch: 89/116	Loss: 0.476
Batch: 100/116	Loss: 0.073
Batch: 111/116	Loss: 0.270
Batch: 116/116	Loss: 0.457
Epoch: 17	Train Loss: 0.185	Val F1: 0.352
Best Epoch: 6	Best Val F1: 0.366

****************************** Epoch: 18 ******************************
Batch: 1/116	Loss: 0.341
Batch: 12/116	Loss: 0.134
Batch: 23/116	Loss: 0.218
Batch: 34/116	Loss: 0.232
Batch: 45/116	Loss: 0.067
Batch: 56/116	Loss: 0.165
Batch: 67/116	Loss: 0.113
Batch: 78/116	Loss: 0.161
Batch: 89/116	Loss: 0.119
Batch: 100/116	Loss: 0.117
Batch: 111/116	Loss: 0.029
Batch: 116/116	Loss: 0.202
Epoch: 18	Train Loss: 0.152	Val F1: 0.343
Best Epoch: 6	Best Val F1: 0.366

****************************** Epoch: 19 ******************************
Batch: 1/116	Loss: 0.131
Batch: 12/116	Loss: 0.233
Batch: 23/116	Loss: 0.048
Batch: 34/116	Loss: 0.205
Batch: 45/116	Loss: 0.103
Batch: 56/116	Loss: 0.122
Batch: 67/116	Loss: 0.207
Batch: 78/116	Loss: 0.071
Batch: 89/116	Loss: 0.117
Batch: 100/116	Loss: 0.147
Batch: 111/116	Loss: 0.074
Batch: 116/116	Loss: 0.273
Epoch: 19	Train Loss: 0.125	Val F1: 0.343
Best Epoch: 6	Best Val F1: 0.366

****************************** Epoch: 20 ******************************
Batch: 1/116	Loss: 0.121
Batch: 12/116	Loss: 0.134
Batch: 23/116	Loss: 0.083
Batch: 34/116	Loss: 0.090
Batch: 45/116	Loss: 0.080
Batch: 56/116	Loss: 0.418
Batch: 67/116	Loss: 0.091
Batch: 78/116	Loss: 0.083
Batch: 89/116	Loss: 0.062
Batch: 100/116	Loss: 0.139
Batch: 111/116	Loss: 0.112
Batch: 116/116	Loss: 0.261
Epoch: 20	Train Loss: 0.113	Val F1: 0.332
Best Epoch: 6	Best Val F1: 0.366

****************************** Epoch: 21 ******************************
Batch: 1/116	Loss: 0.179
Batch: 12/116	Loss: 0.062
Batch: 23/116	Loss: 0.093
Batch: 34/116	Loss: 0.123
Batch: 45/116	Loss: 0.113
Batch: 56/116	Loss: 0.071
Batch: 67/116	Loss: 0.025
Batch: 78/116	Loss: 0.143
Batch: 89/116	Loss: 0.200
Batch: 100/116	Loss: 0.088
Batch: 111/116	Loss: 0.040
Batch: 116/116	Loss: 0.127
Epoch: 21	Train Loss: 0.106	Val F1: 0.352
Best Epoch: 6	Best Val F1: 0.366

Saving the best checkpoint....
Inference...
Test F1: 0.376	Test F1_Few: 0.468	Test F1_Zero: 0.357
Starting training with config: {'batch_size': 16, 'epochs': 50, 'l2_reg': 0.0009378963701122296, 'lr': 1.283891385954562e-05, 'n_layers_freeze': 3, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 1.014
Batch: 23/116	Loss: 0.944
Batch: 34/116	Loss: 0.923
Batch: 45/116	Loss: 0.883
Batch: 56/116	Loss: 0.872
Batch: 67/116	Loss: 0.828
Batch: 78/116	Loss: 0.832
Batch: 89/116	Loss: 0.893
Batch: 100/116	Loss: 0.798
Batch: 111/116	Loss: 0.822
Batch: 116/116	Loss: 0.787
Epoch: 1	Train Loss: 0.890	Val F1: 0.180
Best Epoch: 1	Best Val F1: 0.180

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.853
Batch: 12/116	Loss: 0.808
Batch: 23/116	Loss: 0.781
Batch: 34/116	Loss: 0.770
Batch: 45/116	Loss: 0.832
Batch: 56/116	Loss: 0.789
Batch: 67/116	Loss: 0.802
Batch: 78/116	Loss: 0.772
Batch: 89/116	Loss: 0.778
Batch: 100/116	Loss: 0.767
Batch: 111/116	Loss: 0.774
Batch: 116/116	Loss: 0.763
Epoch: 2	Train Loss: 0.789	Val F1: 0.323
Best Epoch: 2	Best Val F1: 0.323

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.710
Batch: 12/116	Loss: 0.678
Batch: 23/116	Loss: 0.693
Batch: 34/116	Loss: 0.764
Batch: 45/116	Loss: 0.769
Batch: 56/116	Loss: 0.760
Batch: 67/116	Loss: 0.739
Batch: 78/116	Loss: 0.699
Batch: 89/116	Loss: 0.707
Batch: 100/116	Loss: 0.861
Batch: 111/116	Loss: 0.896
Batch: 116/116	Loss: 0.627
Epoch: 3	Train Loss: 0.736	Val F1: 0.320
Best Epoch: 2	Best Val F1: 0.323

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.707
Batch: 12/116	Loss: 0.604
Batch: 23/116	Loss: 0.849
Batch: 34/116	Loss: 0.643
Batch: 45/116	Loss: 0.738
Batch: 56/116	Loss: 0.652
Batch: 67/116	Loss: 0.721
Batch: 78/116	Loss: 0.626
Batch: 89/116	Loss: 0.748
Batch: 100/116	Loss: 0.664
Batch: 111/116	Loss: 0.643
Batch: 116/116	Loss: 0.759
Epoch: 4	Train Loss: 0.678	Val F1: 0.318
Best Epoch: 2	Best Val F1: 0.323

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.443
Batch: 12/116	Loss: 0.698
Batch: 23/116	Loss: 0.705
Batch: 34/116	Loss: 0.682
Batch: 45/116	Loss: 0.681
Batch: 56/116	Loss: 0.667
Batch: 67/116	Loss: 0.610
Batch: 78/116	Loss: 0.700
Batch: 89/116	Loss: 0.833
Batch: 100/116	Loss: 0.639
Batch: 111/116	Loss: 0.645
Batch: 116/116	Loss: 0.506
Epoch: 5	Train Loss: 0.634	Val F1: 0.346
Best Epoch: 5	Best Val F1: 0.346

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.555
Batch: 12/116	Loss: 0.926
Batch: 23/116	Loss: 0.781
Batch: 34/116	Loss: 0.597
Batch: 45/116	Loss: 0.513
Batch: 56/116	Loss: 0.633
Batch: 67/116	Loss: 0.606
Batch: 78/116	Loss: 0.737
Batch: 89/116	Loss: 0.840
Batch: 100/116	Loss: 0.664
Batch: 111/116	Loss: 0.700
Batch: 116/116	Loss: 0.302
Epoch: 6	Train Loss: 0.578	Val F1: 0.373
Best Epoch: 6	Best Val F1: 0.373

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.406
Batch: 12/116	Loss: 0.682
Batch: 23/116	Loss: 0.689
Batch: 34/116	Loss: 0.789
Batch: 45/116	Loss: 0.369
Batch: 56/116	Loss: 0.777
Batch: 67/116	Loss: 0.483
Batch: 78/116	Loss: 0.586
Batch: 89/116	Loss: 0.453
Batch: 100/116	Loss: 0.414
Batch: 111/116	Loss: 0.746
Batch: 116/116	Loss: 0.349
Epoch: 7	Train Loss: 0.533	Val F1: 0.352
Best Epoch: 6	Best Val F1: 0.373

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.552
Batch: 12/116	Loss: 0.541
Batch: 23/116	Loss: 0.232
Batch: 34/116	Loss: 0.435
Batch: 45/116	Loss: 0.407
Batch: 56/116	Loss: 0.267
Batch: 67/116	Loss: 0.777
Batch: 78/116	Loss: 0.350
Batch: 89/116	Loss: 0.275
Batch: 100/116	Loss: 0.695
Batch: 111/116	Loss: 0.422
Batch: 116/116	Loss: 0.460
Epoch: 8	Train Loss: 0.489	Val F1: 0.333
Best Epoch: 6	Best Val F1: 0.373

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.442
Batch: 12/116	Loss: 0.497
Batch: 23/116	Loss: 0.390
Batch: 34/116	Loss: 0.328
Batch: 45/116	Loss: 0.391
Batch: 56/116	Loss: 0.414
Batch: 67/116	Loss: 0.326
Batch: 78/116	Loss: 0.420
Batch: 89/116	Loss: 0.339
Batch: 100/116	Loss: 0.430
Batch: 111/116	Loss: 0.386
Batch: 116/116	Loss: 0.466
Epoch: 9	Train Loss: 0.442	Val F1: 0.354
Best Epoch: 6	Best Val F1: 0.373

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.372
Batch: 12/116	Loss: 0.387
Batch: 23/116	Loss: 0.346
Batch: 34/116	Loss: 0.432
Batch: 45/116	Loss: 0.253
Batch: 56/116	Loss: 0.456
Batch: 67/116	Loss: 0.606
Batch: 78/116	Loss: 0.322
Batch: 89/116	Loss: 0.270
Batch: 100/116	Loss: 0.427
Batch: 111/116	Loss: 0.255
Batch: 116/116	Loss: 0.338
Epoch: 10	Train Loss: 0.406	Val F1: 0.341
Best Epoch: 6	Best Val F1: 0.373

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.431
Batch: 12/116	Loss: 0.232
Batch: 23/116	Loss: 0.392
Batch: 34/116	Loss: 0.292
Batch: 45/116	Loss: 0.483
Batch: 56/116	Loss: 0.468
Batch: 67/116	Loss: 0.360
Batch: 78/116	Loss: 0.317
Batch: 89/116	Loss: 0.243
Batch: 100/116	Loss: 0.438
Batch: 111/116	Loss: 0.480
Batch: 116/116	Loss: 0.183
Epoch: 11	Train Loss: 0.373	Val F1: 0.341
Best Epoch: 6	Best Val F1: 0.373

****************************** Epoch: 12 ******************************
Batch: 1/116	Loss: 0.577
Batch: 12/116	Loss: 0.296
Batch: 23/116	Loss: 0.315
Batch: 34/116	Loss: 0.537
Batch: 45/116	Loss: 0.263
Batch: 56/116	Loss: 0.374
Batch: 67/116	Loss: 0.193
Batch: 78/116	Loss: 0.467
Batch: 89/116	Loss: 0.398
Batch: 100/116	Loss: 0.562
Batch: 111/116	Loss: 0.330
Batch: 116/116	Loss: 0.340
Epoch: 12	Train Loss: 0.351	Val F1: 0.340
Best Epoch: 6	Best Val F1: 0.373

****************************** Epoch: 13 ******************************
Batch: 1/116	Loss: 0.286
Batch: 12/116	Loss: 0.241
Batch: 23/116	Loss: 0.361
Batch: 34/116	Loss: 0.165
Batch: 45/116	Loss: 0.565
Batch: 56/116	Loss: 0.322
Batch: 67/116	Loss: 0.188
Batch: 78/116	Loss: 0.419
Batch: 89/116	Loss: 0.341
Batch: 100/116	Loss: 0.336
Batch: 111/116	Loss: 0.326
Batch: 116/116	Loss: 0.191
Epoch: 13	Train Loss: 0.325	Val F1: 0.346
Best Epoch: 6	Best Val F1: 0.373

****************************** Epoch: 14 ******************************
Batch: 1/116	Loss: 0.582
Batch: 12/116	Loss: 0.451
Batch: 23/116	Loss: 0.198
Batch: 34/116	Loss: 0.200
Batch: 45/116	Loss: 0.404
Batch: 56/116	Loss: 0.314
Batch: 67/116	Loss: 0.445
Batch: 78/116	Loss: 0.429
Batch: 89/116	Loss: 0.219
Batch: 100/116	Loss: 0.323
Batch: 111/116	Loss: 0.224
Batch: 116/116	Loss: 0.425
Epoch: 14	Train Loss: 0.293	Val F1: 0.340
Best Epoch: 6	Best Val F1: 0.373

****************************** Epoch: 15 ******************************
Batch: 1/116	Loss: 0.185
Batch: 12/116	Loss: 0.462
Batch: 23/116	Loss: 0.169
Batch: 34/116	Loss: 0.289
Batch: 45/116	Loss: 0.320
Batch: 56/116	Loss: 0.352
Batch: 67/116	Loss: 0.316
Batch: 78/116	Loss: 0.214
Batch: 89/116	Loss: 0.333
Batch: 100/116	Loss: 0.430
Batch: 111/116	Loss: 0.234
Batch: 116/116	Loss: 0.075
Epoch: 15	Train Loss: 0.277	Val F1: 0.340
Best Epoch: 6	Best Val F1: 0.373

****************************** Epoch: 16 ******************************
Batch: 1/116	Loss: 0.364
Batch: 12/116	Loss: 0.085
Batch: 23/116	Loss: 0.245
Batch: 34/116	Loss: 0.170
Batch: 45/116	Loss: 0.126
Batch: 56/116	Loss: 0.279
Batch: 67/116	Loss: 0.246
Batch: 78/116	Loss: 0.253
Batch: 89/116	Loss: 0.345
Batch: 100/116	Loss: 0.230
Batch: 111/116	Loss: 0.129
Batch: 116/116	Loss: 0.325
Epoch: 16	Train Loss: 0.249	Val F1: 0.343
Best Epoch: 6	Best Val F1: 0.373

****************************** Epoch: 17 ******************************
Batch: 1/116	Loss: 0.172
Batch: 12/116	Loss: 0.202
Batch: 23/116	Loss: 0.248
Batch: 34/116	Loss: 0.136
Batch: 45/116	Loss: 0.203
Batch: 56/116	Loss: 0.192
Batch: 67/116	Loss: 0.259
Batch: 78/116	Loss: 0.173
Batch: 89/116	Loss: 0.472
Batch: 100/116	Loss: 0.092
Batch: 111/116	Loss: 0.265
Batch: 116/116	Loss: 0.501
Epoch: 17	Train Loss: 0.220	Val F1: 0.336
Best Epoch: 6	Best Val F1: 0.373

****************************** Epoch: 18 ******************************
Batch: 1/116	Loss: 0.237
Batch: 12/116	Loss: 0.124
Batch: 23/116	Loss: 0.195
Batch: 34/116	Loss: 0.262
Batch: 45/116	Loss: 0.064
Batch: 56/116	Loss: 0.267
Batch: 67/116	Loss: 0.220
Batch: 78/116	Loss: 0.245
Batch: 89/116	Loss: 0.193
Batch: 100/116	Loss: 0.284
Batch: 111/116	Loss: 0.035
Batch: 116/116	Loss: 0.360
Epoch: 18	Train Loss: 0.200	Val F1: 0.344
Best Epoch: 6	Best Val F1: 0.373

****************************** Epoch: 19 ******************************
Batch: 1/116	Loss: 0.136
Batch: 12/116	Loss: 0.134
Batch: 23/116	Loss: 0.081
Batch: 34/116	Loss: 0.161
Batch: 45/116	Loss: 0.109
Batch: 56/116	Loss: 0.203
Batch: 67/116	Loss: 0.175
Batch: 78/116	Loss: 0.186
Batch: 89/116	Loss: 0.177
Batch: 100/116	Loss: 0.299
Batch: 111/116	Loss: 0.105
Batch: 116/116	Loss: 0.153
Epoch: 19	Train Loss: 0.180	Val F1: 0.340
Best Epoch: 6	Best Val F1: 0.373

****************************** Epoch: 20 ******************************
Batch: 1/116	Loss: 0.168
Batch: 12/116	Loss: 0.212
Batch: 23/116	Loss: 0.127
Batch: 34/116	Loss: 0.091
Batch: 45/116	Loss: 0.147
Batch: 56/116	Loss: 0.397
Batch: 67/116	Loss: 0.129
Batch: 78/116	Loss: 0.128
Batch: 89/116	Loss: 0.177
Batch: 100/116	Loss: 0.121
Batch: 111/116	Loss: 0.136
Batch: 116/116	Loss: 0.375
Epoch: 20	Train Loss: 0.161	Val F1: 0.329
Best Epoch: 6	Best Val F1: 0.373

****************************** Epoch: 21 ******************************
Batch: 1/116	Loss: 0.191
Batch: 12/116	Loss: 0.079
Batch: 23/116	Loss: 0.110
Batch: 34/116	Loss: 0.143
Batch: 45/116	Loss: 0.133
Batch: 56/116	Loss: 0.074
Batch: 67/116	Loss: 0.041
Batch: 78/116	Loss: 0.162
Batch: 89/116	Loss: 0.145
Batch: 100/116	Loss: 0.231
Batch: 111/116	Loss: 0.048
Batch: 116/116	Loss: 0.150
Epoch: 21	Train Loss: 0.141	Val F1: 0.338
Best Epoch: 6	Best Val F1: 0.373

Saving the best checkpoint....
Inference...
Test F1: 0.374	Test F1_Few: 0.449	Test F1_Zero: 0.371
Starting training with config: {'batch_size': 64, 'epochs': 25, 'l2_reg': 0.0009725119709241723, 'lr': 1.997589052280528e-05, 'n_layers_freeze': 1, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.067
Batch: 5/29	Loss: 1.032
Batch: 7/29	Loss: 1.009
Batch: 9/29	Loss: 0.982
Batch: 11/29	Loss: 0.967
Batch: 13/29	Loss: 0.953
Batch: 15/29	Loss: 0.959
Batch: 17/29	Loss: 0.918
Batch: 19/29	Loss: 0.917
Batch: 21/29	Loss: 0.895
Batch: 23/29	Loss: 0.903
Batch: 25/29	Loss: 0.870
Batch: 27/29	Loss: 0.867
Batch: 29/29	Loss: 0.875
Epoch: 1	Train Loss: 0.952	Val F1: 0.186
Best Epoch: 1	Best Val F1: 0.186

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.866
Batch: 3/29	Loss: 0.864
Batch: 5/29	Loss: 0.894
Batch: 7/29	Loss: 0.852
Batch: 9/29	Loss: 0.867
Batch: 11/29	Loss: 0.823
Batch: 13/29	Loss: 0.824
Batch: 15/29	Loss: 0.846
Batch: 17/29	Loss: 0.835
Batch: 19/29	Loss: 0.868
Batch: 21/29	Loss: 0.820
Batch: 23/29	Loss: 0.828
Batch: 25/29	Loss: 0.805
Batch: 27/29	Loss: 0.865
Batch: 29/29	Loss: 0.808
Epoch: 2	Train Loss: 0.840	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.186

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.797
Batch: 3/29	Loss: 0.818
Batch: 5/29	Loss: 0.805
Batch: 7/29	Loss: 0.837
Batch: 9/29	Loss: 0.787
Batch: 11/29	Loss: 0.787
Batch: 13/29	Loss: 0.828
Batch: 15/29	Loss: 0.797
Batch: 17/29	Loss: 0.813
Batch: 19/29	Loss: 0.806
Batch: 21/29	Loss: 0.782
Batch: 23/29	Loss: 0.774
Batch: 25/29	Loss: 0.795
Batch: 27/29	Loss: 0.766
Batch: 29/29	Loss: 0.779
Epoch: 3	Train Loss: 0.800	Val F1: 0.278
Best Epoch: 3	Best Val F1: 0.278

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.757
Batch: 3/29	Loss: 0.768
Batch: 5/29	Loss: 0.744
Batch: 7/29	Loss: 0.810
Batch: 9/29	Loss: 0.784
Batch: 11/29	Loss: 0.720
Batch: 13/29	Loss: 0.742
Batch: 15/29	Loss: 0.731
Batch: 17/29	Loss: 0.725
Batch: 19/29	Loss: 0.764
Batch: 21/29	Loss: 0.750
Batch: 23/29	Loss: 0.748
Batch: 25/29	Loss: 0.729
Batch: 27/29	Loss: 0.759
Batch: 29/29	Loss: 0.742
Epoch: 4	Train Loss: 0.758	Val F1: 0.254
Best Epoch: 3	Best Val F1: 0.278

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.723
Batch: 3/29	Loss: 0.731
Batch: 5/29	Loss: 0.683
Batch: 7/29	Loss: 0.717
Batch: 9/29	Loss: 0.709
Batch: 11/29	Loss: 0.691
Batch: 13/29	Loss: 0.666
Batch: 15/29	Loss: 0.723
Batch: 17/29	Loss: 0.770
Batch: 19/29	Loss: 0.731
Batch: 21/29	Loss: 0.684
Batch: 23/29	Loss: 0.742
Batch: 25/29	Loss: 0.714
Batch: 27/29	Loss: 0.685
Batch: 29/29	Loss: 0.723
Epoch: 5	Train Loss: 0.722	Val F1: 0.342
Best Epoch: 5	Best Val F1: 0.342

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.701
Batch: 3/29	Loss: 0.755
Batch: 5/29	Loss: 0.612
Batch: 7/29	Loss: 0.757
Batch: 9/29	Loss: 0.674
Batch: 11/29	Loss: 0.640
Batch: 13/29	Loss: 0.756
Batch: 15/29	Loss: 0.605
Batch: 17/29	Loss: 0.665
Batch: 19/29	Loss: 0.615
Batch: 21/29	Loss: 0.730
Batch: 23/29	Loss: 0.681
Batch: 25/29	Loss: 0.709
Batch: 27/29	Loss: 0.671
Batch: 29/29	Loss: 0.647
Epoch: 6	Train Loss: 0.681	Val F1: 0.343
Best Epoch: 6	Best Val F1: 0.343

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.612
Batch: 3/29	Loss: 0.690
Batch: 5/29	Loss: 0.779
Batch: 7/29	Loss: 0.684
Batch: 9/29	Loss: 0.685
Batch: 11/29	Loss: 0.613
Batch: 13/29	Loss: 0.634
Batch: 15/29	Loss: 0.653
Batch: 17/29	Loss: 0.666
Batch: 19/29	Loss: 0.672
Batch: 21/29	Loss: 0.621
Batch: 23/29	Loss: 0.578
Batch: 25/29	Loss: 0.563
Batch: 27/29	Loss: 0.600
Batch: 29/29	Loss: 0.572
Epoch: 7	Train Loss: 0.639	Val F1: 0.338
Best Epoch: 6	Best Val F1: 0.343

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.610
Batch: 3/29	Loss: 0.582
Batch: 5/29	Loss: 0.630
Batch: 7/29	Loss: 0.604
Batch: 9/29	Loss: 0.613
Batch: 11/29	Loss: 0.623
Batch: 13/29	Loss: 0.654
Batch: 15/29	Loss: 0.564
Batch: 17/29	Loss: 0.638
Batch: 19/29	Loss: 0.585
Batch: 21/29	Loss: 0.580
Batch: 23/29	Loss: 0.646
Batch: 25/29	Loss: 0.703
Batch: 27/29	Loss: 0.601
Batch: 29/29	Loss: 0.595
Epoch: 8	Train Loss: 0.599	Val F1: 0.331
Best Epoch: 6	Best Val F1: 0.343

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.607
Batch: 3/29	Loss: 0.563
Batch: 5/29	Loss: 0.567
Batch: 7/29	Loss: 0.486
Batch: 9/29	Loss: 0.591
Batch: 11/29	Loss: 0.542
Batch: 13/29	Loss: 0.580
Batch: 15/29	Loss: 0.531
Batch: 17/29	Loss: 0.506
Batch: 19/29	Loss: 0.559
Batch: 21/29	Loss: 0.673
Batch: 23/29	Loss: 0.561
Batch: 25/29	Loss: 0.520
Batch: 27/29	Loss: 0.517
Batch: 29/29	Loss: 0.495
Epoch: 9	Train Loss: 0.557	Val F1: 0.332
Best Epoch: 6	Best Val F1: 0.343

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.461
Batch: 3/29	Loss: 0.542
Batch: 5/29	Loss: 0.483
Batch: 7/29	Loss: 0.536
Batch: 9/29	Loss: 0.531
Batch: 11/29	Loss: 0.427
Batch: 13/29	Loss: 0.587
Batch: 15/29	Loss: 0.511
Batch: 17/29	Loss: 0.597
Batch: 19/29	Loss: 0.349
Batch: 21/29	Loss: 0.586
Batch: 23/29	Loss: 0.573
Batch: 25/29	Loss: 0.551
Batch: 27/29	Loss: 0.462
Batch: 29/29	Loss: 0.575
Epoch: 10	Train Loss: 0.509	Val F1: 0.358
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.476
Batch: 3/29	Loss: 0.401
Batch: 5/29	Loss: 0.593
Batch: 7/29	Loss: 0.464
Batch: 9/29	Loss: 0.468
Batch: 11/29	Loss: 0.423
Batch: 13/29	Loss: 0.435
Batch: 15/29	Loss: 0.359
Batch: 17/29	Loss: 0.540
Batch: 19/29	Loss: 0.495
Batch: 21/29	Loss: 0.398
Batch: 23/29	Loss: 0.393
Batch: 25/29	Loss: 0.397
Batch: 27/29	Loss: 0.402
Batch: 29/29	Loss: 0.451
Epoch: 11	Train Loss: 0.455	Val F1: 0.347
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.497
Batch: 3/29	Loss: 0.386
Batch: 5/29	Loss: 0.383
Batch: 7/29	Loss: 0.423
Batch: 9/29	Loss: 0.451
Batch: 11/29	Loss: 0.435
Batch: 13/29	Loss: 0.425
Batch: 15/29	Loss: 0.371
Batch: 17/29	Loss: 0.420
Batch: 19/29	Loss: 0.389
Batch: 21/29	Loss: 0.374
Batch: 23/29	Loss: 0.455
Batch: 25/29	Loss: 0.427
Batch: 27/29	Loss: 0.542
Batch: 29/29	Loss: 0.349
Epoch: 12	Train Loss: 0.416	Val F1: 0.335
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.453
Batch: 3/29	Loss: 0.323
Batch: 5/29	Loss: 0.452
Batch: 7/29	Loss: 0.338
Batch: 9/29	Loss: 0.412
Batch: 11/29	Loss: 0.397
Batch: 13/29	Loss: 0.407
Batch: 15/29	Loss: 0.356
Batch: 17/29	Loss: 0.351
Batch: 19/29	Loss: 0.236
Batch: 21/29	Loss: 0.357
Batch: 23/29	Loss: 0.391
Batch: 25/29	Loss: 0.282
Batch: 27/29	Loss: 0.442
Batch: 29/29	Loss: 0.460
Epoch: 13	Train Loss: 0.388	Val F1: 0.341
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.409
Batch: 3/29	Loss: 0.390
Batch: 5/29	Loss: 0.293
Batch: 7/29	Loss: 0.385
Batch: 9/29	Loss: 0.399
Batch: 11/29	Loss: 0.380
Batch: 13/29	Loss: 0.361
Batch: 15/29	Loss: 0.306
Batch: 17/29	Loss: 0.418
Batch: 19/29	Loss: 0.420
Batch: 21/29	Loss: 0.261
Batch: 23/29	Loss: 0.294
Batch: 25/29	Loss: 0.363
Batch: 27/29	Loss: 0.380
Batch: 29/29	Loss: 0.358
Epoch: 14	Train Loss: 0.367	Val F1: 0.347
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.318
Batch: 3/29	Loss: 0.343
Batch: 5/29	Loss: 0.253
Batch: 7/29	Loss: 0.336
Batch: 9/29	Loss: 0.392
Batch: 11/29	Loss: 0.344
Batch: 13/29	Loss: 0.331
Batch: 15/29	Loss: 0.313
Batch: 17/29	Loss: 0.406
Batch: 19/29	Loss: 0.322
Batch: 21/29	Loss: 0.375
Batch: 23/29	Loss: 0.361
Batch: 25/29	Loss: 0.402
Batch: 27/29	Loss: 0.308
Batch: 29/29	Loss: 0.458
Epoch: 15	Train Loss: 0.349	Val F1: 0.349
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.375
Batch: 3/29	Loss: 0.357
Batch: 5/29	Loss: 0.380
Batch: 7/29	Loss: 0.300
Batch: 9/29	Loss: 0.319
Batch: 11/29	Loss: 0.304
Batch: 13/29	Loss: 0.304
Batch: 15/29	Loss: 0.261
Batch: 17/29	Loss: 0.313
Batch: 19/29	Loss: 0.355
Batch: 21/29	Loss: 0.280
Batch: 23/29	Loss: 0.345
Batch: 25/29	Loss: 0.334
Batch: 27/29	Loss: 0.304
Batch: 29/29	Loss: 0.334
Epoch: 16	Train Loss: 0.327	Val F1: 0.342
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.276
Batch: 3/29	Loss: 0.366
Batch: 5/29	Loss: 0.323
Batch: 7/29	Loss: 0.322
Batch: 9/29	Loss: 0.221
Batch: 11/29	Loss: 0.375
Batch: 13/29	Loss: 0.367
Batch: 15/29	Loss: 0.359
Batch: 17/29	Loss: 0.363
Batch: 19/29	Loss: 0.288
Batch: 21/29	Loss: 0.351
Batch: 23/29	Loss: 0.443
Batch: 25/29	Loss: 0.188
Batch: 27/29	Loss: 0.360
Batch: 29/29	Loss: 0.408
Epoch: 17	Train Loss: 0.326	Val F1: 0.342
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.347
Batch: 3/29	Loss: 0.371
Batch: 5/29	Loss: 0.348
Batch: 7/29	Loss: 0.272
Batch: 9/29	Loss: 0.407
Batch: 11/29	Loss: 0.237
Batch: 13/29	Loss: 0.242
Batch: 15/29	Loss: 0.296
Batch: 17/29	Loss: 0.275
Batch: 19/29	Loss: 0.226
Batch: 21/29	Loss: 0.335
Batch: 23/29	Loss: 0.347
Batch: 25/29	Loss: 0.312
Batch: 27/29	Loss: 0.243
Batch: 29/29	Loss: 0.330
Epoch: 18	Train Loss: 0.302	Val F1: 0.355
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.209
Batch: 3/29	Loss: 0.222
Batch: 5/29	Loss: 0.314
Batch: 7/29	Loss: 0.304
Batch: 9/29	Loss: 0.227
Batch: 11/29	Loss: 0.356
Batch: 13/29	Loss: 0.365
Batch: 15/29	Loss: 0.263
Batch: 17/29	Loss: 0.244
Batch: 19/29	Loss: 0.344
Batch: 21/29	Loss: 0.256
Batch: 23/29	Loss: 0.285
Batch: 25/29	Loss: 0.320
Batch: 27/29	Loss: 0.219
Batch: 29/29	Loss: 0.246
Epoch: 19	Train Loss: 0.283	Val F1: 0.353
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.297
Batch: 3/29	Loss: 0.274
Batch: 5/29	Loss: 0.241
Batch: 7/29	Loss: 0.211
Batch: 9/29	Loss: 0.279
Batch: 11/29	Loss: 0.300
Batch: 13/29	Loss: 0.287
Batch: 15/29	Loss: 0.270
Batch: 17/29	Loss: 0.324
Batch: 19/29	Loss: 0.232
Batch: 21/29	Loss: 0.217
Batch: 23/29	Loss: 0.276
Batch: 25/29	Loss: 0.267
Batch: 27/29	Loss: 0.263
Batch: 29/29	Loss: 0.344
Epoch: 20	Train Loss: 0.264	Val F1: 0.353
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.239
Batch: 3/29	Loss: 0.189
Batch: 5/29	Loss: 0.245
Batch: 7/29	Loss: 0.420
Batch: 9/29	Loss: 0.222
Batch: 11/29	Loss: 0.199
Batch: 13/29	Loss: 0.295
Batch: 15/29	Loss: 0.282
Batch: 17/29	Loss: 0.220
Batch: 19/29	Loss: 0.214
Batch: 21/29	Loss: 0.265
Batch: 23/29	Loss: 0.221
Batch: 25/29	Loss: 0.255
Batch: 27/29	Loss: 0.234
Batch: 29/29	Loss: 0.277
Epoch: 21	Train Loss: 0.248	Val F1: 0.352
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.204
Batch: 3/29	Loss: 0.232
Batch: 5/29	Loss: 0.241
Batch: 7/29	Loss: 0.284
Batch: 9/29	Loss: 0.251
Batch: 11/29	Loss: 0.258
Batch: 13/29	Loss: 0.181
Batch: 15/29	Loss: 0.202
Batch: 17/29	Loss: 0.272
Batch: 19/29	Loss: 0.276
Batch: 21/29	Loss: 0.247
Batch: 23/29	Loss: 0.221
Batch: 25/29	Loss: 0.245
Batch: 27/29	Loss: 0.195
Batch: 29/29	Loss: 0.234
Epoch: 22	Train Loss: 0.228	Val F1: 0.345
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.180
Batch: 3/29	Loss: 0.185
Batch: 5/29	Loss: 0.230
Batch: 7/29	Loss: 0.268
Batch: 9/29	Loss: 0.216
Batch: 11/29	Loss: 0.186
Batch: 13/29	Loss: 0.178
Batch: 15/29	Loss: 0.235
Batch: 17/29	Loss: 0.270
Batch: 19/29	Loss: 0.264
Batch: 21/29	Loss: 0.197
Batch: 23/29	Loss: 0.162
Batch: 25/29	Loss: 0.202
Batch: 27/29	Loss: 0.134
Batch: 29/29	Loss: 0.171
Epoch: 23	Train Loss: 0.204	Val F1: 0.360
Best Epoch: 23	Best Val F1: 0.360

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.134
Batch: 3/29	Loss: 0.128
Batch: 5/29	Loss: 0.240
Batch: 7/29	Loss: 0.217
Batch: 9/29	Loss: 0.185
Batch: 11/29	Loss: 0.234
Batch: 13/29	Loss: 0.165
Batch: 15/29	Loss: 0.196
Batch: 17/29	Loss: 0.286
Batch: 19/29	Loss: 0.184
Batch: 21/29	Loss: 0.207
Batch: 23/29	Loss: 0.186
Batch: 25/29	Loss: 0.213
Batch: 27/29	Loss: 0.208
Batch: 29/29	Loss: 0.205
Epoch: 24	Train Loss: 0.191	Val F1: 0.345
Best Epoch: 23	Best Val F1: 0.360

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.189
Batch: 3/29	Loss: 0.195
Batch: 5/29	Loss: 0.184
Batch: 7/29	Loss: 0.264
Batch: 9/29	Loss: 0.241
Batch: 11/29	Loss: 0.154
Batch: 13/29	Loss: 0.245
Batch: 15/29	Loss: 0.201
Batch: 17/29	Loss: 0.206
Batch: 19/29	Loss: 0.152
Batch: 21/29	Loss: 0.171
Batch: 23/29	Loss: 0.147
Batch: 25/29	Loss: 0.178
Batch: 27/29	Loss: 0.172
Batch: 29/29	Loss: 0.140
Epoch: 25	Train Loss: 0.180	Val F1: 0.349
Best Epoch: 23	Best Val F1: 0.360

Saving the best checkpoint....
Inference...
Test F1: 0.368	Test F1_Few: 0.450	Test F1_Zero: 0.354
Starting training with config: {'batch_size': 32, 'epochs': 50, 'l2_reg': 0.0009197965999648724, 'lr': 2.287621364227534e-05, 'n_layers_freeze': 0, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 1.023
Batch: 11/58	Loss: 0.953
Batch: 16/58	Loss: 0.888
Batch: 21/58	Loss: 0.900
Batch: 26/58	Loss: 0.890
Batch: 31/58	Loss: 0.857
Batch: 36/58	Loss: 0.884
Batch: 41/58	Loss: 0.830
Batch: 46/58	Loss: 0.811
Batch: 51/58	Loss: 0.798
Batch: 56/58	Loss: 0.805
Batch: 58/58	Loss: 0.812
Epoch: 1	Train Loss: 0.894	Val F1: 0.201
Best Epoch: 1	Best Val F1: 0.201

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.821
Batch: 6/58	Loss: 0.830
Batch: 11/58	Loss: 0.831
Batch: 16/58	Loss: 0.762
Batch: 21/58	Loss: 0.764
Batch: 26/58	Loss: 0.759
Batch: 31/58	Loss: 0.817
Batch: 36/58	Loss: 0.798
Batch: 41/58	Loss: 0.718
Batch: 46/58	Loss: 0.725
Batch: 51/58	Loss: 0.763
Batch: 56/58	Loss: 0.731
Batch: 58/58	Loss: 0.709
Epoch: 2	Train Loss: 0.778	Val F1: 0.322
Best Epoch: 2	Best Val F1: 0.322

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.704
Batch: 6/58	Loss: 0.673
Batch: 11/58	Loss: 0.737
Batch: 16/58	Loss: 0.676
Batch: 21/58	Loss: 0.709
Batch: 26/58	Loss: 0.669
Batch: 31/58	Loss: 0.896
Batch: 36/58	Loss: 0.760
Batch: 41/58	Loss: 0.619
Batch: 46/58	Loss: 0.714
Batch: 51/58	Loss: 0.736
Batch: 56/58	Loss: 0.727
Batch: 58/58	Loss: 0.736
Epoch: 3	Train Loss: 0.716	Val F1: 0.331
Best Epoch: 3	Best Val F1: 0.331

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.716
Batch: 6/58	Loss: 0.662
Batch: 11/58	Loss: 0.627
Batch: 16/58	Loss: 0.601
Batch: 21/58	Loss: 0.620
Batch: 26/58	Loss: 0.620
Batch: 31/58	Loss: 0.577
Batch: 36/58	Loss: 0.705
Batch: 41/58	Loss: 0.724
Batch: 46/58	Loss: 0.653
Batch: 51/58	Loss: 0.578
Batch: 56/58	Loss: 0.527
Batch: 58/58	Loss: 0.570
Epoch: 4	Train Loss: 0.661	Val F1: 0.329
Best Epoch: 3	Best Val F1: 0.331

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.522
Batch: 6/58	Loss: 0.560
Batch: 11/58	Loss: 0.622
Batch: 16/58	Loss: 0.650
Batch: 21/58	Loss: 0.487
Batch: 26/58	Loss: 0.472
Batch: 31/58	Loss: 0.779
Batch: 36/58	Loss: 0.649
Batch: 41/58	Loss: 0.536
Batch: 46/58	Loss: 0.612
Batch: 51/58	Loss: 0.790
Batch: 56/58	Loss: 0.670
Batch: 58/58	Loss: 0.823
Epoch: 5	Train Loss: 0.619	Val F1: 0.359
Best Epoch: 5	Best Val F1: 0.359

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.524
Batch: 6/58	Loss: 0.680
Batch: 11/58	Loss: 0.590
Batch: 16/58	Loss: 0.627
Batch: 21/58	Loss: 0.621
Batch: 26/58	Loss: 0.402
Batch: 31/58	Loss: 0.489
Batch: 36/58	Loss: 0.459
Batch: 41/58	Loss: 0.578
Batch: 46/58	Loss: 0.520
Batch: 51/58	Loss: 0.508
Batch: 56/58	Loss: 0.585
Batch: 58/58	Loss: 0.446
Epoch: 6	Train Loss: 0.554	Val F1: 0.359
Best Epoch: 5	Best Val F1: 0.359

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.375
Batch: 6/58	Loss: 0.589
Batch: 11/58	Loss: 0.581
Batch: 16/58	Loss: 0.390
Batch: 21/58	Loss: 0.413
Batch: 26/58	Loss: 0.558
Batch: 31/58	Loss: 0.443
Batch: 36/58	Loss: 0.359
Batch: 41/58	Loss: 0.522
Batch: 46/58	Loss: 0.388
Batch: 51/58	Loss: 0.434
Batch: 56/58	Loss: 0.511
Batch: 58/58	Loss: 0.334
Epoch: 7	Train Loss: 0.475	Val F1: 0.354
Best Epoch: 5	Best Val F1: 0.359

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.442
Batch: 6/58	Loss: 0.360
Batch: 11/58	Loss: 0.377
Batch: 16/58	Loss: 0.382
Batch: 21/58	Loss: 0.443
Batch: 26/58	Loss: 0.390
Batch: 31/58	Loss: 0.415
Batch: 36/58	Loss: 0.358
Batch: 41/58	Loss: 0.502
Batch: 46/58	Loss: 0.428
Batch: 51/58	Loss: 0.344
Batch: 56/58	Loss: 0.366
Batch: 58/58	Loss: 0.566
Epoch: 8	Train Loss: 0.430	Val F1: 0.352
Best Epoch: 5	Best Val F1: 0.359

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.422
Batch: 6/58	Loss: 0.611
Batch: 11/58	Loss: 0.486
Batch: 16/58	Loss: 0.317
Batch: 21/58	Loss: 0.362
Batch: 26/58	Loss: 0.293
Batch: 31/58	Loss: 0.313
Batch: 36/58	Loss: 0.385
Batch: 41/58	Loss: 0.422
Batch: 46/58	Loss: 0.352
Batch: 51/58	Loss: 0.399
Batch: 56/58	Loss: 0.256
Batch: 58/58	Loss: 0.342
Epoch: 9	Train Loss: 0.387	Val F1: 0.361
Best Epoch: 9	Best Val F1: 0.361

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.330
Batch: 6/58	Loss: 0.346
Batch: 11/58	Loss: 0.388
Batch: 16/58	Loss: 0.433
Batch: 21/58	Loss: 0.279
Batch: 26/58	Loss: 0.412
Batch: 31/58	Loss: 0.261
Batch: 36/58	Loss: 0.583
Batch: 41/58	Loss: 0.444
Batch: 46/58	Loss: 0.404
Batch: 51/58	Loss: 0.296
Batch: 56/58	Loss: 0.304
Batch: 58/58	Loss: 0.406
Epoch: 10	Train Loss: 0.352	Val F1: 0.354
Best Epoch: 9	Best Val F1: 0.361

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.333
Batch: 6/58	Loss: 0.277
Batch: 11/58	Loss: 0.259
Batch: 16/58	Loss: 0.312
Batch: 21/58	Loss: 0.347
Batch: 26/58	Loss: 0.433
Batch: 31/58	Loss: 0.361
Batch: 36/58	Loss: 0.353
Batch: 41/58	Loss: 0.226
Batch: 46/58	Loss: 0.306
Batch: 51/58	Loss: 0.344
Batch: 56/58	Loss: 0.354
Batch: 58/58	Loss: 0.409
Epoch: 11	Train Loss: 0.324	Val F1: 0.354
Best Epoch: 9	Best Val F1: 0.361

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.345
Batch: 6/58	Loss: 0.242
Batch: 11/58	Loss: 0.292
Batch: 16/58	Loss: 0.252
Batch: 21/58	Loss: 0.377
Batch: 26/58	Loss: 0.287
Batch: 31/58	Loss: 0.344
Batch: 36/58	Loss: 0.284
Batch: 41/58	Loss: 0.280
Batch: 46/58	Loss: 0.321
Batch: 51/58	Loss: 0.323
Batch: 56/58	Loss: 0.214
Batch: 58/58	Loss: 0.156
Epoch: 12	Train Loss: 0.298	Val F1: 0.351
Best Epoch: 9	Best Val F1: 0.361

****************************** Epoch: 13 ******************************
Batch: 1/58	Loss: 0.345
Batch: 6/58	Loss: 0.225
Batch: 11/58	Loss: 0.300
Batch: 16/58	Loss: 0.294
Batch: 21/58	Loss: 0.241
Batch: 26/58	Loss: 0.269
Batch: 31/58	Loss: 0.246
Batch: 36/58	Loss: 0.296
Batch: 41/58	Loss: 0.256
Batch: 46/58	Loss: 0.277
Batch: 51/58	Loss: 0.208
Batch: 56/58	Loss: 0.369
Batch: 58/58	Loss: 0.158
Epoch: 13	Train Loss: 0.287	Val F1: 0.333
Best Epoch: 9	Best Val F1: 0.361

****************************** Epoch: 14 ******************************
Batch: 1/58	Loss: 0.348
Batch: 6/58	Loss: 0.364
Batch: 11/58	Loss: 0.287
Batch: 16/58	Loss: 0.294
Batch: 21/58	Loss: 0.231
Batch: 26/58	Loss: 0.282
Batch: 31/58	Loss: 0.256
Batch: 36/58	Loss: 0.217
Batch: 41/58	Loss: 0.130
Batch: 46/58	Loss: 0.261
Batch: 51/58	Loss: 0.316
Batch: 56/58	Loss: 0.194
Batch: 58/58	Loss: 0.346
Epoch: 14	Train Loss: 0.261	Val F1: 0.351
Best Epoch: 9	Best Val F1: 0.361

****************************** Epoch: 15 ******************************
Batch: 1/58	Loss: 0.216
Batch: 6/58	Loss: 0.280
Batch: 11/58	Loss: 0.215
Batch: 16/58	Loss: 0.213
Batch: 21/58	Loss: 0.296
Batch: 26/58	Loss: 0.197
Batch: 31/58	Loss: 0.206
Batch: 36/58	Loss: 0.240
Batch: 41/58	Loss: 0.262
Batch: 46/58	Loss: 0.145
Batch: 51/58	Loss: 0.198
Batch: 56/58	Loss: 0.189
Batch: 58/58	Loss: 0.310
Epoch: 15	Train Loss: 0.235	Val F1: 0.337
Best Epoch: 9	Best Val F1: 0.361

****************************** Epoch: 16 ******************************
Batch: 1/58	Loss: 0.213
Batch: 6/58	Loss: 0.121
Batch: 11/58	Loss: 0.136
Batch: 16/58	Loss: 0.172
Batch: 21/58	Loss: 0.199
Batch: 26/58	Loss: 0.173
Batch: 31/58	Loss: 0.159
Batch: 36/58	Loss: 0.149
Batch: 41/58	Loss: 0.142
Batch: 46/58	Loss: 0.171
Batch: 51/58	Loss: 0.231
Batch: 56/58	Loss: 0.122
Batch: 58/58	Loss: 0.206
Epoch: 16	Train Loss: 0.213	Val F1: 0.348
Best Epoch: 9	Best Val F1: 0.361

****************************** Epoch: 17 ******************************
Batch: 1/58	Loss: 0.173
Batch: 6/58	Loss: 0.231
Batch: 11/58	Loss: 0.190
Batch: 16/58	Loss: 0.238
Batch: 21/58	Loss: 0.163
Batch: 26/58	Loss: 0.259
Batch: 31/58	Loss: 0.192
Batch: 36/58	Loss: 0.207
Batch: 41/58	Loss: 0.192
Batch: 46/58	Loss: 0.310
Batch: 51/58	Loss: 0.236
Batch: 56/58	Loss: 0.183
Batch: 58/58	Loss: 0.288
Epoch: 17	Train Loss: 0.196	Val F1: 0.363
Best Epoch: 17	Best Val F1: 0.363

****************************** Epoch: 18 ******************************
Batch: 1/58	Loss: 0.269
Batch: 6/58	Loss: 0.196
Batch: 11/58	Loss: 0.197
Batch: 16/58	Loss: 0.243
Batch: 21/58	Loss: 0.221
Batch: 26/58	Loss: 0.209
Batch: 31/58	Loss: 0.134
Batch: 36/58	Loss: 0.139
Batch: 41/58	Loss: 0.088
Batch: 46/58	Loss: 0.146
Batch: 51/58	Loss: 0.107
Batch: 56/58	Loss: 0.275
Batch: 58/58	Loss: 0.214
Epoch: 18	Train Loss: 0.174	Val F1: 0.359
Best Epoch: 17	Best Val F1: 0.363

****************************** Epoch: 19 ******************************
Batch: 1/58	Loss: 0.180
Batch: 6/58	Loss: 0.255
Batch: 11/58	Loss: 0.165
Batch: 16/58	Loss: 0.057
Batch: 21/58	Loss: 0.146
Batch: 26/58	Loss: 0.133
Batch: 31/58	Loss: 0.067
Batch: 36/58	Loss: 0.080
Batch: 41/58	Loss: 0.089
Batch: 46/58	Loss: 0.102
Batch: 51/58	Loss: 0.148
Batch: 56/58	Loss: 0.130
Batch: 58/58	Loss: 0.084
Epoch: 19	Train Loss: 0.130	Val F1: 0.354
Best Epoch: 17	Best Val F1: 0.363

****************************** Epoch: 20 ******************************
Batch: 1/58	Loss: 0.093
Batch: 6/58	Loss: 0.092
Batch: 11/58	Loss: 0.065
Batch: 16/58	Loss: 0.101
Batch: 21/58	Loss: 0.073
Batch: 26/58	Loss: 0.127
Batch: 31/58	Loss: 0.154
Batch: 36/58	Loss: 0.095
Batch: 41/58	Loss: 0.076
Batch: 46/58	Loss: 0.148
Batch: 51/58	Loss: 0.081
Batch: 56/58	Loss: 0.055
Batch: 58/58	Loss: 0.200
Epoch: 20	Train Loss: 0.118	Val F1: 0.369
Best Epoch: 20	Best Val F1: 0.369

****************************** Epoch: 21 ******************************
Batch: 1/58	Loss: 0.130
Batch: 6/58	Loss: 0.101
Batch: 11/58	Loss: 0.059
Batch: 16/58	Loss: 0.126
Batch: 21/58	Loss: 0.055
Batch: 26/58	Loss: 0.140
Batch: 31/58	Loss: 0.043
Batch: 36/58	Loss: 0.152
Batch: 41/58	Loss: 0.078
Batch: 46/58	Loss: 0.065
Batch: 51/58	Loss: 0.098
Batch: 56/58	Loss: 0.062
Batch: 58/58	Loss: 0.056
Epoch: 21	Train Loss: 0.101	Val F1: 0.363
Best Epoch: 20	Best Val F1: 0.369

****************************** Epoch: 22 ******************************
Batch: 1/58	Loss: 0.084
Batch: 6/58	Loss: 0.045
Batch: 11/58	Loss: 0.058
Batch: 16/58	Loss: 0.039
Batch: 21/58	Loss: 0.091
Batch: 26/58	Loss: 0.071
Batch: 31/58	Loss: 0.069
Batch: 36/58	Loss: 0.036
Batch: 41/58	Loss: 0.058
Batch: 46/58	Loss: 0.058
Batch: 51/58	Loss: 0.047
Batch: 56/58	Loss: 0.108
Batch: 58/58	Loss: 0.151
Epoch: 22	Train Loss: 0.073	Val F1: 0.349
Best Epoch: 20	Best Val F1: 0.369

****************************** Epoch: 23 ******************************
Batch: 1/58	Loss: 0.072
Batch: 6/58	Loss: 0.067
Batch: 11/58	Loss: 0.032
Batch: 16/58	Loss: 0.180
Batch: 21/58	Loss: 0.056
Batch: 26/58	Loss: 0.041
Batch: 31/58	Loss: 0.029
Batch: 36/58	Loss: 0.180
Batch: 41/58	Loss: 0.070
Batch: 46/58	Loss: 0.074
Batch: 51/58	Loss: 0.031
Batch: 56/58	Loss: 0.022
Batch: 58/58	Loss: 0.067
Epoch: 23	Train Loss: 0.062	Val F1: 0.345
Best Epoch: 20	Best Val F1: 0.369

****************************** Epoch: 24 ******************************
Batch: 1/58	Loss: 0.060
Batch: 6/58	Loss: 0.086
Batch: 11/58	Loss: 0.035
Batch: 16/58	Loss: 0.069
Batch: 21/58	Loss: 0.056
Batch: 26/58	Loss: 0.033
Batch: 31/58	Loss: 0.049
Batch: 36/58	Loss: 0.093
Batch: 41/58	Loss: 0.023
Batch: 46/58	Loss: 0.039
Batch: 51/58	Loss: 0.075
Batch: 56/58	Loss: 0.066
Batch: 58/58	Loss: 0.061
Epoch: 24	Train Loss: 0.066	Val F1: 0.352
Best Epoch: 20	Best Val F1: 0.369

****************************** Epoch: 25 ******************************
Batch: 1/58	Loss: 0.102
Batch: 6/58	Loss: 0.042
Batch: 11/58	Loss: 0.055
Batch: 16/58	Loss: 0.013
Batch: 21/58	Loss: 0.096
Batch: 26/58	Loss: 0.067
Batch: 31/58	Loss: 0.044
Batch: 36/58	Loss: 0.059
Batch: 41/58	Loss: 0.059
Batch: 46/58	Loss: 0.032
Batch: 51/58	Loss: 0.068
Batch: 56/58	Loss: 0.096
Batch: 58/58	Loss: 0.010
Epoch: 25	Train Loss: 0.061	Val F1: 0.362
Best Epoch: 20	Best Val F1: 0.369

****************************** Epoch: 26 ******************************
Batch: 1/58	Loss: 0.058
Batch: 6/58	Loss: 0.021
Batch: 11/58	Loss: 0.019
Batch: 16/58	Loss: 0.044
Batch: 21/58	Loss: 0.122
Batch: 26/58	Loss: 0.087
Batch: 31/58	Loss: 0.108
Batch: 36/58	Loss: 0.015
Batch: 41/58	Loss: 0.068
Batch: 46/58	Loss: 0.019
Batch: 51/58	Loss: 0.036
Batch: 56/58	Loss: 0.057
Batch: 58/58	Loss: 0.020
Epoch: 26	Train Loss: 0.049	Val F1: 0.357
Best Epoch: 20	Best Val F1: 0.369

****************************** Epoch: 27 ******************************
Batch: 1/58	Loss: 0.017
Batch: 6/58	Loss: 0.134
Batch: 11/58	Loss: 0.012
Batch: 16/58	Loss: 0.032
Batch: 21/58	Loss: 0.036
Batch: 26/58	Loss: 0.025
Batch: 31/58	Loss: 0.019
Batch: 36/58	Loss: 0.017
Batch: 41/58	Loss: 0.058
Batch: 46/58	Loss: 0.033
Batch: 51/58	Loss: 0.063
Batch: 56/58	Loss: 0.020
Batch: 58/58	Loss: 0.028
Epoch: 27	Train Loss: 0.038	Val F1: 0.357
Best Epoch: 20	Best Val F1: 0.369

****************************** Epoch: 28 ******************************
Batch: 1/58	Loss: 0.015
Batch: 6/58	Loss: 0.029
Batch: 11/58	Loss: 0.076
Batch: 16/58	Loss: 0.043
Batch: 21/58	Loss: 0.029
Batch: 26/58	Loss: 0.010
Batch: 31/58	Loss: 0.030
Batch: 36/58	Loss: 0.027
Batch: 41/58	Loss: 0.016
Batch: 46/58	Loss: 0.037
Batch: 51/58	Loss: 0.015
Batch: 56/58	Loss: 0.017
Batch: 58/58	Loss: 0.043
Epoch: 28	Train Loss: 0.040	Val F1: 0.356
Best Epoch: 20	Best Val F1: 0.369

****************************** Epoch: 29 ******************************
Batch: 1/58	Loss: 0.104
Batch: 6/58	Loss: 0.022
Batch: 11/58	Loss: 0.028
Batch: 16/58	Loss: 0.014
Batch: 21/58	Loss: 0.023
Batch: 26/58	Loss: 0.027
Batch: 31/58	Loss: 0.089
Batch: 36/58	Loss: 0.061
Batch: 41/58	Loss: 0.057
Batch: 46/58	Loss: 0.032
Batch: 51/58	Loss: 0.032
Batch: 56/58	Loss: 0.057
Batch: 58/58	Loss: 0.023
Epoch: 29	Train Loss: 0.041	Val F1: 0.355
Best Epoch: 20	Best Val F1: 0.369

****************************** Epoch: 30 ******************************
Batch: 1/58	Loss: 0.017
Batch: 6/58	Loss: 0.023
Batch: 11/58	Loss: 0.067
Batch: 16/58	Loss: 0.046
Batch: 21/58	Loss: 0.023
Batch: 26/58	Loss: 0.072
Batch: 31/58	Loss: 0.082
Batch: 36/58	Loss: 0.026
Batch: 41/58	Loss: 0.031
Batch: 46/58	Loss: 0.034
Batch: 51/58	Loss: 0.015
Batch: 56/58	Loss: 0.016
Batch: 58/58	Loss: 0.012
Epoch: 30	Train Loss: 0.044	Val F1: 0.366
Best Epoch: 20	Best Val F1: 0.369

****************************** Epoch: 31 ******************************
Batch: 1/58	Loss: 0.023
Batch: 6/58	Loss: 0.009
Batch: 11/58	Loss: 0.019
Batch: 16/58	Loss: 0.157
Batch: 21/58	Loss: 0.012
Batch: 26/58	Loss: 0.050
Batch: 31/58	Loss: 0.029
Batch: 36/58	Loss: 0.016
Batch: 41/58	Loss: 0.023
Batch: 46/58	Loss: 0.060
Batch: 51/58	Loss: 0.046
Batch: 56/58	Loss: 0.024
Batch: 58/58	Loss: 0.047
Epoch: 31	Train Loss: 0.035	Val F1: 0.356
Best Epoch: 20	Best Val F1: 0.369

****************************** Epoch: 32 ******************************
Batch: 1/58	Loss: 0.043
Batch: 6/58	Loss: 0.014
Batch: 11/58	Loss: 0.012
Batch: 16/58	Loss: 0.061
Batch: 21/58	Loss: 0.037
Batch: 26/58	Loss: 0.011
Batch: 31/58	Loss: 0.027
Batch: 36/58	Loss: 0.010
Batch: 41/58	Loss: 0.057
Batch: 46/58	Loss: 0.015
Batch: 51/58	Loss: 0.016
Batch: 56/58	Loss: 0.070
Batch: 58/58	Loss: 0.020
Epoch: 32	Train Loss: 0.027	Val F1: 0.355
Best Epoch: 20	Best Val F1: 0.369

****************************** Epoch: 33 ******************************
Batch: 1/58	Loss: 0.011
Batch: 6/58	Loss: 0.017
Batch: 11/58	Loss: 0.057
Batch: 16/58	Loss: 0.007
Batch: 21/58	Loss: 0.006
Batch: 26/58	Loss: 0.042
Batch: 31/58	Loss: 0.007
Batch: 36/58	Loss: 0.011
Batch: 41/58	Loss: 0.010
Batch: 46/58	Loss: 0.020
Batch: 51/58	Loss: 0.016
Batch: 56/58	Loss: 0.009
Batch: 58/58	Loss: 0.028
Epoch: 33	Train Loss: 0.018	Val F1: 0.350
Best Epoch: 20	Best Val F1: 0.369

****************************** Epoch: 34 ******************************
Batch: 1/58	Loss: 0.007
Batch: 6/58	Loss: 0.008
Batch: 11/58	Loss: 0.013
Batch: 16/58	Loss: 0.059
Batch: 21/58	Loss: 0.048
Batch: 26/58	Loss: 0.038
Batch: 31/58	Loss: 0.010
Batch: 36/58	Loss: 0.045
Batch: 41/58	Loss: 0.024
Batch: 46/58	Loss: 0.010
Batch: 51/58	Loss: 0.007
Batch: 56/58	Loss: 0.021
Batch: 58/58	Loss: 0.012
Epoch: 34	Train Loss: 0.018	Val F1: 0.368
Best Epoch: 20	Best Val F1: 0.369

****************************** Epoch: 35 ******************************
Batch: 1/58	Loss: 0.016
Batch: 6/58	Loss: 0.020
Batch: 11/58	Loss: 0.015
Batch: 16/58	Loss: 0.026
Batch: 21/58	Loss: 0.006
Batch: 26/58	Loss: 0.008
Batch: 31/58	Loss: 0.006
Batch: 36/58	Loss: 0.008
Batch: 41/58	Loss: 0.006
Batch: 46/58	Loss: 0.018
Batch: 51/58	Loss: 0.008
Batch: 56/58	Loss: 0.025
Batch: 58/58	Loss: 0.079
Epoch: 35	Train Loss: 0.017	Val F1: 0.356
Best Epoch: 20	Best Val F1: 0.369

Saving the best checkpoint....
Inference...
Test F1: 0.369	Test F1_Few: 0.453	Test F1_Zero: 0.358
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0009987448043751728, 'lr': 1.3261799932532791e-05, 'n_layers_freeze': 2, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.078
Batch: 5/29	Loss: 1.055
Batch: 7/29	Loss: 1.038
Batch: 9/29	Loss: 1.019
Batch: 11/29	Loss: 1.003
Batch: 13/29	Loss: 0.990
Batch: 15/29	Loss: 0.989
Batch: 17/29	Loss: 0.953
Batch: 19/29	Loss: 0.947
Batch: 21/29	Loss: 0.931
Batch: 23/29	Loss: 0.932
Batch: 25/29	Loss: 0.906
Batch: 27/29	Loss: 0.900
Batch: 29/29	Loss: 0.905
Epoch: 1	Train Loss: 0.982	Val F1: 0.186
Best Epoch: 1	Best Val F1: 0.186

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.897
Batch: 3/29	Loss: 0.895
Batch: 5/29	Loss: 0.916
Batch: 7/29	Loss: 0.882
Batch: 9/29	Loss: 0.893
Batch: 11/29	Loss: 0.856
Batch: 13/29	Loss: 0.855
Batch: 15/29	Loss: 0.875
Batch: 17/29	Loss: 0.864
Batch: 19/29	Loss: 0.888
Batch: 21/29	Loss: 0.850
Batch: 23/29	Loss: 0.856
Batch: 25/29	Loss: 0.837
Batch: 27/29	Loss: 0.886
Batch: 29/29	Loss: 0.838
Epoch: 2	Train Loss: 0.869	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.186

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.829
Batch: 3/29	Loss: 0.845
Batch: 5/29	Loss: 0.835
Batch: 7/29	Loss: 0.860
Batch: 9/29	Loss: 0.819
Batch: 11/29	Loss: 0.819
Batch: 13/29	Loss: 0.853
Batch: 15/29	Loss: 0.823
Batch: 17/29	Loss: 0.838
Batch: 19/29	Loss: 0.833
Batch: 21/29	Loss: 0.814
Batch: 23/29	Loss: 0.808
Batch: 25/29	Loss: 0.824
Batch: 27/29	Loss: 0.801
Batch: 29/29	Loss: 0.810
Epoch: 3	Train Loss: 0.828	Val F1: 0.196
Best Epoch: 3	Best Val F1: 0.196

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.794
Batch: 3/29	Loss: 0.809
Batch: 5/29	Loss: 0.790
Batch: 7/29	Loss: 0.833
Batch: 9/29	Loss: 0.817
Batch: 11/29	Loss: 0.777
Batch: 13/29	Loss: 0.786
Batch: 15/29	Loss: 0.771
Batch: 17/29	Loss: 0.782
Batch: 19/29	Loss: 0.801
Batch: 21/29	Loss: 0.804
Batch: 23/29	Loss: 0.796
Batch: 25/29	Loss: 0.787
Batch: 27/29	Loss: 0.806
Batch: 29/29	Loss: 0.786
Epoch: 4	Train Loss: 0.796	Val F1: 0.301
Best Epoch: 4	Best Val F1: 0.301

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.759
Batch: 3/29	Loss: 0.753
Batch: 5/29	Loss: 0.733
Batch: 7/29	Loss: 0.734
Batch: 9/29	Loss: 0.715
Batch: 11/29	Loss: 0.729
Batch: 13/29	Loss: 0.735
Batch: 15/29	Loss: 0.790
Batch: 17/29	Loss: 0.791
Batch: 19/29	Loss: 0.802
Batch: 21/29	Loss: 0.727
Batch: 23/29	Loss: 0.744
Batch: 25/29	Loss: 0.775
Batch: 27/29	Loss: 0.735
Batch: 29/29	Loss: 0.751
Epoch: 5	Train Loss: 0.760	Val F1: 0.329
Best Epoch: 5	Best Val F1: 0.329

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.738
Batch: 3/29	Loss: 0.799
Batch: 5/29	Loss: 0.690
Batch: 7/29	Loss: 0.786
Batch: 9/29	Loss: 0.723
Batch: 11/29	Loss: 0.692
Batch: 13/29	Loss: 0.717
Batch: 15/29	Loss: 0.692
Batch: 17/29	Loss: 0.699
Batch: 19/29	Loss: 0.670
Batch: 21/29	Loss: 0.751
Batch: 23/29	Loss: 0.695
Batch: 25/29	Loss: 0.731
Batch: 27/29	Loss: 0.693
Batch: 29/29	Loss: 0.684
Epoch: 6	Train Loss: 0.721	Val F1: 0.332
Best Epoch: 6	Best Val F1: 0.332

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.670
Batch: 3/29	Loss: 0.744
Batch: 5/29	Loss: 0.765
Batch: 7/29	Loss: 0.711
Batch: 9/29	Loss: 0.717
Batch: 11/29	Loss: 0.638
Batch: 13/29	Loss: 0.664
Batch: 15/29	Loss: 0.651
Batch: 17/29	Loss: 0.711
Batch: 19/29	Loss: 0.708
Batch: 21/29	Loss: 0.648
Batch: 23/29	Loss: 0.643
Batch: 25/29	Loss: 0.619
Batch: 27/29	Loss: 0.641
Batch: 29/29	Loss: 0.697
Epoch: 7	Train Loss: 0.680	Val F1: 0.327
Best Epoch: 6	Best Val F1: 0.332

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.677
Batch: 3/29	Loss: 0.627
Batch: 5/29	Loss: 0.658
Batch: 7/29	Loss: 0.624
Batch: 9/29	Loss: 0.643
Batch: 11/29	Loss: 0.644
Batch: 13/29	Loss: 0.717
Batch: 15/29	Loss: 0.611
Batch: 17/29	Loss: 0.682
Batch: 19/29	Loss: 0.643
Batch: 21/29	Loss: 0.658
Batch: 23/29	Loss: 0.652
Batch: 25/29	Loss: 0.715
Batch: 27/29	Loss: 0.654
Batch: 29/29	Loss: 0.623
Epoch: 8	Train Loss: 0.647	Val F1: 0.337
Best Epoch: 8	Best Val F1: 0.337

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.635
Batch: 3/29	Loss: 0.602
Batch: 5/29	Loss: 0.610
Batch: 7/29	Loss: 0.573
Batch: 9/29	Loss: 0.644
Batch: 11/29	Loss: 0.631
Batch: 13/29	Loss: 0.636
Batch: 15/29	Loss: 0.674
Batch: 17/29	Loss: 0.588
Batch: 19/29	Loss: 0.610
Batch: 21/29	Loss: 0.671
Batch: 23/29	Loss: 0.568
Batch: 25/29	Loss: 0.583
Batch: 27/29	Loss: 0.610
Batch: 29/29	Loss: 0.540
Epoch: 9	Train Loss: 0.606	Val F1: 0.348
Best Epoch: 9	Best Val F1: 0.348

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.502
Batch: 3/29	Loss: 0.597
Batch: 5/29	Loss: 0.570
Batch: 7/29	Loss: 0.551
Batch: 9/29	Loss: 0.541
Batch: 11/29	Loss: 0.459
Batch: 13/29	Loss: 0.683
Batch: 15/29	Loss: 0.645
Batch: 17/29	Loss: 0.737
Batch: 19/29	Loss: 0.426
Batch: 21/29	Loss: 0.660
Batch: 23/29	Loss: 0.593
Batch: 25/29	Loss: 0.631
Batch: 27/29	Loss: 0.540
Batch: 29/29	Loss: 0.649
Epoch: 10	Train Loss: 0.580	Val F1: 0.340
Best Epoch: 9	Best Val F1: 0.348

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.557
Batch: 3/29	Loss: 0.502
Batch: 5/29	Loss: 0.663
Batch: 7/29	Loss: 0.569
Batch: 9/29	Loss: 0.534
Batch: 11/29	Loss: 0.530
Batch: 13/29	Loss: 0.478
Batch: 15/29	Loss: 0.464
Batch: 17/29	Loss: 0.613
Batch: 19/29	Loss: 0.525
Batch: 21/29	Loss: 0.493
Batch: 23/29	Loss: 0.425
Batch: 25/29	Loss: 0.444
Batch: 27/29	Loss: 0.465
Batch: 29/29	Loss: 0.508
Epoch: 11	Train Loss: 0.529	Val F1: 0.350
Best Epoch: 11	Best Val F1: 0.350

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.601
Batch: 3/29	Loss: 0.430
Batch: 5/29	Loss: 0.474
Batch: 7/29	Loss: 0.478
Batch: 9/29	Loss: 0.547
Batch: 11/29	Loss: 0.521
Batch: 13/29	Loss: 0.498
Batch: 15/29	Loss: 0.474
Batch: 17/29	Loss: 0.479
Batch: 19/29	Loss: 0.472
Batch: 21/29	Loss: 0.459
Batch: 23/29	Loss: 0.530
Batch: 25/29	Loss: 0.512
Batch: 27/29	Loss: 0.548
Batch: 29/29	Loss: 0.394
Epoch: 12	Train Loss: 0.490	Val F1: 0.334
Best Epoch: 11	Best Val F1: 0.350

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.523
Batch: 3/29	Loss: 0.364
Batch: 5/29	Loss: 0.504
Batch: 7/29	Loss: 0.442
Batch: 9/29	Loss: 0.490
Batch: 11/29	Loss: 0.470
Batch: 13/29	Loss: 0.483
Batch: 15/29	Loss: 0.463
Batch: 17/29	Loss: 0.428
Batch: 19/29	Loss: 0.354
Batch: 21/29	Loss: 0.445
Batch: 23/29	Loss: 0.459
Batch: 25/29	Loss: 0.332
Batch: 27/29	Loss: 0.547
Batch: 29/29	Loss: 0.548
Epoch: 13	Train Loss: 0.471	Val F1: 0.318
Best Epoch: 11	Best Val F1: 0.350

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.513
Batch: 3/29	Loss: 0.456
Batch: 5/29	Loss: 0.362
Batch: 7/29	Loss: 0.440
Batch: 9/29	Loss: 0.471
Batch: 11/29	Loss: 0.464
Batch: 13/29	Loss: 0.421
Batch: 15/29	Loss: 0.374
Batch: 17/29	Loss: 0.554
Batch: 19/29	Loss: 0.488
Batch: 21/29	Loss: 0.326
Batch: 23/29	Loss: 0.349
Batch: 25/29	Loss: 0.475
Batch: 27/29	Loss: 0.421
Batch: 29/29	Loss: 0.479
Epoch: 14	Train Loss: 0.444	Val F1: 0.343
Best Epoch: 11	Best Val F1: 0.350

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.382
Batch: 3/29	Loss: 0.423
Batch: 5/29	Loss: 0.306
Batch: 7/29	Loss: 0.385
Batch: 9/29	Loss: 0.467
Batch: 11/29	Loss: 0.390
Batch: 13/29	Loss: 0.416
Batch: 15/29	Loss: 0.442
Batch: 17/29	Loss: 0.471
Batch: 19/29	Loss: 0.398
Batch: 21/29	Loss: 0.440
Batch: 23/29	Loss: 0.453
Batch: 25/29	Loss: 0.465
Batch: 27/29	Loss: 0.370
Batch: 29/29	Loss: 0.497
Epoch: 15	Train Loss: 0.419	Val F1: 0.342
Best Epoch: 11	Best Val F1: 0.350

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.419
Batch: 3/29	Loss: 0.404
Batch: 5/29	Loss: 0.429
Batch: 7/29	Loss: 0.387
Batch: 9/29	Loss: 0.427
Batch: 11/29	Loss: 0.412
Batch: 13/29	Loss: 0.343
Batch: 15/29	Loss: 0.348
Batch: 17/29	Loss: 0.363
Batch: 19/29	Loss: 0.448
Batch: 21/29	Loss: 0.323
Batch: 23/29	Loss: 0.429
Batch: 25/29	Loss: 0.422
Batch: 27/29	Loss: 0.369
Batch: 29/29	Loss: 0.398
Epoch: 16	Train Loss: 0.402	Val F1: 0.342
Best Epoch: 11	Best Val F1: 0.350

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.362
Batch: 3/29	Loss: 0.472
Batch: 5/29	Loss: 0.376
Batch: 7/29	Loss: 0.349
Batch: 9/29	Loss: 0.310
Batch: 11/29	Loss: 0.435
Batch: 13/29	Loss: 0.420
Batch: 15/29	Loss: 0.426
Batch: 17/29	Loss: 0.500
Batch: 19/29	Loss: 0.374
Batch: 21/29	Loss: 0.591
Batch: 23/29	Loss: 0.526
Batch: 25/29	Loss: 0.285
Batch: 27/29	Loss: 0.479
Batch: 29/29	Loss: 0.417
Epoch: 17	Train Loss: 0.417	Val F1: 0.345
Best Epoch: 11	Best Val F1: 0.350

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.434
Batch: 3/29	Loss: 0.432
Batch: 5/29	Loss: 0.363
Batch: 7/29	Loss: 0.344
Batch: 9/29	Loss: 0.529
Batch: 11/29	Loss: 0.382
Batch: 13/29	Loss: 0.315
Batch: 15/29	Loss: 0.438
Batch: 17/29	Loss: 0.369
Batch: 19/29	Loss: 0.413
Batch: 21/29	Loss: 0.359
Batch: 23/29	Loss: 0.469
Batch: 25/29	Loss: 0.396
Batch: 27/29	Loss: 0.349
Batch: 29/29	Loss: 0.428
Epoch: 18	Train Loss: 0.402	Val F1: 0.345
Best Epoch: 11	Best Val F1: 0.350

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.269
Batch: 3/29	Loss: 0.297
Batch: 5/29	Loss: 0.399
Batch: 7/29	Loss: 0.405
Batch: 9/29	Loss: 0.274
Batch: 11/29	Loss: 0.466
Batch: 13/29	Loss: 0.470
Batch: 15/29	Loss: 0.350
Batch: 17/29	Loss: 0.318
Batch: 19/29	Loss: 0.440
Batch: 21/29	Loss: 0.376
Batch: 23/29	Loss: 0.384
Batch: 25/29	Loss: 0.391
Batch: 27/29	Loss: 0.286
Batch: 29/29	Loss: 0.310
Epoch: 19	Train Loss: 0.371	Val F1: 0.341
Best Epoch: 11	Best Val F1: 0.350

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.453
Batch: 3/29	Loss: 0.378
Batch: 5/29	Loss: 0.323
Batch: 7/29	Loss: 0.322
Batch: 9/29	Loss: 0.394
Batch: 11/29	Loss: 0.359
Batch: 13/29	Loss: 0.356
Batch: 15/29	Loss: 0.382
Batch: 17/29	Loss: 0.422
Batch: 19/29	Loss: 0.303
Batch: 21/29	Loss: 0.343
Batch: 23/29	Loss: 0.385
Batch: 25/29	Loss: 0.319
Batch: 27/29	Loss: 0.365
Batch: 29/29	Loss: 0.433
Epoch: 20	Train Loss: 0.363	Val F1: 0.352
Best Epoch: 20	Best Val F1: 0.352

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.337
Batch: 3/29	Loss: 0.294
Batch: 5/29	Loss: 0.304
Batch: 7/29	Loss: 0.580
Batch: 9/29	Loss: 0.299
Batch: 11/29	Loss: 0.263
Batch: 13/29	Loss: 0.401
Batch: 15/29	Loss: 0.408
Batch: 17/29	Loss: 0.310
Batch: 19/29	Loss: 0.306
Batch: 21/29	Loss: 0.333
Batch: 23/29	Loss: 0.269
Batch: 25/29	Loss: 0.309
Batch: 27/29	Loss: 0.326
Batch: 29/29	Loss: 0.359
Epoch: 21	Train Loss: 0.346	Val F1: 0.351
Best Epoch: 20	Best Val F1: 0.352

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.315
Batch: 3/29	Loss: 0.288
Batch: 5/29	Loss: 0.350
Batch: 7/29	Loss: 0.358
Batch: 9/29	Loss: 0.295
Batch: 11/29	Loss: 0.305
Batch: 13/29	Loss: 0.267
Batch: 15/29	Loss: 0.291
Batch: 17/29	Loss: 0.394
Batch: 19/29	Loss: 0.445
Batch: 21/29	Loss: 0.435
Batch: 23/29	Loss: 0.339
Batch: 25/29	Loss: 0.331
Batch: 27/29	Loss: 0.303
Batch: 29/29	Loss: 0.314
Epoch: 22	Train Loss: 0.331	Val F1: 0.346
Best Epoch: 20	Best Val F1: 0.352

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.319
Batch: 3/29	Loss: 0.322
Batch: 5/29	Loss: 0.351
Batch: 7/29	Loss: 0.396
Batch: 9/29	Loss: 0.293
Batch: 11/29	Loss: 0.340
Batch: 13/29	Loss: 0.294
Batch: 15/29	Loss: 0.333
Batch: 17/29	Loss: 0.324
Batch: 19/29	Loss: 0.320
Batch: 21/29	Loss: 0.302
Batch: 23/29	Loss: 0.304
Batch: 25/29	Loss: 0.311
Batch: 27/29	Loss: 0.246
Batch: 29/29	Loss: 0.310
Epoch: 23	Train Loss: 0.321	Val F1: 0.357
Best Epoch: 23	Best Val F1: 0.357

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.282
Batch: 3/29	Loss: 0.265
Batch: 5/29	Loss: 0.359
Batch: 7/29	Loss: 0.330
Batch: 9/29	Loss: 0.370
Batch: 11/29	Loss: 0.399
Batch: 13/29	Loss: 0.284
Batch: 15/29	Loss: 0.319
Batch: 17/29	Loss: 0.278
Batch: 19/29	Loss: 0.351
Batch: 21/29	Loss: 0.363
Batch: 23/29	Loss: 0.282
Batch: 25/29	Loss: 0.324
Batch: 27/29	Loss: 0.273
Batch: 29/29	Loss: 0.306
Epoch: 24	Train Loss: 0.313	Val F1: 0.344
Best Epoch: 23	Best Val F1: 0.357

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.325
Batch: 3/29	Loss: 0.335
Batch: 5/29	Loss: 0.361
Batch: 7/29	Loss: 0.364
Batch: 9/29	Loss: 0.398
Batch: 11/29	Loss: 0.311
Batch: 13/29	Loss: 0.350
Batch: 15/29	Loss: 0.285
Batch: 17/29	Loss: 0.320
Batch: 19/29	Loss: 0.252
Batch: 21/29	Loss: 0.301
Batch: 23/29	Loss: 0.310
Batch: 25/29	Loss: 0.307
Batch: 27/29	Loss: 0.323
Batch: 29/29	Loss: 0.266
Epoch: 25	Train Loss: 0.304	Val F1: 0.344
Best Epoch: 23	Best Val F1: 0.357

****************************** Epoch: 26 ******************************
Batch: 1/29	Loss: 0.254
Batch: 3/29	Loss: 0.250
Batch: 5/29	Loss: 0.312
Batch: 7/29	Loss: 0.309
Batch: 9/29	Loss: 0.273
Batch: 11/29	Loss: 0.308
Batch: 13/29	Loss: 0.287
Batch: 15/29	Loss: 0.274
Batch: 17/29	Loss: 0.234
Batch: 19/29	Loss: 0.292
Batch: 21/29	Loss: 0.356
Batch: 23/29	Loss: 0.178
Batch: 25/29	Loss: 0.331
Batch: 27/29	Loss: 0.251
Batch: 29/29	Loss: 0.322
Epoch: 26	Train Loss: 0.284	Val F1: 0.349
Best Epoch: 23	Best Val F1: 0.357

****************************** Epoch: 27 ******************************
Batch: 1/29	Loss: 0.258
Batch: 3/29	Loss: 0.315
Batch: 5/29	Loss: 0.368
Batch: 7/29	Loss: 0.187
Batch: 9/29	Loss: 0.392
Batch: 11/29	Loss: 0.235
Batch: 13/29	Loss: 0.323
Batch: 15/29	Loss: 0.324
Batch: 17/29	Loss: 0.244
Batch: 19/29	Loss: 0.283
Batch: 21/29	Loss: 0.287
Batch: 23/29	Loss: 0.251
Batch: 25/29	Loss: 0.278
Batch: 27/29	Loss: 0.272
Batch: 29/29	Loss: 0.318
Epoch: 27	Train Loss: 0.280	Val F1: 0.346
Best Epoch: 23	Best Val F1: 0.357

****************************** Epoch: 28 ******************************
Batch: 1/29	Loss: 0.301
Batch: 3/29	Loss: 0.257
Batch: 5/29	Loss: 0.268
Batch: 7/29	Loss: 0.268
Batch: 9/29	Loss: 0.307
Batch: 11/29	Loss: 0.270
Batch: 13/29	Loss: 0.275
Batch: 15/29	Loss: 0.324
Batch: 17/29	Loss: 0.325
Batch: 19/29	Loss: 0.208
Batch: 21/29	Loss: 0.280
Batch: 23/29	Loss: 0.335
Batch: 25/29	Loss: 0.288
Batch: 27/29	Loss: 0.229
Batch: 29/29	Loss: 0.232
Epoch: 28	Train Loss: 0.272	Val F1: 0.344
Best Epoch: 23	Best Val F1: 0.357

****************************** Epoch: 29 ******************************
Batch: 1/29	Loss: 0.270
Batch: 3/29	Loss: 0.262
Batch: 5/29	Loss: 0.229
Batch: 7/29	Loss: 0.204
Batch: 9/29	Loss: 0.195
Batch: 11/29	Loss: 0.268
Batch: 13/29	Loss: 0.341
Batch: 15/29	Loss: 0.158
Batch: 17/29	Loss: 0.267
Batch: 19/29	Loss: 0.197
Batch: 21/29	Loss: 0.300
Batch: 23/29	Loss: 0.250
Batch: 25/29	Loss: 0.265
Batch: 27/29	Loss: 0.280
Batch: 29/29	Loss: 0.249
Epoch: 29	Train Loss: 0.252	Val F1: 0.340
Best Epoch: 23	Best Val F1: 0.357

****************************** Epoch: 30 ******************************
Batch: 1/29	Loss: 0.205
Batch: 3/29	Loss: 0.214
Batch: 5/29	Loss: 0.298
Batch: 7/29	Loss: 0.223
Batch: 9/29	Loss: 0.249
Batch: 11/29	Loss: 0.201
Batch: 13/29	Loss: 0.256
Batch: 15/29	Loss: 0.195
Batch: 17/29	Loss: 0.225
Batch: 19/29	Loss: 0.217
Batch: 21/29	Loss: 0.274
Batch: 23/29	Loss: 0.255
Batch: 25/29	Loss: 0.261
Batch: 27/29	Loss: 0.210
Batch: 29/29	Loss: 0.210
Epoch: 30	Train Loss: 0.240	Val F1: 0.344
Best Epoch: 23	Best Val F1: 0.357

****************************** Epoch: 31 ******************************
Batch: 1/29	Loss: 0.234
Batch: 3/29	Loss: 0.179
Batch: 5/29	Loss: 0.220
Batch: 7/29	Loss: 0.242
Batch: 9/29	Loss: 0.237
Batch: 11/29	Loss: 0.240
Batch: 13/29	Loss: 0.250
Batch: 15/29	Loss: 0.187
Batch: 17/29	Loss: 0.256
Batch: 19/29	Loss: 0.246
Batch: 21/29	Loss: 0.335
Batch: 23/29	Loss: 0.267
Batch: 25/29	Loss: 0.295
Batch: 27/29	Loss: 0.207
Batch: 29/29	Loss: 0.177
Epoch: 31	Train Loss: 0.243	Val F1: 0.353
Best Epoch: 23	Best Val F1: 0.357

****************************** Epoch: 32 ******************************
Batch: 1/29	Loss: 0.317
Batch: 3/29	Loss: 0.229
Batch: 5/29	Loss: 0.183
Batch: 7/29	Loss: 0.203
Batch: 9/29	Loss: 0.211
Batch: 11/29	Loss: 0.230
Batch: 13/29	Loss: 0.192
Batch: 15/29	Loss: 0.129
Batch: 17/29	Loss: 0.264
Batch: 19/29	Loss: 0.308
Batch: 21/29	Loss: 0.161
Batch: 23/29	Loss: 0.259
Batch: 25/29	Loss: 0.205
Batch: 27/29	Loss: 0.135
Batch: 29/29	Loss: 0.223
Epoch: 32	Train Loss: 0.227	Val F1: 0.349
Best Epoch: 23	Best Val F1: 0.357

****************************** Epoch: 33 ******************************
Batch: 1/29	Loss: 0.234
Batch: 3/29	Loss: 0.200
Batch: 5/29	Loss: 0.191
Batch: 7/29	Loss: 0.224
Batch: 9/29	Loss: 0.296
Batch: 11/29	Loss: 0.218
Batch: 13/29	Loss: 0.259
Batch: 15/29	Loss: 0.287
Batch: 17/29	Loss: 0.238
Batch: 19/29	Loss: 0.210
Batch: 21/29	Loss: 0.155
Batch: 23/29	Loss: 0.199
Batch: 25/29	Loss: 0.195
Batch: 27/29	Loss: 0.286
Batch: 29/29	Loss: 0.197
Epoch: 33	Train Loss: 0.217	Val F1: 0.341
Best Epoch: 23	Best Val F1: 0.357

****************************** Epoch: 34 ******************************
Batch: 1/29	Loss: 0.169
Batch: 3/29	Loss: 0.186
Batch: 5/29	Loss: 0.190
Batch: 7/29	Loss: 0.201
Batch: 9/29	Loss: 0.217
Batch: 11/29	Loss: 0.298
Batch: 13/29	Loss: 0.176
Batch: 15/29	Loss: 0.178
Batch: 17/29	Loss: 0.231
Batch: 19/29	Loss: 0.148
Batch: 21/29	Loss: 0.235
Batch: 23/29	Loss: 0.151
Batch: 25/29	Loss: 0.173
Batch: 27/29	Loss: 0.146
Batch: 29/29	Loss: 0.197
Epoch: 34	Train Loss: 0.206	Val F1: 0.341
Best Epoch: 23	Best Val F1: 0.357

****************************** Epoch: 35 ******************************
Batch: 1/29	Loss: 0.149
Batch: 3/29	Loss: 0.162
Batch: 5/29	Loss: 0.173
Batch: 7/29	Loss: 0.167
Batch: 9/29	Loss: 0.181
Batch: 11/29	Loss: 0.171
Batch: 13/29	Loss: 0.181
Batch: 15/29	Loss: 0.191
Batch: 17/29	Loss: 0.215
Batch: 19/29	Loss: 0.214
Batch: 21/29	Loss: 0.192
Batch: 23/29	Loss: 0.263
Batch: 25/29	Loss: 0.171
Batch: 27/29	Loss: 0.182
Batch: 29/29	Loss: 0.155
Epoch: 35	Train Loss: 0.192	Val F1: 0.341
Best Epoch: 23	Best Val F1: 0.357

****************************** Epoch: 36 ******************************
Batch: 1/29	Loss: 0.286
Batch: 3/29	Loss: 0.197
Batch: 5/29	Loss: 0.143
Batch: 7/29	Loss: 0.150
Batch: 9/29	Loss: 0.105
Batch: 11/29	Loss: 0.164
Batch: 13/29	Loss: 0.240
Batch: 15/29	Loss: 0.279
Batch: 17/29	Loss: 0.191
Batch: 19/29	Loss: 0.223
Batch: 21/29	Loss: 0.229
Batch: 23/29	Loss: 0.153
Batch: 25/29	Loss: 0.221
Batch: 27/29	Loss: 0.166
Batch: 29/29	Loss: 0.169
Epoch: 36	Train Loss: 0.196	Val F1: 0.339
Best Epoch: 23	Best Val F1: 0.357

****************************** Epoch: 37 ******************************
Batch: 1/29	Loss: 0.122
Batch: 3/29	Loss: 0.235
Batch: 5/29	Loss: 0.133
Batch: 7/29	Loss: 0.132
Batch: 9/29	Loss: 0.157
Batch: 11/29	Loss: 0.163
Batch: 13/29	Loss: 0.184
Batch: 15/29	Loss: 0.152
Batch: 17/29	Loss: 0.132
Batch: 19/29	Loss: 0.196
Batch: 21/29	Loss: 0.177
Batch: 23/29	Loss: 0.138
Batch: 25/29	Loss: 0.120
Batch: 27/29	Loss: 0.091
Batch: 29/29	Loss: 0.146
Epoch: 37	Train Loss: 0.166	Val F1: 0.340
Best Epoch: 23	Best Val F1: 0.357

****************************** Epoch: 38 ******************************
Batch: 1/29	Loss: 0.136
Batch: 3/29	Loss: 0.159
Batch: 5/29	Loss: 0.110
Batch: 7/29	Loss: 0.159
Batch: 9/29	Loss: 0.148
Batch: 11/29	Loss: 0.184
Batch: 13/29	Loss: 0.123
Batch: 15/29	Loss: 0.170
Batch: 17/29	Loss: 0.115
Batch: 19/29	Loss: 0.149
Batch: 21/29	Loss: 0.104
Batch: 23/29	Loss: 0.137
Batch: 25/29	Loss: 0.136
Batch: 27/29	Loss: 0.186
Batch: 29/29	Loss: 0.167
Epoch: 38	Train Loss: 0.143	Val F1: 0.348
Best Epoch: 23	Best Val F1: 0.357

Saving the best checkpoint....
Inference...
Test F1: 0.376	Test F1_Few: 0.465	Test F1_Zero: 0.355
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.000855398341971043, 'lr': 1.0050210074627912e-05, 'n_layers_freeze': 1, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.082
Batch: 5/29	Loss: 1.065
Batch: 7/29	Loss: 1.051
Batch: 9/29	Loss: 1.036
Batch: 11/29	Loss: 1.022
Batch: 13/29	Loss: 1.010
Batch: 15/29	Loss: 1.008
Batch: 17/29	Loss: 0.977
Batch: 19/29	Loss: 0.970
Batch: 21/29	Loss: 0.954
Batch: 23/29	Loss: 0.952
Batch: 25/29	Loss: 0.930
Batch: 27/29	Loss: 0.922
Batch: 29/29	Loss: 0.926
Epoch: 1	Train Loss: 0.999	Val F1: 0.190
Best Epoch: 1	Best Val F1: 0.190

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.917
Batch: 3/29	Loss: 0.915
Batch: 5/29	Loss: 0.932
Batch: 7/29	Loss: 0.903
Batch: 9/29	Loss: 0.911
Batch: 11/29	Loss: 0.878
Batch: 13/29	Loss: 0.876
Batch: 15/29	Loss: 0.895
Batch: 17/29	Loss: 0.882
Batch: 19/29	Loss: 0.904
Batch: 21/29	Loss: 0.870
Batch: 23/29	Loss: 0.874
Batch: 25/29	Loss: 0.857
Batch: 27/29	Loss: 0.900
Batch: 29/29	Loss: 0.859
Epoch: 2	Train Loss: 0.889	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.190

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.851
Batch: 3/29	Loss: 0.863
Batch: 5/29	Loss: 0.855
Batch: 7/29	Loss: 0.876
Batch: 9/29	Loss: 0.840
Batch: 11/29	Loss: 0.840
Batch: 13/29	Loss: 0.870
Batch: 15/29	Loss: 0.842
Batch: 17/29	Loss: 0.855
Batch: 19/29	Loss: 0.851
Batch: 21/29	Loss: 0.834
Batch: 23/29	Loss: 0.829
Batch: 25/29	Loss: 0.843
Batch: 27/29	Loss: 0.822
Batch: 29/29	Loss: 0.830
Epoch: 3	Train Loss: 0.848	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.190

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.816
Batch: 3/29	Loss: 0.830
Batch: 5/29	Loss: 0.810
Batch: 7/29	Loss: 0.850
Batch: 9/29	Loss: 0.837
Batch: 11/29	Loss: 0.802
Batch: 13/29	Loss: 0.811
Batch: 15/29	Loss: 0.797
Batch: 17/29	Loss: 0.809
Batch: 19/29	Loss: 0.825
Batch: 21/29	Loss: 0.833
Batch: 23/29	Loss: 0.832
Batch: 25/29	Loss: 0.815
Batch: 27/29	Loss: 0.833
Batch: 29/29	Loss: 0.815
Epoch: 4	Train Loss: 0.821	Val F1: 0.240
Best Epoch: 4	Best Val F1: 0.240

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.800
Batch: 3/29	Loss: 0.802
Batch: 5/29	Loss: 0.792
Batch: 7/29	Loss: 0.780
Batch: 9/29	Loss: 0.784
Batch: 11/29	Loss: 0.778
Batch: 13/29	Loss: 0.772
Batch: 15/29	Loss: 0.797
Batch: 17/29	Loss: 0.830
Batch: 19/29	Loss: 0.794
Batch: 21/29	Loss: 0.764
Batch: 23/29	Loss: 0.781
Batch: 25/29	Loss: 0.794
Batch: 27/29	Loss: 0.753
Batch: 29/29	Loss: 0.781
Epoch: 5	Train Loss: 0.792	Val F1: 0.284
Best Epoch: 5	Best Val F1: 0.284

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.781
Batch: 3/29	Loss: 0.814
Batch: 5/29	Loss: 0.743
Batch: 7/29	Loss: 0.818
Batch: 9/29	Loss: 0.754
Batch: 11/29	Loss: 0.757
Batch: 13/29	Loss: 0.758
Batch: 15/29	Loss: 0.722
Batch: 17/29	Loss: 0.739
Batch: 19/29	Loss: 0.711
Batch: 21/29	Loss: 0.778
Batch: 23/29	Loss: 0.732
Batch: 25/29	Loss: 0.743
Batch: 27/29	Loss: 0.741
Batch: 29/29	Loss: 0.726
Epoch: 6	Train Loss: 0.755	Val F1: 0.319
Best Epoch: 6	Best Val F1: 0.319

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.720
Batch: 3/29	Loss: 0.765
Batch: 5/29	Loss: 0.778
Batch: 7/29	Loss: 0.732
Batch: 9/29	Loss: 0.749
Batch: 11/29	Loss: 0.689
Batch: 13/29	Loss: 0.721
Batch: 15/29	Loss: 0.680
Batch: 17/29	Loss: 0.734
Batch: 19/29	Loss: 0.741
Batch: 21/29	Loss: 0.679
Batch: 23/29	Loss: 0.684
Batch: 25/29	Loss: 0.652
Batch: 27/29	Loss: 0.678
Batch: 29/29	Loss: 0.664
Epoch: 7	Train Loss: 0.711	Val F1: 0.332
Best Epoch: 7	Best Val F1: 0.332

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.702
Batch: 3/29	Loss: 0.647
Batch: 5/29	Loss: 0.687
Batch: 7/29	Loss: 0.655
Batch: 9/29	Loss: 0.652
Batch: 11/29	Loss: 0.679
Batch: 13/29	Loss: 0.711
Batch: 15/29	Loss: 0.645
Batch: 17/29	Loss: 0.701
Batch: 19/29	Loss: 0.700
Batch: 21/29	Loss: 0.695
Batch: 23/29	Loss: 0.696
Batch: 25/29	Loss: 0.739
Batch: 27/29	Loss: 0.658
Batch: 29/29	Loss: 0.660
Epoch: 8	Train Loss: 0.671	Val F1: 0.332
Best Epoch: 7	Best Val F1: 0.332

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.667
Batch: 3/29	Loss: 0.610
Batch: 5/29	Loss: 0.641
Batch: 7/29	Loss: 0.601
Batch: 9/29	Loss: 0.669
Batch: 11/29	Loss: 0.632
Batch: 13/29	Loss: 0.650
Batch: 15/29	Loss: 0.669
Batch: 17/29	Loss: 0.606
Batch: 19/29	Loss: 0.587
Batch: 21/29	Loss: 0.738
Batch: 23/29	Loss: 0.591
Batch: 25/29	Loss: 0.651
Batch: 27/29	Loss: 0.633
Batch: 29/29	Loss: 0.589
Epoch: 9	Train Loss: 0.640	Val F1: 0.325
Best Epoch: 7	Best Val F1: 0.332

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.569
Batch: 3/29	Loss: 0.649
Batch: 5/29	Loss: 0.605
Batch: 7/29	Loss: 0.654
Batch: 9/29	Loss: 0.572
Batch: 11/29	Loss: 0.563
Batch: 13/29	Loss: 0.698
Batch: 15/29	Loss: 0.731
Batch: 17/29	Loss: 0.671
Batch: 19/29	Loss: 0.484
Batch: 21/29	Loss: 0.659
Batch: 23/29	Loss: 0.614
Batch: 25/29	Loss: 0.641
Batch: 27/29	Loss: 0.560
Batch: 29/29	Loss: 0.657
Epoch: 10	Train Loss: 0.610	Val F1: 0.345
Best Epoch: 10	Best Val F1: 0.345

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.594
Batch: 3/29	Loss: 0.515
Batch: 5/29	Loss: 0.683
Batch: 7/29	Loss: 0.600
Batch: 9/29	Loss: 0.558
Batch: 11/29	Loss: 0.587
Batch: 13/29	Loss: 0.547
Batch: 15/29	Loss: 0.462
Batch: 17/29	Loss: 0.629
Batch: 19/29	Loss: 0.543
Batch: 21/29	Loss: 0.546
Batch: 23/29	Loss: 0.503
Batch: 25/29	Loss: 0.523
Batch: 27/29	Loss: 0.560
Batch: 29/29	Loss: 0.553
Epoch: 11	Train Loss: 0.570	Val F1: 0.336
Best Epoch: 10	Best Val F1: 0.345

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.637
Batch: 3/29	Loss: 0.477
Batch: 5/29	Loss: 0.569
Batch: 7/29	Loss: 0.485
Batch: 9/29	Loss: 0.567
Batch: 11/29	Loss: 0.544
Batch: 13/29	Loss: 0.529
Batch: 15/29	Loss: 0.499
Batch: 17/29	Loss: 0.550
Batch: 19/29	Loss: 0.543
Batch: 21/29	Loss: 0.528
Batch: 23/29	Loss: 0.536
Batch: 25/29	Loss: 0.531
Batch: 27/29	Loss: 0.576
Batch: 29/29	Loss: 0.431
Epoch: 12	Train Loss: 0.532	Val F1: 0.345
Best Epoch: 12	Best Val F1: 0.345

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.548
Batch: 3/29	Loss: 0.418
Batch: 5/29	Loss: 0.521
Batch: 7/29	Loss: 0.514
Batch: 9/29	Loss: 0.518
Batch: 11/29	Loss: 0.473
Batch: 13/29	Loss: 0.514
Batch: 15/29	Loss: 0.563
Batch: 17/29	Loss: 0.479
Batch: 19/29	Loss: 0.364
Batch: 21/29	Loss: 0.498
Batch: 23/29	Loss: 0.510
Batch: 25/29	Loss: 0.424
Batch: 27/29	Loss: 0.543
Batch: 29/29	Loss: 0.576
Epoch: 13	Train Loss: 0.506	Val F1: 0.325
Best Epoch: 12	Best Val F1: 0.345

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.521
Batch: 3/29	Loss: 0.500
Batch: 5/29	Loss: 0.378
Batch: 7/29	Loss: 0.514
Batch: 9/29	Loss: 0.512
Batch: 11/29	Loss: 0.517
Batch: 13/29	Loss: 0.468
Batch: 15/29	Loss: 0.413
Batch: 17/29	Loss: 0.548
Batch: 19/29	Loss: 0.541
Batch: 21/29	Loss: 0.377
Batch: 23/29	Loss: 0.392
Batch: 25/29	Loss: 0.498
Batch: 27/29	Loss: 0.497
Batch: 29/29	Loss: 0.498
Epoch: 14	Train Loss: 0.484	Val F1: 0.326
Best Epoch: 12	Best Val F1: 0.345

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.476
Batch: 3/29	Loss: 0.451
Batch: 5/29	Loss: 0.418
Batch: 7/29	Loss: 0.402
Batch: 9/29	Loss: 0.510
Batch: 11/29	Loss: 0.396
Batch: 13/29	Loss: 0.506
Batch: 15/29	Loss: 0.450
Batch: 17/29	Loss: 0.479
Batch: 19/29	Loss: 0.457
Batch: 21/29	Loss: 0.441
Batch: 23/29	Loss: 0.493
Batch: 25/29	Loss: 0.484
Batch: 27/29	Loss: 0.404
Batch: 29/29	Loss: 0.481
Epoch: 15	Train Loss: 0.462	Val F1: 0.348
Best Epoch: 15	Best Val F1: 0.348

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.468
Batch: 3/29	Loss: 0.430
Batch: 5/29	Loss: 0.467
Batch: 7/29	Loss: 0.410
Batch: 9/29	Loss: 0.474
Batch: 11/29	Loss: 0.394
Batch: 13/29	Loss: 0.408
Batch: 15/29	Loss: 0.385
Batch: 17/29	Loss: 0.420
Batch: 19/29	Loss: 0.482
Batch: 21/29	Loss: 0.369
Batch: 23/29	Loss: 0.441
Batch: 25/29	Loss: 0.468
Batch: 27/29	Loss: 0.400
Batch: 29/29	Loss: 0.417
Epoch: 16	Train Loss: 0.432	Val F1: 0.343
Best Epoch: 15	Best Val F1: 0.348

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.403
Batch: 3/29	Loss: 0.523
Batch: 5/29	Loss: 0.447
Batch: 7/29	Loss: 0.380
Batch: 9/29	Loss: 0.346
Batch: 11/29	Loss: 0.433
Batch: 13/29	Loss: 0.448
Batch: 15/29	Loss: 0.447
Batch: 17/29	Loss: 0.424
Batch: 19/29	Loss: 0.416
Batch: 21/29	Loss: 0.464
Batch: 23/29	Loss: 0.458
Batch: 25/29	Loss: 0.282
Batch: 27/29	Loss: 0.455
Batch: 29/29	Loss: 0.467
Epoch: 17	Train Loss: 0.419	Val F1: 0.350
Best Epoch: 17	Best Val F1: 0.350

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.449
Batch: 3/29	Loss: 0.442
Batch: 5/29	Loss: 0.379
Batch: 7/29	Loss: 0.372
Batch: 9/29	Loss: 0.484
Batch: 11/29	Loss: 0.348
Batch: 13/29	Loss: 0.315
Batch: 15/29	Loss: 0.365
Batch: 17/29	Loss: 0.369
Batch: 19/29	Loss: 0.337
Batch: 21/29	Loss: 0.425
Batch: 23/29	Loss: 0.421
Batch: 25/29	Loss: 0.415
Batch: 27/29	Loss: 0.293
Batch: 29/29	Loss: 0.458
Epoch: 18	Train Loss: 0.399	Val F1: 0.340
Best Epoch: 17	Best Val F1: 0.350

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.290
Batch: 3/29	Loss: 0.303
Batch: 5/29	Loss: 0.436
Batch: 7/29	Loss: 0.419
Batch: 9/29	Loss: 0.292
Batch: 11/29	Loss: 0.472
Batch: 13/29	Loss: 0.474
Batch: 15/29	Loss: 0.388
Batch: 17/29	Loss: 0.385
Batch: 19/29	Loss: 0.501
Batch: 21/29	Loss: 0.405
Batch: 23/29	Loss: 0.403
Batch: 25/29	Loss: 0.386
Batch: 27/29	Loss: 0.326
Batch: 29/29	Loss: 0.347
Epoch: 19	Train Loss: 0.393	Val F1: 0.338
Best Epoch: 17	Best Val F1: 0.350

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.452
Batch: 3/29	Loss: 0.421
Batch: 5/29	Loss: 0.341
Batch: 7/29	Loss: 0.372
Batch: 9/29	Loss: 0.444
Batch: 11/29	Loss: 0.428
Batch: 13/29	Loss: 0.413
Batch: 15/29	Loss: 0.400
Batch: 17/29	Loss: 0.466
Batch: 19/29	Loss: 0.345
Batch: 21/29	Loss: 0.393
Batch: 23/29	Loss: 0.451
Batch: 25/29	Loss: 0.353
Batch: 27/29	Loss: 0.369
Batch: 29/29	Loss: 0.477
Epoch: 20	Train Loss: 0.398	Val F1: 0.345
Best Epoch: 17	Best Val F1: 0.350

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.371
Batch: 3/29	Loss: 0.316
Batch: 5/29	Loss: 0.324
Batch: 7/29	Loss: 0.598
Batch: 9/29	Loss: 0.341
Batch: 11/29	Loss: 0.336
Batch: 13/29	Loss: 0.402
Batch: 15/29	Loss: 0.437
Batch: 17/29	Loss: 0.338
Batch: 19/29	Loss: 0.318
Batch: 21/29	Loss: 0.349
Batch: 23/29	Loss: 0.309
Batch: 25/29	Loss: 0.388
Batch: 27/29	Loss: 0.371
Batch: 29/29	Loss: 0.371
Epoch: 21	Train Loss: 0.371	Val F1: 0.338
Best Epoch: 17	Best Val F1: 0.350

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.351
Batch: 3/29	Loss: 0.297
Batch: 5/29	Loss: 0.374
Batch: 7/29	Loss: 0.379
Batch: 9/29	Loss: 0.309
Batch: 11/29	Loss: 0.324
Batch: 13/29	Loss: 0.291
Batch: 15/29	Loss: 0.364
Batch: 17/29	Loss: 0.398
Batch: 19/29	Loss: 0.448
Batch: 21/29	Loss: 0.484
Batch: 23/29	Loss: 0.369
Batch: 25/29	Loss: 0.349
Batch: 27/29	Loss: 0.314
Batch: 29/29	Loss: 0.350
Epoch: 22	Train Loss: 0.355	Val F1: 0.340
Best Epoch: 17	Best Val F1: 0.350

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.345
Batch: 3/29	Loss: 0.378
Batch: 5/29	Loss: 0.371
Batch: 7/29	Loss: 0.457
Batch: 9/29	Loss: 0.309
Batch: 11/29	Loss: 0.384
Batch: 13/29	Loss: 0.320
Batch: 15/29	Loss: 0.364
Batch: 17/29	Loss: 0.322
Batch: 19/29	Loss: 0.390
Batch: 21/29	Loss: 0.338
Batch: 23/29	Loss: 0.324
Batch: 25/29	Loss: 0.391
Batch: 27/29	Loss: 0.268
Batch: 29/29	Loss: 0.403
Epoch: 23	Train Loss: 0.358	Val F1: 0.348
Best Epoch: 17	Best Val F1: 0.350

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.350
Batch: 3/29	Loss: 0.304
Batch: 5/29	Loss: 0.411
Batch: 7/29	Loss: 0.414
Batch: 9/29	Loss: 0.380
Batch: 11/29	Loss: 0.454
Batch: 13/29	Loss: 0.305
Batch: 15/29	Loss: 0.343
Batch: 17/29	Loss: 0.315
Batch: 19/29	Loss: 0.408
Batch: 21/29	Loss: 0.393
Batch: 23/29	Loss: 0.320
Batch: 25/29	Loss: 0.327
Batch: 27/29	Loss: 0.281
Batch: 29/29	Loss: 0.326
Epoch: 24	Train Loss: 0.349	Val F1: 0.345
Best Epoch: 17	Best Val F1: 0.350

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.369
Batch: 3/29	Loss: 0.372
Batch: 5/29	Loss: 0.414
Batch: 7/29	Loss: 0.379
Batch: 9/29	Loss: 0.420
Batch: 11/29	Loss: 0.327
Batch: 13/29	Loss: 0.389
Batch: 15/29	Loss: 0.319
Batch: 17/29	Loss: 0.371
Batch: 19/29	Loss: 0.260
Batch: 21/29	Loss: 0.341
Batch: 23/29	Loss: 0.342
Batch: 25/29	Loss: 0.317
Batch: 27/29	Loss: 0.324
Batch: 29/29	Loss: 0.265
Epoch: 25	Train Loss: 0.329	Val F1: 0.344
Best Epoch: 17	Best Val F1: 0.350

****************************** Epoch: 26 ******************************
Batch: 1/29	Loss: 0.263
Batch: 3/29	Loss: 0.273
Batch: 5/29	Loss: 0.349
Batch: 7/29	Loss: 0.389
Batch: 9/29	Loss: 0.318
Batch: 11/29	Loss: 0.340
Batch: 13/29	Loss: 0.318
Batch: 15/29	Loss: 0.352
Batch: 17/29	Loss: 0.255
Batch: 19/29	Loss: 0.393
Batch: 21/29	Loss: 0.410
Batch: 23/29	Loss: 0.208
Batch: 25/29	Loss: 0.381
Batch: 27/29	Loss: 0.286
Batch: 29/29	Loss: 0.329
Epoch: 26	Train Loss: 0.320	Val F1: 0.347
Best Epoch: 17	Best Val F1: 0.350

****************************** Epoch: 27 ******************************
Batch: 1/29	Loss: 0.276
Batch: 3/29	Loss: 0.339
Batch: 5/29	Loss: 0.416
Batch: 7/29	Loss: 0.224
Batch: 9/29	Loss: 0.423
Batch: 11/29	Loss: 0.283
Batch: 13/29	Loss: 0.415
Batch: 15/29	Loss: 0.336
Batch: 17/29	Loss: 0.299
Batch: 19/29	Loss: 0.320
Batch: 21/29	Loss: 0.342
Batch: 23/29	Loss: 0.279
Batch: 25/29	Loss: 0.284
Batch: 27/29	Loss: 0.315
Batch: 29/29	Loss: 0.352
Epoch: 27	Train Loss: 0.315	Val F1: 0.340
Best Epoch: 17	Best Val F1: 0.350

****************************** Epoch: 28 ******************************
Batch: 1/29	Loss: 0.321
Batch: 3/29	Loss: 0.317
Batch: 5/29	Loss: 0.299
Batch: 7/29	Loss: 0.334
Batch: 9/29	Loss: 0.334
Batch: 11/29	Loss: 0.329
Batch: 13/29	Loss: 0.312
Batch: 15/29	Loss: 0.317
Batch: 17/29	Loss: 0.363
Batch: 19/29	Loss: 0.255
Batch: 21/29	Loss: 0.263
Batch: 23/29	Loss: 0.351
Batch: 25/29	Loss: 0.370
Batch: 27/29	Loss: 0.249
Batch: 29/29	Loss: 0.280
Epoch: 28	Train Loss: 0.311	Val F1: 0.348
Best Epoch: 17	Best Val F1: 0.350

****************************** Epoch: 29 ******************************
Batch: 1/29	Loss: 0.343
Batch: 3/29	Loss: 0.310
Batch: 5/29	Loss: 0.264
Batch: 7/29	Loss: 0.259
Batch: 9/29	Loss: 0.232
Batch: 11/29	Loss: 0.340
Batch: 13/29	Loss: 0.366
Batch: 15/29	Loss: 0.189
Batch: 17/29	Loss: 0.305
Batch: 19/29	Loss: 0.240
Batch: 21/29	Loss: 0.347
Batch: 23/29	Loss: 0.280
Batch: 25/29	Loss: 0.302
Batch: 27/29	Loss: 0.298
Batch: 29/29	Loss: 0.324
Epoch: 29	Train Loss: 0.293	Val F1: 0.350
Best Epoch: 29	Best Val F1: 0.350

****************************** Epoch: 30 ******************************
Batch: 1/29	Loss: 0.224
Batch: 3/29	Loss: 0.237
Batch: 5/29	Loss: 0.354
Batch: 7/29	Loss: 0.275
Batch: 9/29	Loss: 0.295
Batch: 11/29	Loss: 0.276
Batch: 13/29	Loss: 0.310
Batch: 15/29	Loss: 0.250
Batch: 17/29	Loss: 0.259
Batch: 19/29	Loss: 0.261
Batch: 21/29	Loss: 0.314
Batch: 23/29	Loss: 0.318
Batch: 25/29	Loss: 0.278
Batch: 27/29	Loss: 0.247
Batch: 29/29	Loss: 0.247
Epoch: 30	Train Loss: 0.287	Val F1: 0.348
Best Epoch: 29	Best Val F1: 0.350

****************************** Epoch: 31 ******************************
Batch: 1/29	Loss: 0.255
Batch: 3/29	Loss: 0.243
Batch: 5/29	Loss: 0.251
Batch: 7/29	Loss: 0.229
Batch: 9/29	Loss: 0.279
Batch: 11/29	Loss: 0.265
Batch: 13/29	Loss: 0.294
Batch: 15/29	Loss: 0.236
Batch: 17/29	Loss: 0.293
Batch: 19/29	Loss: 0.248
Batch: 21/29	Loss: 0.273
Batch: 23/29	Loss: 0.269
Batch: 25/29	Loss: 0.331
Batch: 27/29	Loss: 0.232
Batch: 29/29	Loss: 0.232
Epoch: 31	Train Loss: 0.273	Val F1: 0.349
Best Epoch: 29	Best Val F1: 0.350

****************************** Epoch: 32 ******************************
Batch: 1/29	Loss: 0.334
Batch: 3/29	Loss: 0.274
Batch: 5/29	Loss: 0.245
Batch: 7/29	Loss: 0.258
Batch: 9/29	Loss: 0.251
Batch: 11/29	Loss: 0.279
Batch: 13/29	Loss: 0.262
Batch: 15/29	Loss: 0.168
Batch: 17/29	Loss: 0.280
Batch: 19/29	Loss: 0.303
Batch: 21/29	Loss: 0.239
Batch: 23/29	Loss: 0.301
Batch: 25/29	Loss: 0.288
Batch: 27/29	Loss: 0.169
Batch: 29/29	Loss: 0.290
Epoch: 32	Train Loss: 0.264	Val F1: 0.342
Best Epoch: 29	Best Val F1: 0.350

****************************** Epoch: 33 ******************************
Batch: 1/29	Loss: 0.296
Batch: 3/29	Loss: 0.243
Batch: 5/29	Loss: 0.244
Batch: 7/29	Loss: 0.273
Batch: 9/29	Loss: 0.322
Batch: 11/29	Loss: 0.225
Batch: 13/29	Loss: 0.259
Batch: 15/29	Loss: 0.302
Batch: 17/29	Loss: 0.274
Batch: 19/29	Loss: 0.290
Batch: 21/29	Loss: 0.254
Batch: 23/29	Loss: 0.244
Batch: 25/29	Loss: 0.277
Batch: 27/29	Loss: 0.278
Batch: 29/29	Loss: 0.306
Epoch: 33	Train Loss: 0.264	Val F1: 0.355
Best Epoch: 33	Best Val F1: 0.355

****************************** Epoch: 34 ******************************
Batch: 1/29	Loss: 0.217
Batch: 3/29	Loss: 0.258
Batch: 5/29	Loss: 0.234
Batch: 7/29	Loss: 0.229
Batch: 9/29	Loss: 0.271
Batch: 11/29	Loss: 0.299
Batch: 13/29	Loss: 0.192
Batch: 15/29	Loss: 0.287
Batch: 17/29	Loss: 0.303
Batch: 19/29	Loss: 0.200
Batch: 21/29	Loss: 0.292
Batch: 23/29	Loss: 0.205
Batch: 25/29	Loss: 0.213
Batch: 27/29	Loss: 0.216
Batch: 29/29	Loss: 0.263
Epoch: 34	Train Loss: 0.253	Val F1: 0.343
Best Epoch: 33	Best Val F1: 0.355

****************************** Epoch: 35 ******************************
Batch: 1/29	Loss: 0.218
Batch: 3/29	Loss: 0.231
Batch: 5/29	Loss: 0.221
Batch: 7/29	Loss: 0.239
Batch: 9/29	Loss: 0.247
Batch: 11/29	Loss: 0.197
Batch: 13/29	Loss: 0.232
Batch: 15/29	Loss: 0.241
Batch: 17/29	Loss: 0.275
Batch: 19/29	Loss: 0.244
Batch: 21/29	Loss: 0.268
Batch: 23/29	Loss: 0.278
Batch: 25/29	Loss: 0.238
Batch: 27/29	Loss: 0.220
Batch: 29/29	Loss: 0.238
Epoch: 35	Train Loss: 0.250	Val F1: 0.355
Best Epoch: 35	Best Val F1: 0.355

****************************** Epoch: 36 ******************************
Batch: 1/29	Loss: 0.238
Batch: 3/29	Loss: 0.242
Batch: 5/29	Loss: 0.197
Batch: 7/29	Loss: 0.196
Batch: 9/29	Loss: 0.184
Batch: 11/29	Loss: 0.184
Batch: 13/29	Loss: 0.290
Batch: 15/29	Loss: 0.250
Batch: 17/29	Loss: 0.256
Batch: 19/29	Loss: 0.229
Batch: 21/29	Loss: 0.239
Batch: 23/29	Loss: 0.257
Batch: 25/29	Loss: 0.201
Batch: 27/29	Loss: 0.214
Batch: 29/29	Loss: 0.209
Epoch: 36	Train Loss: 0.232	Val F1: 0.350
Best Epoch: 35	Best Val F1: 0.355

****************************** Epoch: 37 ******************************
Batch: 1/29	Loss: 0.171
Batch: 3/29	Loss: 0.327
Batch: 5/29	Loss: 0.270
Batch: 7/29	Loss: 0.189
Batch: 9/29	Loss: 0.212
Batch: 11/29	Loss: 0.265
Batch: 13/29	Loss: 0.242
Batch: 15/29	Loss: 0.193
Batch: 17/29	Loss: 0.185
Batch: 19/29	Loss: 0.235
Batch: 21/29	Loss: 0.228
Batch: 23/29	Loss: 0.227
Batch: 25/29	Loss: 0.177
Batch: 27/29	Loss: 0.159
Batch: 29/29	Loss: 0.230
Epoch: 37	Train Loss: 0.227	Val F1: 0.355
Best Epoch: 37	Best Val F1: 0.355

****************************** Epoch: 38 ******************************
Batch: 1/29	Loss: 0.199
Batch: 3/29	Loss: 0.280
Batch: 5/29	Loss: 0.171
Batch: 7/29	Loss: 0.194
Batch: 9/29	Loss: 0.229
Batch: 11/29	Loss: 0.206
Batch: 13/29	Loss: 0.191
Batch: 15/29	Loss: 0.237
Batch: 17/29	Loss: 0.217
Batch: 19/29	Loss: 0.227
Batch: 21/29	Loss: 0.142
Batch: 23/29	Loss: 0.207
Batch: 25/29	Loss: 0.179
Batch: 27/29	Loss: 0.234
Batch: 29/29	Loss: 0.222
Epoch: 38	Train Loss: 0.206	Val F1: 0.346
Best Epoch: 37	Best Val F1: 0.355

****************************** Epoch: 39 ******************************
Batch: 1/29	Loss: 0.176
Batch: 3/29	Loss: 0.276
Batch: 5/29	Loss: 0.195
Batch: 7/29	Loss: 0.256
Batch: 9/29	Loss: 0.184
Batch: 11/29	Loss: 0.191
Batch: 13/29	Loss: 0.197
Batch: 15/29	Loss: 0.225
Batch: 17/29	Loss: 0.219
Batch: 19/29	Loss: 0.182
Batch: 21/29	Loss: 0.156
Batch: 23/29	Loss: 0.186
Batch: 25/29	Loss: 0.227
Batch: 27/29	Loss: 0.258
Batch: 29/29	Loss: 0.272
Epoch: 39	Train Loss: 0.217	Val F1: 0.358
Best Epoch: 39	Best Val F1: 0.358

****************************** Epoch: 40 ******************************
Batch: 1/29	Loss: 0.249
Batch: 3/29	Loss: 0.206
Batch: 5/29	Loss: 0.184
Batch: 7/29	Loss: 0.227
Batch: 9/29	Loss: 0.212
Batch: 11/29	Loss: 0.133
Batch: 13/29	Loss: 0.220
Batch: 15/29	Loss: 0.260
Batch: 17/29	Loss: 0.270
Batch: 19/29	Loss: 0.244
Batch: 21/29	Loss: 0.190
Batch: 23/29	Loss: 0.158
Batch: 25/29	Loss: 0.143
Batch: 27/29	Loss: 0.131
Batch: 29/29	Loss: 0.199
Epoch: 40	Train Loss: 0.202	Val F1: 0.353
Best Epoch: 39	Best Val F1: 0.358

****************************** Epoch: 41 ******************************
Batch: 1/29	Loss: 0.149
Batch: 3/29	Loss: 0.247
Batch: 5/29	Loss: 0.160
Batch: 7/29	Loss: 0.221
Batch: 9/29	Loss: 0.136
Batch: 11/29	Loss: 0.220
Batch: 13/29	Loss: 0.185
Batch: 15/29	Loss: 0.165
Batch: 17/29	Loss: 0.210
Batch: 19/29	Loss: 0.177
Batch: 21/29	Loss: 0.149
Batch: 23/29	Loss: 0.183
Batch: 25/29	Loss: 0.193
Batch: 27/29	Loss: 0.223
Batch: 29/29	Loss: 0.193
Epoch: 41	Train Loss: 0.182	Val F1: 0.346
Best Epoch: 39	Best Val F1: 0.358

****************************** Epoch: 42 ******************************
Batch: 1/29	Loss: 0.195
Batch: 3/29	Loss: 0.241
Batch: 5/29	Loss: 0.185
Batch: 7/29	Loss: 0.174
Batch: 9/29	Loss: 0.206
Batch: 11/29	Loss: 0.224
Batch: 13/29	Loss: 0.175
Batch: 15/29	Loss: 0.098
Batch: 17/29	Loss: 0.177
Batch: 19/29	Loss: 0.175
Batch: 21/29	Loss: 0.193
Batch: 23/29	Loss: 0.184
Batch: 25/29	Loss: 0.147
Batch: 27/29	Loss: 0.170
Batch: 29/29	Loss: 0.109
Epoch: 42	Train Loss: 0.169	Val F1: 0.346
Best Epoch: 39	Best Val F1: 0.358

****************************** Epoch: 43 ******************************
Batch: 1/29	Loss: 0.167
Batch: 3/29	Loss: 0.137
Batch: 5/29	Loss: 0.229
Batch: 7/29	Loss: 0.182
Batch: 9/29	Loss: 0.216
Batch: 11/29	Loss: 0.177
Batch: 13/29	Loss: 0.212
Batch: 15/29	Loss: 0.153
Batch: 17/29	Loss: 0.274
Batch: 19/29	Loss: 0.154
Batch: 21/29	Loss: 0.181
Batch: 23/29	Loss: 0.143
Batch: 25/29	Loss: 0.146
Batch: 27/29	Loss: 0.176
Batch: 29/29	Loss: 0.149
Epoch: 43	Train Loss: 0.183	Val F1: 0.347
Best Epoch: 39	Best Val F1: 0.358

****************************** Epoch: 44 ******************************
Batch: 1/29	Loss: 0.159
Batch: 3/29	Loss: 0.188
Batch: 5/29	Loss: 0.168
Batch: 7/29	Loss: 0.153
Batch: 9/29	Loss: 0.216
Batch: 11/29	Loss: 0.145
Batch: 13/29	Loss: 0.125
Batch: 15/29	Loss: 0.166
Batch: 17/29	Loss: 0.130
Batch: 19/29	Loss: 0.174
Batch: 21/29	Loss: 0.173
Batch: 23/29	Loss: 0.158
Batch: 25/29	Loss: 0.189
Batch: 27/29	Loss: 0.152
Batch: 29/29	Loss: 0.122
Epoch: 44	Train Loss: 0.162	Val F1: 0.353
Best Epoch: 39	Best Val F1: 0.358

****************************** Epoch: 45 ******************************
Batch: 1/29	Loss: 0.097
Batch: 3/29	Loss: 0.102
Batch: 5/29	Loss: 0.212
Batch: 7/29	Loss: 0.133
Batch: 9/29	Loss: 0.176
Batch: 11/29	Loss: 0.149
Batch: 13/29	Loss: 0.176
Batch: 15/29	Loss: 0.115
Batch: 17/29	Loss: 0.128
Batch: 19/29	Loss: 0.095
Batch: 21/29	Loss: 0.141
Batch: 23/29	Loss: 0.159
Batch: 25/29	Loss: 0.122
Batch: 27/29	Loss: 0.108
Batch: 29/29	Loss: 0.171
Epoch: 45	Train Loss: 0.140	Val F1: 0.357
Best Epoch: 39	Best Val F1: 0.358

****************************** Epoch: 46 ******************************
Batch: 1/29	Loss: 0.120
Batch: 3/29	Loss: 0.163
Batch: 5/29	Loss: 0.148
Batch: 7/29	Loss: 0.165
Batch: 9/29	Loss: 0.079
Batch: 11/29	Loss: 0.119
Batch: 13/29	Loss: 0.151
Batch: 15/29	Loss: 0.122
Batch: 17/29	Loss: 0.152
Batch: 19/29	Loss: 0.151
Batch: 21/29	Loss: 0.160
Batch: 23/29	Loss: 0.082
Batch: 25/29	Loss: 0.107
Batch: 27/29	Loss: 0.125
Batch: 29/29	Loss: 0.103
Epoch: 46	Train Loss: 0.131	Val F1: 0.348
Best Epoch: 39	Best Val F1: 0.358

****************************** Epoch: 47 ******************************
Batch: 1/29	Loss: 0.112
Batch: 3/29	Loss: 0.179
Batch: 5/29	Loss: 0.147
Batch: 7/29	Loss: 0.135
Batch: 9/29	Loss: 0.204
Batch: 11/29	Loss: 0.162
Batch: 13/29	Loss: 0.176
Batch: 15/29	Loss: 0.145
Batch: 17/29	Loss: 0.091
Batch: 19/29	Loss: 0.135
Batch: 21/29	Loss: 0.144
Batch: 23/29	Loss: 0.167
Batch: 25/29	Loss: 0.131
Batch: 27/29	Loss: 0.089
Batch: 29/29	Loss: 0.130
Epoch: 47	Train Loss: 0.136	Val F1: 0.357
Best Epoch: 39	Best Val F1: 0.358

****************************** Epoch: 48 ******************************
Batch: 1/29	Loss: 0.099
Batch: 3/29	Loss: 0.122
Batch: 5/29	Loss: 0.158
Batch: 7/29	Loss: 0.128
Batch: 9/29	Loss: 0.139
Batch: 11/29	Loss: 0.165
Batch: 13/29	Loss: 0.190
Batch: 15/29	Loss: 0.123
Batch: 17/29	Loss: 0.177
Batch: 19/29	Loss: 0.099
Batch: 21/29	Loss: 0.145
Batch: 23/29	Loss: 0.108
Batch: 25/29	Loss: 0.100
Batch: 27/29	Loss: 0.121
Batch: 29/29	Loss: 0.083
Epoch: 48	Train Loss: 0.127	Val F1: 0.351
Best Epoch: 39	Best Val F1: 0.358

****************************** Epoch: 49 ******************************
Batch: 1/29	Loss: 0.110
Batch: 3/29	Loss: 0.131
Batch: 5/29	Loss: 0.136
Batch: 7/29	Loss: 0.154
Batch: 9/29	Loss: 0.108
Batch: 11/29	Loss: 0.162
Batch: 13/29	Loss: 0.145
Batch: 15/29	Loss: 0.073
Batch: 17/29	Loss: 0.099
Batch: 19/29	Loss: 0.151
Batch: 21/29	Loss: 0.080
Batch: 23/29	Loss: 0.117
Batch: 25/29	Loss: 0.137
Batch: 27/29	Loss: 0.102
Batch: 29/29	Loss: 0.104
Epoch: 49	Train Loss: 0.120	Val F1: 0.354
Best Epoch: 39	Best Val F1: 0.358

****************************** Epoch: 50 ******************************
Batch: 1/29	Loss: 0.089
Batch: 3/29	Loss: 0.161
Batch: 5/29	Loss: 0.102
Batch: 7/29	Loss: 0.123
Batch: 9/29	Loss: 0.121
Batch: 11/29	Loss: 0.135
Batch: 13/29	Loss: 0.128
Batch: 15/29	Loss: 0.127
Batch: 17/29	Loss: 0.143
Batch: 19/29	Loss: 0.113
Batch: 21/29	Loss: 0.117
Batch: 23/29	Loss: 0.091
Batch: 25/29	Loss: 0.087
Batch: 27/29	Loss: 0.174
Batch: 29/29	Loss: 0.158
Epoch: 50	Train Loss: 0.118	Val F1: 0.352
Best Epoch: 39	Best Val F1: 0.358

Saving the best checkpoint....
Inference...
Test F1: 0.362	Test F1_Few: 0.448	Test F1_Zero: 0.347
Starting training with config: {'batch_size': 32, 'epochs': 25, 'l2_reg': 0.0007718276037470111, 'lr': 2.6424786039762423e-05, 'n_layers_freeze': 1, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 1.014
Batch: 11/58	Loss: 0.940
Batch: 16/58	Loss: 0.877
Batch: 21/58	Loss: 0.890
Batch: 26/58	Loss: 0.882
Batch: 31/58	Loss: 0.846
Batch: 36/58	Loss: 0.876
Batch: 41/58	Loss: 0.817
Batch: 46/58	Loss: 0.801
Batch: 51/58	Loss: 0.787
Batch: 56/58	Loss: 0.794
Batch: 58/58	Loss: 0.803
Epoch: 1	Train Loss: 0.885	Val F1: 0.213
Best Epoch: 1	Best Val F1: 0.213

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.811
Batch: 6/58	Loss: 0.824
Batch: 11/58	Loss: 0.826
Batch: 16/58	Loss: 0.756
Batch: 21/58	Loss: 0.755
Batch: 26/58	Loss: 0.768
Batch: 31/58	Loss: 0.813
Batch: 36/58	Loss: 0.809
Batch: 41/58	Loss: 0.752
Batch: 46/58	Loss: 0.749
Batch: 51/58	Loss: 0.754
Batch: 56/58	Loss: 0.753
Batch: 58/58	Loss: 0.722
Epoch: 2	Train Loss: 0.782	Val F1: 0.294
Best Epoch: 2	Best Val F1: 0.294

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.719
Batch: 6/58	Loss: 0.698
Batch: 11/58	Loss: 0.771
Batch: 16/58	Loss: 0.697
Batch: 21/58	Loss: 0.750
Batch: 26/58	Loss: 0.715
Batch: 31/58	Loss: 0.889
Batch: 36/58	Loss: 0.750
Batch: 41/58	Loss: 0.645
Batch: 46/58	Loss: 0.704
Batch: 51/58	Loss: 0.748
Batch: 56/58	Loss: 0.753
Batch: 58/58	Loss: 0.736
Epoch: 3	Train Loss: 0.733	Val F1: 0.323
Best Epoch: 3	Best Val F1: 0.323

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.726
Batch: 6/58	Loss: 0.667
Batch: 11/58	Loss: 0.637
Batch: 16/58	Loss: 0.625
Batch: 21/58	Loss: 0.652
Batch: 26/58	Loss: 0.555
Batch: 31/58	Loss: 0.592
Batch: 36/58	Loss: 0.772
Batch: 41/58	Loss: 0.713
Batch: 46/58	Loss: 0.651
Batch: 51/58	Loss: 0.542
Batch: 56/58	Loss: 0.533
Batch: 58/58	Loss: 0.582
Epoch: 4	Train Loss: 0.671	Val F1: 0.345
Best Epoch: 4	Best Val F1: 0.345

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.571
Batch: 6/58	Loss: 0.536
Batch: 11/58	Loss: 0.593
Batch: 16/58	Loss: 0.574
Batch: 21/58	Loss: 0.464
Batch: 26/58	Loss: 0.560
Batch: 31/58	Loss: 0.719
Batch: 36/58	Loss: 0.650
Batch: 41/58	Loss: 0.616
Batch: 46/58	Loss: 0.689
Batch: 51/58	Loss: 0.841
Batch: 56/58	Loss: 0.693
Batch: 58/58	Loss: 0.825
Epoch: 5	Train Loss: 0.623	Val F1: 0.356
Best Epoch: 5	Best Val F1: 0.356

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.581
Batch: 6/58	Loss: 0.793
Batch: 11/58	Loss: 0.673
Batch: 16/58	Loss: 0.582
Batch: 21/58	Loss: 0.584
Batch: 26/58	Loss: 0.448
Batch: 31/58	Loss: 0.510
Batch: 36/58	Loss: 0.451
Batch: 41/58	Loss: 0.599
Batch: 46/58	Loss: 0.546
Batch: 51/58	Loss: 0.520
Batch: 56/58	Loss: 0.518
Batch: 58/58	Loss: 0.415
Epoch: 6	Train Loss: 0.575	Val F1: 0.337
Best Epoch: 5	Best Val F1: 0.356

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.414
Batch: 6/58	Loss: 0.596
Batch: 11/58	Loss: 0.579
Batch: 16/58	Loss: 0.462
Batch: 21/58	Loss: 0.413
Batch: 26/58	Loss: 0.570
Batch: 31/58	Loss: 0.553
Batch: 36/58	Loss: 0.466
Batch: 41/58	Loss: 0.504
Batch: 46/58	Loss: 0.400
Batch: 51/58	Loss: 0.424
Batch: 56/58	Loss: 0.570
Batch: 58/58	Loss: 0.301
Epoch: 7	Train Loss: 0.496	Val F1: 0.335
Best Epoch: 5	Best Val F1: 0.356

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.457
Batch: 6/58	Loss: 0.503
Batch: 11/58	Loss: 0.414
Batch: 16/58	Loss: 0.387
Batch: 21/58	Loss: 0.388
Batch: 26/58	Loss: 0.343
Batch: 31/58	Loss: 0.376
Batch: 36/58	Loss: 0.337
Batch: 41/58	Loss: 0.505
Batch: 46/58	Loss: 0.533
Batch: 51/58	Loss: 0.371
Batch: 56/58	Loss: 0.360
Batch: 58/58	Loss: 0.534
Epoch: 8	Train Loss: 0.453	Val F1: 0.312
Best Epoch: 5	Best Val F1: 0.356

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.515
Batch: 6/58	Loss: 0.539
Batch: 11/58	Loss: 0.496
Batch: 16/58	Loss: 0.341
Batch: 21/58	Loss: 0.417
Batch: 26/58	Loss: 0.285
Batch: 31/58	Loss: 0.321
Batch: 36/58	Loss: 0.387
Batch: 41/58	Loss: 0.434
Batch: 46/58	Loss: 0.367
Batch: 51/58	Loss: 0.458
Batch: 56/58	Loss: 0.299
Batch: 58/58	Loss: 0.380
Epoch: 9	Train Loss: 0.395	Val F1: 0.331
Best Epoch: 5	Best Val F1: 0.356

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.343
Batch: 6/58	Loss: 0.349
Batch: 11/58	Loss: 0.412
Batch: 16/58	Loss: 0.502
Batch: 21/58	Loss: 0.309
Batch: 26/58	Loss: 0.347
Batch: 31/58	Loss: 0.279
Batch: 36/58	Loss: 0.588
Batch: 41/58	Loss: 0.381
Batch: 46/58	Loss: 0.442
Batch: 51/58	Loss: 0.275
Batch: 56/58	Loss: 0.298
Batch: 58/58	Loss: 0.430
Epoch: 10	Train Loss: 0.352	Val F1: 0.341
Best Epoch: 5	Best Val F1: 0.356

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.302
Batch: 6/58	Loss: 0.290
Batch: 11/58	Loss: 0.268
Batch: 16/58	Loss: 0.323
Batch: 21/58	Loss: 0.338
Batch: 26/58	Loss: 0.351
Batch: 31/58	Loss: 0.382
Batch: 36/58	Loss: 0.325
Batch: 41/58	Loss: 0.253
Batch: 46/58	Loss: 0.317
Batch: 51/58	Loss: 0.362
Batch: 56/58	Loss: 0.338
Batch: 58/58	Loss: 0.338
Epoch: 11	Train Loss: 0.315	Val F1: 0.351
Best Epoch: 5	Best Val F1: 0.356

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.325
Batch: 6/58	Loss: 0.259
Batch: 11/58	Loss: 0.286
Batch: 16/58	Loss: 0.256
Batch: 21/58	Loss: 0.354
Batch: 26/58	Loss: 0.274
Batch: 31/58	Loss: 0.366
Batch: 36/58	Loss: 0.343
Batch: 41/58	Loss: 0.247
Batch: 46/58	Loss: 0.299
Batch: 51/58	Loss: 0.353
Batch: 56/58	Loss: 0.238
Batch: 58/58	Loss: 0.139
Epoch: 12	Train Loss: 0.284	Val F1: 0.339
Best Epoch: 5	Best Val F1: 0.356

****************************** Epoch: 13 ******************************
Batch: 1/58	Loss: 0.194
Batch: 6/58	Loss: 0.231
Batch: 11/58	Loss: 0.289
Batch: 16/58	Loss: 0.230
Batch: 21/58	Loss: 0.259
Batch: 26/58	Loss: 0.247
Batch: 31/58	Loss: 0.222
Batch: 36/58	Loss: 0.242
Batch: 41/58	Loss: 0.234
Batch: 46/58	Loss: 0.249
Batch: 51/58	Loss: 0.263
Batch: 56/58	Loss: 0.332
Batch: 58/58	Loss: 0.189
Epoch: 13	Train Loss: 0.261	Val F1: 0.337
Best Epoch: 5	Best Val F1: 0.356

****************************** Epoch: 14 ******************************
Batch: 1/58	Loss: 0.367
Batch: 6/58	Loss: 0.289
Batch: 11/58	Loss: 0.214
Batch: 16/58	Loss: 0.239
Batch: 21/58	Loss: 0.191
Batch: 26/58	Loss: 0.260
Batch: 31/58	Loss: 0.222
Batch: 36/58	Loss: 0.208
Batch: 41/58	Loss: 0.110
Batch: 46/58	Loss: 0.197
Batch: 51/58	Loss: 0.238
Batch: 56/58	Loss: 0.144
Batch: 58/58	Loss: 0.225
Epoch: 14	Train Loss: 0.226	Val F1: 0.352
Best Epoch: 5	Best Val F1: 0.356

****************************** Epoch: 15 ******************************
Batch: 1/58	Loss: 0.139
Batch: 6/58	Loss: 0.296
Batch: 11/58	Loss: 0.182
Batch: 16/58	Loss: 0.180
Batch: 21/58	Loss: 0.244
Batch: 26/58	Loss: 0.151
Batch: 31/58	Loss: 0.191
Batch: 36/58	Loss: 0.220
Batch: 41/58	Loss: 0.206
Batch: 46/58	Loss: 0.151
Batch: 51/58	Loss: 0.221
Batch: 56/58	Loss: 0.146
Batch: 58/58	Loss: 0.187
Epoch: 15	Train Loss: 0.202	Val F1: 0.346
Best Epoch: 5	Best Val F1: 0.356

****************************** Epoch: 16 ******************************
Batch: 1/58	Loss: 0.179
Batch: 6/58	Loss: 0.073
Batch: 11/58	Loss: 0.081
Batch: 16/58	Loss: 0.145
Batch: 21/58	Loss: 0.135
Batch: 26/58	Loss: 0.141
Batch: 31/58	Loss: 0.186
Batch: 36/58	Loss: 0.112
Batch: 41/58	Loss: 0.101
Batch: 46/58	Loss: 0.149
Batch: 51/58	Loss: 0.168
Batch: 56/58	Loss: 0.103
Batch: 58/58	Loss: 0.137
Epoch: 16	Train Loss: 0.158	Val F1: 0.349
Best Epoch: 5	Best Val F1: 0.356

****************************** Epoch: 17 ******************************
Batch: 1/58	Loss: 0.131
Batch: 6/58	Loss: 0.164
Batch: 11/58	Loss: 0.107
Batch: 16/58	Loss: 0.139
Batch: 21/58	Loss: 0.163
Batch: 26/58	Loss: 0.115
Batch: 31/58	Loss: 0.089
Batch: 36/58	Loss: 0.074
Batch: 41/58	Loss: 0.194
Batch: 46/58	Loss: 0.199
Batch: 51/58	Loss: 0.075
Batch: 56/58	Loss: 0.104
Batch: 58/58	Loss: 0.199
Epoch: 17	Train Loss: 0.120	Val F1: 0.351
Best Epoch: 5	Best Val F1: 0.356

****************************** Epoch: 18 ******************************
Batch: 1/58	Loss: 0.087
Batch: 6/58	Loss: 0.190
Batch: 11/58	Loss: 0.078
Batch: 16/58	Loss: 0.108
Batch: 21/58	Loss: 0.196
Batch: 26/58	Loss: 0.101
Batch: 31/58	Loss: 0.069
Batch: 36/58	Loss: 0.050
Batch: 41/58	Loss: 0.076
Batch: 46/58	Loss: 0.134
Batch: 51/58	Loss: 0.059
Batch: 56/58	Loss: 0.086
Batch: 58/58	Loss: 0.123
Epoch: 18	Train Loss: 0.095	Val F1: 0.342
Best Epoch: 5	Best Val F1: 0.356

****************************** Epoch: 19 ******************************
Batch: 1/58	Loss: 0.104
Batch: 6/58	Loss: 0.088
Batch: 11/58	Loss: 0.091
Batch: 16/58	Loss: 0.076
Batch: 21/58	Loss: 0.082
Batch: 26/58	Loss: 0.078
Batch: 31/58	Loss: 0.069
Batch: 36/58	Loss: 0.066
Batch: 41/58	Loss: 0.039
Batch: 46/58	Loss: 0.085
Batch: 51/58	Loss: 0.053
Batch: 56/58	Loss: 0.059
Batch: 58/58	Loss: 0.074
Epoch: 19	Train Loss: 0.081	Val F1: 0.349
Best Epoch: 5	Best Val F1: 0.356

****************************** Epoch: 20 ******************************
Batch: 1/58	Loss: 0.071
Batch: 6/58	Loss: 0.057
Batch: 11/58	Loss: 0.062
Batch: 16/58	Loss: 0.057
Batch: 21/58	Loss: 0.045
Batch: 26/58	Loss: 0.084
Batch: 31/58	Loss: 0.151
Batch: 36/58	Loss: 0.053
Batch: 41/58	Loss: 0.048
Batch: 46/58	Loss: 0.103
Batch: 51/58	Loss: 0.037
Batch: 56/58	Loss: 0.025
Batch: 58/58	Loss: 0.058
Epoch: 20	Train Loss: 0.068	Val F1: 0.339
Best Epoch: 5	Best Val F1: 0.356

Saving the best checkpoint....
Inference...
Test F1: 0.375	Test F1_Few: 0.446	Test F1_Zero: 0.370
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0007995067970859197, 'lr': 8.496671751096136e-06, 'n_layers_freeze': 1, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.085
Batch: 5/29	Loss: 1.070
Batch: 7/29	Loss: 1.059
Batch: 9/29	Loss: 1.047
Batch: 11/29	Loss: 1.034
Batch: 13/29	Loss: 1.023
Batch: 15/29	Loss: 1.021
Batch: 17/29	Loss: 0.992
Batch: 19/29	Loss: 0.985
Batch: 21/29	Loss: 0.971
Batch: 23/29	Loss: 0.967
Batch: 25/29	Loss: 0.947
Batch: 27/29	Loss: 0.937
Batch: 29/29	Loss: 0.939
Epoch: 1	Train Loss: 1.011	Val F1: 0.195
Best Epoch: 1	Best Val F1: 0.195

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.931
Batch: 3/29	Loss: 0.929
Batch: 5/29	Loss: 0.943
Batch: 7/29	Loss: 0.916
Batch: 9/29	Loss: 0.923
Batch: 11/29	Loss: 0.892
Batch: 13/29	Loss: 0.890
Batch: 15/29	Loss: 0.907
Batch: 17/29	Loss: 0.894
Batch: 19/29	Loss: 0.913
Batch: 21/29	Loss: 0.882
Batch: 23/29	Loss: 0.885
Batch: 25/29	Loss: 0.870
Batch: 27/29	Loss: 0.909
Batch: 29/29	Loss: 0.871
Epoch: 2	Train Loss: 0.901	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.195

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.863
Batch: 3/29	Loss: 0.874
Batch: 5/29	Loss: 0.867
Batch: 7/29	Loss: 0.886
Batch: 9/29	Loss: 0.853
Batch: 11/29	Loss: 0.852
Batch: 13/29	Loss: 0.880
Batch: 15/29	Loss: 0.853
Batch: 17/29	Loss: 0.866
Batch: 19/29	Loss: 0.862
Batch: 21/29	Loss: 0.846
Batch: 23/29	Loss: 0.842
Batch: 25/29	Loss: 0.854
Batch: 27/29	Loss: 0.835
Batch: 29/29	Loss: 0.841
Epoch: 3	Train Loss: 0.859	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.195

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.830
Batch: 3/29	Loss: 0.842
Batch: 5/29	Loss: 0.823
Batch: 7/29	Loss: 0.859
Batch: 9/29	Loss: 0.848
Batch: 11/29	Loss: 0.817
Batch: 13/29	Loss: 0.824
Batch: 15/29	Loss: 0.811
Batch: 17/29	Loss: 0.822
Batch: 19/29	Loss: 0.837
Batch: 21/29	Loss: 0.845
Batch: 23/29	Loss: 0.845
Batch: 25/29	Loss: 0.833
Batch: 27/29	Loss: 0.845
Batch: 29/29	Loss: 0.831
Epoch: 4	Train Loss: 0.833	Val F1: 0.223
Best Epoch: 4	Best Val F1: 0.223

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.818
Batch: 3/29	Loss: 0.811
Batch: 5/29	Loss: 0.804
Batch: 7/29	Loss: 0.798
Batch: 9/29	Loss: 0.796
Batch: 11/29	Loss: 0.802
Batch: 13/29	Loss: 0.794
Batch: 15/29	Loss: 0.817
Batch: 17/29	Loss: 0.837
Batch: 19/29	Loss: 0.807
Batch: 21/29	Loss: 0.786
Batch: 23/29	Loss: 0.806
Batch: 25/29	Loss: 0.818
Batch: 27/29	Loss: 0.780
Batch: 29/29	Loss: 0.798
Epoch: 5	Train Loss: 0.810	Val F1: 0.294
Best Epoch: 5	Best Val F1: 0.294

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.788
Batch: 3/29	Loss: 0.827
Batch: 5/29	Loss: 0.778
Batch: 7/29	Loss: 0.831
Batch: 9/29	Loss: 0.782
Batch: 11/29	Loss: 0.792
Batch: 13/29	Loss: 0.771
Batch: 15/29	Loss: 0.751
Batch: 17/29	Loss: 0.760
Batch: 19/29	Loss: 0.746
Batch: 21/29	Loss: 0.792
Batch: 23/29	Loss: 0.755
Batch: 25/29	Loss: 0.768
Batch: 27/29	Loss: 0.764
Batch: 29/29	Loss: 0.761
Epoch: 6	Train Loss: 0.778	Val F1: 0.318
Best Epoch: 6	Best Val F1: 0.318

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.739
Batch: 3/29	Loss: 0.808
Batch: 5/29	Loss: 0.807
Batch: 7/29	Loss: 0.763
Batch: 9/29	Loss: 0.772
Batch: 11/29	Loss: 0.726
Batch: 13/29	Loss: 0.730
Batch: 15/29	Loss: 0.754
Batch: 17/29	Loss: 0.761
Batch: 19/29	Loss: 0.760
Batch: 21/29	Loss: 0.711
Batch: 23/29	Loss: 0.702
Batch: 25/29	Loss: 0.680
Batch: 27/29	Loss: 0.725
Batch: 29/29	Loss: 0.689
Epoch: 7	Train Loss: 0.743	Val F1: 0.339
Best Epoch: 7	Best Val F1: 0.339

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.729
Batch: 3/29	Loss: 0.685
Batch: 5/29	Loss: 0.716
Batch: 7/29	Loss: 0.693
Batch: 9/29	Loss: 0.713
Batch: 11/29	Loss: 0.715
Batch: 13/29	Loss: 0.774
Batch: 15/29	Loss: 0.675
Batch: 17/29	Loss: 0.766
Batch: 19/29	Loss: 0.724
Batch: 21/29	Loss: 0.732
Batch: 23/29	Loss: 0.702
Batch: 25/29	Loss: 0.742
Batch: 27/29	Loss: 0.710
Batch: 29/29	Loss: 0.691
Epoch: 8	Train Loss: 0.712	Val F1: 0.337
Best Epoch: 7	Best Val F1: 0.339

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.732
Batch: 3/29	Loss: 0.662
Batch: 5/29	Loss: 0.680
Batch: 7/29	Loss: 0.694
Batch: 9/29	Loss: 0.708
Batch: 11/29	Loss: 0.707
Batch: 13/29	Loss: 0.701
Batch: 15/29	Loss: 0.655
Batch: 17/29	Loss: 0.716
Batch: 19/29	Loss: 0.595
Batch: 21/29	Loss: 0.723
Batch: 23/29	Loss: 0.650
Batch: 25/29	Loss: 0.625
Batch: 27/29	Loss: 0.756
Batch: 29/29	Loss: 0.614
Epoch: 9	Train Loss: 0.678	Val F1: 0.344
Best Epoch: 9	Best Val F1: 0.344

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.601
Batch: 3/29	Loss: 0.670
Batch: 5/29	Loss: 0.627
Batch: 7/29	Loss: 0.616
Batch: 9/29	Loss: 0.614
Batch: 11/29	Loss: 0.556
Batch: 13/29	Loss: 0.727
Batch: 15/29	Loss: 0.679
Batch: 17/29	Loss: 0.706
Batch: 19/29	Loss: 0.531
Batch: 21/29	Loss: 0.680
Batch: 23/29	Loss: 0.658
Batch: 25/29	Loss: 0.667
Batch: 27/29	Loss: 0.604
Batch: 29/29	Loss: 0.698
Epoch: 10	Train Loss: 0.643	Val F1: 0.349
Best Epoch: 10	Best Val F1: 0.349

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.617
Batch: 3/29	Loss: 0.600
Batch: 5/29	Loss: 0.719
Batch: 7/29	Loss: 0.617
Batch: 9/29	Loss: 0.611
Batch: 11/29	Loss: 0.603
Batch: 13/29	Loss: 0.604
Batch: 15/29	Loss: 0.507
Batch: 17/29	Loss: 0.653
Batch: 19/29	Loss: 0.603
Batch: 21/29	Loss: 0.592
Batch: 23/29	Loss: 0.597
Batch: 25/29	Loss: 0.575
Batch: 27/29	Loss: 0.594
Batch: 29/29	Loss: 0.590
Epoch: 11	Train Loss: 0.614	Val F1: 0.315
Best Epoch: 10	Best Val F1: 0.349

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.727
Batch: 3/29	Loss: 0.565
Batch: 5/29	Loss: 0.652
Batch: 7/29	Loss: 0.551
Batch: 9/29	Loss: 0.616
Batch: 11/29	Loss: 0.573
Batch: 13/29	Loss: 0.549
Batch: 15/29	Loss: 0.543
Batch: 17/29	Loss: 0.569
Batch: 19/29	Loss: 0.611
Batch: 21/29	Loss: 0.583
Batch: 23/29	Loss: 0.585
Batch: 25/29	Loss: 0.561
Batch: 27/29	Loss: 0.645
Batch: 29/29	Loss: 0.480
Epoch: 12	Train Loss: 0.582	Val F1: 0.346
Best Epoch: 10	Best Val F1: 0.349

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.579
Batch: 3/29	Loss: 0.478
Batch: 5/29	Loss: 0.564
Batch: 7/29	Loss: 0.554
Batch: 9/29	Loss: 0.552
Batch: 11/29	Loss: 0.529
Batch: 13/29	Loss: 0.568
Batch: 15/29	Loss: 0.572
Batch: 17/29	Loss: 0.493
Batch: 19/29	Loss: 0.420
Batch: 21/29	Loss: 0.541
Batch: 23/29	Loss: 0.588
Batch: 25/29	Loss: 0.395
Batch: 27/29	Loss: 0.608
Batch: 29/29	Loss: 0.614
Epoch: 13	Train Loss: 0.543	Val F1: 0.325
Best Epoch: 10	Best Val F1: 0.349

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.533
Batch: 3/29	Loss: 0.529
Batch: 5/29	Loss: 0.442
Batch: 7/29	Loss: 0.515
Batch: 9/29	Loss: 0.551
Batch: 11/29	Loss: 0.510
Batch: 13/29	Loss: 0.475
Batch: 15/29	Loss: 0.408
Batch: 17/29	Loss: 0.681
Batch: 19/29	Loss: 0.552
Batch: 21/29	Loss: 0.492
Batch: 23/29	Loss: 0.428
Batch: 25/29	Loss: 0.523
Batch: 27/29	Loss: 0.638
Batch: 29/29	Loss: 0.531
Epoch: 14	Train Loss: 0.521	Val F1: 0.323
Best Epoch: 10	Best Val F1: 0.349

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.524
Batch: 3/29	Loss: 0.498
Batch: 5/29	Loss: 0.454
Batch: 7/29	Loss: 0.460
Batch: 9/29	Loss: 0.554
Batch: 11/29	Loss: 0.438
Batch: 13/29	Loss: 0.540
Batch: 15/29	Loss: 0.538
Batch: 17/29	Loss: 0.537
Batch: 19/29	Loss: 0.468
Batch: 21/29	Loss: 0.458
Batch: 23/29	Loss: 0.564
Batch: 25/29	Loss: 0.505
Batch: 27/29	Loss: 0.428
Batch: 29/29	Loss: 0.557
Epoch: 15	Train Loss: 0.507	Val F1: 0.354
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.499
Batch: 3/29	Loss: 0.444
Batch: 5/29	Loss: 0.486
Batch: 7/29	Loss: 0.424
Batch: 9/29	Loss: 0.508
Batch: 11/29	Loss: 0.443
Batch: 13/29	Loss: 0.426
Batch: 15/29	Loss: 0.449
Batch: 17/29	Loss: 0.445
Batch: 19/29	Loss: 0.536
Batch: 21/29	Loss: 0.391
Batch: 23/29	Loss: 0.482
Batch: 25/29	Loss: 0.515
Batch: 27/29	Loss: 0.429
Batch: 29/29	Loss: 0.469
Epoch: 16	Train Loss: 0.465	Val F1: 0.342
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.496
Batch: 3/29	Loss: 0.546
Batch: 5/29	Loss: 0.502
Batch: 7/29	Loss: 0.409
Batch: 9/29	Loss: 0.427
Batch: 11/29	Loss: 0.472
Batch: 13/29	Loss: 0.500
Batch: 15/29	Loss: 0.487
Batch: 17/29	Loss: 0.494
Batch: 19/29	Loss: 0.431
Batch: 21/29	Loss: 0.468
Batch: 23/29	Loss: 0.510
Batch: 25/29	Loss: 0.302
Batch: 27/29	Loss: 0.488
Batch: 29/29	Loss: 0.503
Epoch: 17	Train Loss: 0.457	Val F1: 0.351
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.463
Batch: 3/29	Loss: 0.446
Batch: 5/29	Loss: 0.439
Batch: 7/29	Loss: 0.393
Batch: 9/29	Loss: 0.503
Batch: 11/29	Loss: 0.383
Batch: 13/29	Loss: 0.345
Batch: 15/29	Loss: 0.399
Batch: 17/29	Loss: 0.395
Batch: 19/29	Loss: 0.357
Batch: 21/29	Loss: 0.457
Batch: 23/29	Loss: 0.421
Batch: 25/29	Loss: 0.458
Batch: 27/29	Loss: 0.329
Batch: 29/29	Loss: 0.456
Epoch: 18	Train Loss: 0.427	Val F1: 0.350
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.309
Batch: 3/29	Loss: 0.313
Batch: 5/29	Loss: 0.422
Batch: 7/29	Loss: 0.456
Batch: 9/29	Loss: 0.306
Batch: 11/29	Loss: 0.487
Batch: 13/29	Loss: 0.480
Batch: 15/29	Loss: 0.416
Batch: 17/29	Loss: 0.400
Batch: 19/29	Loss: 0.516
Batch: 21/29	Loss: 0.402
Batch: 23/29	Loss: 0.425
Batch: 25/29	Loss: 0.403
Batch: 27/29	Loss: 0.365
Batch: 29/29	Loss: 0.352
Epoch: 19	Train Loss: 0.410	Val F1: 0.335
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.501
Batch: 3/29	Loss: 0.449
Batch: 5/29	Loss: 0.382
Batch: 7/29	Loss: 0.302
Batch: 9/29	Loss: 0.498
Batch: 11/29	Loss: 0.429
Batch: 13/29	Loss: 0.455
Batch: 15/29	Loss: 0.416
Batch: 17/29	Loss: 0.511
Batch: 19/29	Loss: 0.358
Batch: 21/29	Loss: 0.398
Batch: 23/29	Loss: 0.493
Batch: 25/29	Loss: 0.367
Batch: 27/29	Loss: 0.391
Batch: 29/29	Loss: 0.456
Epoch: 20	Train Loss: 0.416	Val F1: 0.349
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.413
Batch: 3/29	Loss: 0.337
Batch: 5/29	Loss: 0.351
Batch: 7/29	Loss: 0.561
Batch: 9/29	Loss: 0.369
Batch: 11/29	Loss: 0.333
Batch: 13/29	Loss: 0.421
Batch: 15/29	Loss: 0.450
Batch: 17/29	Loss: 0.374
Batch: 19/29	Loss: 0.353
Batch: 21/29	Loss: 0.410
Batch: 23/29	Loss: 0.327
Batch: 25/29	Loss: 0.368
Batch: 27/29	Loss: 0.375
Batch: 29/29	Loss: 0.385
Epoch: 21	Train Loss: 0.393	Val F1: 0.348
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.377
Batch: 3/29	Loss: 0.324
Batch: 5/29	Loss: 0.411
Batch: 7/29	Loss: 0.386
Batch: 9/29	Loss: 0.351
Batch: 11/29	Loss: 0.348
Batch: 13/29	Loss: 0.307
Batch: 15/29	Loss: 0.411
Batch: 17/29	Loss: 0.425
Batch: 19/29	Loss: 0.472
Batch: 21/29	Loss: 0.505
Batch: 23/29	Loss: 0.376
Batch: 25/29	Loss: 0.350
Batch: 27/29	Loss: 0.316
Batch: 29/29	Loss: 0.361
Epoch: 22	Train Loss: 0.377	Val F1: 0.336
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.353
Batch: 3/29	Loss: 0.375
Batch: 5/29	Loss: 0.373
Batch: 7/29	Loss: 0.467
Batch: 9/29	Loss: 0.381
Batch: 11/29	Loss: 0.443
Batch: 13/29	Loss: 0.354
Batch: 15/29	Loss: 0.381
Batch: 17/29	Loss: 0.416
Batch: 19/29	Loss: 0.420
Batch: 21/29	Loss: 0.371
Batch: 23/29	Loss: 0.308
Batch: 25/29	Loss: 0.404
Batch: 27/29	Loss: 0.313
Batch: 29/29	Loss: 0.405
Epoch: 23	Train Loss: 0.388	Val F1: 0.348
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.323
Batch: 3/29	Loss: 0.358
Batch: 5/29	Loss: 0.429
Batch: 7/29	Loss: 0.510
Batch: 9/29	Loss: 0.431
Batch: 11/29	Loss: 0.514
Batch: 13/29	Loss: 0.315
Batch: 15/29	Loss: 0.361
Batch: 17/29	Loss: 0.322
Batch: 19/29	Loss: 0.419
Batch: 21/29	Loss: 0.417
Batch: 23/29	Loss: 0.348
Batch: 25/29	Loss: 0.357
Batch: 27/29	Loss: 0.318
Batch: 29/29	Loss: 0.360
Epoch: 24	Train Loss: 0.383	Val F1: 0.343
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.422
Batch: 3/29	Loss: 0.382
Batch: 5/29	Loss: 0.436
Batch: 7/29	Loss: 0.399
Batch: 9/29	Loss: 0.439
Batch: 11/29	Loss: 0.366
Batch: 13/29	Loss: 0.433
Batch: 15/29	Loss: 0.384
Batch: 17/29	Loss: 0.375
Batch: 19/29	Loss: 0.297
Batch: 21/29	Loss: 0.352
Batch: 23/29	Loss: 0.342
Batch: 25/29	Loss: 0.364
Batch: 27/29	Loss: 0.357
Batch: 29/29	Loss: 0.328
Epoch: 25	Train Loss: 0.361	Val F1: 0.341
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 26 ******************************
Batch: 1/29	Loss: 0.302
Batch: 3/29	Loss: 0.302
Batch: 5/29	Loss: 0.376
Batch: 7/29	Loss: 0.416
Batch: 9/29	Loss: 0.348
Batch: 11/29	Loss: 0.354
Batch: 13/29	Loss: 0.336
Batch: 15/29	Loss: 0.365
Batch: 17/29	Loss: 0.304
Batch: 19/29	Loss: 0.450
Batch: 21/29	Loss: 0.485
Batch: 23/29	Loss: 0.252
Batch: 25/29	Loss: 0.394
Batch: 27/29	Loss: 0.315
Batch: 29/29	Loss: 0.406
Epoch: 26	Train Loss: 0.349	Val F1: 0.347
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 27 ******************************
Batch: 1/29	Loss: 0.302
Batch: 3/29	Loss: 0.379
Batch: 5/29	Loss: 0.455
Batch: 7/29	Loss: 0.253
Batch: 9/29	Loss: 0.451
Batch: 11/29	Loss: 0.286
Batch: 13/29	Loss: 0.425
Batch: 15/29	Loss: 0.371
Batch: 17/29	Loss: 0.382
Batch: 19/29	Loss: 0.331
Batch: 21/29	Loss: 0.373
Batch: 23/29	Loss: 0.278
Batch: 25/29	Loss: 0.313
Batch: 27/29	Loss: 0.344
Batch: 29/29	Loss: 0.378
Epoch: 27	Train Loss: 0.344	Val F1: 0.340
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 28 ******************************
Batch: 1/29	Loss: 0.344
Batch: 3/29	Loss: 0.321
Batch: 5/29	Loss: 0.369
Batch: 7/29	Loss: 0.347
Batch: 9/29	Loss: 0.394
Batch: 11/29	Loss: 0.341
Batch: 13/29	Loss: 0.292
Batch: 15/29	Loss: 0.391
Batch: 17/29	Loss: 0.415
Batch: 19/29	Loss: 0.287
Batch: 21/29	Loss: 0.313
Batch: 23/29	Loss: 0.369
Batch: 25/29	Loss: 0.374
Batch: 27/29	Loss: 0.273
Batch: 29/29	Loss: 0.326
Epoch: 28	Train Loss: 0.338	Val F1: 0.345
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 29 ******************************
Batch: 1/29	Loss: 0.355
Batch: 3/29	Loss: 0.361
Batch: 5/29	Loss: 0.279
Batch: 7/29	Loss: 0.342
Batch: 9/29	Loss: 0.271
Batch: 11/29	Loss: 0.372
Batch: 13/29	Loss: 0.402
Batch: 15/29	Loss: 0.278
Batch: 17/29	Loss: 0.376
Batch: 19/29	Loss: 0.325
Batch: 21/29	Loss: 0.372
Batch: 23/29	Loss: 0.342
Batch: 25/29	Loss: 0.382
Batch: 27/29	Loss: 0.356
Batch: 29/29	Loss: 0.334
Epoch: 29	Train Loss: 0.342	Val F1: 0.345
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 30 ******************************
Batch: 1/29	Loss: 0.251
Batch: 3/29	Loss: 0.349
Batch: 5/29	Loss: 0.361
Batch: 7/29	Loss: 0.352
Batch: 9/29	Loss: 0.341
Batch: 11/29	Loss: 0.304
Batch: 13/29	Loss: 0.369
Batch: 15/29	Loss: 0.246
Batch: 17/29	Loss: 0.332
Batch: 19/29	Loss: 0.325
Batch: 21/29	Loss: 0.376
Batch: 23/29	Loss: 0.357
Batch: 25/29	Loss: 0.313
Batch: 27/29	Loss: 0.270
Batch: 29/29	Loss: 0.301
Epoch: 30	Train Loss: 0.328	Val F1: 0.348
Best Epoch: 15	Best Val F1: 0.354

Saving the best checkpoint....
Inference...
Test F1: 0.375	Test F1_Few: 0.457	Test F1_Zero: 0.359
Starting training with config: {'batch_size': 16, 'epochs': 75, 'l2_reg': 0.0007135602003910751, 'lr': 9.04277113317022e-06, 'n_layers_freeze': 2, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 1.035
Batch: 23/116	Loss: 0.970
Batch: 34/116	Loss: 0.949
Batch: 45/116	Loss: 0.909
Batch: 56/116	Loss: 0.893
Batch: 67/116	Loss: 0.856
Batch: 78/116	Loss: 0.858
Batch: 89/116	Loss: 0.906
Batch: 100/116	Loss: 0.825
Batch: 111/116	Loss: 0.843
Batch: 116/116	Loss: 0.816
Epoch: 1	Train Loss: 0.913	Val F1: 0.183
Best Epoch: 1	Best Val F1: 0.183

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.868
Batch: 12/116	Loss: 0.830
Batch: 23/116	Loss: 0.806
Batch: 34/116	Loss: 0.793
Batch: 45/116	Loss: 0.849
Batch: 56/116	Loss: 0.811
Batch: 67/116	Loss: 0.819
Batch: 78/116	Loss: 0.784
Batch: 89/116	Loss: 0.796
Batch: 100/116	Loss: 0.803
Batch: 111/116	Loss: 0.799
Batch: 116/116	Loss: 0.772
Epoch: 2	Train Loss: 0.811	Val F1: 0.249
Best Epoch: 2	Best Val F1: 0.249

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.754
Batch: 12/116	Loss: 0.752
Batch: 23/116	Loss: 0.745
Batch: 34/116	Loss: 0.788
Batch: 45/116	Loss: 0.841
Batch: 56/116	Loss: 0.788
Batch: 67/116	Loss: 0.788
Batch: 78/116	Loss: 0.742
Batch: 89/116	Loss: 0.731
Batch: 100/116	Loss: 0.904
Batch: 111/116	Loss: 0.830
Batch: 116/116	Loss: 0.717
Epoch: 3	Train Loss: 0.778	Val F1: 0.276
Best Epoch: 3	Best Val F1: 0.276

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.752
Batch: 12/116	Loss: 0.699
Batch: 23/116	Loss: 0.867
Batch: 34/116	Loss: 0.745
Batch: 45/116	Loss: 0.805
Batch: 56/116	Loss: 0.725
Batch: 67/116	Loss: 0.750
Batch: 78/116	Loss: 0.692
Batch: 89/116	Loss: 0.740
Batch: 100/116	Loss: 0.725
Batch: 111/116	Loss: 0.673
Batch: 116/116	Loss: 0.903
Epoch: 4	Train Loss: 0.731	Val F1: 0.311
Best Epoch: 4	Best Val F1: 0.311

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.598
Batch: 12/116	Loss: 0.710
Batch: 23/116	Loss: 0.695
Batch: 34/116	Loss: 0.654
Batch: 45/116	Loss: 0.742
Batch: 56/116	Loss: 0.716
Batch: 67/116	Loss: 0.632
Batch: 78/116	Loss: 0.681
Batch: 89/116	Loss: 0.808
Batch: 100/116	Loss: 0.702
Batch: 111/116	Loss: 0.627
Batch: 116/116	Loss: 0.504
Epoch: 5	Train Loss: 0.681	Val F1: 0.336
Best Epoch: 5	Best Val F1: 0.336

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.629
Batch: 12/116	Loss: 0.853
Batch: 23/116	Loss: 0.687
Batch: 34/116	Loss: 0.623
Batch: 45/116	Loss: 0.558
Batch: 56/116	Loss: 0.630
Batch: 67/116	Loss: 0.606
Batch: 78/116	Loss: 0.741
Batch: 89/116	Loss: 0.849
Batch: 100/116	Loss: 0.779
Batch: 111/116	Loss: 0.724
Batch: 116/116	Loss: 0.405
Epoch: 6	Train Loss: 0.631	Val F1: 0.360
Best Epoch: 6	Best Val F1: 0.360

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.470
Batch: 12/116	Loss: 0.755
Batch: 23/116	Loss: 0.736
Batch: 34/116	Loss: 0.787
Batch: 45/116	Loss: 0.432
Batch: 56/116	Loss: 0.853
Batch: 67/116	Loss: 0.602
Batch: 78/116	Loss: 0.644
Batch: 89/116	Loss: 0.494
Batch: 100/116	Loss: 0.433
Batch: 111/116	Loss: 0.796
Batch: 116/116	Loss: 0.567
Epoch: 7	Train Loss: 0.592	Val F1: 0.342
Best Epoch: 6	Best Val F1: 0.360

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.641
Batch: 12/116	Loss: 0.709
Batch: 23/116	Loss: 0.314
Batch: 34/116	Loss: 0.563
Batch: 45/116	Loss: 0.621
Batch: 56/116	Loss: 0.384
Batch: 67/116	Loss: 0.795
Batch: 78/116	Loss: 0.362
Batch: 89/116	Loss: 0.354
Batch: 100/116	Loss: 0.696
Batch: 111/116	Loss: 0.446
Batch: 116/116	Loss: 0.475
Epoch: 8	Train Loss: 0.543	Val F1: 0.355
Best Epoch: 6	Best Val F1: 0.360

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.511
Batch: 12/116	Loss: 0.540
Batch: 23/116	Loss: 0.482
Batch: 34/116	Loss: 0.475
Batch: 45/116	Loss: 0.378
Batch: 56/116	Loss: 0.437
Batch: 67/116	Loss: 0.356
Batch: 78/116	Loss: 0.598
Batch: 89/116	Loss: 0.364
Batch: 100/116	Loss: 0.427
Batch: 111/116	Loss: 0.404
Batch: 116/116	Loss: 0.480
Epoch: 9	Train Loss: 0.477	Val F1: 0.342
Best Epoch: 6	Best Val F1: 0.360

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.387
Batch: 12/116	Loss: 0.445
Batch: 23/116	Loss: 0.368
Batch: 34/116	Loss: 0.517
Batch: 45/116	Loss: 0.287
Batch: 56/116	Loss: 0.428
Batch: 67/116	Loss: 0.524
Batch: 78/116	Loss: 0.395
Batch: 89/116	Loss: 0.272
Batch: 100/116	Loss: 0.459
Batch: 111/116	Loss: 0.329
Batch: 116/116	Loss: 0.265
Epoch: 10	Train Loss: 0.437	Val F1: 0.332
Best Epoch: 6	Best Val F1: 0.360

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.455
Batch: 12/116	Loss: 0.356
Batch: 23/116	Loss: 0.390
Batch: 34/116	Loss: 0.407
Batch: 45/116	Loss: 0.575
Batch: 56/116	Loss: 0.470
Batch: 67/116	Loss: 0.581
Batch: 78/116	Loss: 0.341
Batch: 89/116	Loss: 0.266
Batch: 100/116	Loss: 0.437
Batch: 111/116	Loss: 0.448
Batch: 116/116	Loss: 0.199
Epoch: 11	Train Loss: 0.400	Val F1: 0.314
Best Epoch: 6	Best Val F1: 0.360

****************************** Epoch: 12 ******************************
Batch: 1/116	Loss: 0.568
Batch: 12/116	Loss: 0.371
Batch: 23/116	Loss: 0.295
Batch: 34/116	Loss: 0.551
Batch: 45/116	Loss: 0.238
Batch: 56/116	Loss: 0.409
Batch: 67/116	Loss: 0.249
Batch: 78/116	Loss: 0.470
Batch: 89/116	Loss: 0.452
Batch: 100/116	Loss: 0.508
Batch: 111/116	Loss: 0.340
Batch: 116/116	Loss: 0.160
Epoch: 12	Train Loss: 0.378	Val F1: 0.352
Best Epoch: 6	Best Val F1: 0.360

****************************** Epoch: 13 ******************************
Batch: 1/116	Loss: 0.437
Batch: 12/116	Loss: 0.227
Batch: 23/116	Loss: 0.401
Batch: 34/116	Loss: 0.236
Batch: 45/116	Loss: 0.581
Batch: 56/116	Loss: 0.336
Batch: 67/116	Loss: 0.210
Batch: 78/116	Loss: 0.461
Batch: 89/116	Loss: 0.409
Batch: 100/116	Loss: 0.343
Batch: 111/116	Loss: 0.361
Batch: 116/116	Loss: 0.201
Epoch: 13	Train Loss: 0.352	Val F1: 0.354
Best Epoch: 6	Best Val F1: 0.360

****************************** Epoch: 14 ******************************
Batch: 1/116	Loss: 0.543
Batch: 12/116	Loss: 0.440
Batch: 23/116	Loss: 0.205
Batch: 34/116	Loss: 0.354
Batch: 45/116	Loss: 0.485
Batch: 56/116	Loss: 0.410
Batch: 67/116	Loss: 0.458
Batch: 78/116	Loss: 0.437
Batch: 89/116	Loss: 0.232
Batch: 100/116	Loss: 0.392
Batch: 111/116	Loss: 0.308
Batch: 116/116	Loss: 0.366
Epoch: 14	Train Loss: 0.325	Val F1: 0.360
Best Epoch: 14	Best Val F1: 0.360

****************************** Epoch: 15 ******************************
Batch: 1/116	Loss: 0.222
Batch: 12/116	Loss: 0.531
Batch: 23/116	Loss: 0.194
Batch: 34/116	Loss: 0.330
Batch: 45/116	Loss: 0.292
Batch: 56/116	Loss: 0.406
Batch: 67/116	Loss: 0.419
Batch: 78/116	Loss: 0.312
Batch: 89/116	Loss: 0.383
Batch: 100/116	Loss: 0.389
Batch: 111/116	Loss: 0.302
Batch: 116/116	Loss: 0.189
Epoch: 15	Train Loss: 0.308	Val F1: 0.348
Best Epoch: 14	Best Val F1: 0.360

****************************** Epoch: 16 ******************************
Batch: 1/116	Loss: 0.451
Batch: 12/116	Loss: 0.116
Batch: 23/116	Loss: 0.223
Batch: 34/116	Loss: 0.247
Batch: 45/116	Loss: 0.200
Batch: 56/116	Loss: 0.278
Batch: 67/116	Loss: 0.309
Batch: 78/116	Loss: 0.288
Batch: 89/116	Loss: 0.361
Batch: 100/116	Loss: 0.334
Batch: 111/116	Loss: 0.184
Batch: 116/116	Loss: 0.408
Epoch: 16	Train Loss: 0.289	Val F1: 0.351
Best Epoch: 14	Best Val F1: 0.360

****************************** Epoch: 17 ******************************
Batch: 1/116	Loss: 0.206
Batch: 12/116	Loss: 0.292
Batch: 23/116	Loss: 0.313
Batch: 34/116	Loss: 0.167
Batch: 45/116	Loss: 0.260
Batch: 56/116	Loss: 0.331
Batch: 67/116	Loss: 0.377
Batch: 78/116	Loss: 0.186
Batch: 89/116	Loss: 0.488
Batch: 100/116	Loss: 0.169
Batch: 111/116	Loss: 0.283
Batch: 116/116	Loss: 0.467
Epoch: 17	Train Loss: 0.282	Val F1: 0.348
Best Epoch: 14	Best Val F1: 0.360

****************************** Epoch: 18 ******************************
Batch: 1/116	Loss: 0.454
Batch: 12/116	Loss: 0.201
Batch: 23/116	Loss: 0.258
Batch: 34/116	Loss: 0.344
Batch: 45/116	Loss: 0.123
Batch: 56/116	Loss: 0.310
Batch: 67/116	Loss: 0.286
Batch: 78/116	Loss: 0.287
Batch: 89/116	Loss: 0.221
Batch: 100/116	Loss: 0.260
Batch: 111/116	Loss: 0.095
Batch: 116/116	Loss: 0.485
Epoch: 18	Train Loss: 0.255	Val F1: 0.337
Best Epoch: 14	Best Val F1: 0.360

****************************** Epoch: 19 ******************************
Batch: 1/116	Loss: 0.159
Batch: 12/116	Loss: 0.142
Batch: 23/116	Loss: 0.114
Batch: 34/116	Loss: 0.229
Batch: 45/116	Loss: 0.200
Batch: 56/116	Loss: 0.264
Batch: 67/116	Loss: 0.192
Batch: 78/116	Loss: 0.196
Batch: 89/116	Loss: 0.187
Batch: 100/116	Loss: 0.249
Batch: 111/116	Loss: 0.243
Batch: 116/116	Loss: 0.209
Epoch: 19	Train Loss: 0.237	Val F1: 0.337
Best Epoch: 14	Best Val F1: 0.360

****************************** Epoch: 20 ******************************
Batch: 1/116	Loss: 0.229
Batch: 12/116	Loss: 0.250
Batch: 23/116	Loss: 0.176
Batch: 34/116	Loss: 0.184
Batch: 45/116	Loss: 0.194
Batch: 56/116	Loss: 0.388
Batch: 67/116	Loss: 0.186
Batch: 78/116	Loss: 0.194
Batch: 89/116	Loss: 0.210
Batch: 100/116	Loss: 0.152
Batch: 111/116	Loss: 0.169
Batch: 116/116	Loss: 0.425
Epoch: 20	Train Loss: 0.219	Val F1: 0.334
Best Epoch: 14	Best Val F1: 0.360

****************************** Epoch: 21 ******************************
Batch: 1/116	Loss: 0.189
Batch: 12/116	Loss: 0.193
Batch: 23/116	Loss: 0.210
Batch: 34/116	Loss: 0.223
Batch: 45/116	Loss: 0.196
Batch: 56/116	Loss: 0.156
Batch: 67/116	Loss: 0.059
Batch: 78/116	Loss: 0.214
Batch: 89/116	Loss: 0.278
Batch: 100/116	Loss: 0.237
Batch: 111/116	Loss: 0.062
Batch: 116/116	Loss: 0.287
Epoch: 21	Train Loss: 0.201	Val F1: 0.335
Best Epoch: 14	Best Val F1: 0.360

****************************** Epoch: 22 ******************************
Batch: 1/116	Loss: 0.259
Batch: 12/116	Loss: 0.080
Batch: 23/116	Loss: 0.162
Batch: 34/116	Loss: 0.092
Batch: 45/116	Loss: 0.169
Batch: 56/116	Loss: 0.128
Batch: 67/116	Loss: 0.237
Batch: 78/116	Loss: 0.178
Batch: 89/116	Loss: 0.120
Batch: 100/116	Loss: 0.175
Batch: 111/116	Loss: 0.159
Batch: 116/116	Loss: 0.347
Epoch: 22	Train Loss: 0.183	Val F1: 0.353
Best Epoch: 14	Best Val F1: 0.360

****************************** Epoch: 23 ******************************
Batch: 1/116	Loss: 0.187
Batch: 12/116	Loss: 0.111
Batch: 23/116	Loss: 0.166
Batch: 34/116	Loss: 0.175
Batch: 45/116	Loss: 0.340
Batch: 56/116	Loss: 0.214
Batch: 67/116	Loss: 0.172
Batch: 78/116	Loss: 0.189
Batch: 89/116	Loss: 0.106
Batch: 100/116	Loss: 0.150
Batch: 111/116	Loss: 0.137
Batch: 116/116	Loss: 0.259
Epoch: 23	Train Loss: 0.152	Val F1: 0.344
Best Epoch: 14	Best Val F1: 0.360

****************************** Epoch: 24 ******************************
Batch: 1/116	Loss: 0.153
Batch: 12/116	Loss: 0.065
Batch: 23/116	Loss: 0.110
Batch: 34/116	Loss: 0.229
Batch: 45/116	Loss: 0.143
Batch: 56/116	Loss: 0.097
Batch: 67/116	Loss: 0.094
Batch: 78/116	Loss: 0.123
Batch: 89/116	Loss: 0.091
Batch: 100/116	Loss: 0.174
Batch: 111/116	Loss: 0.107
Batch: 116/116	Loss: 0.496
Epoch: 24	Train Loss: 0.138	Val F1: 0.345
Best Epoch: 14	Best Val F1: 0.360

****************************** Epoch: 25 ******************************
Batch: 1/116	Loss: 0.068
Batch: 12/116	Loss: 0.126
Batch: 23/116	Loss: 0.124
Batch: 34/116	Loss: 0.072
Batch: 45/116	Loss: 0.126
Batch: 56/116	Loss: 0.053
Batch: 67/116	Loss: 0.206
Batch: 78/116	Loss: 0.073
Batch: 89/116	Loss: 0.057
Batch: 100/116	Loss: 0.062
Batch: 111/116	Loss: 0.069
Batch: 116/116	Loss: 0.037
Epoch: 25	Train Loss: 0.131	Val F1: 0.344
Best Epoch: 14	Best Val F1: 0.360

****************************** Epoch: 26 ******************************
Batch: 1/116	Loss: 0.101
Batch: 12/116	Loss: 0.138
Batch: 23/116	Loss: 0.075
Batch: 34/116	Loss: 0.054
Batch: 45/116	Loss: 0.133
Batch: 56/116	Loss: 0.157
Batch: 67/116	Loss: 0.093
Batch: 78/116	Loss: 0.075
Batch: 89/116	Loss: 0.053
Batch: 100/116	Loss: 0.182
Batch: 111/116	Loss: 0.049
Batch: 116/116	Loss: 0.136
Epoch: 26	Train Loss: 0.104	Val F1: 0.334
Best Epoch: 14	Best Val F1: 0.360

****************************** Epoch: 27 ******************************
Batch: 1/116	Loss: 0.030
Batch: 12/116	Loss: 0.200
Batch: 23/116	Loss: 0.083
Batch: 34/116	Loss: 0.082
Batch: 45/116	Loss: 0.054
Batch: 56/116	Loss: 0.100
Batch: 67/116	Loss: 0.122
Batch: 78/116	Loss: 0.114
Batch: 89/116	Loss: 0.125
Batch: 100/116	Loss: 0.186
Batch: 111/116	Loss: 0.064
Batch: 116/116	Loss: 0.116
Epoch: 27	Train Loss: 0.091	Val F1: 0.337
Best Epoch: 14	Best Val F1: 0.360

****************************** Epoch: 28 ******************************
Batch: 1/116	Loss: 0.094
Batch: 12/116	Loss: 0.038
Batch: 23/116	Loss: 0.085
Batch: 34/116	Loss: 0.047
Batch: 45/116	Loss: 0.029
Batch: 56/116	Loss: 0.142
Batch: 67/116	Loss: 0.067
Batch: 78/116	Loss: 0.123
Batch: 89/116	Loss: 0.117
Batch: 100/116	Loss: 0.059
Batch: 111/116	Loss: 0.053
Batch: 116/116	Loss: 0.071
Epoch: 28	Train Loss: 0.082	Val F1: 0.349
Best Epoch: 14	Best Val F1: 0.360

****************************** Epoch: 29 ******************************
Batch: 1/116	Loss: 0.250
Batch: 12/116	Loss: 0.071
Batch: 23/116	Loss: 0.077
Batch: 34/116	Loss: 0.036
Batch: 45/116	Loss: 0.089
Batch: 56/116	Loss: 0.137
Batch: 67/116	Loss: 0.101
Batch: 78/116	Loss: 0.122
Batch: 89/116	Loss: 0.138
Batch: 100/116	Loss: 0.202
Batch: 111/116	Loss: 0.133
Batch: 116/116	Loss: 0.071
Epoch: 29	Train Loss: 0.073	Val F1: 0.338
Best Epoch: 14	Best Val F1: 0.360

Saving the best checkpoint....
Inference...
Test F1: 0.370	Test F1_Few: 0.447	Test F1_Zero: 0.362
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0009471870159433036, 'lr': 1.9958090285197807e-06, 'n_layers_freeze': 5, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.096
Batch: 5/29	Loss: 1.094
Batch: 7/29	Loss: 1.091
Batch: 9/29	Loss: 1.091
Batch: 11/29	Loss: 1.086
Batch: 13/29	Loss: 1.081
Batch: 15/29	Loss: 1.083
Batch: 17/29	Loss: 1.074
Batch: 19/29	Loss: 1.073
Batch: 21/29	Loss: 1.068
Batch: 23/29	Loss: 1.069
Batch: 25/29	Loss: 1.062
Batch: 27/29	Loss: 1.057
Batch: 29/29	Loss: 1.061
Epoch: 1	Train Loss: 1.079	Val F1: 0.304
Best Epoch: 1	Best Val F1: 0.304

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 1.057
Batch: 3/29	Loss: 1.058
Batch: 5/29	Loss: 1.055
Batch: 7/29	Loss: 1.049
Batch: 9/29	Loss: 1.047
Batch: 11/29	Loss: 1.040
Batch: 13/29	Loss: 1.038
Batch: 15/29	Loss: 1.040
Batch: 17/29	Loss: 1.035
Batch: 19/29	Loss: 1.036
Batch: 21/29	Loss: 1.030
Batch: 23/29	Loss: 1.024
Batch: 25/29	Loss: 1.019
Batch: 27/29	Loss: 1.026
Batch: 29/29	Loss: 1.018
Epoch: 2	Train Loss: 1.037	Val F1: 0.292
Best Epoch: 1	Best Val F1: 0.304

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 1.014
Batch: 3/29	Loss: 1.008
Batch: 5/29	Loss: 1.006
Batch: 7/29	Loss: 1.010
Batch: 9/29	Loss: 0.997
Batch: 11/29	Loss: 0.995
Batch: 13/29	Loss: 1.005
Batch: 15/29	Loss: 0.987
Batch: 17/29	Loss: 0.993
Batch: 19/29	Loss: 0.985
Batch: 21/29	Loss: 0.979
Batch: 23/29	Loss: 0.977
Batch: 25/29	Loss: 0.978
Batch: 27/29	Loss: 0.968
Batch: 29/29	Loss: 0.967
Epoch: 3	Train Loss: 0.991	Val F1: 0.233
Best Epoch: 1	Best Val F1: 0.304

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.963
Batch: 3/29	Loss: 0.965
Batch: 5/29	Loss: 0.952
Batch: 7/29	Loss: 0.969
Batch: 9/29	Loss: 0.960
Batch: 11/29	Loss: 0.945
Batch: 13/29	Loss: 0.945
Batch: 15/29	Loss: 0.941
Batch: 17/29	Loss: 0.944
Batch: 19/29	Loss: 0.947
Batch: 21/29	Loss: 0.949
Batch: 23/29	Loss: 0.947
Batch: 25/29	Loss: 0.941
Batch: 27/29	Loss: 0.945
Batch: 29/29	Loss: 0.934
Epoch: 4	Train Loss: 0.950	Val F1: 0.194
Best Epoch: 1	Best Val F1: 0.304

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.930
Batch: 3/29	Loss: 0.929
Batch: 5/29	Loss: 0.922
Batch: 7/29	Loss: 0.918
Batch: 9/29	Loss: 0.915
Batch: 11/29	Loss: 0.921
Batch: 13/29	Loss: 0.912
Batch: 15/29	Loss: 0.927
Batch: 17/29	Loss: 0.932
Batch: 19/29	Loss: 0.918
Batch: 21/29	Loss: 0.908
Batch: 23/29	Loss: 0.913
Batch: 25/29	Loss: 0.924
Batch: 27/29	Loss: 0.905
Batch: 29/29	Loss: 0.907
Epoch: 5	Train Loss: 0.922	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.304

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.898
Batch: 3/29	Loss: 0.927
Batch: 5/29	Loss: 0.900
Batch: 7/29	Loss: 0.920
Batch: 9/29	Loss: 0.906
Batch: 11/29	Loss: 0.907
Batch: 13/29	Loss: 0.906
Batch: 15/29	Loss: 0.891
Batch: 17/29	Loss: 0.896
Batch: 19/29	Loss: 0.887
Batch: 21/29	Loss: 0.901
Batch: 23/29	Loss: 0.889
Batch: 25/29	Loss: 0.903
Batch: 27/29	Loss: 0.891
Batch: 29/29	Loss: 0.904
Epoch: 6	Train Loss: 0.903	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.304

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.889
Batch: 3/29	Loss: 0.908
Batch: 5/29	Loss: 0.905
Batch: 7/29	Loss: 0.884
Batch: 9/29	Loss: 0.897
Batch: 11/29	Loss: 0.878
Batch: 13/29	Loss: 0.885
Batch: 15/29	Loss: 0.874
Batch: 17/29	Loss: 0.900
Batch: 19/29	Loss: 0.900
Batch: 21/29	Loss: 0.880
Batch: 23/29	Loss: 0.884
Batch: 25/29	Loss: 0.871
Batch: 27/29	Loss: 0.879
Batch: 29/29	Loss: 0.874
Epoch: 7	Train Loss: 0.889	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.304

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.897
Batch: 3/29	Loss: 0.870
Batch: 5/29	Loss: 0.871
Batch: 7/29	Loss: 0.883
Batch: 9/29	Loss: 0.870
Batch: 11/29	Loss: 0.864
Batch: 13/29	Loss: 0.899
Batch: 15/29	Loss: 0.858
Batch: 17/29	Loss: 0.883
Batch: 19/29	Loss: 0.874
Batch: 21/29	Loss: 0.882
Batch: 23/29	Loss: 0.878
Batch: 25/29	Loss: 0.882
Batch: 27/29	Loss: 0.881
Batch: 29/29	Loss: 0.869
Epoch: 8	Train Loss: 0.878	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.304

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.892
Batch: 3/29	Loss: 0.885
Batch: 5/29	Loss: 0.861
Batch: 7/29	Loss: 0.859
Batch: 9/29	Loss: 0.875
Batch: 11/29	Loss: 0.873
Batch: 13/29	Loss: 0.883
Batch: 15/29	Loss: 0.867
Batch: 17/29	Loss: 0.859
Batch: 19/29	Loss: 0.859
Batch: 21/29	Loss: 0.878
Batch: 23/29	Loss: 0.864
Batch: 25/29	Loss: 0.861
Batch: 27/29	Loss: 0.856
Batch: 29/29	Loss: 0.851
Epoch: 9	Train Loss: 0.869	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.304

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.856
Batch: 3/29	Loss: 0.859
Batch: 5/29	Loss: 0.857
Batch: 7/29	Loss: 0.861
Batch: 9/29	Loss: 0.856
Batch: 11/29	Loss: 0.869
Batch: 13/29	Loss: 0.879
Batch: 15/29	Loss: 0.873
Batch: 17/29	Loss: 0.878
Batch: 19/29	Loss: 0.846
Batch: 21/29	Loss: 0.879
Batch: 23/29	Loss: 0.845
Batch: 25/29	Loss: 0.872
Batch: 27/29	Loss: 0.848
Batch: 29/29	Loss: 0.873
Epoch: 10	Train Loss: 0.861	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.304

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.867
Batch: 3/29	Loss: 0.851
Batch: 5/29	Loss: 0.873
Batch: 7/29	Loss: 0.857
Batch: 9/29	Loss: 0.859
Batch: 11/29	Loss: 0.852
Batch: 13/29	Loss: 0.858
Batch: 15/29	Loss: 0.838
Batch: 17/29	Loss: 0.865
Batch: 19/29	Loss: 0.869
Batch: 21/29	Loss: 0.842
Batch: 23/29	Loss: 0.850
Batch: 25/29	Loss: 0.845
Batch: 27/29	Loss: 0.852
Batch: 29/29	Loss: 0.830
Epoch: 11	Train Loss: 0.854	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.304

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.886
Batch: 3/29	Loss: 0.835
Batch: 5/29	Loss: 0.862
Batch: 7/29	Loss: 0.842
Batch: 9/29	Loss: 0.864
Batch: 11/29	Loss: 0.849
Batch: 13/29	Loss: 0.840
Batch: 15/29	Loss: 0.846
Batch: 17/29	Loss: 0.840
Batch: 19/29	Loss: 0.838
Batch: 21/29	Loss: 0.850
Batch: 23/29	Loss: 0.838
Batch: 25/29	Loss: 0.850
Batch: 27/29	Loss: 0.859
Batch: 29/29	Loss: 0.823
Epoch: 12	Train Loss: 0.847	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.304

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.863
Batch: 3/29	Loss: 0.828
Batch: 5/29	Loss: 0.850
Batch: 7/29	Loss: 0.822
Batch: 9/29	Loss: 0.854
Batch: 11/29	Loss: 0.851
Batch: 13/29	Loss: 0.855
Batch: 15/29	Loss: 0.848
Batch: 17/29	Loss: 0.825
Batch: 19/29	Loss: 0.839
Batch: 21/29	Loss: 0.833
Batch: 23/29	Loss: 0.840
Batch: 25/29	Loss: 0.829
Batch: 27/29	Loss: 0.846
Batch: 29/29	Loss: 0.853
Epoch: 13	Train Loss: 0.841	Val F1: 0.186
Best Epoch: 1	Best Val F1: 0.304

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.844
Batch: 3/29	Loss: 0.843
Batch: 5/29	Loss: 0.824
Batch: 7/29	Loss: 0.815
Batch: 9/29	Loss: 0.841
Batch: 11/29	Loss: 0.828
Batch: 13/29	Loss: 0.817
Batch: 15/29	Loss: 0.830
Batch: 17/29	Loss: 0.854
Batch: 19/29	Loss: 0.853
Batch: 21/29	Loss: 0.810
Batch: 23/29	Loss: 0.834
Batch: 25/29	Loss: 0.835
Batch: 27/29	Loss: 0.825
Batch: 29/29	Loss: 0.825
Epoch: 14	Train Loss: 0.835	Val F1: 0.188
Best Epoch: 1	Best Val F1: 0.304

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.824
Batch: 3/29	Loss: 0.838
Batch: 5/29	Loss: 0.817
Batch: 7/29	Loss: 0.842
Batch: 9/29	Loss: 0.809
Batch: 11/29	Loss: 0.830
Batch: 13/29	Loss: 0.826
Batch: 15/29	Loss: 0.835
Batch: 17/29	Loss: 0.831
Batch: 19/29	Loss: 0.822
Batch: 21/29	Loss: 0.833
Batch: 23/29	Loss: 0.820
Batch: 25/29	Loss: 0.830
Batch: 27/29	Loss: 0.837
Batch: 29/29	Loss: 0.865
Epoch: 15	Train Loss: 0.830	Val F1: 0.193
Best Epoch: 1	Best Val F1: 0.304

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.822
Batch: 3/29	Loss: 0.828
Batch: 5/29	Loss: 0.851
Batch: 7/29	Loss: 0.809
Batch: 9/29	Loss: 0.818
Batch: 11/29	Loss: 0.825
Batch: 13/29	Loss: 0.820
Batch: 15/29	Loss: 0.813
Batch: 17/29	Loss: 0.807
Batch: 19/29	Loss: 0.837
Batch: 21/29	Loss: 0.818
Batch: 23/29	Loss: 0.832
Batch: 25/29	Loss: 0.829
Batch: 27/29	Loss: 0.817
Batch: 29/29	Loss: 0.815
Epoch: 16	Train Loss: 0.824	Val F1: 0.229
Best Epoch: 1	Best Val F1: 0.304

Saving the best checkpoint....
Inference...
Test F1: 0.278	Test F1_Few: 0.316	Test F1_Zero: 0.288
Starting training with config: {'batch_size': 32, 'epochs': 75, 'l2_reg': 0.0008267466901022327, 'lr': 2.0582088149486673e-05, 'n_layers_freeze': 4, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 1.035
Batch: 11/58	Loss: 0.969
Batch: 16/58	Loss: 0.905
Batch: 21/58	Loss: 0.910
Batch: 26/58	Loss: 0.899
Batch: 31/58	Loss: 0.866
Batch: 36/58	Loss: 0.890
Batch: 41/58	Loss: 0.837
Batch: 46/58	Loss: 0.821
Batch: 51/58	Loss: 0.807
Batch: 56/58	Loss: 0.813
Batch: 58/58	Loss: 0.819
Epoch: 1	Train Loss: 0.904	Val F1: 0.219
Best Epoch: 1	Best Val F1: 0.219

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.827
Batch: 6/58	Loss: 0.836
Batch: 11/58	Loss: 0.838
Batch: 16/58	Loss: 0.774
Batch: 21/58	Loss: 0.772
Batch: 26/58	Loss: 0.780
Batch: 31/58	Loss: 0.820
Batch: 36/58	Loss: 0.815
Batch: 41/58	Loss: 0.766
Batch: 46/58	Loss: 0.760
Batch: 51/58	Loss: 0.770
Batch: 56/58	Loss: 0.760
Batch: 58/58	Loss: 0.737
Epoch: 2	Train Loss: 0.793	Val F1: 0.321
Best Epoch: 2	Best Val F1: 0.321

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.722
Batch: 6/58	Loss: 0.718
Batch: 11/58	Loss: 0.809
Batch: 16/58	Loss: 0.734
Batch: 21/58	Loss: 0.748
Batch: 26/58	Loss: 0.721
Batch: 31/58	Loss: 0.848
Batch: 36/58	Loss: 0.759
Batch: 41/58	Loss: 0.649
Batch: 46/58	Loss: 0.640
Batch: 51/58	Loss: 0.764
Batch: 56/58	Loss: 0.703
Batch: 58/58	Loss: 0.740
Epoch: 3	Train Loss: 0.738	Val F1: 0.318
Best Epoch: 2	Best Val F1: 0.321

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.721
Batch: 6/58	Loss: 0.665
Batch: 11/58	Loss: 0.666
Batch: 16/58	Loss: 0.647
Batch: 21/58	Loss: 0.534
Batch: 26/58	Loss: 0.600
Batch: 31/58	Loss: 0.601
Batch: 36/58	Loss: 0.723
Batch: 41/58	Loss: 0.725
Batch: 46/58	Loss: 0.616
Batch: 51/58	Loss: 0.738
Batch: 56/58	Loss: 0.591
Batch: 58/58	Loss: 0.631
Epoch: 4	Train Loss: 0.670	Val F1: 0.329
Best Epoch: 4	Best Val F1: 0.329

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.555
Batch: 6/58	Loss: 0.567
Batch: 11/58	Loss: 0.588
Batch: 16/58	Loss: 0.618
Batch: 21/58	Loss: 0.558
Batch: 26/58	Loss: 0.689
Batch: 31/58	Loss: 0.744
Batch: 36/58	Loss: 0.659
Batch: 41/58	Loss: 0.544
Batch: 46/58	Loss: 0.583
Batch: 51/58	Loss: 0.737
Batch: 56/58	Loss: 0.750
Batch: 58/58	Loss: 0.751
Epoch: 5	Train Loss: 0.639	Val F1: 0.348
Best Epoch: 5	Best Val F1: 0.348

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.650
Batch: 6/58	Loss: 0.678
Batch: 11/58	Loss: 0.663
Batch: 16/58	Loss: 0.578
Batch: 21/58	Loss: 0.613
Batch: 26/58	Loss: 0.437
Batch: 31/58	Loss: 0.589
Batch: 36/58	Loss: 0.467
Batch: 41/58	Loss: 0.555
Batch: 46/58	Loss: 0.552
Batch: 51/58	Loss: 0.586
Batch: 56/58	Loss: 0.568
Batch: 58/58	Loss: 0.515
Epoch: 6	Train Loss: 0.575	Val F1: 0.321
Best Epoch: 5	Best Val F1: 0.348

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.430
Batch: 6/58	Loss: 0.592
Batch: 11/58	Loss: 0.624
Batch: 16/58	Loss: 0.370
Batch: 21/58	Loss: 0.471
Batch: 26/58	Loss: 0.494
Batch: 31/58	Loss: 0.550
Batch: 36/58	Loss: 0.504
Batch: 41/58	Loss: 0.475
Batch: 46/58	Loss: 0.500
Batch: 51/58	Loss: 0.463
Batch: 56/58	Loss: 0.557
Batch: 58/58	Loss: 0.423
Epoch: 7	Train Loss: 0.521	Val F1: 0.354
Best Epoch: 7	Best Val F1: 0.354

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.499
Batch: 6/58	Loss: 0.425
Batch: 11/58	Loss: 0.419
Batch: 16/58	Loss: 0.436
Batch: 21/58	Loss: 0.454
Batch: 26/58	Loss: 0.375
Batch: 31/58	Loss: 0.450
Batch: 36/58	Loss: 0.345
Batch: 41/58	Loss: 0.532
Batch: 46/58	Loss: 0.480
Batch: 51/58	Loss: 0.491
Batch: 56/58	Loss: 0.479
Batch: 58/58	Loss: 0.598
Epoch: 8	Train Loss: 0.474	Val F1: 0.351
Best Epoch: 7	Best Val F1: 0.354

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.553
Batch: 6/58	Loss: 0.569
Batch: 11/58	Loss: 0.603
Batch: 16/58	Loss: 0.348
Batch: 21/58	Loss: 0.384
Batch: 26/58	Loss: 0.312
Batch: 31/58	Loss: 0.380
Batch: 36/58	Loss: 0.371
Batch: 41/58	Loss: 0.430
Batch: 46/58	Loss: 0.448
Batch: 51/58	Loss: 0.518
Batch: 56/58	Loss: 0.338
Batch: 58/58	Loss: 0.423
Epoch: 9	Train Loss: 0.444	Val F1: 0.356
Best Epoch: 9	Best Val F1: 0.356

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.379
Batch: 6/58	Loss: 0.379
Batch: 11/58	Loss: 0.435
Batch: 16/58	Loss: 0.560
Batch: 21/58	Loss: 0.339
Batch: 26/58	Loss: 0.437
Batch: 31/58	Loss: 0.295
Batch: 36/58	Loss: 0.565
Batch: 41/58	Loss: 0.525
Batch: 46/58	Loss: 0.518
Batch: 51/58	Loss: 0.402
Batch: 56/58	Loss: 0.325
Batch: 58/58	Loss: 0.487
Epoch: 10	Train Loss: 0.412	Val F1: 0.348
Best Epoch: 9	Best Val F1: 0.356

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.371
Batch: 6/58	Loss: 0.355
Batch: 11/58	Loss: 0.404
Batch: 16/58	Loss: 0.407
Batch: 21/58	Loss: 0.425
Batch: 26/58	Loss: 0.478
Batch: 31/58	Loss: 0.405
Batch: 36/58	Loss: 0.377
Batch: 41/58	Loss: 0.344
Batch: 46/58	Loss: 0.349
Batch: 51/58	Loss: 0.400
Batch: 56/58	Loss: 0.385
Batch: 58/58	Loss: 0.425
Epoch: 11	Train Loss: 0.386	Val F1: 0.334
Best Epoch: 9	Best Val F1: 0.356

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.440
Batch: 6/58	Loss: 0.282
Batch: 11/58	Loss: 0.355
Batch: 16/58	Loss: 0.412
Batch: 21/58	Loss: 0.449
Batch: 26/58	Loss: 0.321
Batch: 31/58	Loss: 0.448
Batch: 36/58	Loss: 0.310
Batch: 41/58	Loss: 0.330
Batch: 46/58	Loss: 0.323
Batch: 51/58	Loss: 0.463
Batch: 56/58	Loss: 0.279
Batch: 58/58	Loss: 0.182
Epoch: 12	Train Loss: 0.354	Val F1: 0.349
Best Epoch: 9	Best Val F1: 0.356

****************************** Epoch: 13 ******************************
Batch: 1/58	Loss: 0.387
Batch: 6/58	Loss: 0.269
Batch: 11/58	Loss: 0.348
Batch: 16/58	Loss: 0.283
Batch: 21/58	Loss: 0.291
Batch: 26/58	Loss: 0.325
Batch: 31/58	Loss: 0.318
Batch: 36/58	Loss: 0.290
Batch: 41/58	Loss: 0.289
Batch: 46/58	Loss: 0.311
Batch: 51/58	Loss: 0.325
Batch: 56/58	Loss: 0.424
Batch: 58/58	Loss: 0.240
Epoch: 13	Train Loss: 0.329	Val F1: 0.376
Best Epoch: 13	Best Val F1: 0.376

****************************** Epoch: 14 ******************************
Batch: 1/58	Loss: 0.367
Batch: 6/58	Loss: 0.398
Batch: 11/58	Loss: 0.279
Batch: 16/58	Loss: 0.319
Batch: 21/58	Loss: 0.315
Batch: 26/58	Loss: 0.336
Batch: 31/58	Loss: 0.292
Batch: 36/58	Loss: 0.279
Batch: 41/58	Loss: 0.195
Batch: 46/58	Loss: 0.256
Batch: 51/58	Loss: 0.393
Batch: 56/58	Loss: 0.255
Batch: 58/58	Loss: 0.334
Epoch: 14	Train Loss: 0.312	Val F1: 0.354
Best Epoch: 13	Best Val F1: 0.376

****************************** Epoch: 15 ******************************
Batch: 1/58	Loss: 0.254
Batch: 6/58	Loss: 0.354
Batch: 11/58	Loss: 0.264
Batch: 16/58	Loss: 0.259
Batch: 21/58	Loss: 0.359
Batch: 26/58	Loss: 0.284
Batch: 31/58	Loss: 0.247
Batch: 36/58	Loss: 0.335
Batch: 41/58	Loss: 0.377
Batch: 46/58	Loss: 0.185
Batch: 51/58	Loss: 0.261
Batch: 56/58	Loss: 0.247
Batch: 58/58	Loss: 0.352
Epoch: 15	Train Loss: 0.290	Val F1: 0.346
Best Epoch: 13	Best Val F1: 0.376

****************************** Epoch: 16 ******************************
Batch: 1/58	Loss: 0.274
Batch: 6/58	Loss: 0.160
Batch: 11/58	Loss: 0.164
Batch: 16/58	Loss: 0.253
Batch: 21/58	Loss: 0.204
Batch: 26/58	Loss: 0.293
Batch: 31/58	Loss: 0.246
Batch: 36/58	Loss: 0.219
Batch: 41/58	Loss: 0.172
Batch: 46/58	Loss: 0.204
Batch: 51/58	Loss: 0.298
Batch: 56/58	Loss: 0.210
Batch: 58/58	Loss: 0.237
Epoch: 16	Train Loss: 0.268	Val F1: 0.335
Best Epoch: 13	Best Val F1: 0.376

****************************** Epoch: 17 ******************************
Batch: 1/58	Loss: 0.211
Batch: 6/58	Loss: 0.271
Batch: 11/58	Loss: 0.202
Batch: 16/58	Loss: 0.219
Batch: 21/58	Loss: 0.231
Batch: 26/58	Loss: 0.287
Batch: 31/58	Loss: 0.211
Batch: 36/58	Loss: 0.207
Batch: 41/58	Loss: 0.255
Batch: 46/58	Loss: 0.388
Batch: 51/58	Loss: 0.165
Batch: 56/58	Loss: 0.173
Batch: 58/58	Loss: 0.237
Epoch: 17	Train Loss: 0.239	Val F1: 0.341
Best Epoch: 13	Best Val F1: 0.376

****************************** Epoch: 18 ******************************
Batch: 1/58	Loss: 0.239
Batch: 6/58	Loss: 0.344
Batch: 11/58	Loss: 0.301
Batch: 16/58	Loss: 0.258
Batch: 21/58	Loss: 0.227
Batch: 26/58	Loss: 0.208
Batch: 31/58	Loss: 0.145
Batch: 36/58	Loss: 0.222
Batch: 41/58	Loss: 0.162
Batch: 46/58	Loss: 0.279
Batch: 51/58	Loss: 0.167
Batch: 56/58	Loss: 0.232
Batch: 58/58	Loss: 0.222
Epoch: 18	Train Loss: 0.217	Val F1: 0.320
Best Epoch: 13	Best Val F1: 0.376

****************************** Epoch: 19 ******************************
Batch: 1/58	Loss: 0.222
Batch: 6/58	Loss: 0.241
Batch: 11/58	Loss: 0.234
Batch: 16/58	Loss: 0.083
Batch: 21/58	Loss: 0.263
Batch: 26/58	Loss: 0.253
Batch: 31/58	Loss: 0.159
Batch: 36/58	Loss: 0.137
Batch: 41/58	Loss: 0.142
Batch: 46/58	Loss: 0.220
Batch: 51/58	Loss: 0.182
Batch: 56/58	Loss: 0.245
Batch: 58/58	Loss: 0.142
Epoch: 19	Train Loss: 0.200	Val F1: 0.338
Best Epoch: 13	Best Val F1: 0.376

****************************** Epoch: 20 ******************************
Batch: 1/58	Loss: 0.197
Batch: 6/58	Loss: 0.148
Batch: 11/58	Loss: 0.137
Batch: 16/58	Loss: 0.220
Batch: 21/58	Loss: 0.158
Batch: 26/58	Loss: 0.127
Batch: 31/58	Loss: 0.216
Batch: 36/58	Loss: 0.087
Batch: 41/58	Loss: 0.103
Batch: 46/58	Loss: 0.338
Batch: 51/58	Loss: 0.180
Batch: 56/58	Loss: 0.164
Batch: 58/58	Loss: 0.202
Epoch: 20	Train Loss: 0.171	Val F1: 0.341
Best Epoch: 13	Best Val F1: 0.376

****************************** Epoch: 21 ******************************
Batch: 1/58	Loss: 0.206
Batch: 6/58	Loss: 0.077
Batch: 11/58	Loss: 0.128
Batch: 16/58	Loss: 0.147
Batch: 21/58	Loss: 0.123
Batch: 26/58	Loss: 0.148
Batch: 31/58	Loss: 0.076
Batch: 36/58	Loss: 0.182
Batch: 41/58	Loss: 0.105
Batch: 46/58	Loss: 0.147
Batch: 51/58	Loss: 0.137
Batch: 56/58	Loss: 0.076
Batch: 58/58	Loss: 0.208
Epoch: 21	Train Loss: 0.153	Val F1: 0.345
Best Epoch: 13	Best Val F1: 0.376

****************************** Epoch: 22 ******************************
Batch: 1/58	Loss: 0.193
Batch: 6/58	Loss: 0.126
Batch: 11/58	Loss: 0.108
Batch: 16/58	Loss: 0.083
Batch: 21/58	Loss: 0.138
Batch: 26/58	Loss: 0.134
Batch: 31/58	Loss: 0.094
Batch: 36/58	Loss: 0.129
Batch: 41/58	Loss: 0.184
Batch: 46/58	Loss: 0.143
Batch: 51/58	Loss: 0.068
Batch: 56/58	Loss: 0.104
Batch: 58/58	Loss: 0.164
Epoch: 22	Train Loss: 0.124	Val F1: 0.336
Best Epoch: 13	Best Val F1: 0.376

****************************** Epoch: 23 ******************************
Batch: 1/58	Loss: 0.225
Batch: 6/58	Loss: 0.126
Batch: 11/58	Loss: 0.176
Batch: 16/58	Loss: 0.094
Batch: 21/58	Loss: 0.077
Batch: 26/58	Loss: 0.077
Batch: 31/58	Loss: 0.062
Batch: 36/58	Loss: 0.187
Batch: 41/58	Loss: 0.112
Batch: 46/58	Loss: 0.104
Batch: 51/58	Loss: 0.060
Batch: 56/58	Loss: 0.074
Batch: 58/58	Loss: 0.132
Epoch: 23	Train Loss: 0.108	Val F1: 0.354
Best Epoch: 13	Best Val F1: 0.376

****************************** Epoch: 24 ******************************
Batch: 1/58	Loss: 0.102
Batch: 6/58	Loss: 0.074
Batch: 11/58	Loss: 0.079
Batch: 16/58	Loss: 0.215
Batch: 21/58	Loss: 0.077
Batch: 26/58	Loss: 0.092
Batch: 31/58	Loss: 0.113
Batch: 36/58	Loss: 0.132
Batch: 41/58	Loss: 0.085
Batch: 46/58	Loss: 0.065
Batch: 51/58	Loss: 0.083
Batch: 56/58	Loss: 0.092
Batch: 58/58	Loss: 0.150
Epoch: 24	Train Loss: 0.100	Val F1: 0.354
Best Epoch: 13	Best Val F1: 0.376

****************************** Epoch: 25 ******************************
Batch: 1/58	Loss: 0.101
Batch: 6/58	Loss: 0.062
Batch: 11/58	Loss: 0.053
Batch: 16/58	Loss: 0.038
Batch: 21/58	Loss: 0.091
Batch: 26/58	Loss: 0.077
Batch: 31/58	Loss: 0.078
Batch: 36/58	Loss: 0.085
Batch: 41/58	Loss: 0.105
Batch: 46/58	Loss: 0.102
Batch: 51/58	Loss: 0.153
Batch: 56/58	Loss: 0.049
Batch: 58/58	Loss: 0.047
Epoch: 25	Train Loss: 0.079	Val F1: 0.360
Best Epoch: 13	Best Val F1: 0.376

****************************** Epoch: 26 ******************************
Batch: 1/58	Loss: 0.100
Batch: 6/58	Loss: 0.197
Batch: 11/58	Loss: 0.097
Batch: 16/58	Loss: 0.074
Batch: 21/58	Loss: 0.122
Batch: 26/58	Loss: 0.201
Batch: 31/58	Loss: 0.071
Batch: 36/58	Loss: 0.051
Batch: 41/58	Loss: 0.078
Batch: 46/58	Loss: 0.046
Batch: 51/58	Loss: 0.048
Batch: 56/58	Loss: 0.070
Batch: 58/58	Loss: 0.110
Epoch: 26	Train Loss: 0.081	Val F1: 0.348
Best Epoch: 13	Best Val F1: 0.376

****************************** Epoch: 27 ******************************
Batch: 1/58	Loss: 0.059
Batch: 6/58	Loss: 0.104
Batch: 11/58	Loss: 0.066
Batch: 16/58	Loss: 0.102
Batch: 21/58	Loss: 0.051
Batch: 26/58	Loss: 0.105
Batch: 31/58	Loss: 0.035
Batch: 36/58	Loss: 0.057
Batch: 41/58	Loss: 0.109
Batch: 46/58	Loss: 0.048
Batch: 51/58	Loss: 0.052
Batch: 56/58	Loss: 0.070
Batch: 58/58	Loss: 0.063
Epoch: 27	Train Loss: 0.077	Val F1: 0.343
Best Epoch: 13	Best Val F1: 0.376

****************************** Epoch: 28 ******************************
Batch: 1/58	Loss: 0.042
Batch: 6/58	Loss: 0.043
Batch: 11/58	Loss: 0.077
Batch: 16/58	Loss: 0.037
Batch: 21/58	Loss: 0.050
Batch: 26/58	Loss: 0.071
Batch: 31/58	Loss: 0.066
Batch: 36/58	Loss: 0.035
Batch: 41/58	Loss: 0.058
Batch: 46/58	Loss: 0.042
Batch: 51/58	Loss: 0.054
Batch: 56/58	Loss: 0.023
Batch: 58/58	Loss: 0.135
Epoch: 28	Train Loss: 0.061	Val F1: 0.352
Best Epoch: 13	Best Val F1: 0.376

Saving the best checkpoint....
Inference...
Test F1: 0.376	Test F1_Few: 0.442	Test F1_Zero: 0.376
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0009270739750584372, 'lr': 9.270909737787e-06, 'n_layers_freeze': 1, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.083
Batch: 5/29	Loss: 1.067
Batch: 7/29	Loss: 1.055
Batch: 9/29	Loss: 1.042
Batch: 11/29	Loss: 1.027
Batch: 13/29	Loss: 1.016
Batch: 15/29	Loss: 1.013
Batch: 17/29	Loss: 0.983
Batch: 19/29	Loss: 0.976
Batch: 21/29	Loss: 0.961
Batch: 23/29	Loss: 0.958
Batch: 25/29	Loss: 0.937
Batch: 27/29	Loss: 0.929
Batch: 29/29	Loss: 0.932
Epoch: 1	Train Loss: 1.004	Val F1: 0.190
Best Epoch: 1	Best Val F1: 0.190

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.924
Batch: 3/29	Loss: 0.921
Batch: 5/29	Loss: 0.937
Batch: 7/29	Loss: 0.909
Batch: 9/29	Loss: 0.916
Batch: 11/29	Loss: 0.884
Batch: 13/29	Loss: 0.882
Batch: 15/29	Loss: 0.900
Batch: 17/29	Loss: 0.889
Batch: 19/29	Loss: 0.908
Batch: 21/29	Loss: 0.875
Batch: 23/29	Loss: 0.879
Batch: 25/29	Loss: 0.863
Batch: 27/29	Loss: 0.905
Batch: 29/29	Loss: 0.865
Epoch: 2	Train Loss: 0.894	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.190

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.857
Batch: 3/29	Loss: 0.868
Batch: 5/29	Loss: 0.861
Batch: 7/29	Loss: 0.881
Batch: 9/29	Loss: 0.847
Batch: 11/29	Loss: 0.846
Batch: 13/29	Loss: 0.875
Batch: 15/29	Loss: 0.847
Batch: 17/29	Loss: 0.861
Batch: 19/29	Loss: 0.856
Batch: 21/29	Loss: 0.840
Batch: 23/29	Loss: 0.836
Batch: 25/29	Loss: 0.849
Batch: 27/29	Loss: 0.828
Batch: 29/29	Loss: 0.835
Epoch: 3	Train Loss: 0.853	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.190

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.823
Batch: 3/29	Loss: 0.836
Batch: 5/29	Loss: 0.816
Batch: 7/29	Loss: 0.854
Batch: 9/29	Loss: 0.843
Batch: 11/29	Loss: 0.810
Batch: 13/29	Loss: 0.818
Batch: 15/29	Loss: 0.804
Batch: 17/29	Loss: 0.815
Batch: 19/29	Loss: 0.831
Batch: 21/29	Loss: 0.840
Batch: 23/29	Loss: 0.840
Batch: 25/29	Loss: 0.827
Batch: 27/29	Loss: 0.840
Batch: 29/29	Loss: 0.825
Epoch: 4	Train Loss: 0.827	Val F1: 0.234
Best Epoch: 4	Best Val F1: 0.234

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.812
Batch: 3/29	Loss: 0.804
Batch: 5/29	Loss: 0.797
Batch: 7/29	Loss: 0.790
Batch: 9/29	Loss: 0.788
Batch: 11/29	Loss: 0.793
Batch: 13/29	Loss: 0.787
Batch: 15/29	Loss: 0.808
Batch: 17/29	Loss: 0.832
Batch: 19/29	Loss: 0.801
Batch: 21/29	Loss: 0.778
Batch: 23/29	Loss: 0.795
Batch: 25/29	Loss: 0.808
Batch: 27/29	Loss: 0.765
Batch: 29/29	Loss: 0.793
Epoch: 5	Train Loss: 0.802	Val F1: 0.301
Best Epoch: 5	Best Val F1: 0.301

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.780
Batch: 3/29	Loss: 0.817
Batch: 5/29	Loss: 0.771
Batch: 7/29	Loss: 0.822
Batch: 9/29	Loss: 0.778
Batch: 11/29	Loss: 0.778
Batch: 13/29	Loss: 0.759
Batch: 15/29	Loss: 0.744
Batch: 17/29	Loss: 0.750
Batch: 19/29	Loss: 0.741
Batch: 21/29	Loss: 0.782
Batch: 23/29	Loss: 0.750
Batch: 25/29	Loss: 0.754
Batch: 27/29	Loss: 0.756
Batch: 29/29	Loss: 0.751
Epoch: 6	Train Loss: 0.768	Val F1: 0.324
Best Epoch: 6	Best Val F1: 0.324

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.727
Batch: 3/29	Loss: 0.795
Batch: 5/29	Loss: 0.797
Batch: 7/29	Loss: 0.752
Batch: 9/29	Loss: 0.755
Batch: 11/29	Loss: 0.702
Batch: 13/29	Loss: 0.714
Batch: 15/29	Loss: 0.722
Batch: 17/29	Loss: 0.758
Batch: 19/29	Loss: 0.749
Batch: 21/29	Loss: 0.687
Batch: 23/29	Loss: 0.691
Batch: 25/29	Loss: 0.669
Batch: 27/29	Loss: 0.709
Batch: 29/29	Loss: 0.704
Epoch: 7	Train Loss: 0.728	Val F1: 0.323
Best Epoch: 6	Best Val F1: 0.324

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.720
Batch: 3/29	Loss: 0.671
Batch: 5/29	Loss: 0.713
Batch: 7/29	Loss: 0.670
Batch: 9/29	Loss: 0.700
Batch: 11/29	Loss: 0.692
Batch: 13/29	Loss: 0.770
Batch: 15/29	Loss: 0.672
Batch: 17/29	Loss: 0.717
Batch: 19/29	Loss: 0.703
Batch: 21/29	Loss: 0.703
Batch: 23/29	Loss: 0.702
Batch: 25/29	Loss: 0.734
Batch: 27/29	Loss: 0.687
Batch: 29/29	Loss: 0.675
Epoch: 8	Train Loss: 0.697	Val F1: 0.343
Best Epoch: 8	Best Val F1: 0.343

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.703
Batch: 3/29	Loss: 0.637
Batch: 5/29	Loss: 0.659
Batch: 7/29	Loss: 0.638
Batch: 9/29	Loss: 0.694
Batch: 11/29	Loss: 0.663
Batch: 13/29	Loss: 0.692
Batch: 15/29	Loss: 0.648
Batch: 17/29	Loss: 0.660
Batch: 19/29	Loss: 0.646
Batch: 21/29	Loss: 0.713
Batch: 23/29	Loss: 0.644
Batch: 25/29	Loss: 0.608
Batch: 27/29	Loss: 0.692
Batch: 29/29	Loss: 0.605
Epoch: 9	Train Loss: 0.658	Val F1: 0.345
Best Epoch: 9	Best Val F1: 0.345

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.568
Batch: 3/29	Loss: 0.643
Batch: 5/29	Loss: 0.620
Batch: 7/29	Loss: 0.610
Batch: 9/29	Loss: 0.612
Batch: 11/29	Loss: 0.531
Batch: 13/29	Loss: 0.704
Batch: 15/29	Loss: 0.665
Batch: 17/29	Loss: 0.709
Batch: 19/29	Loss: 0.496
Batch: 21/29	Loss: 0.665
Batch: 23/29	Loss: 0.645
Batch: 25/29	Loss: 0.657
Batch: 27/29	Loss: 0.582
Batch: 29/29	Loss: 0.689
Epoch: 10	Train Loss: 0.625	Val F1: 0.348
Best Epoch: 10	Best Val F1: 0.348

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.582
Batch: 3/29	Loss: 0.559
Batch: 5/29	Loss: 0.720
Batch: 7/29	Loss: 0.605
Batch: 9/29	Loss: 0.610
Batch: 11/29	Loss: 0.592
Batch: 13/29	Loss: 0.600
Batch: 15/29	Loss: 0.487
Batch: 17/29	Loss: 0.624
Batch: 19/29	Loss: 0.580
Batch: 21/29	Loss: 0.574
Batch: 23/29	Loss: 0.515
Batch: 25/29	Loss: 0.569
Batch: 27/29	Loss: 0.514
Batch: 29/29	Loss: 0.546
Epoch: 11	Train Loss: 0.591	Val F1: 0.349
Best Epoch: 11	Best Val F1: 0.349

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.696
Batch: 3/29	Loss: 0.557
Batch: 5/29	Loss: 0.640
Batch: 7/29	Loss: 0.515
Batch: 9/29	Loss: 0.613
Batch: 11/29	Loss: 0.564
Batch: 13/29	Loss: 0.526
Batch: 15/29	Loss: 0.516
Batch: 17/29	Loss: 0.575
Batch: 19/29	Loss: 0.569
Batch: 21/29	Loss: 0.557
Batch: 23/29	Loss: 0.553
Batch: 25/29	Loss: 0.518
Batch: 27/29	Loss: 0.598
Batch: 29/29	Loss: 0.474
Epoch: 12	Train Loss: 0.562	Val F1: 0.347
Best Epoch: 11	Best Val F1: 0.349

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.565
Batch: 3/29	Loss: 0.452
Batch: 5/29	Loss: 0.545
Batch: 7/29	Loss: 0.545
Batch: 9/29	Loss: 0.543
Batch: 11/29	Loss: 0.510
Batch: 13/29	Loss: 0.528
Batch: 15/29	Loss: 0.570
Batch: 17/29	Loss: 0.483
Batch: 19/29	Loss: 0.374
Batch: 21/29	Loss: 0.483
Batch: 23/29	Loss: 0.524
Batch: 25/29	Loss: 0.378
Batch: 27/29	Loss: 0.566
Batch: 29/29	Loss: 0.587
Epoch: 13	Train Loss: 0.523	Val F1: 0.347
Best Epoch: 11	Best Val F1: 0.349

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.516
Batch: 3/29	Loss: 0.528
Batch: 5/29	Loss: 0.409
Batch: 7/29	Loss: 0.484
Batch: 9/29	Loss: 0.535
Batch: 11/29	Loss: 0.489
Batch: 13/29	Loss: 0.454
Batch: 15/29	Loss: 0.382
Batch: 17/29	Loss: 0.570
Batch: 19/29	Loss: 0.570
Batch: 21/29	Loss: 0.407
Batch: 23/29	Loss: 0.412
Batch: 25/29	Loss: 0.532
Batch: 27/29	Loss: 0.503
Batch: 29/29	Loss: 0.606
Epoch: 14	Train Loss: 0.495	Val F1: 0.349
Best Epoch: 11	Best Val F1: 0.349

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.454
Batch: 3/29	Loss: 0.517
Batch: 5/29	Loss: 0.418
Batch: 7/29	Loss: 0.491
Batch: 9/29	Loss: 0.489
Batch: 11/29	Loss: 0.479
Batch: 13/29	Loss: 0.491
Batch: 15/29	Loss: 0.647
Batch: 17/29	Loss: 0.503
Batch: 19/29	Loss: 0.493
Batch: 21/29	Loss: 0.474
Batch: 23/29	Loss: 0.574
Batch: 25/29	Loss: 0.492
Batch: 27/29	Loss: 0.421
Batch: 29/29	Loss: 0.518
Epoch: 15	Train Loss: 0.490	Val F1: 0.346
Best Epoch: 11	Best Val F1: 0.349

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.497
Batch: 3/29	Loss: 0.436
Batch: 5/29	Loss: 0.472
Batch: 7/29	Loss: 0.419
Batch: 9/29	Loss: 0.460
Batch: 11/29	Loss: 0.413
Batch: 13/29	Loss: 0.413
Batch: 15/29	Loss: 0.394
Batch: 17/29	Loss: 0.464
Batch: 19/29	Loss: 0.509
Batch: 21/29	Loss: 0.370
Batch: 23/29	Loss: 0.451
Batch: 25/29	Loss: 0.482
Batch: 27/29	Loss: 0.403
Batch: 29/29	Loss: 0.441
Epoch: 16	Train Loss: 0.441	Val F1: 0.347
Best Epoch: 11	Best Val F1: 0.349

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.432
Batch: 3/29	Loss: 0.526
Batch: 5/29	Loss: 0.486
Batch: 7/29	Loss: 0.395
Batch: 9/29	Loss: 0.362
Batch: 11/29	Loss: 0.444
Batch: 13/29	Loss: 0.488
Batch: 15/29	Loss: 0.448
Batch: 17/29	Loss: 0.467
Batch: 19/29	Loss: 0.415
Batch: 21/29	Loss: 0.502
Batch: 23/29	Loss: 0.467
Batch: 25/29	Loss: 0.306
Batch: 27/29	Loss: 0.467
Batch: 29/29	Loss: 0.476
Epoch: 17	Train Loss: 0.435	Val F1: 0.346
Best Epoch: 11	Best Val F1: 0.349

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.449
Batch: 3/29	Loss: 0.444
Batch: 5/29	Loss: 0.422
Batch: 7/29	Loss: 0.358
Batch: 9/29	Loss: 0.493
Batch: 11/29	Loss: 0.372
Batch: 13/29	Loss: 0.368
Batch: 15/29	Loss: 0.397
Batch: 17/29	Loss: 0.390
Batch: 19/29	Loss: 0.331
Batch: 21/29	Loss: 0.430
Batch: 23/29	Loss: 0.423
Batch: 25/29	Loss: 0.446
Batch: 27/29	Loss: 0.320
Batch: 29/29	Loss: 0.451
Epoch: 18	Train Loss: 0.414	Val F1: 0.347
Best Epoch: 11	Best Val F1: 0.349

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.309
Batch: 3/29	Loss: 0.301
Batch: 5/29	Loss: 0.394
Batch: 7/29	Loss: 0.443
Batch: 9/29	Loss: 0.292
Batch: 11/29	Loss: 0.476
Batch: 13/29	Loss: 0.481
Batch: 15/29	Loss: 0.407
Batch: 17/29	Loss: 0.403
Batch: 19/29	Loss: 0.475
Batch: 21/29	Loss: 0.409
Batch: 23/29	Loss: 0.421
Batch: 25/29	Loss: 0.420
Batch: 27/29	Loss: 0.356
Batch: 29/29	Loss: 0.343
Epoch: 19	Train Loss: 0.401	Val F1: 0.340
Best Epoch: 11	Best Val F1: 0.349

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.449
Batch: 3/29	Loss: 0.421
Batch: 5/29	Loss: 0.335
Batch: 7/29	Loss: 0.295
Batch: 9/29	Loss: 0.447
Batch: 11/29	Loss: 0.401
Batch: 13/29	Loss: 0.418
Batch: 15/29	Loss: 0.404
Batch: 17/29	Loss: 0.462
Batch: 19/29	Loss: 0.354
Batch: 21/29	Loss: 0.377
Batch: 23/29	Loss: 0.513
Batch: 25/29	Loss: 0.359
Batch: 27/29	Loss: 0.392
Batch: 29/29	Loss: 0.474
Epoch: 20	Train Loss: 0.394	Val F1: 0.347
Best Epoch: 11	Best Val F1: 0.349

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.378
Batch: 3/29	Loss: 0.332
Batch: 5/29	Loss: 0.330
Batch: 7/29	Loss: 0.563
Batch: 9/29	Loss: 0.366
Batch: 11/29	Loss: 0.344
Batch: 13/29	Loss: 0.392
Batch: 15/29	Loss: 0.438
Batch: 17/29	Loss: 0.356
Batch: 19/29	Loss: 0.335
Batch: 21/29	Loss: 0.377
Batch: 23/29	Loss: 0.309
Batch: 25/29	Loss: 0.363
Batch: 27/29	Loss: 0.381
Batch: 29/29	Loss: 0.390
Epoch: 21	Train Loss: 0.387	Val F1: 0.338
Best Epoch: 11	Best Val F1: 0.349

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.365
Batch: 3/29	Loss: 0.346
Batch: 5/29	Loss: 0.401
Batch: 7/29	Loss: 0.394
Batch: 9/29	Loss: 0.339
Batch: 11/29	Loss: 0.331
Batch: 13/29	Loss: 0.320
Batch: 15/29	Loss: 0.409
Batch: 17/29	Loss: 0.405
Batch: 19/29	Loss: 0.460
Batch: 21/29	Loss: 0.493
Batch: 23/29	Loss: 0.389
Batch: 25/29	Loss: 0.361
Batch: 27/29	Loss: 0.324
Batch: 29/29	Loss: 0.342
Epoch: 22	Train Loss: 0.373	Val F1: 0.342
Best Epoch: 11	Best Val F1: 0.349

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.343
Batch: 3/29	Loss: 0.356
Batch: 5/29	Loss: 0.411
Batch: 7/29	Loss: 0.461
Batch: 9/29	Loss: 0.352
Batch: 11/29	Loss: 0.421
Batch: 13/29	Loss: 0.330
Batch: 15/29	Loss: 0.371
Batch: 17/29	Loss: 0.328
Batch: 19/29	Loss: 0.450
Batch: 21/29	Loss: 0.341
Batch: 23/29	Loss: 0.315
Batch: 25/29	Loss: 0.399
Batch: 27/29	Loss: 0.302
Batch: 29/29	Loss: 0.420
Epoch: 23	Train Loss: 0.374	Val F1: 0.342
Best Epoch: 11	Best Val F1: 0.349

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.348
Batch: 3/29	Loss: 0.323
Batch: 5/29	Loss: 0.426
Batch: 7/29	Loss: 0.427
Batch: 9/29	Loss: 0.415
Batch: 11/29	Loss: 0.467
Batch: 13/29	Loss: 0.313
Batch: 15/29	Loss: 0.336
Batch: 17/29	Loss: 0.321
Batch: 19/29	Loss: 0.406
Batch: 21/29	Loss: 0.417
Batch: 23/29	Loss: 0.353
Batch: 25/29	Loss: 0.334
Batch: 27/29	Loss: 0.309
Batch: 29/29	Loss: 0.350
Epoch: 24	Train Loss: 0.366	Val F1: 0.344
Best Epoch: 11	Best Val F1: 0.349

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.426
Batch: 3/29	Loss: 0.384
Batch: 5/29	Loss: 0.435
Batch: 7/29	Loss: 0.394
Batch: 9/29	Loss: 0.443
Batch: 11/29	Loss: 0.354
Batch: 13/29	Loss: 0.393
Batch: 15/29	Loss: 0.353
Batch: 17/29	Loss: 0.368
Batch: 19/29	Loss: 0.277
Batch: 21/29	Loss: 0.344
Batch: 23/29	Loss: 0.333
Batch: 25/29	Loss: 0.334
Batch: 27/29	Loss: 0.356
Batch: 29/29	Loss: 0.281
Epoch: 25	Train Loss: 0.346	Val F1: 0.340
Best Epoch: 11	Best Val F1: 0.349

****************************** Epoch: 26 ******************************
Batch: 1/29	Loss: 0.288
Batch: 3/29	Loss: 0.293
Batch: 5/29	Loss: 0.364
Batch: 7/29	Loss: 0.417
Batch: 9/29	Loss: 0.330
Batch: 11/29	Loss: 0.357
Batch: 13/29	Loss: 0.338
Batch: 15/29	Loss: 0.356
Batch: 17/29	Loss: 0.271
Batch: 19/29	Loss: 0.435
Batch: 21/29	Loss: 0.472
Batch: 23/29	Loss: 0.238
Batch: 25/29	Loss: 0.398
Batch: 27/29	Loss: 0.298
Batch: 29/29	Loss: 0.371
Epoch: 26	Train Loss: 0.339	Val F1: 0.347
Best Epoch: 11	Best Val F1: 0.349

Saving the best checkpoint....
Inference...
Test F1: 0.381	Test F1_Few: 0.452	Test F1_Zero: 0.382
Starting training with config: {'batch_size': 64, 'epochs': 25, 'l2_reg': 0.0007583829069309617, 'lr': 1.6464634888176222e-05, 'n_layers_freeze': 1, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.072
Batch: 5/29	Loss: 1.043
Batch: 7/29	Loss: 1.023
Batch: 9/29	Loss: 0.999
Batch: 11/29	Loss: 0.983
Batch: 13/29	Loss: 0.970
Batch: 15/29	Loss: 0.972
Batch: 17/29	Loss: 0.933
Batch: 19/29	Loss: 0.930
Batch: 21/29	Loss: 0.912
Batch: 23/29	Loss: 0.917
Batch: 25/29	Loss: 0.886
Batch: 27/29	Loss: 0.882
Batch: 29/29	Loss: 0.888
Epoch: 1	Train Loss: 0.966	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.185

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.880
Batch: 3/29	Loss: 0.878
Batch: 5/29	Loss: 0.904
Batch: 7/29	Loss: 0.866
Batch: 9/29	Loss: 0.879
Batch: 11/29	Loss: 0.839
Batch: 13/29	Loss: 0.838
Batch: 15/29	Loss: 0.860
Batch: 17/29	Loss: 0.848
Batch: 19/29	Loss: 0.878
Batch: 21/29	Loss: 0.834
Batch: 23/29	Loss: 0.841
Batch: 25/29	Loss: 0.820
Batch: 27/29	Loss: 0.875
Batch: 29/29	Loss: 0.822
Epoch: 2	Train Loss: 0.854	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.185

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.812
Batch: 3/29	Loss: 0.830
Batch: 5/29	Loss: 0.819
Batch: 7/29	Loss: 0.848
Batch: 9/29	Loss: 0.802
Batch: 11/29	Loss: 0.802
Batch: 13/29	Loss: 0.839
Batch: 15/29	Loss: 0.809
Batch: 17/29	Loss: 0.824
Batch: 19/29	Loss: 0.818
Batch: 21/29	Loss: 0.797
Batch: 23/29	Loss: 0.790
Batch: 25/29	Loss: 0.808
Batch: 27/29	Loss: 0.782
Batch: 29/29	Loss: 0.793
Epoch: 3	Train Loss: 0.813	Val F1: 0.253
Best Epoch: 3	Best Val F1: 0.253

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.773
Batch: 3/29	Loss: 0.787
Batch: 5/29	Loss: 0.764
Batch: 7/29	Loss: 0.823
Batch: 9/29	Loss: 0.797
Batch: 11/29	Loss: 0.751
Batch: 13/29	Loss: 0.759
Batch: 15/29	Loss: 0.750
Batch: 17/29	Loss: 0.756
Batch: 19/29	Loss: 0.782
Batch: 21/29	Loss: 0.774
Batch: 23/29	Loss: 0.774
Batch: 25/29	Loss: 0.754
Batch: 27/29	Loss: 0.772
Batch: 29/29	Loss: 0.759
Epoch: 4	Train Loss: 0.776	Val F1: 0.255
Best Epoch: 4	Best Val F1: 0.255

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.735
Batch: 3/29	Loss: 0.735
Batch: 5/29	Loss: 0.704
Batch: 7/29	Loss: 0.738
Batch: 9/29	Loss: 0.694
Batch: 11/29	Loss: 0.751
Batch: 13/29	Loss: 0.688
Batch: 15/29	Loss: 0.729
Batch: 17/29	Loss: 0.765
Batch: 19/29	Loss: 0.748
Batch: 21/29	Loss: 0.705
Batch: 23/29	Loss: 0.721
Batch: 25/29	Loss: 0.749
Batch: 27/29	Loss: 0.699
Batch: 29/29	Loss: 0.733
Epoch: 5	Train Loss: 0.737	Val F1: 0.286
Best Epoch: 5	Best Val F1: 0.286

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.736
Batch: 3/29	Loss: 0.797
Batch: 5/29	Loss: 0.659
Batch: 7/29	Loss: 0.785
Batch: 9/29	Loss: 0.699
Batch: 11/29	Loss: 0.667
Batch: 13/29	Loss: 0.710
Batch: 15/29	Loss: 0.692
Batch: 17/29	Loss: 0.687
Batch: 19/29	Loss: 0.631
Batch: 21/29	Loss: 0.747
Batch: 23/29	Loss: 0.691
Batch: 25/29	Loss: 0.706
Batch: 27/29	Loss: 0.687
Batch: 29/29	Loss: 0.676
Epoch: 6	Train Loss: 0.708	Val F1: 0.320
Best Epoch: 6	Best Val F1: 0.320

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.657
Batch: 3/29	Loss: 0.724
Batch: 5/29	Loss: 0.746
Batch: 7/29	Loss: 0.697
Batch: 9/29	Loss: 0.697
Batch: 11/29	Loss: 0.600
Batch: 13/29	Loss: 0.671
Batch: 15/29	Loss: 0.600
Batch: 17/29	Loss: 0.690
Batch: 19/29	Loss: 0.690
Batch: 21/29	Loss: 0.622
Batch: 23/29	Loss: 0.641
Batch: 25/29	Loss: 0.597
Batch: 27/29	Loss: 0.673
Batch: 29/29	Loss: 0.662
Epoch: 7	Train Loss: 0.664	Val F1: 0.276
Best Epoch: 6	Best Val F1: 0.320

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.743
Batch: 3/29	Loss: 0.604
Batch: 5/29	Loss: 0.698
Batch: 7/29	Loss: 0.673
Batch: 9/29	Loss: 0.631
Batch: 11/29	Loss: 0.678
Batch: 13/29	Loss: 0.715
Batch: 15/29	Loss: 0.572
Batch: 17/29	Loss: 0.626
Batch: 19/29	Loss: 0.672
Batch: 21/29	Loss: 0.675
Batch: 23/29	Loss: 0.692
Batch: 25/29	Loss: 0.694
Batch: 27/29	Loss: 0.637
Batch: 29/29	Loss: 0.631
Epoch: 8	Train Loss: 0.649	Val F1: 0.340
Best Epoch: 8	Best Val F1: 0.340

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.659
Batch: 3/29	Loss: 0.579
Batch: 5/29	Loss: 0.605
Batch: 7/29	Loss: 0.572
Batch: 9/29	Loss: 0.667
Batch: 11/29	Loss: 0.627
Batch: 13/29	Loss: 0.641
Batch: 15/29	Loss: 0.561
Batch: 17/29	Loss: 0.577
Batch: 19/29	Loss: 0.496
Batch: 21/29	Loss: 0.664
Batch: 23/29	Loss: 0.561
Batch: 25/29	Loss: 0.573
Batch: 27/29	Loss: 0.616
Batch: 29/29	Loss: 0.549
Epoch: 9	Train Loss: 0.597	Val F1: 0.346
Best Epoch: 9	Best Val F1: 0.346

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.495
Batch: 3/29	Loss: 0.570
Batch: 5/29	Loss: 0.555
Batch: 7/29	Loss: 0.548
Batch: 9/29	Loss: 0.530
Batch: 11/29	Loss: 0.456
Batch: 13/29	Loss: 0.659
Batch: 15/29	Loss: 0.610
Batch: 17/29	Loss: 0.624
Batch: 19/29	Loss: 0.407
Batch: 21/29	Loss: 0.617
Batch: 23/29	Loss: 0.611
Batch: 25/29	Loss: 0.616
Batch: 27/29	Loss: 0.514
Batch: 29/29	Loss: 0.611
Epoch: 10	Train Loss: 0.556	Val F1: 0.355
Best Epoch: 10	Best Val F1: 0.355

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.525
Batch: 3/29	Loss: 0.473
Batch: 5/29	Loss: 0.652
Batch: 7/29	Loss: 0.509
Batch: 9/29	Loss: 0.465
Batch: 11/29	Loss: 0.511
Batch: 13/29	Loss: 0.484
Batch: 15/29	Loss: 0.406
Batch: 17/29	Loss: 0.584
Batch: 19/29	Loss: 0.500
Batch: 21/29	Loss: 0.497
Batch: 23/29	Loss: 0.415
Batch: 25/29	Loss: 0.412
Batch: 27/29	Loss: 0.445
Batch: 29/29	Loss: 0.510
Epoch: 11	Train Loss: 0.504	Val F1: 0.334
Best Epoch: 10	Best Val F1: 0.355

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.556
Batch: 3/29	Loss: 0.427
Batch: 5/29	Loss: 0.450
Batch: 7/29	Loss: 0.460
Batch: 9/29	Loss: 0.517
Batch: 11/29	Loss: 0.525
Batch: 13/29	Loss: 0.452
Batch: 15/29	Loss: 0.460
Batch: 17/29	Loss: 0.479
Batch: 19/29	Loss: 0.427
Batch: 21/29	Loss: 0.459
Batch: 23/29	Loss: 0.479
Batch: 25/29	Loss: 0.462
Batch: 27/29	Loss: 0.565
Batch: 29/29	Loss: 0.378
Epoch: 12	Train Loss: 0.469	Val F1: 0.332
Best Epoch: 10	Best Val F1: 0.355

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.491
Batch: 3/29	Loss: 0.363
Batch: 5/29	Loss: 0.511
Batch: 7/29	Loss: 0.431
Batch: 9/29	Loss: 0.465
Batch: 11/29	Loss: 0.452
Batch: 13/29	Loss: 0.439
Batch: 15/29	Loss: 0.450
Batch: 17/29	Loss: 0.394
Batch: 19/29	Loss: 0.316
Batch: 21/29	Loss: 0.396
Batch: 23/29	Loss: 0.434
Batch: 25/29	Loss: 0.338
Batch: 27/29	Loss: 0.498
Batch: 29/29	Loss: 0.522
Epoch: 13	Train Loss: 0.442	Val F1: 0.338
Best Epoch: 10	Best Val F1: 0.355

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.454
Batch: 3/29	Loss: 0.455
Batch: 5/29	Loss: 0.341
Batch: 7/29	Loss: 0.400
Batch: 9/29	Loss: 0.473
Batch: 11/29	Loss: 0.394
Batch: 13/29	Loss: 0.377
Batch: 15/29	Loss: 0.311
Batch: 17/29	Loss: 0.531
Batch: 19/29	Loss: 0.473
Batch: 21/29	Loss: 0.267
Batch: 23/29	Loss: 0.337
Batch: 25/29	Loss: 0.423
Batch: 27/29	Loss: 0.387
Batch: 29/29	Loss: 0.422
Epoch: 14	Train Loss: 0.409	Val F1: 0.338
Best Epoch: 10	Best Val F1: 0.355

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.356
Batch: 3/29	Loss: 0.393
Batch: 5/29	Loss: 0.271
Batch: 7/29	Loss: 0.361
Batch: 9/29	Loss: 0.413
Batch: 11/29	Loss: 0.370
Batch: 13/29	Loss: 0.360
Batch: 15/29	Loss: 0.363
Batch: 17/29	Loss: 0.439
Batch: 19/29	Loss: 0.351
Batch: 21/29	Loss: 0.388
Batch: 23/29	Loss: 0.432
Batch: 25/29	Loss: 0.430
Batch: 27/29	Loss: 0.344
Batch: 29/29	Loss: 0.442
Epoch: 15	Train Loss: 0.382	Val F1: 0.334
Best Epoch: 10	Best Val F1: 0.355

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.421
Batch: 3/29	Loss: 0.385
Batch: 5/29	Loss: 0.406
Batch: 7/29	Loss: 0.343
Batch: 9/29	Loss: 0.434
Batch: 11/29	Loss: 0.378
Batch: 13/29	Loss: 0.344
Batch: 15/29	Loss: 0.275
Batch: 17/29	Loss: 0.338
Batch: 19/29	Loss: 0.456
Batch: 21/29	Loss: 0.291
Batch: 23/29	Loss: 0.403
Batch: 25/29	Loss: 0.388
Batch: 27/29	Loss: 0.353
Batch: 29/29	Loss: 0.376
Epoch: 16	Train Loss: 0.381	Val F1: 0.346
Best Epoch: 10	Best Val F1: 0.355

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.366
Batch: 3/29	Loss: 0.444
Batch: 5/29	Loss: 0.366
Batch: 7/29	Loss: 0.340
Batch: 9/29	Loss: 0.274
Batch: 11/29	Loss: 0.416
Batch: 13/29	Loss: 0.427
Batch: 15/29	Loss: 0.393
Batch: 17/29	Loss: 0.391
Batch: 19/29	Loss: 0.341
Batch: 21/29	Loss: 0.389
Batch: 23/29	Loss: 0.441
Batch: 25/29	Loss: 0.220
Batch: 27/29	Loss: 0.375
Batch: 29/29	Loss: 0.371
Epoch: 17	Train Loss: 0.360	Val F1: 0.336
Best Epoch: 10	Best Val F1: 0.355

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.391
Batch: 3/29	Loss: 0.402
Batch: 5/29	Loss: 0.347
Batch: 7/29	Loss: 0.290
Batch: 9/29	Loss: 0.454
Batch: 11/29	Loss: 0.277
Batch: 13/29	Loss: 0.268
Batch: 15/29	Loss: 0.315
Batch: 17/29	Loss: 0.302
Batch: 19/29	Loss: 0.293
Batch: 21/29	Loss: 0.356
Batch: 23/29	Loss: 0.377
Batch: 25/29	Loss: 0.354
Batch: 27/29	Loss: 0.269
Batch: 29/29	Loss: 0.372
Epoch: 18	Train Loss: 0.341	Val F1: 0.333
Best Epoch: 10	Best Val F1: 0.355

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.231
Batch: 3/29	Loss: 0.259
Batch: 5/29	Loss: 0.348
Batch: 7/29	Loss: 0.342
Batch: 9/29	Loss: 0.248
Batch: 11/29	Loss: 0.362
Batch: 13/29	Loss: 0.415
Batch: 15/29	Loss: 0.308
Batch: 17/29	Loss: 0.271
Batch: 19/29	Loss: 0.388
Batch: 21/29	Loss: 0.324
Batch: 23/29	Loss: 0.334
Batch: 25/29	Loss: 0.341
Batch: 27/29	Loss: 0.272
Batch: 29/29	Loss: 0.291
Epoch: 19	Train Loss: 0.319	Val F1: 0.355
Best Epoch: 19	Best Val F1: 0.355

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.365
Batch: 3/29	Loss: 0.331
Batch: 5/29	Loss: 0.284
Batch: 7/29	Loss: 0.245
Batch: 9/29	Loss: 0.331
Batch: 11/29	Loss: 0.334
Batch: 13/29	Loss: 0.318
Batch: 15/29	Loss: 0.304
Batch: 17/29	Loss: 0.390
Batch: 19/29	Loss: 0.279
Batch: 21/29	Loss: 0.276
Batch: 23/29	Loss: 0.318
Batch: 25/29	Loss: 0.275
Batch: 27/29	Loss: 0.309
Batch: 29/29	Loss: 0.349
Epoch: 20	Train Loss: 0.309	Val F1: 0.348
Best Epoch: 19	Best Val F1: 0.355

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.269
Batch: 3/29	Loss: 0.261
Batch: 5/29	Loss: 0.282
Batch: 7/29	Loss: 0.494
Batch: 9/29	Loss: 0.245
Batch: 11/29	Loss: 0.231
Batch: 13/29	Loss: 0.349
Batch: 15/29	Loss: 0.324
Batch: 17/29	Loss: 0.255
Batch: 19/29	Loss: 0.273
Batch: 21/29	Loss: 0.259
Batch: 23/29	Loss: 0.251
Batch: 25/29	Loss: 0.284
Batch: 27/29	Loss: 0.282
Batch: 29/29	Loss: 0.340
Epoch: 21	Train Loss: 0.295	Val F1: 0.340
Best Epoch: 19	Best Val F1: 0.355

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.299
Batch: 3/29	Loss: 0.239
Batch: 5/29	Loss: 0.309
Batch: 7/29	Loss: 0.329
Batch: 9/29	Loss: 0.272
Batch: 11/29	Loss: 0.291
Batch: 13/29	Loss: 0.235
Batch: 15/29	Loss: 0.279
Batch: 17/29	Loss: 0.347
Batch: 19/29	Loss: 0.346
Batch: 21/29	Loss: 0.358
Batch: 23/29	Loss: 0.304
Batch: 25/29	Loss: 0.288
Batch: 27/29	Loss: 0.230
Batch: 29/29	Loss: 0.244
Epoch: 22	Train Loss: 0.283	Val F1: 0.352
Best Epoch: 19	Best Val F1: 0.355

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.279
Batch: 3/29	Loss: 0.290
Batch: 5/29	Loss: 0.322
Batch: 7/29	Loss: 0.359
Batch: 9/29	Loss: 0.223
Batch: 11/29	Loss: 0.282
Batch: 13/29	Loss: 0.232
Batch: 15/29	Loss: 0.289
Batch: 17/29	Loss: 0.248
Batch: 19/29	Loss: 0.282
Batch: 21/29	Loss: 0.280
Batch: 23/29	Loss: 0.216
Batch: 25/29	Loss: 0.276
Batch: 27/29	Loss: 0.182
Batch: 29/29	Loss: 0.212
Epoch: 23	Train Loss: 0.263	Val F1: 0.352
Best Epoch: 19	Best Val F1: 0.355

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.216
Batch: 3/29	Loss: 0.215
Batch: 5/29	Loss: 0.328
Batch: 7/29	Loss: 0.254
Batch: 9/29	Loss: 0.248
Batch: 11/29	Loss: 0.269
Batch: 13/29	Loss: 0.230
Batch: 15/29	Loss: 0.245
Batch: 17/29	Loss: 0.236
Batch: 19/29	Loss: 0.288
Batch: 21/29	Loss: 0.267
Batch: 23/29	Loss: 0.231
Batch: 25/29	Loss: 0.249
Batch: 27/29	Loss: 0.241
Batch: 29/29	Loss: 0.272
Epoch: 24	Train Loss: 0.248	Val F1: 0.383
Best Epoch: 24	Best Val F1: 0.383

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.253
Batch: 3/29	Loss: 0.241
Batch: 5/29	Loss: 0.259
Batch: 7/29	Loss: 0.235
Batch: 9/29	Loss: 0.319
Batch: 11/29	Loss: 0.207
Batch: 13/29	Loss: 0.294
Batch: 15/29	Loss: 0.243
Batch: 17/29	Loss: 0.277
Batch: 19/29	Loss: 0.187
Batch: 21/29	Loss: 0.223
Batch: 23/29	Loss: 0.258
Batch: 25/29	Loss: 0.243
Batch: 27/29	Loss: 0.238
Batch: 29/29	Loss: 0.190
Epoch: 25	Train Loss: 0.230	Val F1: 0.371
Best Epoch: 24	Best Val F1: 0.383

Saving the best checkpoint....
Inference...
Test F1: 0.381	Test F1_Few: 0.385	Test F1_Zero: 0.374
Starting training with config: {'batch_size': 64, 'epochs': 25, 'l2_reg': 0.0008073132861096558, 'lr': 2.7105925389110984e-05, 'n_layers_freeze': 1, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.057
Batch: 5/29	Loss: 1.010
Batch: 7/29	Loss: 0.984
Batch: 9/29	Loss: 0.954
Batch: 11/29	Loss: 0.944
Batch: 13/29	Loss: 0.931
Batch: 15/29	Loss: 0.941
Batch: 17/29	Loss: 0.895
Batch: 19/29	Loss: 0.897
Batch: 21/29	Loss: 0.872
Batch: 23/29	Loss: 0.884
Batch: 25/29	Loss: 0.845
Batch: 27/29	Loss: 0.845
Batch: 29/29	Loss: 0.855
Epoch: 1	Train Loss: 0.932	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.185

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.844
Batch: 3/29	Loss: 0.843
Batch: 5/29	Loss: 0.878
Batch: 7/29	Loss: 0.830
Batch: 9/29	Loss: 0.849
Batch: 11/29	Loss: 0.798
Batch: 13/29	Loss: 0.800
Batch: 15/29	Loss: 0.823
Batch: 17/29	Loss: 0.814
Batch: 19/29	Loss: 0.855
Batch: 21/29	Loss: 0.799
Batch: 23/29	Loss: 0.809
Batch: 25/29	Loss: 0.781
Batch: 27/29	Loss: 0.852
Batch: 29/29	Loss: 0.785
Epoch: 2	Train Loss: 0.819	Val F1: 0.191
Best Epoch: 2	Best Val F1: 0.191

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.772
Batch: 3/29	Loss: 0.799
Batch: 5/29	Loss: 0.782
Batch: 7/29	Loss: 0.822
Batch: 9/29	Loss: 0.762
Batch: 11/29	Loss: 0.762
Batch: 13/29	Loss: 0.812
Batch: 15/29	Loss: 0.772
Batch: 17/29	Loss: 0.786
Batch: 19/29	Loss: 0.777
Batch: 21/29	Loss: 0.749
Batch: 23/29	Loss: 0.755
Batch: 25/29	Loss: 0.771
Batch: 27/29	Loss: 0.750
Batch: 29/29	Loss: 0.761
Epoch: 3	Train Loss: 0.776	Val F1: 0.287
Best Epoch: 3	Best Val F1: 0.287

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.731
Batch: 3/29	Loss: 0.739
Batch: 5/29	Loss: 0.716
Batch: 7/29	Loss: 0.776
Batch: 9/29	Loss: 0.740
Batch: 11/29	Loss: 0.686
Batch: 13/29	Loss: 0.693
Batch: 15/29	Loss: 0.694
Batch: 17/29	Loss: 0.678
Batch: 19/29	Loss: 0.718
Batch: 21/29	Loss: 0.710
Batch: 23/29	Loss: 0.694
Batch: 25/29	Loss: 0.681
Batch: 27/29	Loss: 0.689
Batch: 29/29	Loss: 0.711
Epoch: 4	Train Loss: 0.717	Val F1: 0.311
Best Epoch: 4	Best Val F1: 0.311

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.664
Batch: 3/29	Loss: 0.656
Batch: 5/29	Loss: 0.625
Batch: 7/29	Loss: 0.643
Batch: 9/29	Loss: 0.617
Batch: 11/29	Loss: 0.668
Batch: 13/29	Loss: 0.663
Batch: 15/29	Loss: 0.676
Batch: 17/29	Loss: 0.692
Batch: 19/29	Loss: 0.665
Batch: 21/29	Loss: 0.624
Batch: 23/29	Loss: 0.696
Batch: 25/29	Loss: 0.660
Batch: 27/29	Loss: 0.643
Batch: 29/29	Loss: 0.674
Epoch: 5	Train Loss: 0.669	Val F1: 0.327
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.651
Batch: 3/29	Loss: 0.695
Batch: 5/29	Loss: 0.546
Batch: 7/29	Loss: 0.721
Batch: 9/29	Loss: 0.619
Batch: 11/29	Loss: 0.581
Batch: 13/29	Loss: 0.650
Batch: 15/29	Loss: 0.575
Batch: 17/29	Loss: 0.607
Batch: 19/29	Loss: 0.543
Batch: 21/29	Loss: 0.765
Batch: 23/29	Loss: 0.624
Batch: 25/29	Loss: 0.630
Batch: 27/29	Loss: 0.670
Batch: 29/29	Loss: 0.611
Epoch: 6	Train Loss: 0.633	Val F1: 0.302
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.608
Batch: 3/29	Loss: 0.634
Batch: 5/29	Loss: 0.672
Batch: 7/29	Loss: 0.642
Batch: 9/29	Loss: 0.616
Batch: 11/29	Loss: 0.502
Batch: 13/29	Loss: 0.562
Batch: 15/29	Loss: 0.520
Batch: 17/29	Loss: 0.633
Batch: 19/29	Loss: 0.614
Batch: 21/29	Loss: 0.547
Batch: 23/29	Loss: 0.531
Batch: 25/29	Loss: 0.490
Batch: 27/29	Loss: 0.542
Batch: 29/29	Loss: 0.557
Epoch: 7	Train Loss: 0.576	Val F1: 0.355
Best Epoch: 7	Best Val F1: 0.355

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.531
Batch: 3/29	Loss: 0.500
Batch: 5/29	Loss: 0.580
Batch: 7/29	Loss: 0.540
Batch: 9/29	Loss: 0.527
Batch: 11/29	Loss: 0.560
Batch: 13/29	Loss: 0.558
Batch: 15/29	Loss: 0.478
Batch: 17/29	Loss: 0.569
Batch: 19/29	Loss: 0.485
Batch: 21/29	Loss: 0.549
Batch: 23/29	Loss: 0.507
Batch: 25/29	Loss: 0.637
Batch: 27/29	Loss: 0.556
Batch: 29/29	Loss: 0.520
Epoch: 8	Train Loss: 0.530	Val F1: 0.360
Best Epoch: 8	Best Val F1: 0.360

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.565
Batch: 3/29	Loss: 0.524
Batch: 5/29	Loss: 0.527
Batch: 7/29	Loss: 0.377
Batch: 9/29	Loss: 0.520
Batch: 11/29	Loss: 0.477
Batch: 13/29	Loss: 0.433
Batch: 15/29	Loss: 0.392
Batch: 17/29	Loss: 0.440
Batch: 19/29	Loss: 0.393
Batch: 21/29	Loss: 0.537
Batch: 23/29	Loss: 0.447
Batch: 25/29	Loss: 0.418
Batch: 27/29	Loss: 0.472
Batch: 29/29	Loss: 0.375
Epoch: 9	Train Loss: 0.469	Val F1: 0.366
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.375
Batch: 3/29	Loss: 0.453
Batch: 5/29	Loss: 0.415
Batch: 7/29	Loss: 0.415
Batch: 9/29	Loss: 0.417
Batch: 11/29	Loss: 0.436
Batch: 13/29	Loss: 0.433
Batch: 15/29	Loss: 0.424
Batch: 17/29	Loss: 0.476
Batch: 19/29	Loss: 0.302
Batch: 21/29	Loss: 0.486
Batch: 23/29	Loss: 0.484
Batch: 25/29	Loss: 0.554
Batch: 27/29	Loss: 0.422
Batch: 29/29	Loss: 0.502
Epoch: 10	Train Loss: 0.425	Val F1: 0.357
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.422
Batch: 3/29	Loss: 0.362
Batch: 5/29	Loss: 0.532
Batch: 7/29	Loss: 0.410
Batch: 9/29	Loss: 0.367
Batch: 11/29	Loss: 0.397
Batch: 13/29	Loss: 0.391
Batch: 15/29	Loss: 0.327
Batch: 17/29	Loss: 0.439
Batch: 19/29	Loss: 0.426
Batch: 21/29	Loss: 0.365
Batch: 23/29	Loss: 0.303
Batch: 25/29	Loss: 0.368
Batch: 27/29	Loss: 0.348
Batch: 29/29	Loss: 0.395
Epoch: 11	Train Loss: 0.394	Val F1: 0.342
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.460
Batch: 3/29	Loss: 0.309
Batch: 5/29	Loss: 0.359
Batch: 7/29	Loss: 0.421
Batch: 9/29	Loss: 0.384
Batch: 11/29	Loss: 0.375
Batch: 13/29	Loss: 0.356
Batch: 15/29	Loss: 0.343
Batch: 17/29	Loss: 0.319
Batch: 19/29	Loss: 0.302
Batch: 21/29	Loss: 0.345
Batch: 23/29	Loss: 0.393
Batch: 25/29	Loss: 0.339
Batch: 27/29	Loss: 0.465
Batch: 29/29	Loss: 0.268
Epoch: 12	Train Loss: 0.357	Val F1: 0.352
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.389
Batch: 3/29	Loss: 0.277
Batch: 5/29	Loss: 0.334
Batch: 7/29	Loss: 0.293
Batch: 9/29	Loss: 0.354
Batch: 11/29	Loss: 0.356
Batch: 13/29	Loss: 0.335
Batch: 15/29	Loss: 0.309
Batch: 17/29	Loss: 0.281
Batch: 19/29	Loss: 0.192
Batch: 21/29	Loss: 0.293
Batch: 23/29	Loss: 0.338
Batch: 25/29	Loss: 0.247
Batch: 27/29	Loss: 0.377
Batch: 29/29	Loss: 0.363
Epoch: 13	Train Loss: 0.334	Val F1: 0.358
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.347
Batch: 3/29	Loss: 0.368
Batch: 5/29	Loss: 0.259
Batch: 7/29	Loss: 0.326
Batch: 9/29	Loss: 0.326
Batch: 11/29	Loss: 0.287
Batch: 13/29	Loss: 0.289
Batch: 15/29	Loss: 0.250
Batch: 17/29	Loss: 0.361
Batch: 19/29	Loss: 0.367
Batch: 21/29	Loss: 0.196
Batch: 23/29	Loss: 0.272
Batch: 25/29	Loss: 0.351
Batch: 27/29	Loss: 0.361
Batch: 29/29	Loss: 0.301
Epoch: 14	Train Loss: 0.315	Val F1: 0.362
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.310
Batch: 3/29	Loss: 0.354
Batch: 5/29	Loss: 0.192
Batch: 7/29	Loss: 0.299
Batch: 9/29	Loss: 0.360
Batch: 11/29	Loss: 0.275
Batch: 13/29	Loss: 0.305
Batch: 15/29	Loss: 0.313
Batch: 17/29	Loss: 0.325
Batch: 19/29	Loss: 0.303
Batch: 21/29	Loss: 0.339
Batch: 23/29	Loss: 0.295
Batch: 25/29	Loss: 0.340
Batch: 27/29	Loss: 0.300
Batch: 29/29	Loss: 0.327
Epoch: 15	Train Loss: 0.304	Val F1: 0.359
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.324
Batch: 3/29	Loss: 0.338
Batch: 5/29	Loss: 0.365
Batch: 7/29	Loss: 0.241
Batch: 9/29	Loss: 0.285
Batch: 11/29	Loss: 0.272
Batch: 13/29	Loss: 0.263
Batch: 15/29	Loss: 0.211
Batch: 17/29	Loss: 0.278
Batch: 19/29	Loss: 0.335
Batch: 21/29	Loss: 0.237
Batch: 23/29	Loss: 0.273
Batch: 25/29	Loss: 0.345
Batch: 27/29	Loss: 0.321
Batch: 29/29	Loss: 0.295
Epoch: 16	Train Loss: 0.287	Val F1: 0.347
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.371
Batch: 3/29	Loss: 0.320
Batch: 5/29	Loss: 0.293
Batch: 7/29	Loss: 0.269
Batch: 9/29	Loss: 0.182
Batch: 11/29	Loss: 0.282
Batch: 13/29	Loss: 0.338
Batch: 15/29	Loss: 0.331
Batch: 17/29	Loss: 0.331
Batch: 19/29	Loss: 0.258
Batch: 21/29	Loss: 0.297
Batch: 23/29	Loss: 0.376
Batch: 25/29	Loss: 0.163
Batch: 27/29	Loss: 0.223
Batch: 29/29	Loss: 0.297
Epoch: 17	Train Loss: 0.278	Val F1: 0.342
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.271
Batch: 3/29	Loss: 0.318
Batch: 5/29	Loss: 0.343
Batch: 7/29	Loss: 0.202
Batch: 9/29	Loss: 0.333
Batch: 11/29	Loss: 0.193
Batch: 13/29	Loss: 0.194
Batch: 15/29	Loss: 0.250
Batch: 17/29	Loss: 0.248
Batch: 19/29	Loss: 0.193
Batch: 21/29	Loss: 0.277
Batch: 23/29	Loss: 0.263
Batch: 25/29	Loss: 0.265
Batch: 27/29	Loss: 0.202
Batch: 29/29	Loss: 0.287
Epoch: 18	Train Loss: 0.250	Val F1: 0.362
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.161
Batch: 3/29	Loss: 0.194
Batch: 5/29	Loss: 0.293
Batch: 7/29	Loss: 0.278
Batch: 9/29	Loss: 0.210
Batch: 11/29	Loss: 0.273
Batch: 13/29	Loss: 0.272
Batch: 15/29	Loss: 0.232
Batch: 17/29	Loss: 0.190
Batch: 19/29	Loss: 0.301
Batch: 21/29	Loss: 0.207
Batch: 23/29	Loss: 0.227
Batch: 25/29	Loss: 0.269
Batch: 27/29	Loss: 0.162
Batch: 29/29	Loss: 0.269
Epoch: 19	Train Loss: 0.230	Val F1: 0.349
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.269
Batch: 3/29	Loss: 0.252
Batch: 5/29	Loss: 0.198
Batch: 7/29	Loss: 0.211
Batch: 9/29	Loss: 0.205
Batch: 11/29	Loss: 0.245
Batch: 13/29	Loss: 0.243
Batch: 15/29	Loss: 0.224
Batch: 17/29	Loss: 0.305
Batch: 19/29	Loss: 0.179
Batch: 21/29	Loss: 0.176
Batch: 23/29	Loss: 0.220
Batch: 25/29	Loss: 0.156
Batch: 27/29	Loss: 0.190
Batch: 29/29	Loss: 0.239
Epoch: 20	Train Loss: 0.219	Val F1: 0.365
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.156
Batch: 3/29	Loss: 0.172
Batch: 5/29	Loss: 0.224
Batch: 7/29	Loss: 0.304
Batch: 9/29	Loss: 0.146
Batch: 11/29	Loss: 0.106
Batch: 13/29	Loss: 0.227
Batch: 15/29	Loss: 0.222
Batch: 17/29	Loss: 0.127
Batch: 19/29	Loss: 0.191
Batch: 21/29	Loss: 0.205
Batch: 23/29	Loss: 0.241
Batch: 25/29	Loss: 0.197
Batch: 27/29	Loss: 0.166
Batch: 29/29	Loss: 0.221
Epoch: 21	Train Loss: 0.186	Val F1: 0.350
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.198
Batch: 3/29	Loss: 0.136
Batch: 5/29	Loss: 0.157
Batch: 7/29	Loss: 0.221
Batch: 9/29	Loss: 0.154
Batch: 11/29	Loss: 0.188
Batch: 13/29	Loss: 0.160
Batch: 15/29	Loss: 0.138
Batch: 17/29	Loss: 0.178
Batch: 19/29	Loss: 0.190
Batch: 21/29	Loss: 0.231
Batch: 23/29	Loss: 0.156
Batch: 25/29	Loss: 0.141
Batch: 27/29	Loss: 0.098
Batch: 29/29	Loss: 0.142
Epoch: 22	Train Loss: 0.170	Val F1: 0.350
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.156
Batch: 3/29	Loss: 0.122
Batch: 5/29	Loss: 0.168
Batch: 7/29	Loss: 0.131
Batch: 9/29	Loss: 0.115
Batch: 11/29	Loss: 0.138
Batch: 13/29	Loss: 0.128
Batch: 15/29	Loss: 0.125
Batch: 17/29	Loss: 0.262
Batch: 19/29	Loss: 0.140
Batch: 21/29	Loss: 0.142
Batch: 23/29	Loss: 0.111
Batch: 25/29	Loss: 0.134
Batch: 27/29	Loss: 0.127
Batch: 29/29	Loss: 0.100
Epoch: 23	Train Loss: 0.139	Val F1: 0.344
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.108
Batch: 3/29	Loss: 0.071
Batch: 5/29	Loss: 0.149
Batch: 7/29	Loss: 0.091
Batch: 9/29	Loss: 0.194
Batch: 11/29	Loss: 0.198
Batch: 13/29	Loss: 0.111
Batch: 15/29	Loss: 0.191
Batch: 17/29	Loss: 0.141
Batch: 19/29	Loss: 0.122
Batch: 21/29	Loss: 0.118
Batch: 23/29	Loss: 0.085
Batch: 25/29	Loss: 0.109
Batch: 27/29	Loss: 0.073
Batch: 29/29	Loss: 0.159
Epoch: 24	Train Loss: 0.124	Val F1: 0.357
Best Epoch: 9	Best Val F1: 0.366

Saving the best checkpoint....
Inference...
Test F1: 0.368	Test F1_Few: 0.435	Test F1_Zero: 0.368
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0007370122940955247, 'lr': 9.69772293905636e-06, 'n_layers_freeze': 4, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.084
Batch: 5/29	Loss: 1.070
Batch: 7/29	Loss: 1.057
Batch: 9/29	Loss: 1.045
Batch: 11/29	Loss: 1.031
Batch: 13/29	Loss: 1.020
Batch: 15/29	Loss: 1.018
Batch: 17/29	Loss: 0.987
Batch: 19/29	Loss: 0.980
Batch: 21/29	Loss: 0.965
Batch: 23/29	Loss: 0.960
Batch: 25/29	Loss: 0.940
Batch: 27/29	Loss: 0.930
Batch: 29/29	Loss: 0.934
Epoch: 1	Train Loss: 1.007	Val F1: 0.193
Best Epoch: 1	Best Val F1: 0.193

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.924
Batch: 3/29	Loss: 0.921
Batch: 5/29	Loss: 0.937
Batch: 7/29	Loss: 0.909
Batch: 9/29	Loss: 0.916
Batch: 11/29	Loss: 0.884
Batch: 13/29	Loss: 0.881
Batch: 15/29	Loss: 0.899
Batch: 17/29	Loss: 0.887
Batch: 19/29	Loss: 0.906
Batch: 21/29	Loss: 0.874
Batch: 23/29	Loss: 0.878
Batch: 25/29	Loss: 0.861
Batch: 27/29	Loss: 0.902
Batch: 29/29	Loss: 0.862
Epoch: 2	Train Loss: 0.893	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.193

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.854
Batch: 3/29	Loss: 0.865
Batch: 5/29	Loss: 0.859
Batch: 7/29	Loss: 0.878
Batch: 9/29	Loss: 0.844
Batch: 11/29	Loss: 0.843
Batch: 13/29	Loss: 0.873
Batch: 15/29	Loss: 0.844
Batch: 17/29	Loss: 0.858
Batch: 19/29	Loss: 0.854
Batch: 21/29	Loss: 0.838
Batch: 23/29	Loss: 0.833
Batch: 25/29	Loss: 0.846
Batch: 27/29	Loss: 0.825
Batch: 29/29	Loss: 0.832
Epoch: 3	Train Loss: 0.850	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.193

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.820
Batch: 3/29	Loss: 0.834
Batch: 5/29	Loss: 0.813
Batch: 7/29	Loss: 0.852
Batch: 9/29	Loss: 0.839
Batch: 11/29	Loss: 0.807
Batch: 13/29	Loss: 0.815
Batch: 15/29	Loss: 0.802
Batch: 17/29	Loss: 0.812
Batch: 19/29	Loss: 0.828
Batch: 21/29	Loss: 0.837
Batch: 23/29	Loss: 0.838
Batch: 25/29	Loss: 0.826
Batch: 27/29	Loss: 0.838
Batch: 29/29	Loss: 0.823
Epoch: 4	Train Loss: 0.825	Val F1: 0.213
Best Epoch: 4	Best Val F1: 0.213

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.808
Batch: 3/29	Loss: 0.802
Batch: 5/29	Loss: 0.792
Batch: 7/29	Loss: 0.790
Batch: 9/29	Loss: 0.787
Batch: 11/29	Loss: 0.793
Batch: 13/29	Loss: 0.783
Batch: 15/29	Loss: 0.810
Batch: 17/29	Loss: 0.832
Batch: 19/29	Loss: 0.794
Batch: 21/29	Loss: 0.775
Batch: 23/29	Loss: 0.802
Batch: 25/29	Loss: 0.806
Batch: 27/29	Loss: 0.772
Batch: 29/29	Loss: 0.784
Epoch: 5	Train Loss: 0.802	Val F1: 0.303
Best Epoch: 5	Best Val F1: 0.303

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.781
Batch: 3/29	Loss: 0.824
Batch: 5/29	Loss: 0.753
Batch: 7/29	Loss: 0.818
Batch: 9/29	Loss: 0.775
Batch: 11/29	Loss: 0.774
Batch: 13/29	Loss: 0.764
Batch: 15/29	Loss: 0.729
Batch: 17/29	Loss: 0.751
Batch: 19/29	Loss: 0.725
Batch: 21/29	Loss: 0.784
Batch: 23/29	Loss: 0.734
Batch: 25/29	Loss: 0.759
Batch: 27/29	Loss: 0.757
Batch: 29/29	Loss: 0.739
Epoch: 6	Train Loss: 0.767	Val F1: 0.311
Best Epoch: 6	Best Val F1: 0.311

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.735
Batch: 3/29	Loss: 0.787
Batch: 5/29	Loss: 0.795
Batch: 7/29	Loss: 0.731
Batch: 9/29	Loss: 0.764
Batch: 11/29	Loss: 0.713
Batch: 13/29	Loss: 0.731
Batch: 15/29	Loss: 0.705
Batch: 17/29	Loss: 0.755
Batch: 19/29	Loss: 0.758
Batch: 21/29	Loss: 0.699
Batch: 23/29	Loss: 0.683
Batch: 25/29	Loss: 0.667
Batch: 27/29	Loss: 0.707
Batch: 29/29	Loss: 0.699
Epoch: 7	Train Loss: 0.729	Val F1: 0.338
Best Epoch: 7	Best Val F1: 0.338

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.696
Batch: 3/29	Loss: 0.667
Batch: 5/29	Loss: 0.707
Batch: 7/29	Loss: 0.687
Batch: 9/29	Loss: 0.687
Batch: 11/29	Loss: 0.721
Batch: 13/29	Loss: 0.730
Batch: 15/29	Loss: 0.660
Batch: 17/29	Loss: 0.731
Batch: 19/29	Loss: 0.710
Batch: 21/29	Loss: 0.711
Batch: 23/29	Loss: 0.728
Batch: 25/29	Loss: 0.740
Batch: 27/29	Loss: 0.704
Batch: 29/29	Loss: 0.675
Epoch: 8	Train Loss: 0.695	Val F1: 0.340
Best Epoch: 8	Best Val F1: 0.340

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.701
Batch: 3/29	Loss: 0.642
Batch: 5/29	Loss: 0.658
Batch: 7/29	Loss: 0.628
Batch: 9/29	Loss: 0.718
Batch: 11/29	Loss: 0.663
Batch: 13/29	Loss: 0.694
Batch: 15/29	Loss: 0.694
Batch: 17/29	Loss: 0.642
Batch: 19/29	Loss: 0.660
Batch: 21/29	Loss: 0.695
Batch: 23/29	Loss: 0.621
Batch: 25/29	Loss: 0.627
Batch: 27/29	Loss: 0.664
Batch: 29/29	Loss: 0.594
Epoch: 9	Train Loss: 0.661	Val F1: 0.340
Best Epoch: 8	Best Val F1: 0.340

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.586
Batch: 3/29	Loss: 0.645
Batch: 5/29	Loss: 0.644
Batch: 7/29	Loss: 0.628
Batch: 9/29	Loss: 0.587
Batch: 11/29	Loss: 0.548
Batch: 13/29	Loss: 0.693
Batch: 15/29	Loss: 0.711
Batch: 17/29	Loss: 0.712
Batch: 19/29	Loss: 0.488
Batch: 21/29	Loss: 0.664
Batch: 23/29	Loss: 0.628
Batch: 25/29	Loss: 0.636
Batch: 27/29	Loss: 0.595
Batch: 29/29	Loss: 0.685
Epoch: 10	Train Loss: 0.627	Val F1: 0.345
Best Epoch: 10	Best Val F1: 0.345

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.609
Batch: 3/29	Loss: 0.540
Batch: 5/29	Loss: 0.692
Batch: 7/29	Loss: 0.617
Batch: 9/29	Loss: 0.603
Batch: 11/29	Loss: 0.619
Batch: 13/29	Loss: 0.552
Batch: 15/29	Loss: 0.487
Batch: 17/29	Loss: 0.648
Batch: 19/29	Loss: 0.611
Batch: 21/29	Loss: 0.554
Batch: 23/29	Loss: 0.517
Batch: 25/29	Loss: 0.525
Batch: 27/29	Loss: 0.578
Batch: 29/29	Loss: 0.549
Epoch: 11	Train Loss: 0.597	Val F1: 0.329
Best Epoch: 10	Best Val F1: 0.345

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.748
Batch: 3/29	Loss: 0.521
Batch: 5/29	Loss: 0.659
Batch: 7/29	Loss: 0.559
Batch: 9/29	Loss: 0.612
Batch: 11/29	Loss: 0.559
Batch: 13/29	Loss: 0.556
Batch: 15/29	Loss: 0.533
Batch: 17/29	Loss: 0.610
Batch: 19/29	Loss: 0.555
Batch: 21/29	Loss: 0.603
Batch: 23/29	Loss: 0.557
Batch: 25/29	Loss: 0.546
Batch: 27/29	Loss: 0.608
Batch: 29/29	Loss: 0.477
Epoch: 12	Train Loss: 0.576	Val F1: 0.345
Best Epoch: 10	Best Val F1: 0.345

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.592
Batch: 3/29	Loss: 0.466
Batch: 5/29	Loss: 0.549
Batch: 7/29	Loss: 0.478
Batch: 9/29	Loss: 0.550
Batch: 11/29	Loss: 0.573
Batch: 13/29	Loss: 0.587
Batch: 15/29	Loss: 0.538
Batch: 17/29	Loss: 0.496
Batch: 19/29	Loss: 0.439
Batch: 21/29	Loss: 0.499
Batch: 23/29	Loss: 0.592
Batch: 25/29	Loss: 0.398
Batch: 27/29	Loss: 0.539
Batch: 29/29	Loss: 0.655
Epoch: 13	Train Loss: 0.542	Val F1: 0.338
Best Epoch: 10	Best Val F1: 0.345

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.543
Batch: 3/29	Loss: 0.581
Batch: 5/29	Loss: 0.408
Batch: 7/29	Loss: 0.549
Batch: 9/29	Loss: 0.525
Batch: 11/29	Loss: 0.556
Batch: 13/29	Loss: 0.486
Batch: 15/29	Loss: 0.447
Batch: 17/29	Loss: 0.614
Batch: 19/29	Loss: 0.565
Batch: 21/29	Loss: 0.413
Batch: 23/29	Loss: 0.433
Batch: 25/29	Loss: 0.519
Batch: 27/29	Loss: 0.588
Batch: 29/29	Loss: 0.499
Epoch: 14	Train Loss: 0.524	Val F1: 0.329
Best Epoch: 10	Best Val F1: 0.345

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.506
Batch: 3/29	Loss: 0.477
Batch: 5/29	Loss: 0.529
Batch: 7/29	Loss: 0.436
Batch: 9/29	Loss: 0.579
Batch: 11/29	Loss: 0.497
Batch: 13/29	Loss: 0.524
Batch: 15/29	Loss: 0.552
Batch: 17/29	Loss: 0.515
Batch: 19/29	Loss: 0.443
Batch: 21/29	Loss: 0.450
Batch: 23/29	Loss: 0.551
Batch: 25/29	Loss: 0.489
Batch: 27/29	Loss: 0.455
Batch: 29/29	Loss: 0.575
Epoch: 15	Train Loss: 0.506	Val F1: 0.340
Best Epoch: 10	Best Val F1: 0.345

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.496
Batch: 3/29	Loss: 0.486
Batch: 5/29	Loss: 0.505
Batch: 7/29	Loss: 0.415
Batch: 9/29	Loss: 0.496
Batch: 11/29	Loss: 0.450
Batch: 13/29	Loss: 0.409
Batch: 15/29	Loss: 0.495
Batch: 17/29	Loss: 0.461
Batch: 19/29	Loss: 0.572
Batch: 21/29	Loss: 0.392
Batch: 23/29	Loss: 0.480
Batch: 25/29	Loss: 0.472
Batch: 27/29	Loss: 0.450
Batch: 29/29	Loss: 0.507
Epoch: 16	Train Loss: 0.476	Val F1: 0.352
Best Epoch: 16	Best Val F1: 0.352

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.421
Batch: 3/29	Loss: 0.518
Batch: 5/29	Loss: 0.515
Batch: 7/29	Loss: 0.428
Batch: 9/29	Loss: 0.415
Batch: 11/29	Loss: 0.479
Batch: 13/29	Loss: 0.502
Batch: 15/29	Loss: 0.484
Batch: 17/29	Loss: 0.477
Batch: 19/29	Loss: 0.416
Batch: 21/29	Loss: 0.458
Batch: 23/29	Loss: 0.534
Batch: 25/29	Loss: 0.313
Batch: 27/29	Loss: 0.426
Batch: 29/29	Loss: 0.473
Epoch: 17	Train Loss: 0.457	Val F1: 0.344
Best Epoch: 16	Best Val F1: 0.352

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.499
Batch: 3/29	Loss: 0.489
Batch: 5/29	Loss: 0.445
Batch: 7/29	Loss: 0.405
Batch: 9/29	Loss: 0.499
Batch: 11/29	Loss: 0.397
Batch: 13/29	Loss: 0.357
Batch: 15/29	Loss: 0.451
Batch: 17/29	Loss: 0.478
Batch: 19/29	Loss: 0.377
Batch: 21/29	Loss: 0.435
Batch: 23/29	Loss: 0.431
Batch: 25/29	Loss: 0.463
Batch: 27/29	Loss: 0.353
Batch: 29/29	Loss: 0.485
Epoch: 18	Train Loss: 0.433	Val F1: 0.356
Best Epoch: 18	Best Val F1: 0.356

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.297
Batch: 3/29	Loss: 0.306
Batch: 5/29	Loss: 0.429
Batch: 7/29	Loss: 0.476
Batch: 9/29	Loss: 0.340
Batch: 11/29	Loss: 0.506
Batch: 13/29	Loss: 0.481
Batch: 15/29	Loss: 0.438
Batch: 17/29	Loss: 0.390
Batch: 19/29	Loss: 0.468
Batch: 21/29	Loss: 0.445
Batch: 23/29	Loss: 0.417
Batch: 25/29	Loss: 0.495
Batch: 27/29	Loss: 0.386
Batch: 29/29	Loss: 0.374
Epoch: 19	Train Loss: 0.422	Val F1: 0.333
Best Epoch: 18	Best Val F1: 0.356

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.512
Batch: 3/29	Loss: 0.452
Batch: 5/29	Loss: 0.405
Batch: 7/29	Loss: 0.339
Batch: 9/29	Loss: 0.446
Batch: 11/29	Loss: 0.393
Batch: 13/29	Loss: 0.428
Batch: 15/29	Loss: 0.422
Batch: 17/29	Loss: 0.532
Batch: 19/29	Loss: 0.347
Batch: 21/29	Loss: 0.472
Batch: 23/29	Loss: 0.407
Batch: 25/29	Loss: 0.412
Batch: 27/29	Loss: 0.437
Batch: 29/29	Loss: 0.464
Epoch: 20	Train Loss: 0.420	Val F1: 0.341
Best Epoch: 18	Best Val F1: 0.356

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.376
Batch: 3/29	Loss: 0.370
Batch: 5/29	Loss: 0.362
Batch: 7/29	Loss: 0.597
Batch: 9/29	Loss: 0.340
Batch: 11/29	Loss: 0.310
Batch: 13/29	Loss: 0.446
Batch: 15/29	Loss: 0.515
Batch: 17/29	Loss: 0.358
Batch: 19/29	Loss: 0.395
Batch: 21/29	Loss: 0.374
Batch: 23/29	Loss: 0.357
Batch: 25/29	Loss: 0.374
Batch: 27/29	Loss: 0.358
Batch: 29/29	Loss: 0.465
Epoch: 21	Train Loss: 0.397	Val F1: 0.340
Best Epoch: 18	Best Val F1: 0.356

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.378
Batch: 3/29	Loss: 0.351
Batch: 5/29	Loss: 0.439
Batch: 7/29	Loss: 0.419
Batch: 9/29	Loss: 0.350
Batch: 11/29	Loss: 0.353
Batch: 13/29	Loss: 0.299
Batch: 15/29	Loss: 0.473
Batch: 17/29	Loss: 0.438
Batch: 19/29	Loss: 0.406
Batch: 21/29	Loss: 0.494
Batch: 23/29	Loss: 0.407
Batch: 25/29	Loss: 0.390
Batch: 27/29	Loss: 0.348
Batch: 29/29	Loss: 0.345
Epoch: 22	Train Loss: 0.390	Val F1: 0.342
Best Epoch: 18	Best Val F1: 0.356

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.378
Batch: 3/29	Loss: 0.414
Batch: 5/29	Loss: 0.404
Batch: 7/29	Loss: 0.519
Batch: 9/29	Loss: 0.350
Batch: 11/29	Loss: 0.460
Batch: 13/29	Loss: 0.325
Batch: 15/29	Loss: 0.364
Batch: 17/29	Loss: 0.397
Batch: 19/29	Loss: 0.385
Batch: 21/29	Loss: 0.350
Batch: 23/29	Loss: 0.326
Batch: 25/29	Loss: 0.390
Batch: 27/29	Loss: 0.308
Batch: 29/29	Loss: 0.316
Epoch: 23	Train Loss: 0.382	Val F1: 0.336
Best Epoch: 18	Best Val F1: 0.356

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.321
Batch: 3/29	Loss: 0.358
Batch: 5/29	Loss: 0.407
Batch: 7/29	Loss: 0.405
Batch: 9/29	Loss: 0.437
Batch: 11/29	Loss: 0.538
Batch: 13/29	Loss: 0.369
Batch: 15/29	Loss: 0.361
Batch: 17/29	Loss: 0.348
Batch: 19/29	Loss: 0.402
Batch: 21/29	Loss: 0.388
Batch: 23/29	Loss: 0.333
Batch: 25/29	Loss: 0.375
Batch: 27/29	Loss: 0.356
Batch: 29/29	Loss: 0.347
Epoch: 24	Train Loss: 0.373	Val F1: 0.339
Best Epoch: 18	Best Val F1: 0.356

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.445
Batch: 3/29	Loss: 0.438
Batch: 5/29	Loss: 0.410
Batch: 7/29	Loss: 0.401
Batch: 9/29	Loss: 0.488
Batch: 11/29	Loss: 0.378
Batch: 13/29	Loss: 0.413
Batch: 15/29	Loss: 0.379
Batch: 17/29	Loss: 0.381
Batch: 19/29	Loss: 0.308
Batch: 21/29	Loss: 0.428
Batch: 23/29	Loss: 0.361
Batch: 25/29	Loss: 0.387
Batch: 27/29	Loss: 0.352
Batch: 29/29	Loss: 0.375
Epoch: 25	Train Loss: 0.379	Val F1: 0.338
Best Epoch: 18	Best Val F1: 0.356

****************************** Epoch: 26 ******************************
Batch: 1/29	Loss: 0.303
Batch: 3/29	Loss: 0.328
Batch: 5/29	Loss: 0.421
Batch: 7/29	Loss: 0.434
Batch: 9/29	Loss: 0.383
Batch: 11/29	Loss: 0.404
Batch: 13/29	Loss: 0.377
Batch: 15/29	Loss: 0.380
Batch: 17/29	Loss: 0.346
Batch: 19/29	Loss: 0.422
Batch: 21/29	Loss: 0.394
Batch: 23/29	Loss: 0.225
Batch: 25/29	Loss: 0.381
Batch: 27/29	Loss: 0.342
Batch: 29/29	Loss: 0.377
Epoch: 26	Train Loss: 0.359	Val F1: 0.335
Best Epoch: 18	Best Val F1: 0.356

****************************** Epoch: 27 ******************************
Batch: 1/29	Loss: 0.295
Batch: 3/29	Loss: 0.362
Batch: 5/29	Loss: 0.532
Batch: 7/29	Loss: 0.244
Batch: 9/29	Loss: 0.463
Batch: 11/29	Loss: 0.291
Batch: 13/29	Loss: 0.521
Batch: 15/29	Loss: 0.446
Batch: 17/29	Loss: 0.327
Batch: 19/29	Loss: 0.328
Batch: 21/29	Loss: 0.382
Batch: 23/29	Loss: 0.295
Batch: 25/29	Loss: 0.328
Batch: 27/29	Loss: 0.347
Batch: 29/29	Loss: 0.362
Epoch: 27	Train Loss: 0.356	Val F1: 0.345
Best Epoch: 18	Best Val F1: 0.356

****************************** Epoch: 28 ******************************
Batch: 1/29	Loss: 0.297
Batch: 3/29	Loss: 0.321
Batch: 5/29	Loss: 0.365
Batch: 7/29	Loss: 0.384
Batch: 9/29	Loss: 0.394
Batch: 11/29	Loss: 0.353
Batch: 13/29	Loss: 0.320
Batch: 15/29	Loss: 0.377
Batch: 17/29	Loss: 0.361
Batch: 19/29	Loss: 0.262
Batch: 21/29	Loss: 0.330
Batch: 23/29	Loss: 0.367
Batch: 25/29	Loss: 0.386
Batch: 27/29	Loss: 0.264
Batch: 29/29	Loss: 0.321
Epoch: 28	Train Loss: 0.340	Val F1: 0.333
Best Epoch: 18	Best Val F1: 0.356

****************************** Epoch: 29 ******************************
Batch: 1/29	Loss: 0.395
Batch: 3/29	Loss: 0.357
Batch: 5/29	Loss: 0.303
Batch: 7/29	Loss: 0.300
Batch: 9/29	Loss: 0.290
Batch: 11/29	Loss: 0.421
Batch: 13/29	Loss: 0.438
Batch: 15/29	Loss: 0.227
Batch: 17/29	Loss: 0.419
Batch: 19/29	Loss: 0.265
Batch: 21/29	Loss: 0.381
Batch: 23/29	Loss: 0.336
Batch: 25/29	Loss: 0.356
Batch: 27/29	Loss: 0.313
Batch: 29/29	Loss: 0.347
Epoch: 29	Train Loss: 0.334	Val F1: 0.331
Best Epoch: 18	Best Val F1: 0.356

****************************** Epoch: 30 ******************************
Batch: 1/29	Loss: 0.289
Batch: 3/29	Loss: 0.278
Batch: 5/29	Loss: 0.394
Batch: 7/29	Loss: 0.311
Batch: 9/29	Loss: 0.341
Batch: 11/29	Loss: 0.306
Batch: 13/29	Loss: 0.343
Batch: 15/29	Loss: 0.299
Batch: 17/29	Loss: 0.310
Batch: 19/29	Loss: 0.304
Batch: 21/29	Loss: 0.354
Batch: 23/29	Loss: 0.395
Batch: 25/29	Loss: 0.326
Batch: 27/29	Loss: 0.297
Batch: 29/29	Loss: 0.315
Epoch: 30	Train Loss: 0.329	Val F1: 0.335
Best Epoch: 18	Best Val F1: 0.356

****************************** Epoch: 31 ******************************
Batch: 1/29	Loss: 0.294
Batch: 3/29	Loss: 0.257
Batch: 5/29	Loss: 0.313
Batch: 7/29	Loss: 0.280
Batch: 9/29	Loss: 0.313
Batch: 11/29	Loss: 0.357
Batch: 13/29	Loss: 0.347
Batch: 15/29	Loss: 0.305
Batch: 17/29	Loss: 0.357
Batch: 19/29	Loss: 0.314
Batch: 21/29	Loss: 0.328
Batch: 23/29	Loss: 0.319
Batch: 25/29	Loss: 0.365
Batch: 27/29	Loss: 0.296
Batch: 29/29	Loss: 0.271
Epoch: 31	Train Loss: 0.328	Val F1: 0.333
Best Epoch: 18	Best Val F1: 0.356

****************************** Epoch: 32 ******************************
Batch: 1/29	Loss: 0.432
Batch: 3/29	Loss: 0.354
Batch: 5/29	Loss: 0.281
Batch: 7/29	Loss: 0.288
Batch: 9/29	Loss: 0.289
Batch: 11/29	Loss: 0.317
Batch: 13/29	Loss: 0.335
Batch: 15/29	Loss: 0.203
Batch: 17/29	Loss: 0.350
Batch: 19/29	Loss: 0.380
Batch: 21/29	Loss: 0.286
Batch: 23/29	Loss: 0.348
Batch: 25/29	Loss: 0.343
Batch: 27/29	Loss: 0.195
Batch: 29/29	Loss: 0.394
Epoch: 32	Train Loss: 0.318	Val F1: 0.334
Best Epoch: 18	Best Val F1: 0.356

****************************** Epoch: 33 ******************************
Batch: 1/29	Loss: 0.337
Batch: 3/29	Loss: 0.316
Batch: 5/29	Loss: 0.362
Batch: 7/29	Loss: 0.326
Batch: 9/29	Loss: 0.373
Batch: 11/29	Loss: 0.244
Batch: 13/29	Loss: 0.340
Batch: 15/29	Loss: 0.329
Batch: 17/29	Loss: 0.342
Batch: 19/29	Loss: 0.304
Batch: 21/29	Loss: 0.263
Batch: 23/29	Loss: 0.301
Batch: 25/29	Loss: 0.347
Batch: 27/29	Loss: 0.341
Batch: 29/29	Loss: 0.326
Epoch: 33	Train Loss: 0.310	Val F1: 0.336
Best Epoch: 18	Best Val F1: 0.356

Saving the best checkpoint....
Inference...
Test F1: 0.380	Test F1_Few: 0.450	Test F1_Zero: 0.378
Starting training with config: {'batch_size': 64, 'epochs': 25, 'l2_reg': 0.0007003946840813291, 'lr': 2.8439765836815137e-05, 'n_layers_freeze': 2, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.056
Batch: 5/29	Loss: 1.010
Batch: 7/29	Loss: 0.983
Batch: 9/29	Loss: 0.952
Batch: 11/29	Loss: 0.943
Batch: 13/29	Loss: 0.929
Batch: 15/29	Loss: 0.940
Batch: 17/29	Loss: 0.892
Batch: 19/29	Loss: 0.893
Batch: 21/29	Loss: 0.869
Batch: 23/29	Loss: 0.882
Batch: 25/29	Loss: 0.842
Batch: 27/29	Loss: 0.841
Batch: 29/29	Loss: 0.851
Epoch: 1	Train Loss: 0.930	Val F1: 0.210
Best Epoch: 1	Best Val F1: 0.210

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.842
Batch: 3/29	Loss: 0.840
Batch: 5/29	Loss: 0.876
Batch: 7/29	Loss: 0.826
Batch: 9/29	Loss: 0.846
Batch: 11/29	Loss: 0.794
Batch: 13/29	Loss: 0.796
Batch: 15/29	Loss: 0.821
Batch: 17/29	Loss: 0.811
Batch: 19/29	Loss: 0.853
Batch: 21/29	Loss: 0.796
Batch: 23/29	Loss: 0.807
Batch: 25/29	Loss: 0.778
Batch: 27/29	Loss: 0.850
Batch: 29/29	Loss: 0.783
Epoch: 2	Train Loss: 0.816	Val F1: 0.190
Best Epoch: 1	Best Val F1: 0.210

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.770
Batch: 3/29	Loss: 0.798
Batch: 5/29	Loss: 0.781
Batch: 7/29	Loss: 0.820
Batch: 9/29	Loss: 0.761
Batch: 11/29	Loss: 0.762
Batch: 13/29	Loss: 0.811
Batch: 15/29	Loss: 0.778
Batch: 17/29	Loss: 0.798
Batch: 19/29	Loss: 0.786
Batch: 21/29	Loss: 0.761
Batch: 23/29	Loss: 0.750
Batch: 25/29	Loss: 0.778
Batch: 27/29	Loss: 0.743
Batch: 29/29	Loss: 0.760
Epoch: 3	Train Loss: 0.780	Val F1: 0.290
Best Epoch: 3	Best Val F1: 0.290

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.731
Batch: 3/29	Loss: 0.752
Batch: 5/29	Loss: 0.720
Batch: 7/29	Loss: 0.791
Batch: 9/29	Loss: 0.763
Batch: 11/29	Loss: 0.681
Batch: 13/29	Loss: 0.710
Batch: 15/29	Loss: 0.690
Batch: 17/29	Loss: 0.704
Batch: 19/29	Loss: 0.749
Batch: 21/29	Loss: 0.725
Batch: 23/29	Loss: 0.717
Batch: 25/29	Loss: 0.718
Batch: 27/29	Loss: 0.743
Batch: 29/29	Loss: 0.703
Epoch: 4	Train Loss: 0.728	Val F1: 0.321
Best Epoch: 4	Best Val F1: 0.321

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.660
Batch: 3/29	Loss: 0.654
Batch: 5/29	Loss: 0.626
Batch: 7/29	Loss: 0.657
Batch: 9/29	Loss: 0.621
Batch: 11/29	Loss: 0.640
Batch: 13/29	Loss: 0.722
Batch: 15/29	Loss: 0.668
Batch: 17/29	Loss: 0.730
Batch: 19/29	Loss: 0.723
Batch: 21/29	Loss: 0.646
Batch: 23/29	Loss: 0.667
Batch: 25/29	Loss: 0.663
Batch: 27/29	Loss: 0.645
Batch: 29/29	Loss: 0.681
Epoch: 5	Train Loss: 0.678	Val F1: 0.353
Best Epoch: 5	Best Val F1: 0.353

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.634
Batch: 3/29	Loss: 0.680
Batch: 5/29	Loss: 0.560
Batch: 7/29	Loss: 0.718
Batch: 9/29	Loss: 0.617
Batch: 11/29	Loss: 0.596
Batch: 13/29	Loss: 0.595
Batch: 15/29	Loss: 0.566
Batch: 17/29	Loss: 0.587
Batch: 19/29	Loss: 0.560
Batch: 21/29	Loss: 0.660
Batch: 23/29	Loss: 0.652
Batch: 25/29	Loss: 0.650
Batch: 27/29	Loss: 0.645
Batch: 29/29	Loss: 0.607
Epoch: 6	Train Loss: 0.618	Val F1: 0.334
Best Epoch: 5	Best Val F1: 0.353

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.559
Batch: 3/29	Loss: 0.620
Batch: 5/29	Loss: 0.653
Batch: 7/29	Loss: 0.614
Batch: 9/29	Loss: 0.636
Batch: 11/29	Loss: 0.456
Batch: 13/29	Loss: 0.561
Batch: 15/29	Loss: 0.507
Batch: 17/29	Loss: 0.643
Batch: 19/29	Loss: 0.682
Batch: 21/29	Loss: 0.590
Batch: 23/29	Loss: 0.533
Batch: 25/29	Loss: 0.486
Batch: 27/29	Loss: 0.514
Batch: 29/29	Loss: 0.552
Epoch: 7	Train Loss: 0.582	Val F1: 0.375
Best Epoch: 7	Best Val F1: 0.375

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.511
Batch: 3/29	Loss: 0.452
Batch: 5/29	Loss: 0.532
Batch: 7/29	Loss: 0.521
Batch: 9/29	Loss: 0.456
Batch: 11/29	Loss: 0.523
Batch: 13/29	Loss: 0.551
Batch: 15/29	Loss: 0.489
Batch: 17/29	Loss: 0.565
Batch: 19/29	Loss: 0.471
Batch: 21/29	Loss: 0.535
Batch: 23/29	Loss: 0.580
Batch: 25/29	Loss: 0.615
Batch: 27/29	Loss: 0.580
Batch: 29/29	Loss: 0.532
Epoch: 8	Train Loss: 0.518	Val F1: 0.352
Best Epoch: 7	Best Val F1: 0.375

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.524
Batch: 3/29	Loss: 0.473
Batch: 5/29	Loss: 0.472
Batch: 7/29	Loss: 0.374
Batch: 9/29	Loss: 0.500
Batch: 11/29	Loss: 0.466
Batch: 13/29	Loss: 0.441
Batch: 15/29	Loss: 0.391
Batch: 17/29	Loss: 0.424
Batch: 19/29	Loss: 0.393
Batch: 21/29	Loss: 0.548
Batch: 23/29	Loss: 0.469
Batch: 25/29	Loss: 0.437
Batch: 27/29	Loss: 0.517
Batch: 29/29	Loss: 0.365
Epoch: 9	Train Loss: 0.457	Val F1: 0.369
Best Epoch: 7	Best Val F1: 0.375

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.369
Batch: 3/29	Loss: 0.433
Batch: 5/29	Loss: 0.380
Batch: 7/29	Loss: 0.398
Batch: 9/29	Loss: 0.489
Batch: 11/29	Loss: 0.415
Batch: 13/29	Loss: 0.563
Batch: 15/29	Loss: 0.488
Batch: 17/29	Loss: 0.566
Batch: 19/29	Loss: 0.351
Batch: 21/29	Loss: 0.557
Batch: 23/29	Loss: 0.498
Batch: 25/29	Loss: 0.533
Batch: 27/29	Loss: 0.383
Batch: 29/29	Loss: 0.491
Epoch: 10	Train Loss: 0.450	Val F1: 0.351
Best Epoch: 7	Best Val F1: 0.375

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.422
Batch: 3/29	Loss: 0.366
Batch: 5/29	Loss: 0.525
Batch: 7/29	Loss: 0.401
Batch: 9/29	Loss: 0.382
Batch: 11/29	Loss: 0.408
Batch: 13/29	Loss: 0.424
Batch: 15/29	Loss: 0.303
Batch: 17/29	Loss: 0.434
Batch: 19/29	Loss: 0.412
Batch: 21/29	Loss: 0.374
Batch: 23/29	Loss: 0.338
Batch: 25/29	Loss: 0.346
Batch: 27/29	Loss: 0.364
Batch: 29/29	Loss: 0.414
Epoch: 11	Train Loss: 0.394	Val F1: 0.361
Best Epoch: 7	Best Val F1: 0.375

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.463
Batch: 3/29	Loss: 0.346
Batch: 5/29	Loss: 0.323
Batch: 7/29	Loss: 0.401
Batch: 9/29	Loss: 0.393
Batch: 11/29	Loss: 0.385
Batch: 13/29	Loss: 0.376
Batch: 15/29	Loss: 0.335
Batch: 17/29	Loss: 0.359
Batch: 19/29	Loss: 0.323
Batch: 21/29	Loss: 0.338
Batch: 23/29	Loss: 0.349
Batch: 25/29	Loss: 0.333
Batch: 27/29	Loss: 0.489
Batch: 29/29	Loss: 0.297
Epoch: 12	Train Loss: 0.364	Val F1: 0.355
Best Epoch: 7	Best Val F1: 0.375

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.379
Batch: 3/29	Loss: 0.252
Batch: 5/29	Loss: 0.372
Batch: 7/29	Loss: 0.305
Batch: 9/29	Loss: 0.360
Batch: 11/29	Loss: 0.378
Batch: 13/29	Loss: 0.366
Batch: 15/29	Loss: 0.319
Batch: 17/29	Loss: 0.302
Batch: 19/29	Loss: 0.215
Batch: 21/29	Loss: 0.303
Batch: 23/29	Loss: 0.359
Batch: 25/29	Loss: 0.228
Batch: 27/29	Loss: 0.387
Batch: 29/29	Loss: 0.416
Epoch: 13	Train Loss: 0.341	Val F1: 0.347
Best Epoch: 7	Best Val F1: 0.375

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.363
Batch: 3/29	Loss: 0.357
Batch: 5/29	Loss: 0.249
Batch: 7/29	Loss: 0.322
Batch: 9/29	Loss: 0.358
Batch: 11/29	Loss: 0.295
Batch: 13/29	Loss: 0.312
Batch: 15/29	Loss: 0.286
Batch: 17/29	Loss: 0.394
Batch: 19/29	Loss: 0.356
Batch: 21/29	Loss: 0.220
Batch: 23/29	Loss: 0.268
Batch: 25/29	Loss: 0.336
Batch: 27/29	Loss: 0.315
Batch: 29/29	Loss: 0.300
Epoch: 14	Train Loss: 0.319	Val F1: 0.347
Best Epoch: 7	Best Val F1: 0.375

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.294
Batch: 3/29	Loss: 0.352
Batch: 5/29	Loss: 0.218
Batch: 7/29	Loss: 0.313
Batch: 9/29	Loss: 0.376
Batch: 11/29	Loss: 0.307
Batch: 13/29	Loss: 0.291
Batch: 15/29	Loss: 0.286
Batch: 17/29	Loss: 0.350
Batch: 19/29	Loss: 0.271
Batch: 21/29	Loss: 0.356
Batch: 23/29	Loss: 0.291
Batch: 25/29	Loss: 0.322
Batch: 27/29	Loss: 0.269
Batch: 29/29	Loss: 0.330
Epoch: 15	Train Loss: 0.309	Val F1: 0.354
Best Epoch: 7	Best Val F1: 0.375

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.314
Batch: 3/29	Loss: 0.318
Batch: 5/29	Loss: 0.360
Batch: 7/29	Loss: 0.261
Batch: 9/29	Loss: 0.269
Batch: 11/29	Loss: 0.273
Batch: 13/29	Loss: 0.272
Batch: 15/29	Loss: 0.211
Batch: 17/29	Loss: 0.271
Batch: 19/29	Loss: 0.333
Batch: 21/29	Loss: 0.205
Batch: 23/29	Loss: 0.290
Batch: 25/29	Loss: 0.309
Batch: 27/29	Loss: 0.265
Batch: 29/29	Loss: 0.255
Epoch: 16	Train Loss: 0.279	Val F1: 0.342
Best Epoch: 7	Best Val F1: 0.375

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.273
Batch: 3/29	Loss: 0.308
Batch: 5/29	Loss: 0.272
Batch: 7/29	Loss: 0.257
Batch: 9/29	Loss: 0.173
Batch: 11/29	Loss: 0.258
Batch: 13/29	Loss: 0.299
Batch: 15/29	Loss: 0.303
Batch: 17/29	Loss: 0.258
Batch: 19/29	Loss: 0.239
Batch: 21/29	Loss: 0.297
Batch: 23/29	Loss: 0.397
Batch: 25/29	Loss: 0.148
Batch: 27/29	Loss: 0.246
Batch: 29/29	Loss: 0.293
Epoch: 17	Train Loss: 0.260	Val F1: 0.341
Best Epoch: 7	Best Val F1: 0.375

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.244
Batch: 3/29	Loss: 0.332
Batch: 5/29	Loss: 0.265
Batch: 7/29	Loss: 0.195
Batch: 9/29	Loss: 0.332
Batch: 11/29	Loss: 0.183
Batch: 13/29	Loss: 0.181
Batch: 15/29	Loss: 0.251
Batch: 17/29	Loss: 0.235
Batch: 19/29	Loss: 0.173
Batch: 21/29	Loss: 0.260
Batch: 23/29	Loss: 0.330
Batch: 25/29	Loss: 0.256
Batch: 27/29	Loss: 0.200
Batch: 29/29	Loss: 0.257
Epoch: 18	Train Loss: 0.240	Val F1: 0.348
Best Epoch: 7	Best Val F1: 0.375

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.171
Batch: 3/29	Loss: 0.163
Batch: 5/29	Loss: 0.274
Batch: 7/29	Loss: 0.284
Batch: 9/29	Loss: 0.215
Batch: 11/29	Loss: 0.355
Batch: 13/29	Loss: 0.296
Batch: 15/29	Loss: 0.256
Batch: 17/29	Loss: 0.239
Batch: 19/29	Loss: 0.288
Batch: 21/29	Loss: 0.226
Batch: 23/29	Loss: 0.262
Batch: 25/29	Loss: 0.252
Batch: 27/29	Loss: 0.185
Batch: 29/29	Loss: 0.245
Epoch: 19	Train Loss: 0.241	Val F1: 0.342
Best Epoch: 7	Best Val F1: 0.375

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.260
Batch: 3/29	Loss: 0.236
Batch: 5/29	Loss: 0.191
Batch: 7/29	Loss: 0.177
Batch: 9/29	Loss: 0.242
Batch: 11/29	Loss: 0.246
Batch: 13/29	Loss: 0.240
Batch: 15/29	Loss: 0.228
Batch: 17/29	Loss: 0.329
Batch: 19/29	Loss: 0.214
Batch: 21/29	Loss: 0.186
Batch: 23/29	Loss: 0.256
Batch: 25/29	Loss: 0.183
Batch: 27/29	Loss: 0.246
Batch: 29/29	Loss: 0.276
Epoch: 20	Train Loss: 0.232	Val F1: 0.353
Best Epoch: 7	Best Val F1: 0.375

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.199
Batch: 3/29	Loss: 0.189
Batch: 5/29	Loss: 0.212
Batch: 7/29	Loss: 0.394
Batch: 9/29	Loss: 0.172
Batch: 11/29	Loss: 0.128
Batch: 13/29	Loss: 0.225
Batch: 15/29	Loss: 0.222
Batch: 17/29	Loss: 0.144
Batch: 19/29	Loss: 0.182
Batch: 21/29	Loss: 0.270
Batch: 23/29	Loss: 0.221
Batch: 25/29	Loss: 0.233
Batch: 27/29	Loss: 0.235
Batch: 29/29	Loss: 0.218
Epoch: 21	Train Loss: 0.212	Val F1: 0.350
Best Epoch: 7	Best Val F1: 0.375

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.187
Batch: 3/29	Loss: 0.162
Batch: 5/29	Loss: 0.161
Batch: 7/29	Loss: 0.226
Batch: 9/29	Loss: 0.161
Batch: 11/29	Loss: 0.187
Batch: 13/29	Loss: 0.142
Batch: 15/29	Loss: 0.208
Batch: 17/29	Loss: 0.268
Batch: 19/29	Loss: 0.210
Batch: 21/29	Loss: 0.269
Batch: 23/29	Loss: 0.164
Batch: 25/29	Loss: 0.167
Batch: 27/29	Loss: 0.165
Batch: 29/29	Loss: 0.185
Epoch: 22	Train Loss: 0.186	Val F1: 0.347
Best Epoch: 7	Best Val F1: 0.375

Saving the best checkpoint....
Inference...
Test F1: 0.379	Test F1_Few: 0.454	Test F1_Zero: 0.371
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0009340435857302868, 'lr': 1.4471855040499254e-05, 'n_layers_freeze': 2, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.076
Batch: 5/29	Loss: 1.051
Batch: 7/29	Loss: 1.033
Batch: 9/29	Loss: 1.012
Batch: 11/29	Loss: 0.995
Batch: 13/29	Loss: 0.982
Batch: 15/29	Loss: 0.982
Batch: 17/29	Loss: 0.945
Batch: 19/29	Loss: 0.940
Batch: 21/29	Loss: 0.923
Batch: 23/29	Loss: 0.926
Batch: 25/29	Loss: 0.898
Batch: 27/29	Loss: 0.893
Batch: 29/29	Loss: 0.898
Epoch: 1	Train Loss: 0.975	Val F1: 0.188
Best Epoch: 1	Best Val F1: 0.188

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.890
Batch: 3/29	Loss: 0.888
Batch: 5/29	Loss: 0.911
Batch: 7/29	Loss: 0.876
Batch: 9/29	Loss: 0.888
Batch: 11/29	Loss: 0.849
Batch: 13/29	Loss: 0.848
Batch: 15/29	Loss: 0.869
Batch: 17/29	Loss: 0.858
Batch: 19/29	Loss: 0.884
Batch: 21/29	Loss: 0.843
Batch: 23/29	Loss: 0.850
Batch: 25/29	Loss: 0.830
Batch: 27/29	Loss: 0.881
Batch: 29/29	Loss: 0.831
Epoch: 2	Train Loss: 0.863	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.188

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.823
Batch: 3/29	Loss: 0.839
Batch: 5/29	Loss: 0.829
Batch: 7/29	Loss: 0.855
Batch: 9/29	Loss: 0.812
Batch: 11/29	Loss: 0.812
Batch: 13/29	Loss: 0.847
Batch: 15/29	Loss: 0.817
Batch: 17/29	Loss: 0.832
Batch: 19/29	Loss: 0.827
Batch: 21/29	Loss: 0.807
Batch: 23/29	Loss: 0.801
Batch: 25/29	Loss: 0.818
Batch: 27/29	Loss: 0.793
Batch: 29/29	Loss: 0.803
Epoch: 3	Train Loss: 0.822	Val F1: 0.221
Best Epoch: 3	Best Val F1: 0.221

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.786
Batch: 3/29	Loss: 0.800
Batch: 5/29	Loss: 0.782
Batch: 7/29	Loss: 0.828
Batch: 9/29	Loss: 0.808
Batch: 11/29	Loss: 0.765
Batch: 13/29	Loss: 0.774
Batch: 15/29	Loss: 0.760
Batch: 17/29	Loss: 0.767
Batch: 19/29	Loss: 0.791
Batch: 21/29	Loss: 0.792
Batch: 23/29	Loss: 0.779
Batch: 25/29	Loss: 0.773
Batch: 27/29	Loss: 0.788
Batch: 29/29	Loss: 0.781
Epoch: 4	Train Loss: 0.788	Val F1: 0.274
Best Epoch: 4	Best Val F1: 0.274

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.747
Batch: 3/29	Loss: 0.743
Batch: 5/29	Loss: 0.724
Batch: 7/29	Loss: 0.735
Batch: 9/29	Loss: 0.705
Batch: 11/29	Loss: 0.751
Batch: 13/29	Loss: 0.725
Batch: 15/29	Loss: 0.740
Batch: 17/29	Loss: 0.778
Batch: 19/29	Loss: 0.740
Batch: 21/29	Loss: 0.716
Batch: 23/29	Loss: 0.750
Batch: 25/29	Loss: 0.734
Batch: 27/29	Loss: 0.700
Batch: 29/29	Loss: 0.752
Epoch: 5	Train Loss: 0.743	Val F1: 0.329
Best Epoch: 5	Best Val F1: 0.329

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.734
Batch: 3/29	Loss: 0.755
Batch: 5/29	Loss: 0.664
Batch: 7/29	Loss: 0.766
Batch: 9/29	Loss: 0.696
Batch: 11/29	Loss: 0.673
Batch: 13/29	Loss: 0.709
Batch: 15/29	Loss: 0.674
Batch: 17/29	Loss: 0.667
Batch: 19/29	Loss: 0.643
Batch: 21/29	Loss: 0.754
Batch: 23/29	Loss: 0.690
Batch: 25/29	Loss: 0.686
Batch: 27/29	Loss: 0.679
Batch: 29/29	Loss: 0.685
Epoch: 6	Train Loss: 0.698	Val F1: 0.311
Best Epoch: 5	Best Val F1: 0.329

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.652
Batch: 3/29	Loss: 0.760
Batch: 5/29	Loss: 0.731
Batch: 7/29	Loss: 0.695
Batch: 9/29	Loss: 0.675
Batch: 11/29	Loss: 0.609
Batch: 13/29	Loss: 0.643
Batch: 15/29	Loss: 0.604
Batch: 17/29	Loss: 0.681
Batch: 19/29	Loss: 0.693
Batch: 21/29	Loss: 0.619
Batch: 23/29	Loss: 0.629
Batch: 25/29	Loss: 0.603
Batch: 27/29	Loss: 0.612
Batch: 29/29	Loss: 0.588
Epoch: 7	Train Loss: 0.653	Val F1: 0.340
Best Epoch: 7	Best Val F1: 0.340

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.634
Batch: 3/29	Loss: 0.587
Batch: 5/29	Loss: 0.632
Batch: 7/29	Loss: 0.630
Batch: 9/29	Loss: 0.583
Batch: 11/29	Loss: 0.624
Batch: 13/29	Loss: 0.664
Batch: 15/29	Loss: 0.575
Batch: 17/29	Loss: 0.654
Batch: 19/29	Loss: 0.590
Batch: 21/29	Loss: 0.628
Batch: 23/29	Loss: 0.664
Batch: 25/29	Loss: 0.736
Batch: 27/29	Loss: 0.639
Batch: 29/29	Loss: 0.608
Epoch: 8	Train Loss: 0.621	Val F1: 0.330
Best Epoch: 7	Best Val F1: 0.340

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.629
Batch: 3/29	Loss: 0.591
Batch: 5/29	Loss: 0.601
Batch: 7/29	Loss: 0.523
Batch: 9/29	Loss: 0.646
Batch: 11/29	Loss: 0.624
Batch: 13/29	Loss: 0.621
Batch: 15/29	Loss: 0.636
Batch: 17/29	Loss: 0.555
Batch: 19/29	Loss: 0.541
Batch: 21/29	Loss: 0.713
Batch: 23/29	Loss: 0.527
Batch: 25/29	Loss: 0.605
Batch: 27/29	Loss: 0.587
Batch: 29/29	Loss: 0.553
Epoch: 9	Train Loss: 0.596	Val F1: 0.324
Best Epoch: 7	Best Val F1: 0.340

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.503
Batch: 3/29	Loss: 0.585
Batch: 5/29	Loss: 0.556
Batch: 7/29	Loss: 0.553
Batch: 9/29	Loss: 0.551
Batch: 11/29	Loss: 0.464
Batch: 13/29	Loss: 0.673
Batch: 15/29	Loss: 0.603
Batch: 17/29	Loss: 0.635
Batch: 19/29	Loss: 0.408
Batch: 21/29	Loss: 0.582
Batch: 23/29	Loss: 0.589
Batch: 25/29	Loss: 0.614
Batch: 27/29	Loss: 0.497
Batch: 29/29	Loss: 0.591
Epoch: 10	Train Loss: 0.554	Val F1: 0.364
Best Epoch: 10	Best Val F1: 0.364

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.594
Batch: 3/29	Loss: 0.472
Batch: 5/29	Loss: 0.672
Batch: 7/29	Loss: 0.522
Batch: 9/29	Loss: 0.537
Batch: 11/29	Loss: 0.474
Batch: 13/29	Loss: 0.490
Batch: 15/29	Loss: 0.387
Batch: 17/29	Loss: 0.631
Batch: 19/29	Loss: 0.524
Batch: 21/29	Loss: 0.465
Batch: 23/29	Loss: 0.449
Batch: 25/29	Loss: 0.429
Batch: 27/29	Loss: 0.461
Batch: 29/29	Loss: 0.500
Epoch: 11	Train Loss: 0.512	Val F1: 0.359
Best Epoch: 10	Best Val F1: 0.364

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.549
Batch: 3/29	Loss: 0.413
Batch: 5/29	Loss: 0.445
Batch: 7/29	Loss: 0.454
Batch: 9/29	Loss: 0.475
Batch: 11/29	Loss: 0.472
Batch: 13/29	Loss: 0.457
Batch: 15/29	Loss: 0.482
Batch: 17/29	Loss: 0.514
Batch: 19/29	Loss: 0.455
Batch: 21/29	Loss: 0.419
Batch: 23/29	Loss: 0.525
Batch: 25/29	Loss: 0.486
Batch: 27/29	Loss: 0.571
Batch: 29/29	Loss: 0.413
Epoch: 12	Train Loss: 0.473	Val F1: 0.339
Best Epoch: 10	Best Val F1: 0.364

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.528
Batch: 3/29	Loss: 0.365
Batch: 5/29	Loss: 0.495
Batch: 7/29	Loss: 0.418
Batch: 9/29	Loss: 0.494
Batch: 11/29	Loss: 0.461
Batch: 13/29	Loss: 0.452
Batch: 15/29	Loss: 0.453
Batch: 17/29	Loss: 0.431
Batch: 19/29	Loss: 0.372
Batch: 21/29	Loss: 0.413
Batch: 23/29	Loss: 0.446
Batch: 25/29	Loss: 0.325
Batch: 27/29	Loss: 0.494
Batch: 29/29	Loss: 0.544
Epoch: 13	Train Loss: 0.456	Val F1: 0.352
Best Epoch: 10	Best Val F1: 0.364

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.445
Batch: 3/29	Loss: 0.470
Batch: 5/29	Loss: 0.329
Batch: 7/29	Loss: 0.430
Batch: 9/29	Loss: 0.456
Batch: 11/29	Loss: 0.412
Batch: 13/29	Loss: 0.451
Batch: 15/29	Loss: 0.329
Batch: 17/29	Loss: 0.521
Batch: 19/29	Loss: 0.470
Batch: 21/29	Loss: 0.356
Batch: 23/29	Loss: 0.340
Batch: 25/29	Loss: 0.475
Batch: 27/29	Loss: 0.407
Batch: 29/29	Loss: 0.468
Epoch: 14	Train Loss: 0.422	Val F1: 0.351
Best Epoch: 10	Best Val F1: 0.364

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.361
Batch: 3/29	Loss: 0.406
Batch: 5/29	Loss: 0.288
Batch: 7/29	Loss: 0.426
Batch: 9/29	Loss: 0.423
Batch: 11/29	Loss: 0.362
Batch: 13/29	Loss: 0.372
Batch: 15/29	Loss: 0.409
Batch: 17/29	Loss: 0.480
Batch: 19/29	Loss: 0.396
Batch: 21/29	Loss: 0.441
Batch: 23/29	Loss: 0.436
Batch: 25/29	Loss: 0.466
Batch: 27/29	Loss: 0.377
Batch: 29/29	Loss: 0.495
Epoch: 15	Train Loss: 0.411	Val F1: 0.351
Best Epoch: 10	Best Val F1: 0.364

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.409
Batch: 3/29	Loss: 0.400
Batch: 5/29	Loss: 0.437
Batch: 7/29	Loss: 0.336
Batch: 9/29	Loss: 0.469
Batch: 11/29	Loss: 0.355
Batch: 13/29	Loss: 0.341
Batch: 15/29	Loss: 0.290
Batch: 17/29	Loss: 0.340
Batch: 19/29	Loss: 0.431
Batch: 21/29	Loss: 0.304
Batch: 23/29	Loss: 0.404
Batch: 25/29	Loss: 0.444
Batch: 27/29	Loss: 0.425
Batch: 29/29	Loss: 0.383
Epoch: 16	Train Loss: 0.390	Val F1: 0.345
Best Epoch: 10	Best Val F1: 0.364

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.379
Batch: 3/29	Loss: 0.472
Batch: 5/29	Loss: 0.435
Batch: 7/29	Loss: 0.365
Batch: 9/29	Loss: 0.343
Batch: 11/29	Loss: 0.525
Batch: 13/29	Loss: 0.419
Batch: 15/29	Loss: 0.381
Batch: 17/29	Loss: 0.392
Batch: 19/29	Loss: 0.341
Batch: 21/29	Loss: 0.413
Batch: 23/29	Loss: 0.461
Batch: 25/29	Loss: 0.250
Batch: 27/29	Loss: 0.445
Batch: 29/29	Loss: 0.413
Epoch: 17	Train Loss: 0.391	Val F1: 0.346
Best Epoch: 10	Best Val F1: 0.364

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.412
Batch: 3/29	Loss: 0.423
Batch: 5/29	Loss: 0.360
Batch: 7/29	Loss: 0.320
Batch: 9/29	Loss: 0.460
Batch: 11/29	Loss: 0.353
Batch: 13/29	Loss: 0.290
Batch: 15/29	Loss: 0.332
Batch: 17/29	Loss: 0.331
Batch: 19/29	Loss: 0.338
Batch: 21/29	Loss: 0.362
Batch: 23/29	Loss: 0.373
Batch: 25/29	Loss: 0.379
Batch: 27/29	Loss: 0.286
Batch: 29/29	Loss: 0.400
Epoch: 18	Train Loss: 0.366	Val F1: 0.355
Best Epoch: 10	Best Val F1: 0.364

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.259
Batch: 3/29	Loss: 0.310
Batch: 5/29	Loss: 0.363
Batch: 7/29	Loss: 0.367
Batch: 9/29	Loss: 0.255
Batch: 11/29	Loss: 0.455
Batch: 13/29	Loss: 0.460
Batch: 15/29	Loss: 0.348
Batch: 17/29	Loss: 0.305
Batch: 19/29	Loss: 0.429
Batch: 21/29	Loss: 0.361
Batch: 23/29	Loss: 0.371
Batch: 25/29	Loss: 0.370
Batch: 27/29	Loss: 0.281
Batch: 29/29	Loss: 0.304
Epoch: 19	Train Loss: 0.353	Val F1: 0.358
Best Epoch: 10	Best Val F1: 0.364

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.423
Batch: 3/29	Loss: 0.358
Batch: 5/29	Loss: 0.330
Batch: 7/29	Loss: 0.261
Batch: 9/29	Loss: 0.370
Batch: 11/29	Loss: 0.344
Batch: 13/29	Loss: 0.338
Batch: 15/29	Loss: 0.327
Batch: 17/29	Loss: 0.430
Batch: 19/29	Loss: 0.276
Batch: 21/29	Loss: 0.349
Batch: 23/29	Loss: 0.343
Batch: 25/29	Loss: 0.295
Batch: 27/29	Loss: 0.327
Batch: 29/29	Loss: 0.391
Epoch: 20	Train Loss: 0.337	Val F1: 0.360
Best Epoch: 10	Best Val F1: 0.364

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.310
Batch: 3/29	Loss: 0.271
Batch: 5/29	Loss: 0.293
Batch: 7/29	Loss: 0.531
Batch: 9/29	Loss: 0.281
Batch: 11/29	Loss: 0.266
Batch: 13/29	Loss: 0.373
Batch: 15/29	Loss: 0.389
Batch: 17/29	Loss: 0.264
Batch: 19/29	Loss: 0.304
Batch: 21/29	Loss: 0.287
Batch: 23/29	Loss: 0.248
Batch: 25/29	Loss: 0.301
Batch: 27/29	Loss: 0.344
Batch: 29/29	Loss: 0.354
Epoch: 21	Train Loss: 0.323	Val F1: 0.355
Best Epoch: 10	Best Val F1: 0.364

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.296
Batch: 3/29	Loss: 0.267
Batch: 5/29	Loss: 0.318
Batch: 7/29	Loss: 0.354
Batch: 9/29	Loss: 0.287
Batch: 11/29	Loss: 0.287
Batch: 13/29	Loss: 0.281
Batch: 15/29	Loss: 0.278
Batch: 17/29	Loss: 0.385
Batch: 19/29	Loss: 0.406
Batch: 21/29	Loss: 0.412
Batch: 23/29	Loss: 0.308
Batch: 25/29	Loss: 0.317
Batch: 27/29	Loss: 0.265
Batch: 29/29	Loss: 0.309
Epoch: 22	Train Loss: 0.312	Val F1: 0.349
Best Epoch: 10	Best Val F1: 0.364

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.292
Batch: 3/29	Loss: 0.353
Batch: 5/29	Loss: 0.353
Batch: 7/29	Loss: 0.372
Batch: 9/29	Loss: 0.266
Batch: 11/29	Loss: 0.322
Batch: 13/29	Loss: 0.286
Batch: 15/29	Loss: 0.325
Batch: 17/29	Loss: 0.357
Batch: 19/29	Loss: 0.299
Batch: 21/29	Loss: 0.296
Batch: 23/29	Loss: 0.292
Batch: 25/29	Loss: 0.310
Batch: 27/29	Loss: 0.242
Batch: 29/29	Loss: 0.298
Epoch: 23	Train Loss: 0.308	Val F1: 0.359
Best Epoch: 10	Best Val F1: 0.364

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.258
Batch: 3/29	Loss: 0.263
Batch: 5/29	Loss: 0.361
Batch: 7/29	Loss: 0.301
Batch: 9/29	Loss: 0.346
Batch: 11/29	Loss: 0.374
Batch: 13/29	Loss: 0.263
Batch: 15/29	Loss: 0.275
Batch: 17/29	Loss: 0.267
Batch: 19/29	Loss: 0.325
Batch: 21/29	Loss: 0.362
Batch: 23/29	Loss: 0.250
Batch: 25/29	Loss: 0.295
Batch: 27/29	Loss: 0.237
Batch: 29/29	Loss: 0.263
Epoch: 24	Train Loss: 0.290	Val F1: 0.357
Best Epoch: 10	Best Val F1: 0.364

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.305
Batch: 3/29	Loss: 0.296
Batch: 5/29	Loss: 0.333
Batch: 7/29	Loss: 0.337
Batch: 9/29	Loss: 0.357
Batch: 11/29	Loss: 0.299
Batch: 13/29	Loss: 0.341
Batch: 15/29	Loss: 0.292
Batch: 17/29	Loss: 0.326
Batch: 19/29	Loss: 0.228
Batch: 21/29	Loss: 0.260
Batch: 23/29	Loss: 0.291
Batch: 25/29	Loss: 0.294
Batch: 27/29	Loss: 0.297
Batch: 29/29	Loss: 0.244
Epoch: 25	Train Loss: 0.286	Val F1: 0.351
Best Epoch: 10	Best Val F1: 0.364

Saving the best checkpoint....
Inference...
Test F1: 0.386	Test F1_Few: 0.464	Test F1_Zero: 0.377
Starting training with config: {'batch_size': 64, 'epochs': 25, 'l2_reg': 0.0007732411099087956, 'lr': 1.290887004746557e-05, 'n_layers_freeze': 1, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.078
Batch: 5/29	Loss: 1.057
Batch: 7/29	Loss: 1.041
Batch: 9/29	Loss: 1.023
Batch: 11/29	Loss: 1.007
Batch: 13/29	Loss: 0.994
Batch: 15/29	Loss: 0.992
Batch: 17/29	Loss: 0.957
Batch: 19/29	Loss: 0.950
Batch: 21/29	Loss: 0.934
Batch: 23/29	Loss: 0.934
Batch: 25/29	Loss: 0.909
Batch: 27/29	Loss: 0.903
Batch: 29/29	Loss: 0.907
Epoch: 1	Train Loss: 0.984	Val F1: 0.186
Best Epoch: 1	Best Val F1: 0.186

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.899
Batch: 3/29	Loss: 0.897
Batch: 5/29	Loss: 0.918
Batch: 7/29	Loss: 0.884
Batch: 9/29	Loss: 0.895
Batch: 11/29	Loss: 0.859
Batch: 13/29	Loss: 0.857
Batch: 15/29	Loss: 0.877
Batch: 17/29	Loss: 0.866
Batch: 19/29	Loss: 0.890
Batch: 21/29	Loss: 0.852
Batch: 23/29	Loss: 0.858
Batch: 25/29	Loss: 0.839
Batch: 27/29	Loss: 0.887
Batch: 29/29	Loss: 0.840
Epoch: 2	Train Loss: 0.871	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.186

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.832
Batch: 3/29	Loss: 0.846
Batch: 5/29	Loss: 0.837
Batch: 7/29	Loss: 0.861
Batch: 9/29	Loss: 0.821
Batch: 11/29	Loss: 0.821
Batch: 13/29	Loss: 0.854
Batch: 15/29	Loss: 0.825
Batch: 17/29	Loss: 0.840
Batch: 19/29	Loss: 0.834
Batch: 21/29	Loss: 0.816
Batch: 23/29	Loss: 0.811
Batch: 25/29	Loss: 0.827
Batch: 27/29	Loss: 0.803
Batch: 29/29	Loss: 0.812
Epoch: 3	Train Loss: 0.830	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.186

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.797
Batch: 3/29	Loss: 0.812
Batch: 5/29	Loss: 0.792
Batch: 7/29	Loss: 0.835
Batch: 9/29	Loss: 0.820
Batch: 11/29	Loss: 0.781
Batch: 13/29	Loss: 0.791
Batch: 15/29	Loss: 0.776
Batch: 17/29	Loss: 0.788
Batch: 19/29	Loss: 0.807
Batch: 21/29	Loss: 0.813
Batch: 23/29	Loss: 0.808
Batch: 25/29	Loss: 0.792
Batch: 27/29	Loss: 0.810
Batch: 29/29	Loss: 0.797
Epoch: 4	Train Loss: 0.801	Val F1: 0.277
Best Epoch: 4	Best Val F1: 0.277

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.769
Batch: 3/29	Loss: 0.763
Batch: 5/29	Loss: 0.751
Batch: 7/29	Loss: 0.746
Batch: 9/29	Loss: 0.737
Batch: 11/29	Loss: 0.748
Batch: 13/29	Loss: 0.783
Batch: 15/29	Loss: 0.766
Batch: 17/29	Loss: 0.833
Batch: 19/29	Loss: 0.752
Batch: 21/29	Loss: 0.727
Batch: 23/29	Loss: 0.791
Batch: 25/29	Loss: 0.755
Batch: 27/29	Loss: 0.733
Batch: 29/29	Loss: 0.766
Epoch: 5	Train Loss: 0.766	Val F1: 0.320
Best Epoch: 5	Best Val F1: 0.320

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.747
Batch: 3/29	Loss: 0.792
Batch: 5/29	Loss: 0.688
Batch: 7/29	Loss: 0.791
Batch: 9/29	Loss: 0.722
Batch: 11/29	Loss: 0.700
Batch: 13/29	Loss: 0.740
Batch: 15/29	Loss: 0.683
Batch: 17/29	Loss: 0.700
Batch: 19/29	Loss: 0.679
Batch: 21/29	Loss: 0.766
Batch: 23/29	Loss: 0.710
Batch: 25/29	Loss: 0.709
Batch: 27/29	Loss: 0.721
Batch: 29/29	Loss: 0.685
Epoch: 6	Train Loss: 0.724	Val F1: 0.325
Best Epoch: 6	Best Val F1: 0.325

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.684
Batch: 3/29	Loss: 0.722
Batch: 5/29	Loss: 0.757
Batch: 7/29	Loss: 0.700
Batch: 9/29	Loss: 0.718
Batch: 11/29	Loss: 0.630
Batch: 13/29	Loss: 0.679
Batch: 15/29	Loss: 0.620
Batch: 17/29	Loss: 0.716
Batch: 19/29	Loss: 0.713
Batch: 21/29	Loss: 0.659
Batch: 23/29	Loss: 0.644
Batch: 25/29	Loss: 0.608
Batch: 27/29	Loss: 0.663
Batch: 29/29	Loss: 0.668
Epoch: 7	Train Loss: 0.680	Val F1: 0.327
Best Epoch: 7	Best Val F1: 0.327

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.661
Batch: 3/29	Loss: 0.622
Batch: 5/29	Loss: 0.648
Batch: 7/29	Loss: 0.631
Batch: 9/29	Loss: 0.626
Batch: 11/29	Loss: 0.649
Batch: 13/29	Loss: 0.692
Batch: 15/29	Loss: 0.605
Batch: 17/29	Loss: 0.684
Batch: 19/29	Loss: 0.648
Batch: 21/29	Loss: 0.661
Batch: 23/29	Loss: 0.680
Batch: 25/29	Loss: 0.698
Batch: 27/29	Loss: 0.662
Batch: 29/29	Loss: 0.645
Epoch: 8	Train Loss: 0.640	Val F1: 0.339
Best Epoch: 8	Best Val F1: 0.339

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.627
Batch: 3/29	Loss: 0.594
Batch: 5/29	Loss: 0.605
Batch: 7/29	Loss: 0.552
Batch: 9/29	Loss: 0.648
Batch: 11/29	Loss: 0.606
Batch: 13/29	Loss: 0.629
Batch: 15/29	Loss: 0.628
Batch: 17/29	Loss: 0.562
Batch: 19/29	Loss: 0.554
Batch: 21/29	Loss: 0.693
Batch: 23/29	Loss: 0.562
Batch: 25/29	Loss: 0.600
Batch: 27/29	Loss: 0.605
Batch: 29/29	Loss: 0.550
Epoch: 9	Train Loss: 0.597	Val F1: 0.349
Best Epoch: 9	Best Val F1: 0.349

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.497
Batch: 3/29	Loss: 0.588
Batch: 5/29	Loss: 0.544
Batch: 7/29	Loss: 0.517
Batch: 9/29	Loss: 0.513
Batch: 11/29	Loss: 0.449
Batch: 13/29	Loss: 0.654
Batch: 15/29	Loss: 0.608
Batch: 17/29	Loss: 0.673
Batch: 19/29	Loss: 0.408
Batch: 21/29	Loss: 0.621
Batch: 23/29	Loss: 0.601
Batch: 25/29	Loss: 0.601
Batch: 27/29	Loss: 0.516
Batch: 29/29	Loss: 0.610
Epoch: 10	Train Loss: 0.554	Val F1: 0.359
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.527
Batch: 3/29	Loss: 0.464
Batch: 5/29	Loss: 0.641
Batch: 7/29	Loss: 0.562
Batch: 9/29	Loss: 0.503
Batch: 11/29	Loss: 0.501
Batch: 13/29	Loss: 0.444
Batch: 15/29	Loss: 0.418
Batch: 17/29	Loss: 0.567
Batch: 19/29	Loss: 0.532
Batch: 21/29	Loss: 0.466
Batch: 23/29	Loss: 0.414
Batch: 25/29	Loss: 0.436
Batch: 27/29	Loss: 0.455
Batch: 29/29	Loss: 0.481
Epoch: 11	Train Loss: 0.502	Val F1: 0.349
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.563
Batch: 3/29	Loss: 0.390
Batch: 5/29	Loss: 0.448
Batch: 7/29	Loss: 0.461
Batch: 9/29	Loss: 0.539
Batch: 11/29	Loss: 0.478
Batch: 13/29	Loss: 0.451
Batch: 15/29	Loss: 0.459
Batch: 17/29	Loss: 0.502
Batch: 19/29	Loss: 0.455
Batch: 21/29	Loss: 0.453
Batch: 23/29	Loss: 0.448
Batch: 25/29	Loss: 0.476
Batch: 27/29	Loss: 0.588
Batch: 29/29	Loss: 0.389
Epoch: 12	Train Loss: 0.468	Val F1: 0.346
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.555
Batch: 3/29	Loss: 0.358
Batch: 5/29	Loss: 0.527
Batch: 7/29	Loss: 0.392
Batch: 9/29	Loss: 0.501
Batch: 11/29	Loss: 0.472
Batch: 13/29	Loss: 0.443
Batch: 15/29	Loss: 0.419
Batch: 17/29	Loss: 0.435
Batch: 19/29	Loss: 0.311
Batch: 21/29	Loss: 0.473
Batch: 23/29	Loss: 0.437
Batch: 25/29	Loss: 0.357
Batch: 27/29	Loss: 0.438
Batch: 29/29	Loss: 0.538
Epoch: 13	Train Loss: 0.459	Val F1: 0.354
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.430
Batch: 3/29	Loss: 0.451
Batch: 5/29	Loss: 0.320
Batch: 7/29	Loss: 0.448
Batch: 9/29	Loss: 0.440
Batch: 11/29	Loss: 0.444
Batch: 13/29	Loss: 0.376
Batch: 15/29	Loss: 0.355
Batch: 17/29	Loss: 0.523
Batch: 19/29	Loss: 0.446
Batch: 21/29	Loss: 0.288
Batch: 23/29	Loss: 0.328
Batch: 25/29	Loss: 0.424
Batch: 27/29	Loss: 0.409
Batch: 29/29	Loss: 0.439
Epoch: 14	Train Loss: 0.418	Val F1: 0.344
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.386
Batch: 3/29	Loss: 0.378
Batch: 5/29	Loss: 0.320
Batch: 7/29	Loss: 0.367
Batch: 9/29	Loss: 0.446
Batch: 11/29	Loss: 0.341
Batch: 13/29	Loss: 0.396
Batch: 15/29	Loss: 0.394
Batch: 17/29	Loss: 0.428
Batch: 19/29	Loss: 0.415
Batch: 21/29	Loss: 0.428
Batch: 23/29	Loss: 0.448
Batch: 25/29	Loss: 0.440
Batch: 27/29	Loss: 0.363
Batch: 29/29	Loss: 0.476
Epoch: 15	Train Loss: 0.400	Val F1: 0.362
Best Epoch: 15	Best Val F1: 0.362

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.409
Batch: 3/29	Loss: 0.400
Batch: 5/29	Loss: 0.428
Batch: 7/29	Loss: 0.356
Batch: 9/29	Loss: 0.381
Batch: 11/29	Loss: 0.354
Batch: 13/29	Loss: 0.337
Batch: 15/29	Loss: 0.295
Batch: 17/29	Loss: 0.384
Batch: 19/29	Loss: 0.457
Batch: 21/29	Loss: 0.323
Batch: 23/29	Loss: 0.410
Batch: 25/29	Loss: 0.376
Batch: 27/29	Loss: 0.374
Batch: 29/29	Loss: 0.388
Epoch: 16	Train Loss: 0.383	Val F1: 0.366
Best Epoch: 16	Best Val F1: 0.366

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.373
Batch: 3/29	Loss: 0.452
Batch: 5/29	Loss: 0.404
Batch: 7/29	Loss: 0.330
Batch: 9/29	Loss: 0.289
Batch: 11/29	Loss: 0.401
Batch: 13/29	Loss: 0.395
Batch: 15/29	Loss: 0.415
Batch: 17/29	Loss: 0.381
Batch: 19/29	Loss: 0.370
Batch: 21/29	Loss: 0.414
Batch: 23/29	Loss: 0.441
Batch: 25/29	Loss: 0.211
Batch: 27/29	Loss: 0.393
Batch: 29/29	Loss: 0.384
Epoch: 17	Train Loss: 0.376	Val F1: 0.342
Best Epoch: 16	Best Val F1: 0.366

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.429
Batch: 3/29	Loss: 0.398
Batch: 5/29	Loss: 0.377
Batch: 7/29	Loss: 0.336
Batch: 9/29	Loss: 0.468
Batch: 11/29	Loss: 0.311
Batch: 13/29	Loss: 0.290
Batch: 15/29	Loss: 0.318
Batch: 17/29	Loss: 0.346
Batch: 19/29	Loss: 0.290
Batch: 21/29	Loss: 0.365
Batch: 23/29	Loss: 0.374
Batch: 25/29	Loss: 0.366
Batch: 27/29	Loss: 0.264
Batch: 29/29	Loss: 0.414
Epoch: 18	Train Loss: 0.358	Val F1: 0.364
Best Epoch: 16	Best Val F1: 0.366

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.241
Batch: 3/29	Loss: 0.271
Batch: 5/29	Loss: 0.336
Batch: 7/29	Loss: 0.395
Batch: 9/29	Loss: 0.264
Batch: 11/29	Loss: 0.436
Batch: 13/29	Loss: 0.447
Batch: 15/29	Loss: 0.325
Batch: 17/29	Loss: 0.319
Batch: 19/29	Loss: 0.414
Batch: 21/29	Loss: 0.363
Batch: 23/29	Loss: 0.338
Batch: 25/29	Loss: 0.418
Batch: 27/29	Loss: 0.267
Batch: 29/29	Loss: 0.306
Epoch: 19	Train Loss: 0.346	Val F1: 0.355
Best Epoch: 16	Best Val F1: 0.366

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.406
Batch: 3/29	Loss: 0.365
Batch: 5/29	Loss: 0.314
Batch: 7/29	Loss: 0.274
Batch: 9/29	Loss: 0.358
Batch: 11/29	Loss: 0.380
Batch: 13/29	Loss: 0.335
Batch: 15/29	Loss: 0.362
Batch: 17/29	Loss: 0.419
Batch: 19/29	Loss: 0.312
Batch: 21/29	Loss: 0.308
Batch: 23/29	Loss: 0.424
Batch: 25/29	Loss: 0.290
Batch: 27/29	Loss: 0.366
Batch: 29/29	Loss: 0.431
Epoch: 20	Train Loss: 0.348	Val F1: 0.353
Best Epoch: 16	Best Val F1: 0.366

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.320
Batch: 3/29	Loss: 0.273
Batch: 5/29	Loss: 0.317
Batch: 7/29	Loss: 0.548
Batch: 9/29	Loss: 0.299
Batch: 11/29	Loss: 0.258
Batch: 13/29	Loss: 0.361
Batch: 15/29	Loss: 0.379
Batch: 17/29	Loss: 0.308
Batch: 19/29	Loss: 0.291
Batch: 21/29	Loss: 0.338
Batch: 23/29	Loss: 0.258
Batch: 25/29	Loss: 0.319
Batch: 27/29	Loss: 0.316
Batch: 29/29	Loss: 0.322
Epoch: 21	Train Loss: 0.330	Val F1: 0.363
Best Epoch: 16	Best Val F1: 0.366

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.307
Batch: 3/29	Loss: 0.257
Batch: 5/29	Loss: 0.329
Batch: 7/29	Loss: 0.351
Batch: 9/29	Loss: 0.278
Batch: 11/29	Loss: 0.308
Batch: 13/29	Loss: 0.257
Batch: 15/29	Loss: 0.297
Batch: 17/29	Loss: 0.402
Batch: 19/29	Loss: 0.400
Batch: 21/29	Loss: 0.414
Batch: 23/29	Loss: 0.310
Batch: 25/29	Loss: 0.342
Batch: 27/29	Loss: 0.282
Batch: 29/29	Loss: 0.287
Epoch: 22	Train Loss: 0.315	Val F1: 0.347
Best Epoch: 16	Best Val F1: 0.366

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.323
Batch: 3/29	Loss: 0.306
Batch: 5/29	Loss: 0.357
Batch: 7/29	Loss: 0.384
Batch: 9/29	Loss: 0.293
Batch: 11/29	Loss: 0.322
Batch: 13/29	Loss: 0.310
Batch: 15/29	Loss: 0.296
Batch: 17/29	Loss: 0.348
Batch: 19/29	Loss: 0.333
Batch: 21/29	Loss: 0.289
Batch: 23/29	Loss: 0.270
Batch: 25/29	Loss: 0.281
Batch: 27/29	Loss: 0.241
Batch: 29/29	Loss: 0.232
Epoch: 23	Train Loss: 0.309	Val F1: 0.363
Best Epoch: 16	Best Val F1: 0.366

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.281
Batch: 3/29	Loss: 0.253
Batch: 5/29	Loss: 0.337
Batch: 7/29	Loss: 0.322
Batch: 9/29	Loss: 0.339
Batch: 11/29	Loss: 0.395
Batch: 13/29	Loss: 0.249
Batch: 15/29	Loss: 0.301
Batch: 17/29	Loss: 0.273
Batch: 19/29	Loss: 0.347
Batch: 21/29	Loss: 0.339
Batch: 23/29	Loss: 0.262
Batch: 25/29	Loss: 0.318
Batch: 27/29	Loss: 0.262
Batch: 29/29	Loss: 0.256
Epoch: 24	Train Loss: 0.295	Val F1: 0.365
Best Epoch: 16	Best Val F1: 0.366

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.298
Batch: 3/29	Loss: 0.332
Batch: 5/29	Loss: 0.329
Batch: 7/29	Loss: 0.345
Batch: 9/29	Loss: 0.370
Batch: 11/29	Loss: 0.310
Batch: 13/29	Loss: 0.332
Batch: 15/29	Loss: 0.328
Batch: 17/29	Loss: 0.301
Batch: 19/29	Loss: 0.240
Batch: 21/29	Loss: 0.284
Batch: 23/29	Loss: 0.329
Batch: 25/29	Loss: 0.286
Batch: 27/29	Loss: 0.314
Batch: 29/29	Loss: 0.254
Epoch: 25	Train Loss: 0.290	Val F1: 0.361
Best Epoch: 16	Best Val F1: 0.366

Saving the best checkpoint....
Inference...
Test F1: 0.370	Test F1_Few: 0.450	Test F1_Zero: 0.357
Starting training with config: {'batch_size': 16, 'epochs': 75, 'l2_reg': 0.0008098608845559173, 'lr': 3.1931540110186844e-05, 'n_layers_freeze': 6, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 0.947
Batch: 23/116	Loss: 0.881
Batch: 34/116	Loss: 0.862
Batch: 45/116	Loss: 0.814
Batch: 56/116	Loss: 0.819
Batch: 67/116	Loss: 0.754
Batch: 78/116	Loss: 0.763
Batch: 89/116	Loss: 0.877
Batch: 100/116	Loss: 0.734
Batch: 111/116	Loss: 0.786
Batch: 116/116	Loss: 0.711
Epoch: 1	Train Loss: 0.832	Val F1: 0.222
Best Epoch: 1	Best Val F1: 0.222

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.833
Batch: 12/116	Loss: 0.766
Batch: 23/116	Loss: 0.710
Batch: 34/116	Loss: 0.728
Batch: 45/116	Loss: 0.771
Batch: 56/116	Loss: 0.706
Batch: 67/116	Loss: 0.720
Batch: 78/116	Loss: 0.761
Batch: 89/116	Loss: 0.653
Batch: 100/116	Loss: 0.688
Batch: 111/116	Loss: 0.678
Batch: 116/116	Loss: 0.658
Epoch: 2	Train Loss: 0.737	Val F1: 0.313
Best Epoch: 2	Best Val F1: 0.313

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.612
Batch: 12/116	Loss: 0.548
Batch: 23/116	Loss: 0.661
Batch: 34/116	Loss: 0.747
Batch: 45/116	Loss: 0.780
Batch: 56/116	Loss: 0.702
Batch: 67/116	Loss: 0.619
Batch: 78/116	Loss: 0.692
Batch: 89/116	Loss: 0.727
Batch: 100/116	Loss: 0.806
Batch: 111/116	Loss: 0.737
Batch: 116/116	Loss: 0.711
Epoch: 3	Train Loss: 0.683	Val F1: 0.318
Best Epoch: 3	Best Val F1: 0.318

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.684
Batch: 12/116	Loss: 0.514
Batch: 23/116	Loss: 0.754
Batch: 34/116	Loss: 0.519
Batch: 45/116	Loss: 0.709
Batch: 56/116	Loss: 0.659
Batch: 67/116	Loss: 0.797
Batch: 78/116	Loss: 0.488
Batch: 89/116	Loss: 0.649
Batch: 100/116	Loss: 0.580
Batch: 111/116	Loss: 0.626
Batch: 116/116	Loss: 0.663
Epoch: 4	Train Loss: 0.632	Val F1: 0.311
Best Epoch: 3	Best Val F1: 0.318

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.408
Batch: 12/116	Loss: 0.560
Batch: 23/116	Loss: 0.500
Batch: 34/116	Loss: 0.576
Batch: 45/116	Loss: 0.609
Batch: 56/116	Loss: 0.614
Batch: 67/116	Loss: 0.574
Batch: 78/116	Loss: 0.638
Batch: 89/116	Loss: 0.720
Batch: 100/116	Loss: 0.649
Batch: 111/116	Loss: 0.554
Batch: 116/116	Loss: 0.443
Epoch: 5	Train Loss: 0.588	Val F1: 0.332
Best Epoch: 5	Best Val F1: 0.332

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.566
Batch: 12/116	Loss: 0.752
Batch: 23/116	Loss: 0.502
Batch: 34/116	Loss: 0.527
Batch: 45/116	Loss: 0.470
Batch: 56/116	Loss: 0.468
Batch: 67/116	Loss: 0.537
Batch: 78/116	Loss: 0.731
Batch: 89/116	Loss: 0.718
Batch: 100/116	Loss: 0.577
Batch: 111/116	Loss: 0.586
Batch: 116/116	Loss: 0.395
Epoch: 6	Train Loss: 0.523	Val F1: 0.346
Best Epoch: 6	Best Val F1: 0.346

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.374
Batch: 12/116	Loss: 0.669
Batch: 23/116	Loss: 0.442
Batch: 34/116	Loss: 0.660
Batch: 45/116	Loss: 0.334
Batch: 56/116	Loss: 0.752
Batch: 67/116	Loss: 0.496
Batch: 78/116	Loss: 0.501
Batch: 89/116	Loss: 0.373
Batch: 100/116	Loss: 0.300
Batch: 111/116	Loss: 0.802
Batch: 116/116	Loss: 0.285
Epoch: 7	Train Loss: 0.458	Val F1: 0.336
Best Epoch: 6	Best Val F1: 0.346

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.427
Batch: 12/116	Loss: 0.427
Batch: 23/116	Loss: 0.209
Batch: 34/116	Loss: 0.344
Batch: 45/116	Loss: 0.291
Batch: 56/116	Loss: 0.289
Batch: 67/116	Loss: 0.649
Batch: 78/116	Loss: 0.297
Batch: 89/116	Loss: 0.225
Batch: 100/116	Loss: 0.583
Batch: 111/116	Loss: 0.348
Batch: 116/116	Loss: 0.375
Epoch: 8	Train Loss: 0.403	Val F1: 0.316
Best Epoch: 6	Best Val F1: 0.346

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.218
Batch: 12/116	Loss: 0.330
Batch: 23/116	Loss: 0.330
Batch: 34/116	Loss: 0.297
Batch: 45/116	Loss: 0.317
Batch: 56/116	Loss: 0.481
Batch: 67/116	Loss: 0.341
Batch: 78/116	Loss: 0.235
Batch: 89/116	Loss: 0.193
Batch: 100/116	Loss: 0.268
Batch: 111/116	Loss: 0.337
Batch: 116/116	Loss: 0.486
Epoch: 9	Train Loss: 0.346	Val F1: 0.335
Best Epoch: 6	Best Val F1: 0.346

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.338
Batch: 12/116	Loss: 0.314
Batch: 23/116	Loss: 0.208
Batch: 34/116	Loss: 0.341
Batch: 45/116	Loss: 0.171
Batch: 56/116	Loss: 0.396
Batch: 67/116	Loss: 0.413
Batch: 78/116	Loss: 0.270
Batch: 89/116	Loss: 0.222
Batch: 100/116	Loss: 0.430
Batch: 111/116	Loss: 0.191
Batch: 116/116	Loss: 0.223
Epoch: 10	Train Loss: 0.312	Val F1: 0.317
Best Epoch: 6	Best Val F1: 0.346

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.292
Batch: 12/116	Loss: 0.145
Batch: 23/116	Loss: 0.130
Batch: 34/116	Loss: 0.226
Batch: 45/116	Loss: 0.355
Batch: 56/116	Loss: 0.321
Batch: 67/116	Loss: 0.243
Batch: 78/116	Loss: 0.156
Batch: 89/116	Loss: 0.117
Batch: 100/116	Loss: 0.205
Batch: 111/116	Loss: 0.390
Batch: 116/116	Loss: 0.071
Epoch: 11	Train Loss: 0.266	Val F1: 0.341
Best Epoch: 6	Best Val F1: 0.346

****************************** Epoch: 12 ******************************
Batch: 1/116	Loss: 0.290
Batch: 12/116	Loss: 0.211
Batch: 23/116	Loss: 0.127
Batch: 34/116	Loss: 0.205
Batch: 45/116	Loss: 0.164
Batch: 56/116	Loss: 0.236
Batch: 67/116	Loss: 0.107
Batch: 78/116	Loss: 0.232
Batch: 89/116	Loss: 0.183
Batch: 100/116	Loss: 0.189
Batch: 111/116	Loss: 0.167
Batch: 116/116	Loss: 0.078
Epoch: 12	Train Loss: 0.218	Val F1: 0.319
Best Epoch: 6	Best Val F1: 0.346

****************************** Epoch: 13 ******************************
Batch: 1/116	Loss: 0.115
Batch: 12/116	Loss: 0.115
Batch: 23/116	Loss: 0.235
Batch: 34/116	Loss: 0.097
Batch: 45/116	Loss: 0.339
Batch: 56/116	Loss: 0.274
Batch: 67/116	Loss: 0.151
Batch: 78/116	Loss: 0.297
Batch: 89/116	Loss: 0.207
Batch: 100/116	Loss: 0.201
Batch: 111/116	Loss: 0.199
Batch: 116/116	Loss: 0.162
Epoch: 13	Train Loss: 0.188	Val F1: 0.329
Best Epoch: 6	Best Val F1: 0.346

****************************** Epoch: 14 ******************************
Batch: 1/116	Loss: 0.293
Batch: 12/116	Loss: 0.175
Batch: 23/116	Loss: 0.155
Batch: 34/116	Loss: 0.102
Batch: 45/116	Loss: 0.174
Batch: 56/116	Loss: 0.112
Batch: 67/116	Loss: 0.182
Batch: 78/116	Loss: 0.171
Batch: 89/116	Loss: 0.084
Batch: 100/116	Loss: 0.159
Batch: 111/116	Loss: 0.078
Batch: 116/116	Loss: 0.287
Epoch: 14	Train Loss: 0.144	Val F1: 0.328
Best Epoch: 6	Best Val F1: 0.346

****************************** Epoch: 15 ******************************
Batch: 1/116	Loss: 0.074
Batch: 12/116	Loss: 0.396
Batch: 23/116	Loss: 0.049
Batch: 34/116	Loss: 0.130
Batch: 45/116	Loss: 0.254
Batch: 56/116	Loss: 0.099
Batch: 67/116	Loss: 0.212
Batch: 78/116	Loss: 0.066
Batch: 89/116	Loss: 0.129
Batch: 100/116	Loss: 0.091
Batch: 111/116	Loss: 0.049
Batch: 116/116	Loss: 0.022
Epoch: 15	Train Loss: 0.118	Val F1: 0.325
Best Epoch: 6	Best Val F1: 0.346

****************************** Epoch: 16 ******************************
Batch: 1/116	Loss: 0.130
Batch: 12/116	Loss: 0.022
Batch: 23/116	Loss: 0.063
Batch: 34/116	Loss: 0.155
Batch: 45/116	Loss: 0.135
Batch: 56/116	Loss: 0.191
Batch: 67/116	Loss: 0.074
Batch: 78/116	Loss: 0.070
Batch: 89/116	Loss: 0.108
Batch: 100/116	Loss: 0.166
Batch: 111/116	Loss: 0.048
Batch: 116/116	Loss: 0.097
Epoch: 16	Train Loss: 0.090	Val F1: 0.328
Best Epoch: 6	Best Val F1: 0.346

****************************** Epoch: 17 ******************************
Batch: 1/116	Loss: 0.030
Batch: 12/116	Loss: 0.033
Batch: 23/116	Loss: 0.059
Batch: 34/116	Loss: 0.053
Batch: 45/116	Loss: 0.065
Batch: 56/116	Loss: 0.068
Batch: 67/116	Loss: 0.154
Batch: 78/116	Loss: 0.055
Batch: 89/116	Loss: 0.049
Batch: 100/116	Loss: 0.035
Batch: 111/116	Loss: 0.174
Batch: 116/116	Loss: 0.067
Epoch: 17	Train Loss: 0.076	Val F1: 0.325
Best Epoch: 6	Best Val F1: 0.346

****************************** Epoch: 18 ******************************
Batch: 1/116	Loss: 0.102
Batch: 12/116	Loss: 0.043
Batch: 23/116	Loss: 0.042
Batch: 34/116	Loss: 0.121
Batch: 45/116	Loss: 0.025
Batch: 56/116	Loss: 0.096
Batch: 67/116	Loss: 0.045
Batch: 78/116	Loss: 0.113
Batch: 89/116	Loss: 0.038
Batch: 100/116	Loss: 0.044
Batch: 111/116	Loss: 0.049
Batch: 116/116	Loss: 0.085
Epoch: 18	Train Loss: 0.065	Val F1: 0.332
Best Epoch: 6	Best Val F1: 0.346

****************************** Epoch: 19 ******************************
Batch: 1/116	Loss: 0.019
Batch: 12/116	Loss: 0.027
Batch: 23/116	Loss: 0.078
Batch: 34/116	Loss: 0.017
Batch: 45/116	Loss: 0.052
Batch: 56/116	Loss: 0.069
Batch: 67/116	Loss: 0.067
Batch: 78/116	Loss: 0.057
Batch: 89/116	Loss: 0.060
Batch: 100/116	Loss: 0.098
Batch: 111/116	Loss: 0.027
Batch: 116/116	Loss: 0.093
Epoch: 19	Train Loss: 0.049	Val F1: 0.328
Best Epoch: 6	Best Val F1: 0.346

****************************** Epoch: 20 ******************************
Batch: 1/116	Loss: 0.044
Batch: 12/116	Loss: 0.049
Batch: 23/116	Loss: 0.023
Batch: 34/116	Loss: 0.028
Batch: 45/116	Loss: 0.017
Batch: 56/116	Loss: 0.067
Batch: 67/116	Loss: 0.028
Batch: 78/116	Loss: 0.017
Batch: 89/116	Loss: 0.030
Batch: 100/116	Loss: 0.016
Batch: 111/116	Loss: 0.026
Batch: 116/116	Loss: 0.066
Epoch: 20	Train Loss: 0.040	Val F1: 0.316
Best Epoch: 6	Best Val F1: 0.346

****************************** Epoch: 21 ******************************
Batch: 1/116	Loss: 0.061
Batch: 12/116	Loss: 0.007
Batch: 23/116	Loss: 0.060
Batch: 34/116	Loss: 0.034
Batch: 45/116	Loss: 0.026
Batch: 56/116	Loss: 0.018
Batch: 67/116	Loss: 0.010
Batch: 78/116	Loss: 0.025
Batch: 89/116	Loss: 0.039
Batch: 100/116	Loss: 0.025
Batch: 111/116	Loss: 0.006
Batch: 116/116	Loss: 0.022
Epoch: 21	Train Loss: 0.034	Val F1: 0.333
Best Epoch: 6	Best Val F1: 0.346

Saving the best checkpoint....
Inference...
Test F1: 0.389	Test F1_Few: 0.458	Test F1_Zero: 0.388
Starting training with config: {'batch_size': 32, 'epochs': 50, 'l2_reg': 0.0008217086395838875, 'lr': 2.380564241288977e-05, 'n_layers_freeze': 3, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 1.023
Batch: 11/58	Loss: 0.952
Batch: 16/58	Loss: 0.886
Batch: 21/58	Loss: 0.898
Batch: 26/58	Loss: 0.888
Batch: 31/58	Loss: 0.854
Batch: 36/58	Loss: 0.882
Batch: 41/58	Loss: 0.827
Batch: 46/58	Loss: 0.808
Batch: 51/58	Loss: 0.795
Batch: 56/58	Loss: 0.802
Batch: 58/58	Loss: 0.809
Epoch: 1	Train Loss: 0.893	Val F1: 0.195
Best Epoch: 1	Best Val F1: 0.195

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.818
Batch: 6/58	Loss: 0.828
Batch: 11/58	Loss: 0.830
Batch: 16/58	Loss: 0.761
Batch: 21/58	Loss: 0.763
Batch: 26/58	Loss: 0.762
Batch: 31/58	Loss: 0.814
Batch: 36/58	Loss: 0.792
Batch: 41/58	Loss: 0.739
Batch: 46/58	Loss: 0.753
Batch: 51/58	Loss: 0.752
Batch: 56/58	Loss: 0.747
Batch: 58/58	Loss: 0.726
Epoch: 2	Train Loss: 0.781	Val F1: 0.341
Best Epoch: 2	Best Val F1: 0.341

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.693
Batch: 6/58	Loss: 0.662
Batch: 11/58	Loss: 0.774
Batch: 16/58	Loss: 0.682
Batch: 21/58	Loss: 0.705
Batch: 26/58	Loss: 0.699
Batch: 31/58	Loss: 0.871
Batch: 36/58	Loss: 0.756
Batch: 41/58	Loss: 0.620
Batch: 46/58	Loss: 0.636
Batch: 51/58	Loss: 0.723
Batch: 56/58	Loss: 0.795
Batch: 58/58	Loss: 0.735
Epoch: 3	Train Loss: 0.712	Val F1: 0.336
Best Epoch: 2	Best Val F1: 0.341

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.705
Batch: 6/58	Loss: 0.639
Batch: 11/58	Loss: 0.641
Batch: 16/58	Loss: 0.620
Batch: 21/58	Loss: 0.585
Batch: 26/58	Loss: 0.615
Batch: 31/58	Loss: 0.585
Batch: 36/58	Loss: 0.668
Batch: 41/58	Loss: 0.728
Batch: 46/58	Loss: 0.587
Batch: 51/58	Loss: 0.572
Batch: 56/58	Loss: 0.575
Batch: 58/58	Loss: 0.591
Epoch: 4	Train Loss: 0.662	Val F1: 0.342
Best Epoch: 4	Best Val F1: 0.342

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.543
Batch: 6/58	Loss: 0.548
Batch: 11/58	Loss: 0.635
Batch: 16/58	Loss: 0.580
Batch: 21/58	Loss: 0.477
Batch: 26/58	Loss: 0.473
Batch: 31/58	Loss: 0.734
Batch: 36/58	Loss: 0.646
Batch: 41/58	Loss: 0.605
Batch: 46/58	Loss: 0.623
Batch: 51/58	Loss: 0.850
Batch: 56/58	Loss: 0.700
Batch: 58/58	Loss: 0.777
Epoch: 5	Train Loss: 0.614	Val F1: 0.373
Best Epoch: 5	Best Val F1: 0.373

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.555
Batch: 6/58	Loss: 0.691
Batch: 11/58	Loss: 0.621
Batch: 16/58	Loss: 0.603
Batch: 21/58	Loss: 0.588
Batch: 26/58	Loss: 0.432
Batch: 31/58	Loss: 0.526
Batch: 36/58	Loss: 0.431
Batch: 41/58	Loss: 0.542
Batch: 46/58	Loss: 0.521
Batch: 51/58	Loss: 0.522
Batch: 56/58	Loss: 0.624
Batch: 58/58	Loss: 0.451
Epoch: 6	Train Loss: 0.556	Val F1: 0.358
Best Epoch: 5	Best Val F1: 0.373

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.358
Batch: 6/58	Loss: 0.596
Batch: 11/58	Loss: 0.607
Batch: 16/58	Loss: 0.405
Batch: 21/58	Loss: 0.442
Batch: 26/58	Loss: 0.494
Batch: 31/58	Loss: 0.537
Batch: 36/58	Loss: 0.479
Batch: 41/58	Loss: 0.500
Batch: 46/58	Loss: 0.439
Batch: 51/58	Loss: 0.482
Batch: 56/58	Loss: 0.540
Batch: 58/58	Loss: 0.352
Epoch: 7	Train Loss: 0.497	Val F1: 0.359
Best Epoch: 5	Best Val F1: 0.373

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.430
Batch: 6/58	Loss: 0.373
Batch: 11/58	Loss: 0.401
Batch: 16/58	Loss: 0.447
Batch: 21/58	Loss: 0.429
Batch: 26/58	Loss: 0.366
Batch: 31/58	Loss: 0.354
Batch: 36/58	Loss: 0.330
Batch: 41/58	Loss: 0.427
Batch: 46/58	Loss: 0.452
Batch: 51/58	Loss: 0.383
Batch: 56/58	Loss: 0.396
Batch: 58/58	Loss: 0.440
Epoch: 8	Train Loss: 0.437	Val F1: 0.346
Best Epoch: 5	Best Val F1: 0.373

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.462
Batch: 6/58	Loss: 0.519
Batch: 11/58	Loss: 0.460
Batch: 16/58	Loss: 0.300
Batch: 21/58	Loss: 0.355
Batch: 26/58	Loss: 0.306
Batch: 31/58	Loss: 0.347
Batch: 36/58	Loss: 0.355
Batch: 41/58	Loss: 0.421
Batch: 46/58	Loss: 0.374
Batch: 51/58	Loss: 0.498
Batch: 56/58	Loss: 0.291
Batch: 58/58	Loss: 0.361
Epoch: 9	Train Loss: 0.390	Val F1: 0.362
Best Epoch: 5	Best Val F1: 0.373

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.327
Batch: 6/58	Loss: 0.312
Batch: 11/58	Loss: 0.407
Batch: 16/58	Loss: 0.442
Batch: 21/58	Loss: 0.284
Batch: 26/58	Loss: 0.400
Batch: 31/58	Loss: 0.264
Batch: 36/58	Loss: 0.570
Batch: 41/58	Loss: 0.464
Batch: 46/58	Loss: 0.426
Batch: 51/58	Loss: 0.345
Batch: 56/58	Loss: 0.320
Batch: 58/58	Loss: 0.418
Epoch: 10	Train Loss: 0.363	Val F1: 0.339
Best Epoch: 5	Best Val F1: 0.373

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.361
Batch: 6/58	Loss: 0.308
Batch: 11/58	Loss: 0.232
Batch: 16/58	Loss: 0.368
Batch: 21/58	Loss: 0.324
Batch: 26/58	Loss: 0.395
Batch: 31/58	Loss: 0.353
Batch: 36/58	Loss: 0.370
Batch: 41/58	Loss: 0.241
Batch: 46/58	Loss: 0.288
Batch: 51/58	Loss: 0.357
Batch: 56/58	Loss: 0.349
Batch: 58/58	Loss: 0.357
Epoch: 11	Train Loss: 0.337	Val F1: 0.346
Best Epoch: 5	Best Val F1: 0.373

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.408
Batch: 6/58	Loss: 0.244
Batch: 11/58	Loss: 0.293
Batch: 16/58	Loss: 0.294
Batch: 21/58	Loss: 0.383
Batch: 26/58	Loss: 0.309
Batch: 31/58	Loss: 0.405
Batch: 36/58	Loss: 0.346
Batch: 41/58	Loss: 0.312
Batch: 46/58	Loss: 0.312
Batch: 51/58	Loss: 0.472
Batch: 56/58	Loss: 0.248
Batch: 58/58	Loss: 0.143
Epoch: 12	Train Loss: 0.312	Val F1: 0.350
Best Epoch: 5	Best Val F1: 0.373

****************************** Epoch: 13 ******************************
Batch: 1/58	Loss: 0.291
Batch: 6/58	Loss: 0.269
Batch: 11/58	Loss: 0.370
Batch: 16/58	Loss: 0.264
Batch: 21/58	Loss: 0.324
Batch: 26/58	Loss: 0.271
Batch: 31/58	Loss: 0.252
Batch: 36/58	Loss: 0.268
Batch: 41/58	Loss: 0.236
Batch: 46/58	Loss: 0.265
Batch: 51/58	Loss: 0.211
Batch: 56/58	Loss: 0.331
Batch: 58/58	Loss: 0.165
Epoch: 13	Train Loss: 0.291	Val F1: 0.340
Best Epoch: 5	Best Val F1: 0.373

****************************** Epoch: 14 ******************************
Batch: 1/58	Loss: 0.364
Batch: 6/58	Loss: 0.373
Batch: 11/58	Loss: 0.329
Batch: 16/58	Loss: 0.279
Batch: 21/58	Loss: 0.273
Batch: 26/58	Loss: 0.299
Batch: 31/58	Loss: 0.287
Batch: 36/58	Loss: 0.282
Batch: 41/58	Loss: 0.129
Batch: 46/58	Loss: 0.224
Batch: 51/58	Loss: 0.342
Batch: 56/58	Loss: 0.227
Batch: 58/58	Loss: 0.284
Epoch: 14	Train Loss: 0.278	Val F1: 0.348
Best Epoch: 5	Best Val F1: 0.373

****************************** Epoch: 15 ******************************
Batch: 1/58	Loss: 0.225
Batch: 6/58	Loss: 0.319
Batch: 11/58	Loss: 0.217
Batch: 16/58	Loss: 0.207
Batch: 21/58	Loss: 0.415
Batch: 26/58	Loss: 0.245
Batch: 31/58	Loss: 0.227
Batch: 36/58	Loss: 0.258
Batch: 41/58	Loss: 0.347
Batch: 46/58	Loss: 0.185
Batch: 51/58	Loss: 0.233
Batch: 56/58	Loss: 0.199
Batch: 58/58	Loss: 0.251
Epoch: 15	Train Loss: 0.252	Val F1: 0.367
Best Epoch: 5	Best Val F1: 0.373

****************************** Epoch: 16 ******************************
Batch: 1/58	Loss: 0.253
Batch: 6/58	Loss: 0.173
Batch: 11/58	Loss: 0.110
Batch: 16/58	Loss: 0.177
Batch: 21/58	Loss: 0.130
Batch: 26/58	Loss: 0.219
Batch: 31/58	Loss: 0.193
Batch: 36/58	Loss: 0.207
Batch: 41/58	Loss: 0.181
Batch: 46/58	Loss: 0.212
Batch: 51/58	Loss: 0.206
Batch: 56/58	Loss: 0.170
Batch: 58/58	Loss: 0.191
Epoch: 16	Train Loss: 0.233	Val F1: 0.355
Best Epoch: 5	Best Val F1: 0.373

****************************** Epoch: 17 ******************************
Batch: 1/58	Loss: 0.163
Batch: 6/58	Loss: 0.237
Batch: 11/58	Loss: 0.226
Batch: 16/58	Loss: 0.182
Batch: 21/58	Loss: 0.188
Batch: 26/58	Loss: 0.248
Batch: 31/58	Loss: 0.155
Batch: 36/58	Loss: 0.160
Batch: 41/58	Loss: 0.222
Batch: 46/58	Loss: 0.309
Batch: 51/58	Loss: 0.108
Batch: 56/58	Loss: 0.154
Batch: 58/58	Loss: 0.190
Epoch: 17	Train Loss: 0.195	Val F1: 0.343
Best Epoch: 5	Best Val F1: 0.373

****************************** Epoch: 18 ******************************
Batch: 1/58	Loss: 0.176
Batch: 6/58	Loss: 0.249
Batch: 11/58	Loss: 0.153
Batch: 16/58	Loss: 0.174
Batch: 21/58	Loss: 0.115
Batch: 26/58	Loss: 0.188
Batch: 31/58	Loss: 0.113
Batch: 36/58	Loss: 0.175
Batch: 41/58	Loss: 0.130
Batch: 46/58	Loss: 0.265
Batch: 51/58	Loss: 0.097
Batch: 56/58	Loss: 0.135
Batch: 58/58	Loss: 0.163
Epoch: 18	Train Loss: 0.160	Val F1: 0.341
Best Epoch: 5	Best Val F1: 0.373

****************************** Epoch: 19 ******************************
Batch: 1/58	Loss: 0.129
Batch: 6/58	Loss: 0.176
Batch: 11/58	Loss: 0.122
Batch: 16/58	Loss: 0.054
Batch: 21/58	Loss: 0.208
Batch: 26/58	Loss: 0.117
Batch: 31/58	Loss: 0.095
Batch: 36/58	Loss: 0.067
Batch: 41/58	Loss: 0.062
Batch: 46/58	Loss: 0.113
Batch: 51/58	Loss: 0.100
Batch: 56/58	Loss: 0.100
Batch: 58/58	Loss: 0.059
Epoch: 19	Train Loss: 0.128	Val F1: 0.364
Best Epoch: 5	Best Val F1: 0.373

****************************** Epoch: 20 ******************************
Batch: 1/58	Loss: 0.123
Batch: 6/58	Loss: 0.100
Batch: 11/58	Loss: 0.067
Batch: 16/58	Loss: 0.162
Batch: 21/58	Loss: 0.078
Batch: 26/58	Loss: 0.092
Batch: 31/58	Loss: 0.178
Batch: 36/58	Loss: 0.108
Batch: 41/58	Loss: 0.051
Batch: 46/58	Loss: 0.168
Batch: 51/58	Loss: 0.120
Batch: 56/58	Loss: 0.086
Batch: 58/58	Loss: 0.194
Epoch: 20	Train Loss: 0.120	Val F1: 0.360
Best Epoch: 5	Best Val F1: 0.373

Saving the best checkpoint....
Inference...
Test F1: 0.384	Test F1_Few: 0.464	Test F1_Zero: 0.376
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0008494522839080882, 'lr': 1.7851224816951143e-05, 'n_layers_freeze': 2, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.071
Batch: 5/29	Loss: 1.040
Batch: 7/29	Loss: 1.019
Batch: 9/29	Loss: 0.994
Batch: 11/29	Loss: 0.978
Batch: 13/29	Loss: 0.964
Batch: 15/29	Loss: 0.967
Batch: 17/29	Loss: 0.928
Batch: 19/29	Loss: 0.925
Batch: 21/29	Loss: 0.907
Batch: 23/29	Loss: 0.912
Batch: 25/29	Loss: 0.880
Batch: 27/29	Loss: 0.876
Batch: 29/29	Loss: 0.883
Epoch: 1	Train Loss: 0.961	Val F1: 0.186
Best Epoch: 1	Best Val F1: 0.186

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.875
Batch: 3/29	Loss: 0.873
Batch: 5/29	Loss: 0.900
Batch: 7/29	Loss: 0.861
Batch: 9/29	Loss: 0.875
Batch: 11/29	Loss: 0.833
Batch: 13/29	Loss: 0.832
Batch: 15/29	Loss: 0.854
Batch: 17/29	Loss: 0.843
Batch: 19/29	Loss: 0.874
Batch: 21/29	Loss: 0.829
Batch: 23/29	Loss: 0.836
Batch: 25/29	Loss: 0.814
Batch: 27/29	Loss: 0.871
Batch: 29/29	Loss: 0.816
Epoch: 2	Train Loss: 0.849	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.186

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.806
Batch: 3/29	Loss: 0.825
Batch: 5/29	Loss: 0.813
Batch: 7/29	Loss: 0.843
Batch: 9/29	Loss: 0.796
Batch: 11/29	Loss: 0.796
Batch: 13/29	Loss: 0.835
Batch: 15/29	Loss: 0.804
Batch: 17/29	Loss: 0.820
Batch: 19/29	Loss: 0.814
Batch: 21/29	Loss: 0.791
Batch: 23/29	Loss: 0.784
Batch: 25/29	Loss: 0.804
Batch: 27/29	Loss: 0.777
Batch: 29/29	Loss: 0.789
Epoch: 3	Train Loss: 0.808	Val F1: 0.254
Best Epoch: 3	Best Val F1: 0.254

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.768
Batch: 3/29	Loss: 0.782
Batch: 5/29	Loss: 0.759
Batch: 7/29	Loss: 0.819
Batch: 9/29	Loss: 0.793
Batch: 11/29	Loss: 0.744
Batch: 13/29	Loss: 0.754
Batch: 15/29	Loss: 0.743
Batch: 17/29	Loss: 0.748
Batch: 19/29	Loss: 0.776
Batch: 21/29	Loss: 0.769
Batch: 23/29	Loss: 0.770
Batch: 25/29	Loss: 0.747
Batch: 27/29	Loss: 0.779
Batch: 29/29	Loss: 0.752
Epoch: 4	Train Loss: 0.772	Val F1: 0.247
Best Epoch: 3	Best Val F1: 0.254

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.734
Batch: 3/29	Loss: 0.743
Batch: 5/29	Loss: 0.698
Batch: 7/29	Loss: 0.730
Batch: 9/29	Loss: 0.697
Batch: 11/29	Loss: 0.724
Batch: 13/29	Loss: 0.681
Batch: 15/29	Loss: 0.727
Batch: 17/29	Loss: 0.759
Batch: 19/29	Loss: 0.750
Batch: 21/29	Loss: 0.699
Batch: 23/29	Loss: 0.726
Batch: 25/29	Loss: 0.736
Batch: 27/29	Loss: 0.701
Batch: 29/29	Loss: 0.728
Epoch: 5	Train Loss: 0.732	Val F1: 0.307
Best Epoch: 5	Best Val F1: 0.307

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.728
Batch: 3/29	Loss: 0.786
Batch: 5/29	Loss: 0.644
Batch: 7/29	Loss: 0.776
Batch: 9/29	Loss: 0.687
Batch: 11/29	Loss: 0.656
Batch: 13/29	Loss: 0.714
Batch: 15/29	Loss: 0.673
Batch: 17/29	Loss: 0.660
Batch: 19/29	Loss: 0.630
Batch: 21/29	Loss: 0.735
Batch: 23/29	Loss: 0.668
Batch: 25/29	Loss: 0.714
Batch: 27/29	Loss: 0.671
Batch: 29/29	Loss: 0.653
Epoch: 6	Train Loss: 0.696	Val F1: 0.341
Best Epoch: 6	Best Val F1: 0.341

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.636
Batch: 3/29	Loss: 0.718
Batch: 5/29	Loss: 0.750
Batch: 7/29	Loss: 0.689
Batch: 9/29	Loss: 0.681
Batch: 11/29	Loss: 0.598
Batch: 13/29	Loss: 0.639
Batch: 15/29	Loss: 0.600
Batch: 17/29	Loss: 0.677
Batch: 19/29	Loss: 0.687
Batch: 21/29	Loss: 0.625
Batch: 23/29	Loss: 0.622
Batch: 25/29	Loss: 0.577
Batch: 27/29	Loss: 0.633
Batch: 29/29	Loss: 0.633
Epoch: 7	Train Loss: 0.648	Val F1: 0.323
Best Epoch: 6	Best Val F1: 0.341

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.683
Batch: 3/29	Loss: 0.584
Batch: 5/29	Loss: 0.646
Batch: 7/29	Loss: 0.614
Batch: 9/29	Loss: 0.629
Batch: 11/29	Loss: 0.626
Batch: 13/29	Loss: 0.679
Batch: 15/29	Loss: 0.565
Batch: 17/29	Loss: 0.624
Batch: 19/29	Loss: 0.607
Batch: 21/29	Loss: 0.626
Batch: 23/29	Loss: 0.627
Batch: 25/29	Loss: 0.718
Batch: 27/29	Loss: 0.611
Batch: 29/29	Loss: 0.604
Epoch: 8	Train Loss: 0.618	Val F1: 0.348
Best Epoch: 8	Best Val F1: 0.348

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.625
Batch: 3/29	Loss: 0.571
Batch: 5/29	Loss: 0.601
Batch: 7/29	Loss: 0.521
Batch: 9/29	Loss: 0.636
Batch: 11/29	Loss: 0.623
Batch: 13/29	Loss: 0.621
Batch: 15/29	Loss: 0.537
Batch: 17/29	Loss: 0.537
Batch: 19/29	Loss: 0.503
Batch: 21/29	Loss: 0.712
Batch: 23/29	Loss: 0.556
Batch: 25/29	Loss: 0.594
Batch: 27/29	Loss: 0.562
Batch: 29/29	Loss: 0.513
Epoch: 9	Train Loss: 0.581	Val F1: 0.329
Best Epoch: 8	Best Val F1: 0.348

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.477
Batch: 3/29	Loss: 0.573
Batch: 5/29	Loss: 0.562
Batch: 7/29	Loss: 0.512
Batch: 9/29	Loss: 0.535
Batch: 11/29	Loss: 0.440
Batch: 13/29	Loss: 0.658
Batch: 15/29	Loss: 0.592
Batch: 17/29	Loss: 0.631
Batch: 19/29	Loss: 0.400
Batch: 21/29	Loss: 0.596
Batch: 23/29	Loss: 0.552
Batch: 25/29	Loss: 0.598
Batch: 27/29	Loss: 0.491
Batch: 29/29	Loss: 0.575
Epoch: 10	Train Loss: 0.540	Val F1: 0.350
Best Epoch: 10	Best Val F1: 0.350

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.525
Batch: 3/29	Loss: 0.437
Batch: 5/29	Loss: 0.610
Batch: 7/29	Loss: 0.525
Batch: 9/29	Loss: 0.471
Batch: 11/29	Loss: 0.488
Batch: 13/29	Loss: 0.463
Batch: 15/29	Loss: 0.364
Batch: 17/29	Loss: 0.568
Batch: 19/29	Loss: 0.510
Batch: 21/29	Loss: 0.512
Batch: 23/29	Loss: 0.375
Batch: 25/29	Loss: 0.454
Batch: 27/29	Loss: 0.453
Batch: 29/29	Loss: 0.491
Epoch: 11	Train Loss: 0.497	Val F1: 0.322
Best Epoch: 10	Best Val F1: 0.350

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.578
Batch: 3/29	Loss: 0.399
Batch: 5/29	Loss: 0.482
Batch: 7/29	Loss: 0.436
Batch: 9/29	Loss: 0.468
Batch: 11/29	Loss: 0.484
Batch: 13/29	Loss: 0.437
Batch: 15/29	Loss: 0.467
Batch: 17/29	Loss: 0.482
Batch: 19/29	Loss: 0.417
Batch: 21/29	Loss: 0.413
Batch: 23/29	Loss: 0.476
Batch: 25/29	Loss: 0.455
Batch: 27/29	Loss: 0.526
Batch: 29/29	Loss: 0.332
Epoch: 12	Train Loss: 0.456	Val F1: 0.342
Best Epoch: 10	Best Val F1: 0.350

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.474
Batch: 3/29	Loss: 0.357
Batch: 5/29	Loss: 0.478
Batch: 7/29	Loss: 0.432
Batch: 9/29	Loss: 0.442
Batch: 11/29	Loss: 0.418
Batch: 13/29	Loss: 0.415
Batch: 15/29	Loss: 0.449
Batch: 17/29	Loss: 0.380
Batch: 19/29	Loss: 0.278
Batch: 21/29	Loss: 0.464
Batch: 23/29	Loss: 0.464
Batch: 25/29	Loss: 0.317
Batch: 27/29	Loss: 0.476
Batch: 29/29	Loss: 0.524
Epoch: 13	Train Loss: 0.435	Val F1: 0.342
Best Epoch: 10	Best Val F1: 0.350

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.462
Batch: 3/29	Loss: 0.434
Batch: 5/29	Loss: 0.333
Batch: 7/29	Loss: 0.424
Batch: 9/29	Loss: 0.489
Batch: 11/29	Loss: 0.426
Batch: 13/29	Loss: 0.419
Batch: 15/29	Loss: 0.318
Batch: 17/29	Loss: 0.472
Batch: 19/29	Loss: 0.442
Batch: 21/29	Loss: 0.291
Batch: 23/29	Loss: 0.329
Batch: 25/29	Loss: 0.434
Batch: 27/29	Loss: 0.377
Batch: 29/29	Loss: 0.430
Epoch: 14	Train Loss: 0.415	Val F1: 0.344
Best Epoch: 10	Best Val F1: 0.350

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.338
Batch: 3/29	Loss: 0.365
Batch: 5/29	Loss: 0.277
Batch: 7/29	Loss: 0.379
Batch: 9/29	Loss: 0.422
Batch: 11/29	Loss: 0.361
Batch: 13/29	Loss: 0.365
Batch: 15/29	Loss: 0.365
Batch: 17/29	Loss: 0.487
Batch: 19/29	Loss: 0.398
Batch: 21/29	Loss: 0.396
Batch: 23/29	Loss: 0.441
Batch: 25/29	Loss: 0.427
Batch: 27/29	Loss: 0.352
Batch: 29/29	Loss: 0.450
Epoch: 15	Train Loss: 0.389	Val F1: 0.343
Best Epoch: 10	Best Val F1: 0.350

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.406
Batch: 3/29	Loss: 0.379
Batch: 5/29	Loss: 0.410
Batch: 7/29	Loss: 0.331
Batch: 9/29	Loss: 0.380
Batch: 11/29	Loss: 0.367
Batch: 13/29	Loss: 0.352
Batch: 15/29	Loss: 0.290
Batch: 17/29	Loss: 0.372
Batch: 19/29	Loss: 0.423
Batch: 21/29	Loss: 0.315
Batch: 23/29	Loss: 0.393
Batch: 25/29	Loss: 0.402
Batch: 27/29	Loss: 0.334
Batch: 29/29	Loss: 0.369
Epoch: 16	Train Loss: 0.367	Val F1: 0.353
Best Epoch: 16	Best Val F1: 0.353

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.317
Batch: 3/29	Loss: 0.445
Batch: 5/29	Loss: 0.358
Batch: 7/29	Loss: 0.318
Batch: 9/29	Loss: 0.252
Batch: 11/29	Loss: 0.402
Batch: 13/29	Loss: 0.430
Batch: 15/29	Loss: 0.382
Batch: 17/29	Loss: 0.369
Batch: 19/29	Loss: 0.338
Batch: 21/29	Loss: 0.478
Batch: 23/29	Loss: 0.452
Batch: 25/29	Loss: 0.228
Batch: 27/29	Loss: 0.415
Batch: 29/29	Loss: 0.371
Epoch: 17	Train Loss: 0.361	Val F1: 0.346
Best Epoch: 16	Best Val F1: 0.353

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.366
Batch: 3/29	Loss: 0.394
Batch: 5/29	Loss: 0.313
Batch: 7/29	Loss: 0.295
Batch: 9/29	Loss: 0.453
Batch: 11/29	Loss: 0.297
Batch: 13/29	Loss: 0.259
Batch: 15/29	Loss: 0.376
Batch: 17/29	Loss: 0.315
Batch: 19/29	Loss: 0.306
Batch: 21/29	Loss: 0.355
Batch: 23/29	Loss: 0.386
Batch: 25/29	Loss: 0.359
Batch: 27/29	Loss: 0.272
Batch: 29/29	Loss: 0.372
Epoch: 18	Train Loss: 0.344	Val F1: 0.348
Best Epoch: 16	Best Val F1: 0.353

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.236
Batch: 3/29	Loss: 0.275
Batch: 5/29	Loss: 0.335
Batch: 7/29	Loss: 0.363
Batch: 9/29	Loss: 0.251
Batch: 11/29	Loss: 0.351
Batch: 13/29	Loss: 0.414
Batch: 15/29	Loss: 0.310
Batch: 17/29	Loss: 0.279
Batch: 19/29	Loss: 0.393
Batch: 21/29	Loss: 0.361
Batch: 23/29	Loss: 0.343
Batch: 25/29	Loss: 0.363
Batch: 27/29	Loss: 0.275
Batch: 29/29	Loss: 0.284
Epoch: 19	Train Loss: 0.328	Val F1: 0.350
Best Epoch: 16	Best Val F1: 0.353

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.350
Batch: 3/29	Loss: 0.338
Batch: 5/29	Loss: 0.279
Batch: 7/29	Loss: 0.244
Batch: 9/29	Loss: 0.345
Batch: 11/29	Loss: 0.352
Batch: 13/29	Loss: 0.337
Batch: 15/29	Loss: 0.287
Batch: 17/29	Loss: 0.389
Batch: 19/29	Loss: 0.291
Batch: 21/29	Loss: 0.301
Batch: 23/29	Loss: 0.331
Batch: 25/29	Loss: 0.303
Batch: 27/29	Loss: 0.311
Batch: 29/29	Loss: 0.420
Epoch: 20	Train Loss: 0.316	Val F1: 0.346
Best Epoch: 16	Best Val F1: 0.353

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.295
Batch: 3/29	Loss: 0.246
Batch: 5/29	Loss: 0.272
Batch: 7/29	Loss: 0.508
Batch: 9/29	Loss: 0.265
Batch: 11/29	Loss: 0.257
Batch: 13/29	Loss: 0.343
Batch: 15/29	Loss: 0.345
Batch: 17/29	Loss: 0.247
Batch: 19/29	Loss: 0.273
Batch: 21/29	Loss: 0.300
Batch: 23/29	Loss: 0.249
Batch: 25/29	Loss: 0.298
Batch: 27/29	Loss: 0.284
Batch: 29/29	Loss: 0.297
Epoch: 21	Train Loss: 0.305	Val F1: 0.343
Best Epoch: 16	Best Val F1: 0.353

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.285
Batch: 3/29	Loss: 0.258
Batch: 5/29	Loss: 0.306
Batch: 7/29	Loss: 0.337
Batch: 9/29	Loss: 0.267
Batch: 11/29	Loss: 0.279
Batch: 13/29	Loss: 0.258
Batch: 15/29	Loss: 0.241
Batch: 17/29	Loss: 0.345
Batch: 19/29	Loss: 0.328
Batch: 21/29	Loss: 0.359
Batch: 23/29	Loss: 0.281
Batch: 25/29	Loss: 0.270
Batch: 27/29	Loss: 0.239
Batch: 29/29	Loss: 0.244
Epoch: 22	Train Loss: 0.279	Val F1: 0.354
Best Epoch: 22	Best Val F1: 0.354

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.268
Batch: 3/29	Loss: 0.270
Batch: 5/29	Loss: 0.308
Batch: 7/29	Loss: 0.346
Batch: 9/29	Loss: 0.216
Batch: 11/29	Loss: 0.282
Batch: 13/29	Loss: 0.246
Batch: 15/29	Loss: 0.262
Batch: 17/29	Loss: 0.266
Batch: 19/29	Loss: 0.271
Batch: 21/29	Loss: 0.241
Batch: 23/29	Loss: 0.207
Batch: 25/29	Loss: 0.253
Batch: 27/29	Loss: 0.202
Batch: 29/29	Loss: 0.232
Epoch: 23	Train Loss: 0.260	Val F1: 0.355
Best Epoch: 23	Best Val F1: 0.355

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.206
Batch: 3/29	Loss: 0.238
Batch: 5/29	Loss: 0.284
Batch: 7/29	Loss: 0.263
Batch: 9/29	Loss: 0.290
Batch: 11/29	Loss: 0.288
Batch: 13/29	Loss: 0.207
Batch: 15/29	Loss: 0.248
Batch: 17/29	Loss: 0.273
Batch: 19/29	Loss: 0.281
Batch: 21/29	Loss: 0.309
Batch: 23/29	Loss: 0.225
Batch: 25/29	Loss: 0.259
Batch: 27/29	Loss: 0.220
Batch: 29/29	Loss: 0.286
Epoch: 24	Train Loss: 0.258	Val F1: 0.358
Best Epoch: 24	Best Val F1: 0.358

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.258
Batch: 3/29	Loss: 0.270
Batch: 5/29	Loss: 0.278
Batch: 7/29	Loss: 0.293
Batch: 9/29	Loss: 0.327
Batch: 11/29	Loss: 0.221
Batch: 13/29	Loss: 0.313
Batch: 15/29	Loss: 0.243
Batch: 17/29	Loss: 0.296
Batch: 19/29	Loss: 0.193
Batch: 21/29	Loss: 0.221
Batch: 23/29	Loss: 0.230
Batch: 25/29	Loss: 0.249
Batch: 27/29	Loss: 0.267
Batch: 29/29	Loss: 0.192
Epoch: 25	Train Loss: 0.240	Val F1: 0.355
Best Epoch: 24	Best Val F1: 0.358

****************************** Epoch: 26 ******************************
Batch: 1/29	Loss: 0.189
Batch: 3/29	Loss: 0.189
Batch: 5/29	Loss: 0.239
Batch: 7/29	Loss: 0.275
Batch: 9/29	Loss: 0.192
Batch: 11/29	Loss: 0.243
Batch: 13/29	Loss: 0.245
Batch: 15/29	Loss: 0.200
Batch: 17/29	Loss: 0.176
Batch: 19/29	Loss: 0.191
Batch: 21/29	Loss: 0.263
Batch: 23/29	Loss: 0.129
Batch: 25/29	Loss: 0.211
Batch: 27/29	Loss: 0.193
Batch: 29/29	Loss: 0.245
Epoch: 26	Train Loss: 0.216	Val F1: 0.352
Best Epoch: 24	Best Val F1: 0.358

****************************** Epoch: 27 ******************************
Batch: 1/29	Loss: 0.192
Batch: 3/29	Loss: 0.232
Batch: 5/29	Loss: 0.281
Batch: 7/29	Loss: 0.131
Batch: 9/29	Loss: 0.283
Batch: 11/29	Loss: 0.163
Batch: 13/29	Loss: 0.275
Batch: 15/29	Loss: 0.221
Batch: 17/29	Loss: 0.162
Batch: 19/29	Loss: 0.218
Batch: 21/29	Loss: 0.182
Batch: 23/29	Loss: 0.178
Batch: 25/29	Loss: 0.168
Batch: 27/29	Loss: 0.230
Batch: 29/29	Loss: 0.238
Epoch: 27	Train Loss: 0.197	Val F1: 0.395
Best Epoch: 27	Best Val F1: 0.395

****************************** Epoch: 28 ******************************
Batch: 1/29	Loss: 0.254
Batch: 3/29	Loss: 0.173
Batch: 5/29	Loss: 0.181
Batch: 7/29	Loss: 0.207
Batch: 9/29	Loss: 0.220
Batch: 11/29	Loss: 0.152
Batch: 13/29	Loss: 0.151
Batch: 15/29	Loss: 0.241
Batch: 17/29	Loss: 0.189
Batch: 19/29	Loss: 0.141
Batch: 21/29	Loss: 0.210
Batch: 23/29	Loss: 0.224
Batch: 25/29	Loss: 0.252
Batch: 27/29	Loss: 0.206
Batch: 29/29	Loss: 0.219
Epoch: 28	Train Loss: 0.199	Val F1: 0.359
Best Epoch: 27	Best Val F1: 0.395

****************************** Epoch: 29 ******************************
Batch: 1/29	Loss: 0.193
Batch: 3/29	Loss: 0.227
Batch: 5/29	Loss: 0.182
Batch: 7/29	Loss: 0.137
Batch: 9/29	Loss: 0.122
Batch: 11/29	Loss: 0.185
Batch: 13/29	Loss: 0.234
Batch: 15/29	Loss: 0.103
Batch: 17/29	Loss: 0.181
Batch: 19/29	Loss: 0.148
Batch: 21/29	Loss: 0.174
Batch: 23/29	Loss: 0.216
Batch: 25/29	Loss: 0.216
Batch: 27/29	Loss: 0.165
Batch: 29/29	Loss: 0.132
Epoch: 29	Train Loss: 0.174	Val F1: 0.355
Best Epoch: 27	Best Val F1: 0.395

****************************** Epoch: 30 ******************************
Batch: 1/29	Loss: 0.118
Batch: 3/29	Loss: 0.160
Batch: 5/29	Loss: 0.208
Batch: 7/29	Loss: 0.130
Batch: 9/29	Loss: 0.151
Batch: 11/29	Loss: 0.137
Batch: 13/29	Loss: 0.145
Batch: 15/29	Loss: 0.120
Batch: 17/29	Loss: 0.090
Batch: 19/29	Loss: 0.169
Batch: 21/29	Loss: 0.175
Batch: 23/29	Loss: 0.169
Batch: 25/29	Loss: 0.156
Batch: 27/29	Loss: 0.162
Batch: 29/29	Loss: 0.182
Epoch: 30	Train Loss: 0.160	Val F1: 0.351
Best Epoch: 27	Best Val F1: 0.395

****************************** Epoch: 31 ******************************
Batch: 1/29	Loss: 0.142
Batch: 3/29	Loss: 0.123
Batch: 5/29	Loss: 0.100
Batch: 7/29	Loss: 0.108
Batch: 9/29	Loss: 0.134
Batch: 11/29	Loss: 0.147
Batch: 13/29	Loss: 0.216
Batch: 15/29	Loss: 0.156
Batch: 17/29	Loss: 0.156
Batch: 19/29	Loss: 0.135
Batch: 21/29	Loss: 0.153
Batch: 23/29	Loss: 0.142
Batch: 25/29	Loss: 0.184
Batch: 27/29	Loss: 0.151
Batch: 29/29	Loss: 0.098
Epoch: 31	Train Loss: 0.139	Val F1: 0.347
Best Epoch: 27	Best Val F1: 0.395

****************************** Epoch: 32 ******************************
Batch: 1/29	Loss: 0.178
Batch: 3/29	Loss: 0.113
Batch: 5/29	Loss: 0.100
Batch: 7/29	Loss: 0.107
Batch: 9/29	Loss: 0.116
Batch: 11/29	Loss: 0.102
Batch: 13/29	Loss: 0.116
Batch: 15/29	Loss: 0.070
Batch: 17/29	Loss: 0.161
Batch: 19/29	Loss: 0.167
Batch: 21/29	Loss: 0.111
Batch: 23/29	Loss: 0.153
Batch: 25/29	Loss: 0.112
Batch: 27/29	Loss: 0.056
Batch: 29/29	Loss: 0.130
Epoch: 32	Train Loss: 0.128	Val F1: 0.354
Best Epoch: 27	Best Val F1: 0.395

****************************** Epoch: 33 ******************************
Batch: 1/29	Loss: 0.120
Batch: 3/29	Loss: 0.118
Batch: 5/29	Loss: 0.104
Batch: 7/29	Loss: 0.116
Batch: 9/29	Loss: 0.096
Batch: 11/29	Loss: 0.062
Batch: 13/29	Loss: 0.109
Batch: 15/29	Loss: 0.127
Batch: 17/29	Loss: 0.099
Batch: 19/29	Loss: 0.111
Batch: 21/29	Loss: 0.081
Batch: 23/29	Loss: 0.075
Batch: 25/29	Loss: 0.110
Batch: 27/29	Loss: 0.169
Batch: 29/29	Loss: 0.098
Epoch: 33	Train Loss: 0.109	Val F1: 0.367
Best Epoch: 27	Best Val F1: 0.395

****************************** Epoch: 34 ******************************
Batch: 1/29	Loss: 0.066
Batch: 3/29	Loss: 0.105
Batch: 5/29	Loss: 0.089
Batch: 7/29	Loss: 0.109
Batch: 9/29	Loss: 0.094
Batch: 11/29	Loss: 0.107
Batch: 13/29	Loss: 0.106
Batch: 15/29	Loss: 0.091
Batch: 17/29	Loss: 0.142
Batch: 19/29	Loss: 0.083
Batch: 21/29	Loss: 0.136
Batch: 23/29	Loss: 0.080
Batch: 25/29	Loss: 0.068
Batch: 27/29	Loss: 0.059
Batch: 29/29	Loss: 0.138
Epoch: 34	Train Loss: 0.105	Val F1: 0.354
Best Epoch: 27	Best Val F1: 0.395

****************************** Epoch: 35 ******************************
Batch: 1/29	Loss: 0.057
Batch: 3/29	Loss: 0.095
Batch: 5/29	Loss: 0.117
Batch: 7/29	Loss: 0.098
Batch: 9/29	Loss: 0.108
Batch: 11/29	Loss: 0.099
Batch: 13/29	Loss: 0.076
Batch: 15/29	Loss: 0.126
Batch: 17/29	Loss: 0.084
Batch: 19/29	Loss: 0.211
Batch: 21/29	Loss: 0.164
Batch: 23/29	Loss: 0.137
Batch: 25/29	Loss: 0.136
Batch: 27/29	Loss: 0.100
Batch: 29/29	Loss: 0.065
Epoch: 35	Train Loss: 0.111	Val F1: 0.345
Best Epoch: 27	Best Val F1: 0.395

****************************** Epoch: 36 ******************************
Batch: 1/29	Loss: 0.088
Batch: 3/29	Loss: 0.100
Batch: 5/29	Loss: 0.072
Batch: 7/29	Loss: 0.086
Batch: 9/29	Loss: 0.065
Batch: 11/29	Loss: 0.074
Batch: 13/29	Loss: 0.103
Batch: 15/29	Loss: 0.145
Batch: 17/29	Loss: 0.117
Batch: 19/29	Loss: 0.132
Batch: 21/29	Loss: 0.107
Batch: 23/29	Loss: 0.105
Batch: 25/29	Loss: 0.067
Batch: 27/29	Loss: 0.088
Batch: 29/29	Loss: 0.061
Epoch: 36	Train Loss: 0.094	Val F1: 0.343
Best Epoch: 27	Best Val F1: 0.395

****************************** Epoch: 37 ******************************
Batch: 1/29	Loss: 0.066
Batch: 3/29	Loss: 0.135
Batch: 5/29	Loss: 0.099
Batch: 7/29	Loss: 0.082
Batch: 9/29	Loss: 0.084
Batch: 11/29	Loss: 0.077
Batch: 13/29	Loss: 0.097
Batch: 15/29	Loss: 0.069
Batch: 17/29	Loss: 0.051
Batch: 19/29	Loss: 0.069
Batch: 21/29	Loss: 0.090
Batch: 23/29	Loss: 0.093
Batch: 25/29	Loss: 0.064
Batch: 27/29	Loss: 0.066
Batch: 29/29	Loss: 0.097
Epoch: 37	Train Loss: 0.083	Val F1: 0.353
Best Epoch: 27	Best Val F1: 0.395

****************************** Epoch: 38 ******************************
Batch: 1/29	Loss: 0.094
Batch: 3/29	Loss: 0.096
Batch: 5/29	Loss: 0.068
Batch: 7/29	Loss: 0.098
Batch: 9/29	Loss: 0.097
Batch: 11/29	Loss: 0.103
Batch: 13/29	Loss: 0.081
Batch: 15/29	Loss: 0.102
Batch: 17/29	Loss: 0.098
Batch: 19/29	Loss: 0.094
Batch: 21/29	Loss: 0.051
Batch: 23/29	Loss: 0.098
Batch: 25/29	Loss: 0.054
Batch: 27/29	Loss: 0.104
Batch: 29/29	Loss: 0.073
Epoch: 38	Train Loss: 0.086	Val F1: 0.350
Best Epoch: 27	Best Val F1: 0.395

****************************** Epoch: 39 ******************************
Batch: 1/29	Loss: 0.078
Batch: 3/29	Loss: 0.110
Batch: 5/29	Loss: 0.077
Batch: 7/29	Loss: 0.070
Batch: 9/29	Loss: 0.076
Batch: 11/29	Loss: 0.065
Batch: 13/29	Loss: 0.050
Batch: 15/29	Loss: 0.096
Batch: 17/29	Loss: 0.052
Batch: 19/29	Loss: 0.062
Batch: 21/29	Loss: 0.099
Batch: 23/29	Loss: 0.057
Batch: 25/29	Loss: 0.056
Batch: 27/29	Loss: 0.081
Batch: 29/29	Loss: 0.064
Epoch: 39	Train Loss: 0.078	Val F1: 0.339
Best Epoch: 27	Best Val F1: 0.395

****************************** Epoch: 40 ******************************
Batch: 1/29	Loss: 0.119
Batch: 3/29	Loss: 0.038
Batch: 5/29	Loss: 0.083
Batch: 7/29	Loss: 0.071
Batch: 9/29	Loss: 0.054
Batch: 11/29	Loss: 0.043
Batch: 13/29	Loss: 0.092
Batch: 15/29	Loss: 0.060
Batch: 17/29	Loss: 0.158
Batch: 19/29	Loss: 0.075
Batch: 21/29	Loss: 0.056
Batch: 23/29	Loss: 0.043
Batch: 25/29	Loss: 0.053
Batch: 27/29	Loss: 0.035
Batch: 29/29	Loss: 0.067
Epoch: 40	Train Loss: 0.068	Val F1: 0.346
Best Epoch: 27	Best Val F1: 0.395

****************************** Epoch: 41 ******************************
Batch: 1/29	Loss: 0.057
Batch: 3/29	Loss: 0.100
Batch: 5/29	Loss: 0.039
Batch: 7/29	Loss: 0.074
Batch: 9/29	Loss: 0.056
Batch: 11/29	Loss: 0.079
Batch: 13/29	Loss: 0.030
Batch: 15/29	Loss: 0.047
Batch: 17/29	Loss: 0.062
Batch: 19/29	Loss: 0.076
Batch: 21/29	Loss: 0.031
Batch: 23/29	Loss: 0.078
Batch: 25/29	Loss: 0.039
Batch: 27/29	Loss: 0.067
Batch: 29/29	Loss: 0.070
Epoch: 41	Train Loss: 0.061	Val F1: 0.343
Best Epoch: 27	Best Val F1: 0.395

****************************** Epoch: 42 ******************************
Batch: 1/29	Loss: 0.069
Batch: 3/29	Loss: 0.044
Batch: 5/29	Loss: 0.043
Batch: 7/29	Loss: 0.045
Batch: 9/29	Loss: 0.052
Batch: 11/29	Loss: 0.042
Batch: 13/29	Loss: 0.047
Batch: 15/29	Loss: 0.038
Batch: 17/29	Loss: 0.066
Batch: 19/29	Loss: 0.062
Batch: 21/29	Loss: 0.071
Batch: 23/29	Loss: 0.065
Batch: 25/29	Loss: 0.079
Batch: 27/29	Loss: 0.039
Batch: 29/29	Loss: 0.025
Epoch: 42	Train Loss: 0.052	Val F1: 0.347
Best Epoch: 27	Best Val F1: 0.395

Saving the best checkpoint....
Inference...
Test F1: 0.382	Test F1_Few: 0.403	Test F1_Zero: 0.363
Starting training with config: {'batch_size': 64, 'epochs': 25, 'l2_reg': 0.0008983771577242227, 'lr': 5.157806290079633e-06, 'n_layers_freeze': 1, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.090
Batch: 5/29	Loss: 1.082
Batch: 7/29	Loss: 1.074
Batch: 9/29	Loss: 1.068
Batch: 11/29	Loss: 1.058
Batch: 13/29	Loss: 1.050
Batch: 15/29	Loss: 1.050
Batch: 17/29	Loss: 1.029
Batch: 19/29	Loss: 1.024
Batch: 21/29	Loss: 1.013
Batch: 23/29	Loss: 1.009
Batch: 25/29	Loss: 0.995
Batch: 27/29	Loss: 0.983
Batch: 29/29	Loss: 0.984
Epoch: 1	Train Loss: 1.040	Val F1: 0.238
Best Epoch: 1	Best Val F1: 0.238

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.976
Batch: 3/29	Loss: 0.972
Batch: 5/29	Loss: 0.980
Batch: 7/29	Loss: 0.960
Batch: 9/29	Loss: 0.960
Batch: 11/29	Loss: 0.937
Batch: 13/29	Loss: 0.932
Batch: 15/29	Loss: 0.944
Batch: 17/29	Loss: 0.932
Batch: 19/29	Loss: 0.945
Batch: 21/29	Loss: 0.921
Batch: 23/29	Loss: 0.921
Batch: 25/29	Loss: 0.908
Batch: 27/29	Loss: 0.938
Batch: 29/29	Loss: 0.909
Epoch: 2	Train Loss: 0.940	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.238

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.902
Batch: 3/29	Loss: 0.907
Batch: 5/29	Loss: 0.903
Batch: 7/29	Loss: 0.916
Batch: 9/29	Loss: 0.889
Batch: 11/29	Loss: 0.888
Batch: 13/29	Loss: 0.911
Batch: 15/29	Loss: 0.887
Batch: 17/29	Loss: 0.897
Batch: 19/29	Loss: 0.894
Batch: 21/29	Loss: 0.880
Batch: 23/29	Loss: 0.877
Batch: 25/29	Loss: 0.886
Batch: 27/29	Loss: 0.870
Batch: 29/29	Loss: 0.875
Epoch: 3	Train Loss: 0.893	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.238

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.866
Batch: 3/29	Loss: 0.876
Batch: 5/29	Loss: 0.859
Batch: 7/29	Loss: 0.889
Batch: 9/29	Loss: 0.879
Batch: 11/29	Loss: 0.855
Batch: 13/29	Loss: 0.859
Batch: 15/29	Loss: 0.849
Batch: 17/29	Loss: 0.858
Batch: 19/29	Loss: 0.869
Batch: 21/29	Loss: 0.875
Batch: 23/29	Loss: 0.875
Batch: 25/29	Loss: 0.866
Batch: 27/29	Loss: 0.876
Batch: 29/29	Loss: 0.862
Epoch: 4	Train Loss: 0.867	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.238

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.852
Batch: 3/29	Loss: 0.849
Batch: 5/29	Loss: 0.842
Batch: 7/29	Loss: 0.838
Batch: 9/29	Loss: 0.836
Batch: 11/29	Loss: 0.844
Batch: 13/29	Loss: 0.833
Batch: 15/29	Loss: 0.856
Batch: 17/29	Loss: 0.866
Batch: 19/29	Loss: 0.846
Batch: 21/29	Loss: 0.832
Batch: 23/29	Loss: 0.845
Batch: 25/29	Loss: 0.860
Batch: 27/29	Loss: 0.831
Batch: 29/29	Loss: 0.837
Epoch: 5	Train Loss: 0.849	Val F1: 0.217
Best Epoch: 1	Best Val F1: 0.238

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.823
Batch: 3/29	Loss: 0.869
Batch: 5/29	Loss: 0.826
Batch: 7/29	Loss: 0.859
Batch: 9/29	Loss: 0.838
Batch: 11/29	Loss: 0.839
Batch: 13/29	Loss: 0.834
Batch: 15/29	Loss: 0.812
Batch: 17/29	Loss: 0.822
Batch: 19/29	Loss: 0.813
Batch: 21/29	Loss: 0.835
Batch: 23/29	Loss: 0.816
Batch: 25/29	Loss: 0.836
Batch: 27/29	Loss: 0.820
Batch: 29/29	Loss: 0.833
Epoch: 6	Train Loss: 0.833	Val F1: 0.247
Best Epoch: 6	Best Val F1: 0.247

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.815
Batch: 3/29	Loss: 0.836
Batch: 5/29	Loss: 0.847
Batch: 7/29	Loss: 0.808
Batch: 9/29	Loss: 0.832
Batch: 11/29	Loss: 0.805
Batch: 13/29	Loss: 0.812
Batch: 15/29	Loss: 0.796
Batch: 17/29	Loss: 0.827
Batch: 19/29	Loss: 0.833
Batch: 21/29	Loss: 0.799
Batch: 23/29	Loss: 0.799
Batch: 25/29	Loss: 0.781
Batch: 27/29	Loss: 0.802
Batch: 29/29	Loss: 0.805
Epoch: 7	Train Loss: 0.816	Val F1: 0.291
Best Epoch: 7	Best Val F1: 0.291

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.826
Batch: 3/29	Loss: 0.777
Batch: 5/29	Loss: 0.791
Batch: 7/29	Loss: 0.800
Batch: 9/29	Loss: 0.782
Batch: 11/29	Loss: 0.788
Batch: 13/29	Loss: 0.838
Batch: 15/29	Loss: 0.762
Batch: 17/29	Loss: 0.791
Batch: 19/29	Loss: 0.795
Batch: 21/29	Loss: 0.790
Batch: 23/29	Loss: 0.812
Batch: 25/29	Loss: 0.797
Batch: 27/29	Loss: 0.798
Batch: 29/29	Loss: 0.766
Epoch: 8	Train Loss: 0.792	Val F1: 0.305
Best Epoch: 8	Best Val F1: 0.305

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.806
Batch: 3/29	Loss: 0.750
Batch: 5/29	Loss: 0.759
Batch: 7/29	Loss: 0.753
Batch: 9/29	Loss: 0.787
Batch: 11/29	Loss: 0.778
Batch: 13/29	Loss: 0.782
Batch: 15/29	Loss: 0.747
Batch: 17/29	Loss: 0.773
Batch: 19/29	Loss: 0.739
Batch: 21/29	Loss: 0.783
Batch: 23/29	Loss: 0.762
Batch: 25/29	Loss: 0.729
Batch: 27/29	Loss: 0.797
Batch: 29/29	Loss: 0.724
Epoch: 9	Train Loss: 0.765	Val F1: 0.321
Best Epoch: 9	Best Val F1: 0.321

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.714
Batch: 3/29	Loss: 0.749
Batch: 5/29	Loss: 0.729
Batch: 7/29	Loss: 0.730
Batch: 9/29	Loss: 0.735
Batch: 11/29	Loss: 0.700
Batch: 13/29	Loss: 0.782
Batch: 15/29	Loss: 0.787
Batch: 17/29	Loss: 0.779
Batch: 19/29	Loss: 0.666
Batch: 21/29	Loss: 0.752
Batch: 23/29	Loss: 0.746
Batch: 25/29	Loss: 0.749
Batch: 27/29	Loss: 0.703
Batch: 29/29	Loss: 0.766
Epoch: 10	Train Loss: 0.736	Val F1: 0.319
Best Epoch: 9	Best Val F1: 0.321

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.726
Batch: 3/29	Loss: 0.697
Batch: 5/29	Loss: 0.784
Batch: 7/29	Loss: 0.720
Batch: 9/29	Loss: 0.695
Batch: 11/29	Loss: 0.720
Batch: 13/29	Loss: 0.710
Batch: 15/29	Loss: 0.633
Batch: 17/29	Loss: 0.741
Batch: 19/29	Loss: 0.733
Batch: 21/29	Loss: 0.674
Batch: 23/29	Loss: 0.659
Batch: 25/29	Loss: 0.671
Batch: 27/29	Loss: 0.636
Batch: 29/29	Loss: 0.688
Epoch: 11	Train Loss: 0.710	Val F1: 0.325
Best Epoch: 11	Best Val F1: 0.325

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.807
Batch: 3/29	Loss: 0.670
Batch: 5/29	Loss: 0.692
Batch: 7/29	Loss: 0.678
Batch: 9/29	Loss: 0.683
Batch: 11/29	Loss: 0.686
Batch: 13/29	Loss: 0.663
Batch: 15/29	Loss: 0.658
Batch: 17/29	Loss: 0.680
Batch: 19/29	Loss: 0.678
Batch: 21/29	Loss: 0.658
Batch: 23/29	Loss: 0.674
Batch: 25/29	Loss: 0.687
Batch: 27/29	Loss: 0.729
Batch: 29/29	Loss: 0.622
Epoch: 12	Train Loss: 0.687	Val F1: 0.338
Best Epoch: 12	Best Val F1: 0.338

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.685
Batch: 3/29	Loss: 0.618
Batch: 5/29	Loss: 0.689
Batch: 7/29	Loss: 0.668
Batch: 9/29	Loss: 0.663
Batch: 11/29	Loss: 0.676
Batch: 13/29	Loss: 0.696
Batch: 15/29	Loss: 0.642
Batch: 17/29	Loss: 0.618
Batch: 19/29	Loss: 0.589
Batch: 21/29	Loss: 0.685
Batch: 23/29	Loss: 0.665
Batch: 25/29	Loss: 0.582
Batch: 27/29	Loss: 0.708
Batch: 29/29	Loss: 0.700
Epoch: 13	Train Loss: 0.665	Val F1: 0.337
Best Epoch: 12	Best Val F1: 0.338

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.610
Batch: 3/29	Loss: 0.665
Batch: 5/29	Loss: 0.606
Batch: 7/29	Loss: 0.611
Batch: 9/29	Loss: 0.680
Batch: 11/29	Loss: 0.647
Batch: 13/29	Loss: 0.627
Batch: 15/29	Loss: 0.587
Batch: 17/29	Loss: 0.713
Batch: 19/29	Loss: 0.661
Batch: 21/29	Loss: 0.598
Batch: 23/29	Loss: 0.543
Batch: 25/29	Loss: 0.664
Batch: 27/29	Loss: 0.675
Batch: 29/29	Loss: 0.643
Epoch: 14	Train Loss: 0.638	Val F1: 0.334
Best Epoch: 12	Best Val F1: 0.338

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.611
Batch: 3/29	Loss: 0.588
Batch: 5/29	Loss: 0.529
Batch: 7/29	Loss: 0.586
Batch: 9/29	Loss: 0.596
Batch: 11/29	Loss: 0.574
Batch: 13/29	Loss: 0.652
Batch: 15/29	Loss: 0.646
Batch: 17/29	Loss: 0.624
Batch: 19/29	Loss: 0.568
Batch: 21/29	Loss: 0.562
Batch: 23/29	Loss: 0.640
Batch: 25/29	Loss: 0.628
Batch: 27/29	Loss: 0.547
Batch: 29/29	Loss: 0.666
Epoch: 15	Train Loss: 0.611	Val F1: 0.334
Best Epoch: 12	Best Val F1: 0.338

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.608
Batch: 3/29	Loss: 0.560
Batch: 5/29	Loss: 0.585
Batch: 7/29	Loss: 0.556
Batch: 9/29	Loss: 0.633
Batch: 11/29	Loss: 0.590
Batch: 13/29	Loss: 0.539
Batch: 15/29	Loss: 0.581
Batch: 17/29	Loss: 0.545
Batch: 19/29	Loss: 0.616
Batch: 21/29	Loss: 0.562
Batch: 23/29	Loss: 0.615
Batch: 25/29	Loss: 0.573
Batch: 27/29	Loss: 0.522
Batch: 29/29	Loss: 0.597
Epoch: 16	Train Loss: 0.583	Val F1: 0.339
Best Epoch: 16	Best Val F1: 0.339

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.533
Batch: 3/29	Loss: 0.643
Batch: 5/29	Loss: 0.594
Batch: 7/29	Loss: 0.517
Batch: 9/29	Loss: 0.526
Batch: 11/29	Loss: 0.614
Batch: 13/29	Loss: 0.629
Batch: 15/29	Loss: 0.575
Batch: 17/29	Loss: 0.591
Batch: 19/29	Loss: 0.522
Batch: 21/29	Loss: 0.616
Batch: 23/29	Loss: 0.601
Batch: 25/29	Loss: 0.478
Batch: 27/29	Loss: 0.546
Batch: 29/29	Loss: 0.610
Epoch: 17	Train Loss: 0.561	Val F1: 0.337
Best Epoch: 16	Best Val F1: 0.339

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.572
Batch: 3/29	Loss: 0.559
Batch: 5/29	Loss: 0.590
Batch: 7/29	Loss: 0.533
Batch: 9/29	Loss: 0.590
Batch: 11/29	Loss: 0.542
Batch: 13/29	Loss: 0.480
Batch: 15/29	Loss: 0.520
Batch: 17/29	Loss: 0.521
Batch: 19/29	Loss: 0.472
Batch: 21/29	Loss: 0.592
Batch: 23/29	Loss: 0.557
Batch: 25/29	Loss: 0.578
Batch: 27/29	Loss: 0.437
Batch: 29/29	Loss: 0.598
Epoch: 18	Train Loss: 0.544	Val F1: 0.348
Best Epoch: 18	Best Val F1: 0.348

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.463
Batch: 3/29	Loss: 0.414
Batch: 5/29	Loss: 0.572
Batch: 7/29	Loss: 0.577
Batch: 9/29	Loss: 0.439
Batch: 11/29	Loss: 0.585
Batch: 13/29	Loss: 0.551
Batch: 15/29	Loss: 0.528
Batch: 17/29	Loss: 0.488
Batch: 19/29	Loss: 0.647
Batch: 21/29	Loss: 0.494
Batch: 23/29	Loss: 0.521
Batch: 25/29	Loss: 0.502
Batch: 27/29	Loss: 0.459
Batch: 29/29	Loss: 0.566
Epoch: 19	Train Loss: 0.524	Val F1: 0.346
Best Epoch: 18	Best Val F1: 0.348

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.552
Batch: 3/29	Loss: 0.529
Batch: 5/29	Loss: 0.507
Batch: 7/29	Loss: 0.459
Batch: 9/29	Loss: 0.528
Batch: 11/29	Loss: 0.514
Batch: 13/29	Loss: 0.503
Batch: 15/29	Loss: 0.510
Batch: 17/29	Loss: 0.549
Batch: 19/29	Loss: 0.477
Batch: 21/29	Loss: 0.483
Batch: 23/29	Loss: 0.576
Batch: 25/29	Loss: 0.497
Batch: 27/29	Loss: 0.515
Batch: 29/29	Loss: 0.521
Epoch: 20	Train Loss: 0.507	Val F1: 0.339
Best Epoch: 18	Best Val F1: 0.348

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.477
Batch: 3/29	Loss: 0.516
Batch: 5/29	Loss: 0.485
Batch: 7/29	Loss: 0.621
Batch: 9/29	Loss: 0.445
Batch: 11/29	Loss: 0.498
Batch: 13/29	Loss: 0.488
Batch: 15/29	Loss: 0.566
Batch: 17/29	Loss: 0.463
Batch: 19/29	Loss: 0.462
Batch: 21/29	Loss: 0.547
Batch: 23/29	Loss: 0.445
Batch: 25/29	Loss: 0.501
Batch: 27/29	Loss: 0.496
Batch: 29/29	Loss: 0.461
Epoch: 21	Train Loss: 0.502	Val F1: 0.344
Best Epoch: 18	Best Val F1: 0.348

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.449
Batch: 3/29	Loss: 0.463
Batch: 5/29	Loss: 0.513
Batch: 7/29	Loss: 0.499
Batch: 9/29	Loss: 0.453
Batch: 11/29	Loss: 0.436
Batch: 13/29	Loss: 0.418
Batch: 15/29	Loss: 0.578
Batch: 17/29	Loss: 0.517
Batch: 19/29	Loss: 0.565
Batch: 21/29	Loss: 0.627
Batch: 23/29	Loss: 0.458
Batch: 25/29	Loss: 0.482
Batch: 27/29	Loss: 0.415
Batch: 29/29	Loss: 0.525
Epoch: 22	Train Loss: 0.486	Val F1: 0.344
Best Epoch: 18	Best Val F1: 0.348

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.491
Batch: 3/29	Loss: 0.464
Batch: 5/29	Loss: 0.440
Batch: 7/29	Loss: 0.536
Batch: 9/29	Loss: 0.407
Batch: 11/29	Loss: 0.522
Batch: 13/29	Loss: 0.428
Batch: 15/29	Loss: 0.466
Batch: 17/29	Loss: 0.487
Batch: 19/29	Loss: 0.475
Batch: 21/29	Loss: 0.459
Batch: 23/29	Loss: 0.403
Batch: 25/29	Loss: 0.466
Batch: 27/29	Loss: 0.451
Batch: 29/29	Loss: 0.555
Epoch: 23	Train Loss: 0.469	Val F1: 0.335
Best Epoch: 18	Best Val F1: 0.348

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.455
Batch: 3/29	Loss: 0.448
Batch: 5/29	Loss: 0.515
Batch: 7/29	Loss: 0.458
Batch: 9/29	Loss: 0.475
Batch: 11/29	Loss: 0.535
Batch: 13/29	Loss: 0.431
Batch: 15/29	Loss: 0.395
Batch: 17/29	Loss: 0.389
Batch: 19/29	Loss: 0.454
Batch: 21/29	Loss: 0.466
Batch: 23/29	Loss: 0.475
Batch: 25/29	Loss: 0.399
Batch: 27/29	Loss: 0.421
Batch: 29/29	Loss: 0.404
Epoch: 24	Train Loss: 0.451	Val F1: 0.340
Best Epoch: 18	Best Val F1: 0.348

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.501
Batch: 3/29	Loss: 0.461
Batch: 5/29	Loss: 0.495
Batch: 7/29	Loss: 0.508
Batch: 9/29	Loss: 0.473
Batch: 11/29	Loss: 0.455
Batch: 13/29	Loss: 0.481
Batch: 15/29	Loss: 0.464
Batch: 17/29	Loss: 0.471
Batch: 19/29	Loss: 0.399
Batch: 21/29	Loss: 0.480
Batch: 23/29	Loss: 0.465
Batch: 25/29	Loss: 0.465
Batch: 27/29	Loss: 0.450
Batch: 29/29	Loss: 0.388
Epoch: 25	Train Loss: 0.448	Val F1: 0.338
Best Epoch: 18	Best Val F1: 0.348

Saving the best checkpoint....
Inference...
Test F1: 0.378	Test F1_Few: 0.448	Test F1_Zero: 0.375
Starting training with config: {'batch_size': 64, 'epochs': 75, 'l2_reg': 0.0003819656756611007, 'lr': 7.444705732816724e-05, 'n_layers_freeze': 2, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.003
Batch: 5/29	Loss: 0.920
Batch: 7/29	Loss: 0.901
Batch: 9/29	Loss: 0.873
Batch: 11/29	Loss: 0.875
Batch: 13/29	Loss: 0.857
Batch: 15/29	Loss: 0.891
Batch: 17/29	Loss: 0.821
Batch: 19/29	Loss: 0.836
Batch: 21/29	Loss: 0.791
Batch: 23/29	Loss: 0.823
Batch: 25/29	Loss: 0.759
Batch: 27/29	Loss: 0.770
Batch: 29/29	Loss: 0.792
Epoch: 1	Train Loss: 0.863	Val F1: 0.188
Best Epoch: 1	Best Val F1: 0.188

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.775
Batch: 3/29	Loss: 0.782
Batch: 5/29	Loss: 0.847
Batch: 7/29	Loss: 0.764
Batch: 9/29	Loss: 0.806
Batch: 11/29	Loss: 0.726
Batch: 13/29	Loss: 0.738
Batch: 15/29	Loss: 0.767
Batch: 17/29	Loss: 0.765
Batch: 19/29	Loss: 0.842
Batch: 21/29	Loss: 0.745
Batch: 23/29	Loss: 0.757
Batch: 25/29	Loss: 0.727
Batch: 27/29	Loss: 0.831
Batch: 29/29	Loss: 0.723
Epoch: 2	Train Loss: 0.766	Val F1: 0.320
Best Epoch: 2	Best Val F1: 0.320

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.700
Batch: 3/29	Loss: 0.755
Batch: 5/29	Loss: 0.715
Batch: 7/29	Loss: 0.801
Batch: 9/29	Loss: 0.669
Batch: 11/29	Loss: 0.723
Batch: 13/29	Loss: 0.785
Batch: 15/29	Loss: 0.754
Batch: 17/29	Loss: 0.756
Batch: 19/29	Loss: 0.727
Batch: 21/29	Loss: 0.665
Batch: 23/29	Loss: 0.703
Batch: 25/29	Loss: 0.723
Batch: 27/29	Loss: 0.709
Batch: 29/29	Loss: 0.709
Epoch: 3	Train Loss: 0.725	Val F1: 0.318
Best Epoch: 2	Best Val F1: 0.320

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.671
Batch: 3/29	Loss: 0.692
Batch: 5/29	Loss: 0.690
Batch: 7/29	Loss: 0.759
Batch: 9/29	Loss: 0.693
Batch: 11/29	Loss: 0.606
Batch: 13/29	Loss: 0.607
Batch: 15/29	Loss: 0.662
Batch: 17/29	Loss: 0.637
Batch: 19/29	Loss: 0.683
Batch: 21/29	Loss: 0.660
Batch: 23/29	Loss: 0.658
Batch: 25/29	Loss: 0.623
Batch: 27/29	Loss: 0.663
Batch: 29/29	Loss: 0.654
Epoch: 4	Train Loss: 0.670	Val F1: 0.324
Best Epoch: 4	Best Val F1: 0.324

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.567
Batch: 3/29	Loss: 0.597
Batch: 5/29	Loss: 0.583
Batch: 7/29	Loss: 0.637
Batch: 9/29	Loss: 0.552
Batch: 11/29	Loss: 0.613
Batch: 13/29	Loss: 0.574
Batch: 15/29	Loss: 0.634
Batch: 17/29	Loss: 0.666
Batch: 19/29	Loss: 0.604
Batch: 21/29	Loss: 0.589
Batch: 23/29	Loss: 0.785
Batch: 25/29	Loss: 0.660
Batch: 27/29	Loss: 0.592
Batch: 29/29	Loss: 0.699
Epoch: 5	Train Loss: 0.634	Val F1: 0.307
Best Epoch: 4	Best Val F1: 0.324

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.645
Batch: 3/29	Loss: 0.749
Batch: 5/29	Loss: 0.566
Batch: 7/29	Loss: 0.718
Batch: 9/29	Loss: 0.587
Batch: 11/29	Loss: 0.592
Batch: 13/29	Loss: 0.601
Batch: 15/29	Loss: 0.602
Batch: 17/29	Loss: 0.592
Batch: 19/29	Loss: 0.550
Batch: 21/29	Loss: 0.641
Batch: 23/29	Loss: 0.643
Batch: 25/29	Loss: 0.662
Batch: 27/29	Loss: 0.632
Batch: 29/29	Loss: 0.548
Epoch: 6	Train Loss: 0.624	Val F1: 0.340
Best Epoch: 6	Best Val F1: 0.340

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.599
Batch: 3/29	Loss: 0.679
Batch: 5/29	Loss: 0.755
Batch: 7/29	Loss: 0.677
Batch: 9/29	Loss: 0.631
Batch: 11/29	Loss: 0.506
Batch: 13/29	Loss: 0.547
Batch: 15/29	Loss: 0.518
Batch: 17/29	Loss: 0.657
Batch: 19/29	Loss: 0.648
Batch: 21/29	Loss: 0.622
Batch: 23/29	Loss: 0.587
Batch: 25/29	Loss: 0.479
Batch: 27/29	Loss: 0.627
Batch: 29/29	Loss: 0.491
Epoch: 7	Train Loss: 0.592	Val F1: 0.322
Best Epoch: 6	Best Val F1: 0.340

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.584
Batch: 3/29	Loss: 0.565
Batch: 5/29	Loss: 0.547
Batch: 7/29	Loss: 0.598
Batch: 9/29	Loss: 0.521
Batch: 11/29	Loss: 0.646
Batch: 13/29	Loss: 0.661
Batch: 15/29	Loss: 0.504
Batch: 17/29	Loss: 0.665
Batch: 19/29	Loss: 0.569
Batch: 21/29	Loss: 0.589
Batch: 23/29	Loss: 0.651
Batch: 25/29	Loss: 0.627
Batch: 27/29	Loss: 0.613
Batch: 29/29	Loss: 0.597
Epoch: 8	Train Loss: 0.571	Val F1: 0.347
Best Epoch: 8	Best Val F1: 0.347

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.602
Batch: 3/29	Loss: 0.505
Batch: 5/29	Loss: 0.559
Batch: 7/29	Loss: 0.456
Batch: 9/29	Loss: 0.540
Batch: 11/29	Loss: 0.564
Batch: 13/29	Loss: 0.614
Batch: 15/29	Loss: 0.480
Batch: 17/29	Loss: 0.499
Batch: 19/29	Loss: 0.426
Batch: 21/29	Loss: 0.612
Batch: 23/29	Loss: 0.503
Batch: 25/29	Loss: 0.499
Batch: 27/29	Loss: 0.549
Batch: 29/29	Loss: 0.441
Epoch: 9	Train Loss: 0.516	Val F1: 0.351
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.425
Batch: 3/29	Loss: 0.471
Batch: 5/29	Loss: 0.483
Batch: 7/29	Loss: 0.536
Batch: 9/29	Loss: 0.518
Batch: 11/29	Loss: 0.529
Batch: 13/29	Loss: 0.650
Batch: 15/29	Loss: 0.633
Batch: 17/29	Loss: 0.604
Batch: 19/29	Loss: 0.437
Batch: 21/29	Loss: 0.618
Batch: 23/29	Loss: 0.571
Batch: 25/29	Loss: 0.643
Batch: 27/29	Loss: 0.479
Batch: 29/29	Loss: 0.607
Epoch: 10	Train Loss: 0.542	Val F1: 0.349
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.509
Batch: 3/29	Loss: 0.527
Batch: 5/29	Loss: 0.602
Batch: 7/29	Loss: 0.486
Batch: 9/29	Loss: 0.476
Batch: 11/29	Loss: 0.463
Batch: 13/29	Loss: 0.460
Batch: 15/29	Loss: 0.324
Batch: 17/29	Loss: 0.537
Batch: 19/29	Loss: 0.522
Batch: 21/29	Loss: 0.435
Batch: 23/29	Loss: 0.433
Batch: 25/29	Loss: 0.429
Batch: 27/29	Loss: 0.442
Batch: 29/29	Loss: 0.442
Epoch: 11	Train Loss: 0.488	Val F1: 0.347
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.584
Batch: 3/29	Loss: 0.419
Batch: 5/29	Loss: 0.423
Batch: 7/29	Loss: 0.381
Batch: 9/29	Loss: 0.443
Batch: 11/29	Loss: 0.472
Batch: 13/29	Loss: 0.545
Batch: 15/29	Loss: 0.531
Batch: 17/29	Loss: 0.529
Batch: 19/29	Loss: 0.615
Batch: 21/29	Loss: 0.495
Batch: 23/29	Loss: 0.632
Batch: 25/29	Loss: 0.689
Batch: 27/29	Loss: 0.770
Batch: 29/29	Loss: 0.678
Epoch: 12	Train Loss: 0.543	Val F1: 0.205
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.807
Batch: 3/29	Loss: 0.702
Batch: 5/29	Loss: 0.810
Batch: 7/29	Loss: 0.711
Batch: 9/29	Loss: 0.799
Batch: 11/29	Loss: 0.754
Batch: 13/29	Loss: 0.756
Batch: 15/29	Loss: 0.734
Batch: 17/29	Loss: 0.689
Batch: 19/29	Loss: 0.666
Batch: 21/29	Loss: 0.658
Batch: 23/29	Loss: 0.642
Batch: 25/29	Loss: 0.590
Batch: 27/29	Loss: 0.667
Batch: 29/29	Loss: 0.608
Epoch: 13	Train Loss: 0.714	Val F1: 0.335
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.622
Batch: 3/29	Loss: 0.610
Batch: 5/29	Loss: 0.464
Batch: 7/29	Loss: 0.500
Batch: 9/29	Loss: 0.550
Batch: 11/29	Loss: 0.440
Batch: 13/29	Loss: 0.504
Batch: 15/29	Loss: 0.392
Batch: 17/29	Loss: 0.513
Batch: 19/29	Loss: 0.679
Batch: 21/29	Loss: 0.332
Batch: 23/29	Loss: 0.484
Batch: 25/29	Loss: 0.555
Batch: 27/29	Loss: 0.668
Batch: 29/29	Loss: 0.773
Epoch: 14	Train Loss: 0.546	Val F1: 0.328
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.689
Batch: 3/29	Loss: 0.755
Batch: 5/29	Loss: 0.684
Batch: 7/29	Loss: 0.817
Batch: 9/29	Loss: 0.692
Batch: 11/29	Loss: 0.725
Batch: 13/29	Loss: 0.750
Batch: 15/29	Loss: 0.773
Batch: 17/29	Loss: 0.826
Batch: 19/29	Loss: 0.766
Batch: 21/29	Loss: 0.757
Batch: 23/29	Loss: 0.737
Batch: 25/29	Loss: 0.760
Batch: 27/29	Loss: 0.778
Batch: 29/29	Loss: 0.851
Epoch: 15	Train Loss: 0.754	Val F1: 0.190
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.764
Batch: 3/29	Loss: 0.762
Batch: 5/29	Loss: 0.797
Batch: 7/29	Loss: 0.750
Batch: 9/29	Loss: 0.747
Batch: 11/29	Loss: 0.775
Batch: 13/29	Loss: 0.749
Batch: 15/29	Loss: 0.739
Batch: 17/29	Loss: 0.730
Batch: 19/29	Loss: 0.782
Batch: 21/29	Loss: 0.755
Batch: 23/29	Loss: 0.772
Batch: 25/29	Loss: 0.787
Batch: 27/29	Loss: 0.753
Batch: 29/29	Loss: 0.741
Epoch: 16	Train Loss: 0.763	Val F1: 0.185
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.734
Batch: 3/29	Loss: 0.767
Batch: 5/29	Loss: 0.750
Batch: 7/29	Loss: 0.734
Batch: 9/29	Loss: 0.711
Batch: 11/29	Loss: 0.865
Batch: 13/29	Loss: 0.739
Batch: 15/29	Loss: 0.776
Batch: 17/29	Loss: 0.797
Batch: 19/29	Loss: 0.735
Batch: 21/29	Loss: 0.774
Batch: 23/29	Loss: 0.773
Batch: 25/29	Loss: 0.708
Batch: 27/29	Loss: 0.752
Batch: 29/29	Loss: 0.791
Epoch: 17	Train Loss: 0.763	Val F1: 0.180
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.779
Batch: 3/29	Loss: 0.781
Batch: 5/29	Loss: 0.761
Batch: 7/29	Loss: 0.726
Batch: 9/29	Loss: 0.801
Batch: 11/29	Loss: 0.754
Batch: 13/29	Loss: 0.738
Batch: 15/29	Loss: 0.749
Batch: 17/29	Loss: 0.738
Batch: 19/29	Loss: 0.735
Batch: 21/29	Loss: 0.759
Batch: 23/29	Loss: 0.769
Batch: 25/29	Loss: 0.764
Batch: 27/29	Loss: 0.756
Batch: 29/29	Loss: 0.814
Epoch: 18	Train Loss: 0.763	Val F1: 0.185
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.740
Batch: 3/29	Loss: 0.735
Batch: 5/29	Loss: 0.750
Batch: 7/29	Loss: 0.797
Batch: 9/29	Loss: 0.744
Batch: 11/29	Loss: 0.795
Batch: 13/29	Loss: 0.805
Batch: 15/29	Loss: 0.768
Batch: 17/29	Loss: 0.759
Batch: 19/29	Loss: 0.834
Batch: 21/29	Loss: 0.810
Batch: 23/29	Loss: 0.708
Batch: 25/29	Loss: 0.783
Batch: 27/29	Loss: 0.742
Batch: 29/29	Loss: 0.710
Epoch: 19	Train Loss: 0.761	Val F1: 0.182
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.769
Batch: 3/29	Loss: 0.755
Batch: 5/29	Loss: 0.771
Batch: 7/29	Loss: 0.725
Batch: 9/29	Loss: 0.777
Batch: 11/29	Loss: 0.728
Batch: 13/29	Loss: 0.801
Batch: 15/29	Loss: 0.736
Batch: 17/29	Loss: 0.860
Batch: 19/29	Loss: 0.796
Batch: 21/29	Loss: 0.732
Batch: 23/29	Loss: 0.738
Batch: 25/29	Loss: 0.736
Batch: 27/29	Loss: 0.807
Batch: 29/29	Loss: 0.746
Epoch: 20	Train Loss: 0.764	Val F1: 0.180
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.742
Batch: 3/29	Loss: 0.727
Batch: 5/29	Loss: 0.750
Batch: 7/29	Loss: 0.896
Batch: 9/29	Loss: 0.768
Batch: 11/29	Loss: 0.735
Batch: 13/29	Loss: 0.766
Batch: 15/29	Loss: 0.788
Batch: 17/29	Loss: 0.803
Batch: 19/29	Loss: 0.751
Batch: 21/29	Loss: 0.748
Batch: 23/29	Loss: 0.709
Batch: 25/29	Loss: 0.771
Batch: 27/29	Loss: 0.754
Batch: 29/29	Loss: 0.740
Epoch: 21	Train Loss: 0.762	Val F1: 0.185
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.737
Batch: 3/29	Loss: 0.760
Batch: 5/29	Loss: 0.762
Batch: 7/29	Loss: 0.775
Batch: 9/29	Loss: 0.729
Batch: 11/29	Loss: 0.730
Batch: 13/29	Loss: 0.708
Batch: 15/29	Loss: 0.797
Batch: 17/29	Loss: 0.759
Batch: 19/29	Loss: 0.750
Batch: 21/29	Loss: 0.763
Batch: 23/29	Loss: 0.750
Batch: 25/29	Loss: 0.776
Batch: 27/29	Loss: 0.773
Batch: 29/29	Loss: 0.757
Epoch: 22	Train Loss: 0.762	Val F1: 0.180
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.761
Batch: 3/29	Loss: 0.774
Batch: 5/29	Loss: 0.780
Batch: 7/29	Loss: 0.786
Batch: 9/29	Loss: 0.729
Batch: 11/29	Loss: 0.807
Batch: 13/29	Loss: 0.767
Batch: 15/29	Loss: 0.732
Batch: 17/29	Loss: 0.793
Batch: 19/29	Loss: 0.748
Batch: 21/29	Loss: 0.801
Batch: 23/29	Loss: 0.770
Batch: 25/29	Loss: 0.735
Batch: 27/29	Loss: 0.718
Batch: 29/29	Loss: 0.745
Epoch: 23	Train Loss: 0.762	Val F1: 0.185
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.755
Batch: 3/29	Loss: 0.763
Batch: 5/29	Loss: 0.759
Batch: 7/29	Loss: 0.855
Batch: 9/29	Loss: 0.794
Batch: 11/29	Loss: 0.796
Batch: 13/29	Loss: 0.738
Batch: 15/29	Loss: 0.758
Batch: 17/29	Loss: 0.724
Batch: 19/29	Loss: 0.789
Batch: 21/29	Loss: 0.815
Batch: 23/29	Loss: 0.747
Batch: 25/29	Loss: 0.825
Batch: 27/29	Loss: 0.724
Batch: 29/29	Loss: 0.726
Epoch: 24	Train Loss: 0.763	Val F1: 0.185
Best Epoch: 9	Best Val F1: 0.351

Saving the best checkpoint....
Inference...
Test F1: 0.380	Test F1_Few: 0.448	Test F1_Zero: 0.380
Starting training with config: {'batch_size': 16, 'epochs': 75, 'l2_reg': 0.0007507690911188417, 'lr': 1.1148891873628807e-05, 'n_layers_freeze': 2, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 1.022
Batch: 23/116	Loss: 0.953
Batch: 34/116	Loss: 0.931
Batch: 45/116	Loss: 0.893
Batch: 56/116	Loss: 0.880
Batch: 67/116	Loss: 0.839
Batch: 78/116	Loss: 0.842
Batch: 89/116	Loss: 0.898
Batch: 100/116	Loss: 0.809
Batch: 111/116	Loss: 0.830
Batch: 116/116	Loss: 0.799
Epoch: 1	Train Loss: 0.899	Val F1: 0.179
Best Epoch: 1	Best Val F1: 0.179

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.858
Batch: 12/116	Loss: 0.816
Batch: 23/116	Loss: 0.791
Batch: 34/116	Loss: 0.779
Batch: 45/116	Loss: 0.838
Batch: 56/116	Loss: 0.797
Batch: 67/116	Loss: 0.809
Batch: 78/116	Loss: 0.774
Batch: 89/116	Loss: 0.783
Batch: 100/116	Loss: 0.787
Batch: 111/116	Loss: 0.786
Batch: 116/116	Loss: 0.766
Epoch: 2	Train Loss: 0.798	Val F1: 0.293
Best Epoch: 2	Best Val F1: 0.293

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.731
Batch: 12/116	Loss: 0.710
Batch: 23/116	Loss: 0.702
Batch: 34/116	Loss: 0.781
Batch: 45/116	Loss: 0.804
Batch: 56/116	Loss: 0.776
Batch: 67/116	Loss: 0.747
Batch: 78/116	Loss: 0.744
Batch: 89/116	Loss: 0.747
Batch: 100/116	Loss: 0.874
Batch: 111/116	Loss: 0.907
Batch: 116/116	Loss: 0.650
Epoch: 3	Train Loss: 0.748	Val F1: 0.320
Best Epoch: 3	Best Val F1: 0.320

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.740
Batch: 12/116	Loss: 0.634
Batch: 23/116	Loss: 0.882
Batch: 34/116	Loss: 0.663
Batch: 45/116	Loss: 0.741
Batch: 56/116	Loss: 0.664
Batch: 67/116	Loss: 0.714
Batch: 78/116	Loss: 0.645
Batch: 89/116	Loss: 0.770
Batch: 100/116	Loss: 0.657
Batch: 111/116	Loss: 0.678
Batch: 116/116	Loss: 0.821
Epoch: 4	Train Loss: 0.696	Val F1: 0.322
Best Epoch: 4	Best Val F1: 0.322

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.503
Batch: 12/116	Loss: 0.603
Batch: 23/116	Loss: 0.648
Batch: 34/116	Loss: 0.673
Batch: 45/116	Loss: 0.677
Batch: 56/116	Loss: 0.668
Batch: 67/116	Loss: 0.604
Batch: 78/116	Loss: 0.687
Batch: 89/116	Loss: 0.801
Batch: 100/116	Loss: 0.667
Batch: 111/116	Loss: 0.595
Batch: 116/116	Loss: 0.493
Epoch: 5	Train Loss: 0.646	Val F1: 0.338
Best Epoch: 5	Best Val F1: 0.338

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.549
Batch: 12/116	Loss: 0.884
Batch: 23/116	Loss: 0.813
Batch: 34/116	Loss: 0.593
Batch: 45/116	Loss: 0.550
Batch: 56/116	Loss: 0.591
Batch: 67/116	Loss: 0.559
Batch: 78/116	Loss: 0.698
Batch: 89/116	Loss: 0.932
Batch: 100/116	Loss: 0.728
Batch: 111/116	Loss: 0.668
Batch: 116/116	Loss: 0.271
Epoch: 6	Train Loss: 0.602	Val F1: 0.362
Best Epoch: 6	Best Val F1: 0.362

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.470
Batch: 12/116	Loss: 0.680
Batch: 23/116	Loss: 0.687
Batch: 34/116	Loss: 0.798
Batch: 45/116	Loss: 0.401
Batch: 56/116	Loss: 0.795
Batch: 67/116	Loss: 0.503
Batch: 78/116	Loss: 0.626
Batch: 89/116	Loss: 0.498
Batch: 100/116	Loss: 0.405
Batch: 111/116	Loss: 0.764
Batch: 116/116	Loss: 0.613
Epoch: 7	Train Loss: 0.561	Val F1: 0.356
Best Epoch: 6	Best Val F1: 0.362

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.560
Batch: 12/116	Loss: 0.647
Batch: 23/116	Loss: 0.296
Batch: 34/116	Loss: 0.475
Batch: 45/116	Loss: 0.404
Batch: 56/116	Loss: 0.304
Batch: 67/116	Loss: 0.822
Batch: 78/116	Loss: 0.385
Batch: 89/116	Loss: 0.326
Batch: 100/116	Loss: 0.695
Batch: 111/116	Loss: 0.358
Batch: 116/116	Loss: 0.418
Epoch: 8	Train Loss: 0.504	Val F1: 0.348
Best Epoch: 6	Best Val F1: 0.362

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.471
Batch: 12/116	Loss: 0.490
Batch: 23/116	Loss: 0.450
Batch: 34/116	Loss: 0.495
Batch: 45/116	Loss: 0.427
Batch: 56/116	Loss: 0.468
Batch: 67/116	Loss: 0.325
Batch: 78/116	Loss: 0.460
Batch: 89/116	Loss: 0.326
Batch: 100/116	Loss: 0.383
Batch: 111/116	Loss: 0.397
Batch: 116/116	Loss: 0.463
Epoch: 9	Train Loss: 0.452	Val F1: 0.366
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.385
Batch: 12/116	Loss: 0.373
Batch: 23/116	Loss: 0.366
Batch: 34/116	Loss: 0.437
Batch: 45/116	Loss: 0.200
Batch: 56/116	Loss: 0.451
Batch: 67/116	Loss: 0.608
Batch: 78/116	Loss: 0.334
Batch: 89/116	Loss: 0.308
Batch: 100/116	Loss: 0.402
Batch: 111/116	Loss: 0.286
Batch: 116/116	Loss: 0.385
Epoch: 10	Train Loss: 0.421	Val F1: 0.359
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.378
Batch: 12/116	Loss: 0.373
Batch: 23/116	Loss: 0.379
Batch: 34/116	Loss: 0.251
Batch: 45/116	Loss: 0.458
Batch: 56/116	Loss: 0.415
Batch: 67/116	Loss: 0.432
Batch: 78/116	Loss: 0.291
Batch: 89/116	Loss: 0.297
Batch: 100/116	Loss: 0.312
Batch: 111/116	Loss: 0.417
Batch: 116/116	Loss: 0.180
Epoch: 11	Train Loss: 0.380	Val F1: 0.356
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 12 ******************************
Batch: 1/116	Loss: 0.563
Batch: 12/116	Loss: 0.326
Batch: 23/116	Loss: 0.253
Batch: 34/116	Loss: 0.564
Batch: 45/116	Loss: 0.252
Batch: 56/116	Loss: 0.404
Batch: 67/116	Loss: 0.232
Batch: 78/116	Loss: 0.482
Batch: 89/116	Loss: 0.424
Batch: 100/116	Loss: 0.536
Batch: 111/116	Loss: 0.313
Batch: 116/116	Loss: 0.298
Epoch: 12	Train Loss: 0.354	Val F1: 0.347
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 13 ******************************
Batch: 1/116	Loss: 0.327
Batch: 12/116	Loss: 0.193
Batch: 23/116	Loss: 0.371
Batch: 34/116	Loss: 0.179
Batch: 45/116	Loss: 0.551
Batch: 56/116	Loss: 0.335
Batch: 67/116	Loss: 0.210
Batch: 78/116	Loss: 0.454
Batch: 89/116	Loss: 0.356
Batch: 100/116	Loss: 0.303
Batch: 111/116	Loss: 0.338
Batch: 116/116	Loss: 0.196
Epoch: 13	Train Loss: 0.327	Val F1: 0.365
Best Epoch: 9	Best Val F1: 0.366

****************************** Epoch: 14 ******************************
Batch: 1/116	Loss: 0.628
Batch: 12/116	Loss: 0.470
Batch: 23/116	Loss: 0.220
Batch: 34/116	Loss: 0.195
Batch: 45/116	Loss: 0.393
Batch: 56/116	Loss: 0.351
Batch: 67/116	Loss: 0.623
Batch: 78/116	Loss: 0.502
Batch: 89/116	Loss: 0.221
Batch: 100/116	Loss: 0.345
Batch: 111/116	Loss: 0.256
Batch: 116/116	Loss: 0.261
Epoch: 14	Train Loss: 0.308	Val F1: 0.356
Best Epoch: 9	Best Val F1: 0.366

Saving the best checkpoint....
Inference...
Test F1: 0.375	Test F1_Few: 0.458	Test F1_Zero: 0.363
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0008887434368556278, 'lr': 1.5549171593163225e-05, 'n_layers_freeze': 2, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.074
Batch: 5/29	Loss: 1.048
Batch: 7/29	Loss: 1.028
Batch: 9/29	Loss: 1.006
Batch: 11/29	Loss: 0.989
Batch: 13/29	Loss: 0.976
Batch: 15/29	Loss: 0.977
Batch: 17/29	Loss: 0.939
Batch: 19/29	Loss: 0.935
Batch: 21/29	Loss: 0.917
Batch: 23/29	Loss: 0.921
Batch: 25/29	Loss: 0.892
Batch: 27/29	Loss: 0.887
Batch: 29/29	Loss: 0.893
Epoch: 1	Train Loss: 0.970	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.185

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.885
Batch: 3/29	Loss: 0.883
Batch: 5/29	Loss: 0.907
Batch: 7/29	Loss: 0.871
Batch: 9/29	Loss: 0.883
Batch: 11/29	Loss: 0.843
Batch: 13/29	Loss: 0.843
Batch: 15/29	Loss: 0.864
Batch: 17/29	Loss: 0.853
Batch: 19/29	Loss: 0.880
Batch: 21/29	Loss: 0.838
Batch: 23/29	Loss: 0.845
Batch: 25/29	Loss: 0.825
Batch: 27/29	Loss: 0.878
Batch: 29/29	Loss: 0.826
Epoch: 2	Train Loss: 0.858	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.185

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.817
Batch: 3/29	Loss: 0.834
Batch: 5/29	Loss: 0.823
Batch: 7/29	Loss: 0.851
Batch: 9/29	Loss: 0.806
Batch: 11/29	Loss: 0.806
Batch: 13/29	Loss: 0.843
Batch: 15/29	Loss: 0.812
Batch: 17/29	Loss: 0.828
Batch: 19/29	Loss: 0.822
Batch: 21/29	Loss: 0.801
Batch: 23/29	Loss: 0.795
Batch: 25/29	Loss: 0.812
Batch: 27/29	Loss: 0.787
Batch: 29/29	Loss: 0.797
Epoch: 3	Train Loss: 0.817	Val F1: 0.246
Best Epoch: 3	Best Val F1: 0.246

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.779
Batch: 3/29	Loss: 0.792
Batch: 5/29	Loss: 0.772
Batch: 7/29	Loss: 0.825
Batch: 9/29	Loss: 0.801
Batch: 11/29	Loss: 0.757
Batch: 13/29	Loss: 0.765
Batch: 15/29	Loss: 0.754
Batch: 17/29	Loss: 0.761
Batch: 19/29	Loss: 0.787
Batch: 21/29	Loss: 0.781
Batch: 23/29	Loss: 0.784
Batch: 25/29	Loss: 0.763
Batch: 27/29	Loss: 0.787
Batch: 29/29	Loss: 0.764
Epoch: 4	Train Loss: 0.782	Val F1: 0.257
Best Epoch: 4	Best Val F1: 0.257

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.742
Batch: 3/29	Loss: 0.751
Batch: 5/29	Loss: 0.710
Batch: 7/29	Loss: 0.743
Batch: 9/29	Loss: 0.709
Batch: 11/29	Loss: 0.741
Batch: 13/29	Loss: 0.695
Batch: 15/29	Loss: 0.739
Batch: 17/29	Loss: 0.774
Batch: 19/29	Loss: 0.748
Batch: 21/29	Loss: 0.711
Batch: 23/29	Loss: 0.744
Batch: 25/29	Loss: 0.744
Batch: 27/29	Loss: 0.708
Batch: 29/29	Loss: 0.739
Epoch: 5	Train Loss: 0.742	Val F1: 0.305
Best Epoch: 5	Best Val F1: 0.305

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.737
Batch: 3/29	Loss: 0.788
Batch: 5/29	Loss: 0.663
Batch: 7/29	Loss: 0.792
Batch: 9/29	Loss: 0.695
Batch: 11/29	Loss: 0.670
Batch: 13/29	Loss: 0.720
Batch: 15/29	Loss: 0.667
Batch: 17/29	Loss: 0.678
Batch: 19/29	Loss: 0.663
Batch: 21/29	Loss: 0.752
Batch: 23/29	Loss: 0.686
Batch: 25/29	Loss: 0.722
Batch: 27/29	Loss: 0.683
Batch: 29/29	Loss: 0.673
Epoch: 6	Train Loss: 0.708	Val F1: 0.336
Best Epoch: 6	Best Val F1: 0.336

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.649
Batch: 3/29	Loss: 0.734
Batch: 5/29	Loss: 0.758
Batch: 7/29	Loss: 0.696
Batch: 9/29	Loss: 0.697
Batch: 11/29	Loss: 0.618
Batch: 13/29	Loss: 0.657
Batch: 15/29	Loss: 0.603
Batch: 17/29	Loss: 0.686
Batch: 19/29	Loss: 0.705
Batch: 21/29	Loss: 0.637
Batch: 23/29	Loss: 0.628
Batch: 25/29	Loss: 0.597
Batch: 27/29	Loss: 0.627
Batch: 29/29	Loss: 0.613
Epoch: 7	Train Loss: 0.661	Val F1: 0.339
Best Epoch: 7	Best Val F1: 0.339

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.650
Batch: 3/29	Loss: 0.593
Batch: 5/29	Loss: 0.636
Batch: 7/29	Loss: 0.621
Batch: 9/29	Loss: 0.611
Batch: 11/29	Loss: 0.643
Batch: 13/29	Loss: 0.669
Batch: 15/29	Loss: 0.572
Batch: 17/29	Loss: 0.631
Batch: 19/29	Loss: 0.598
Batch: 21/29	Loss: 0.638
Batch: 23/29	Loss: 0.644
Batch: 25/29	Loss: 0.747
Batch: 27/29	Loss: 0.608
Batch: 29/29	Loss: 0.614
Epoch: 8	Train Loss: 0.622	Val F1: 0.347
Best Epoch: 8	Best Val F1: 0.347

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.644
Batch: 3/29	Loss: 0.573
Batch: 5/29	Loss: 0.601
Batch: 7/29	Loss: 0.533
Batch: 9/29	Loss: 0.635
Batch: 11/29	Loss: 0.605
Batch: 13/29	Loss: 0.630
Batch: 15/29	Loss: 0.557
Batch: 17/29	Loss: 0.571
Batch: 19/29	Loss: 0.480
Batch: 21/29	Loss: 0.657
Batch: 23/29	Loss: 0.594
Batch: 25/29	Loss: 0.542
Batch: 27/29	Loss: 0.746
Batch: 29/29	Loss: 0.517
Epoch: 9	Train Loss: 0.588	Val F1: 0.344
Best Epoch: 8	Best Val F1: 0.347

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.514
Batch: 3/29	Loss: 0.584
Batch: 5/29	Loss: 0.544
Batch: 7/29	Loss: 0.517
Batch: 9/29	Loss: 0.532
Batch: 11/29	Loss: 0.445
Batch: 13/29	Loss: 0.657
Batch: 15/29	Loss: 0.619
Batch: 17/29	Loss: 0.714
Batch: 19/29	Loss: 0.406
Batch: 21/29	Loss: 0.647
Batch: 23/29	Loss: 0.601
Batch: 25/29	Loss: 0.603
Batch: 27/29	Loss: 0.506
Batch: 29/29	Loss: 0.595
Epoch: 10	Train Loss: 0.560	Val F1: 0.362
Best Epoch: 10	Best Val F1: 0.362

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.539
Batch: 3/29	Loss: 0.479
Batch: 5/29	Loss: 0.628
Batch: 7/29	Loss: 0.547
Batch: 9/29	Loss: 0.490
Batch: 11/29	Loss: 0.519
Batch: 13/29	Loss: 0.522
Batch: 15/29	Loss: 0.398
Batch: 17/29	Loss: 0.616
Batch: 19/29	Loss: 0.572
Batch: 21/29	Loss: 0.476
Batch: 23/29	Loss: 0.479
Batch: 25/29	Loss: 0.451
Batch: 27/29	Loss: 0.490
Batch: 29/29	Loss: 0.496
Epoch: 11	Train Loss: 0.525	Val F1: 0.345
Best Epoch: 10	Best Val F1: 0.362

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.620
Batch: 3/29	Loss: 0.436
Batch: 5/29	Loss: 0.449
Batch: 7/29	Loss: 0.466
Batch: 9/29	Loss: 0.505
Batch: 11/29	Loss: 0.523
Batch: 13/29	Loss: 0.493
Batch: 15/29	Loss: 0.491
Batch: 17/29	Loss: 0.487
Batch: 19/29	Loss: 0.468
Batch: 21/29	Loss: 0.462
Batch: 23/29	Loss: 0.486
Batch: 25/29	Loss: 0.506
Batch: 27/29	Loss: 0.544
Batch: 29/29	Loss: 0.407
Epoch: 12	Train Loss: 0.484	Val F1: 0.356
Best Epoch: 10	Best Val F1: 0.362

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.491
Batch: 3/29	Loss: 0.414
Batch: 5/29	Loss: 0.495
Batch: 7/29	Loss: 0.514
Batch: 9/29	Loss: 0.500
Batch: 11/29	Loss: 0.449
Batch: 13/29	Loss: 0.450
Batch: 15/29	Loss: 0.468
Batch: 17/29	Loss: 0.400
Batch: 19/29	Loss: 0.312
Batch: 21/29	Loss: 0.429
Batch: 23/29	Loss: 0.444
Batch: 25/29	Loss: 0.319
Batch: 27/29	Loss: 0.485
Batch: 29/29	Loss: 0.587
Epoch: 13	Train Loss: 0.459	Val F1: 0.337
Best Epoch: 10	Best Val F1: 0.362

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.463
Batch: 3/29	Loss: 0.455
Batch: 5/29	Loss: 0.346
Batch: 7/29	Loss: 0.426
Batch: 9/29	Loss: 0.474
Batch: 11/29	Loss: 0.438
Batch: 13/29	Loss: 0.411
Batch: 15/29	Loss: 0.325
Batch: 17/29	Loss: 0.486
Batch: 19/29	Loss: 0.469
Batch: 21/29	Loss: 0.291
Batch: 23/29	Loss: 0.337
Batch: 25/29	Loss: 0.476
Batch: 27/29	Loss: 0.418
Batch: 29/29	Loss: 0.464
Epoch: 14	Train Loss: 0.425	Val F1: 0.346
Best Epoch: 10	Best Val F1: 0.362

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.411
Batch: 3/29	Loss: 0.386
Batch: 5/29	Loss: 0.287
Batch: 7/29	Loss: 0.393
Batch: 9/29	Loss: 0.428
Batch: 11/29	Loss: 0.385
Batch: 13/29	Loss: 0.407
Batch: 15/29	Loss: 0.444
Batch: 17/29	Loss: 0.446
Batch: 19/29	Loss: 0.421
Batch: 21/29	Loss: 0.519
Batch: 23/29	Loss: 0.451
Batch: 25/29	Loss: 0.464
Batch: 27/29	Loss: 0.365
Batch: 29/29	Loss: 0.461
Epoch: 15	Train Loss: 0.416	Val F1: 0.347
Best Epoch: 10	Best Val F1: 0.362

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.428
Batch: 3/29	Loss: 0.373
Batch: 5/29	Loss: 0.436
Batch: 7/29	Loss: 0.330
Batch: 9/29	Loss: 0.494
Batch: 11/29	Loss: 0.392
Batch: 13/29	Loss: 0.364
Batch: 15/29	Loss: 0.294
Batch: 17/29	Loss: 0.366
Batch: 19/29	Loss: 0.451
Batch: 21/29	Loss: 0.363
Batch: 23/29	Loss: 0.454
Batch: 25/29	Loss: 0.412
Batch: 27/29	Loss: 0.365
Batch: 29/29	Loss: 0.386
Epoch: 16	Train Loss: 0.403	Val F1: 0.339
Best Epoch: 10	Best Val F1: 0.362

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.393
Batch: 3/29	Loss: 0.483
Batch: 5/29	Loss: 0.408
Batch: 7/29	Loss: 0.336
Batch: 9/29	Loss: 0.329
Batch: 11/29	Loss: 0.417
Batch: 13/29	Loss: 0.449
Batch: 15/29	Loss: 0.379
Batch: 17/29	Loss: 0.390
Batch: 19/29	Loss: 0.356
Batch: 21/29	Loss: 0.414
Batch: 23/29	Loss: 0.447
Batch: 25/29	Loss: 0.265
Batch: 27/29	Loss: 0.426
Batch: 29/29	Loss: 0.420
Epoch: 17	Train Loss: 0.388	Val F1: 0.347
Best Epoch: 10	Best Val F1: 0.362

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.396
Batch: 3/29	Loss: 0.408
Batch: 5/29	Loss: 0.321
Batch: 7/29	Loss: 0.314
Batch: 9/29	Loss: 0.472
Batch: 11/29	Loss: 0.323
Batch: 13/29	Loss: 0.298
Batch: 15/29	Loss: 0.335
Batch: 17/29	Loss: 0.324
Batch: 19/29	Loss: 0.312
Batch: 21/29	Loss: 0.376
Batch: 23/29	Loss: 0.398
Batch: 25/29	Loss: 0.389
Batch: 27/29	Loss: 0.274
Batch: 29/29	Loss: 0.377
Epoch: 18	Train Loss: 0.369	Val F1: 0.344
Best Epoch: 10	Best Val F1: 0.362

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.254
Batch: 3/29	Loss: 0.281
Batch: 5/29	Loss: 0.373
Batch: 7/29	Loss: 0.397
Batch: 9/29	Loss: 0.263
Batch: 11/29	Loss: 0.387
Batch: 13/29	Loss: 0.460
Batch: 15/29	Loss: 0.344
Batch: 17/29	Loss: 0.293
Batch: 19/29	Loss: 0.426
Batch: 21/29	Loss: 0.344
Batch: 23/29	Loss: 0.330
Batch: 25/29	Loss: 0.375
Batch: 27/29	Loss: 0.284
Batch: 29/29	Loss: 0.319
Epoch: 19	Train Loss: 0.349	Val F1: 0.348
Best Epoch: 10	Best Val F1: 0.362

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.360
Batch: 3/29	Loss: 0.360
Batch: 5/29	Loss: 0.303
Batch: 7/29	Loss: 0.260
Batch: 9/29	Loss: 0.373
Batch: 11/29	Loss: 0.378
Batch: 13/29	Loss: 0.326
Batch: 15/29	Loss: 0.321
Batch: 17/29	Loss: 0.395
Batch: 19/29	Loss: 0.302
Batch: 21/29	Loss: 0.333
Batch: 23/29	Loss: 0.399
Batch: 25/29	Loss: 0.309
Batch: 27/29	Loss: 0.358
Batch: 29/29	Loss: 0.405
Epoch: 20	Train Loss: 0.334	Val F1: 0.349
Best Epoch: 10	Best Val F1: 0.362

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.317
Batch: 3/29	Loss: 0.259
Batch: 5/29	Loss: 0.301
Batch: 7/29	Loss: 0.562
Batch: 9/29	Loss: 0.282
Batch: 11/29	Loss: 0.264
Batch: 13/29	Loss: 0.385
Batch: 15/29	Loss: 0.355
Batch: 17/29	Loss: 0.265
Batch: 19/29	Loss: 0.287
Batch: 21/29	Loss: 0.308
Batch: 23/29	Loss: 0.254
Batch: 25/29	Loss: 0.295
Batch: 27/29	Loss: 0.293
Batch: 29/29	Loss: 0.338
Epoch: 21	Train Loss: 0.323	Val F1: 0.340
Best Epoch: 10	Best Val F1: 0.362

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.320
Batch: 3/29	Loss: 0.276
Batch: 5/29	Loss: 0.352
Batch: 7/29	Loss: 0.338
Batch: 9/29	Loss: 0.278
Batch: 11/29	Loss: 0.312
Batch: 13/29	Loss: 0.297
Batch: 15/29	Loss: 0.289
Batch: 17/29	Loss: 0.412
Batch: 19/29	Loss: 0.353
Batch: 21/29	Loss: 0.403
Batch: 23/29	Loss: 0.349
Batch: 25/29	Loss: 0.312
Batch: 27/29	Loss: 0.268
Batch: 29/29	Loss: 0.280
Epoch: 22	Train Loss: 0.312	Val F1: 0.343
Best Epoch: 10	Best Val F1: 0.362

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.280
Batch: 3/29	Loss: 0.306
Batch: 5/29	Loss: 0.351
Batch: 7/29	Loss: 0.371
Batch: 9/29	Loss: 0.265
Batch: 11/29	Loss: 0.315
Batch: 13/29	Loss: 0.293
Batch: 15/29	Loss: 0.316
Batch: 17/29	Loss: 0.305
Batch: 19/29	Loss: 0.314
Batch: 21/29	Loss: 0.273
Batch: 23/29	Loss: 0.261
Batch: 25/29	Loss: 0.272
Batch: 27/29	Loss: 0.222
Batch: 29/29	Loss: 0.254
Epoch: 23	Train Loss: 0.298	Val F1: 0.349
Best Epoch: 10	Best Val F1: 0.362

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.243
Batch: 3/29	Loss: 0.261
Batch: 5/29	Loss: 0.312
Batch: 7/29	Loss: 0.282
Batch: 9/29	Loss: 0.348
Batch: 11/29	Loss: 0.328
Batch: 13/29	Loss: 0.220
Batch: 15/29	Loss: 0.291
Batch: 17/29	Loss: 0.254
Batch: 19/29	Loss: 0.329
Batch: 21/29	Loss: 0.315
Batch: 23/29	Loss: 0.253
Batch: 25/29	Loss: 0.279
Batch: 27/29	Loss: 0.250
Batch: 29/29	Loss: 0.292
Epoch: 24	Train Loss: 0.282	Val F1: 0.349
Best Epoch: 10	Best Val F1: 0.362

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.279
Batch: 3/29	Loss: 0.311
Batch: 5/29	Loss: 0.313
Batch: 7/29	Loss: 0.310
Batch: 9/29	Loss: 0.403
Batch: 11/29	Loss: 0.319
Batch: 13/29	Loss: 0.333
Batch: 15/29	Loss: 0.373
Batch: 17/29	Loss: 0.345
Batch: 19/29	Loss: 0.228
Batch: 21/29	Loss: 0.258
Batch: 23/29	Loss: 0.265
Batch: 25/29	Loss: 0.328
Batch: 27/29	Loss: 0.311
Batch: 29/29	Loss: 0.244
Epoch: 25	Train Loss: 0.298	Val F1: 0.349
Best Epoch: 10	Best Val F1: 0.362

Saving the best checkpoint....
Inference...
Test F1: 0.379	Test F1_Few: 0.454	Test F1_Zero: 0.374
Starting training with config: {'batch_size': 64, 'epochs': 25, 'l2_reg': 0.0007702933344453673, 'lr': 2.409350192979909e-05, 'n_layers_freeze': 0, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.060
Batch: 5/29	Loss: 1.017
Batch: 7/29	Loss: 0.992
Batch: 9/29	Loss: 0.964
Batch: 11/29	Loss: 0.952
Batch: 13/29	Loss: 0.938
Batch: 15/29	Loss: 0.947
Batch: 17/29	Loss: 0.904
Batch: 19/29	Loss: 0.904
Batch: 21/29	Loss: 0.881
Batch: 23/29	Loss: 0.891
Batch: 25/29	Loss: 0.855
Batch: 27/29	Loss: 0.854
Batch: 29/29	Loss: 0.862
Epoch: 1	Train Loss: 0.939	Val F1: 0.188
Best Epoch: 1	Best Val F1: 0.188

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.853
Batch: 3/29	Loss: 0.852
Batch: 5/29	Loss: 0.884
Batch: 7/29	Loss: 0.839
Batch: 9/29	Loss: 0.856
Batch: 11/29	Loss: 0.808
Batch: 13/29	Loss: 0.809
Batch: 15/29	Loss: 0.832
Batch: 17/29	Loss: 0.822
Batch: 19/29	Loss: 0.860
Batch: 21/29	Loss: 0.807
Batch: 23/29	Loss: 0.816
Batch: 25/29	Loss: 0.790
Batch: 27/29	Loss: 0.857
Batch: 29/29	Loss: 0.794
Epoch: 2	Train Loss: 0.828	Val F1: 0.187
Best Epoch: 1	Best Val F1: 0.188

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.782
Batch: 3/29	Loss: 0.806
Batch: 5/29	Loss: 0.791
Batch: 7/29	Loss: 0.828
Batch: 9/29	Loss: 0.772
Batch: 11/29	Loss: 0.772
Batch: 13/29	Loss: 0.819
Batch: 15/29	Loss: 0.784
Batch: 17/29	Loss: 0.801
Batch: 19/29	Loss: 0.795
Batch: 21/29	Loss: 0.769
Batch: 23/29	Loss: 0.753
Batch: 25/29	Loss: 0.785
Batch: 27/29	Loss: 0.748
Batch: 29/29	Loss: 0.770
Epoch: 3	Train Loss: 0.788	Val F1: 0.285
Best Epoch: 3	Best Val F1: 0.285

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.736
Batch: 3/29	Loss: 0.757
Batch: 5/29	Loss: 0.739
Batch: 7/29	Loss: 0.797
Batch: 9/29	Loss: 0.769
Batch: 11/29	Loss: 0.691
Batch: 13/29	Loss: 0.718
Batch: 15/29	Loss: 0.701
Batch: 17/29	Loss: 0.692
Batch: 19/29	Loss: 0.770
Batch: 21/29	Loss: 0.743
Batch: 23/29	Loss: 0.744
Batch: 25/29	Loss: 0.716
Batch: 27/29	Loss: 0.763
Batch: 29/29	Loss: 0.723
Epoch: 4	Train Loss: 0.740	Val F1: 0.329
Best Epoch: 4	Best Val F1: 0.329

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.681
Batch: 3/29	Loss: 0.681
Batch: 5/29	Loss: 0.645
Batch: 7/29	Loss: 0.654
Batch: 9/29	Loss: 0.636
Batch: 11/29	Loss: 0.667
Batch: 13/29	Loss: 0.675
Batch: 15/29	Loss: 0.717
Batch: 17/29	Loss: 0.703
Batch: 19/29	Loss: 0.780
Batch: 21/29	Loss: 0.715
Batch: 23/29	Loss: 0.674
Batch: 25/29	Loss: 0.719
Batch: 27/29	Loss: 0.666
Batch: 29/29	Loss: 0.700
Epoch: 5	Train Loss: 0.702	Val F1: 0.272
Best Epoch: 4	Best Val F1: 0.329

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.696
Batch: 3/29	Loss: 0.775
Batch: 5/29	Loss: 0.605
Batch: 7/29	Loss: 0.762
Batch: 9/29	Loss: 0.665
Batch: 11/29	Loss: 0.637
Batch: 13/29	Loss: 0.665
Batch: 15/29	Loss: 0.619
Batch: 17/29	Loss: 0.622
Batch: 19/29	Loss: 0.605
Batch: 21/29	Loss: 0.740
Batch: 23/29	Loss: 0.662
Batch: 25/29	Loss: 0.680
Batch: 27/29	Loss: 0.643
Batch: 29/29	Loss: 0.630
Epoch: 6	Train Loss: 0.671	Val F1: 0.341
Best Epoch: 6	Best Val F1: 0.341

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.601
Batch: 3/29	Loss: 0.682
Batch: 5/29	Loss: 0.711
Batch: 7/29	Loss: 0.717
Batch: 9/29	Loss: 0.713
Batch: 11/29	Loss: 0.568
Batch: 13/29	Loss: 0.647
Batch: 15/29	Loss: 0.644
Batch: 17/29	Loss: 0.673
Batch: 19/29	Loss: 0.673
Batch: 21/29	Loss: 0.604
Batch: 23/29	Loss: 0.605
Batch: 25/29	Loss: 0.542
Batch: 27/29	Loss: 0.624
Batch: 29/29	Loss: 0.536
Epoch: 7	Train Loss: 0.631	Val F1: 0.335
Best Epoch: 6	Best Val F1: 0.341

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.598
Batch: 3/29	Loss: 0.556
Batch: 5/29	Loss: 0.609
Batch: 7/29	Loss: 0.570
Batch: 9/29	Loss: 0.568
Batch: 11/29	Loss: 0.630
Batch: 13/29	Loss: 0.626
Batch: 15/29	Loss: 0.529
Batch: 17/29	Loss: 0.619
Batch: 19/29	Loss: 0.588
Batch: 21/29	Loss: 0.584
Batch: 23/29	Loss: 0.677
Batch: 25/29	Loss: 0.741
Batch: 27/29	Loss: 0.589
Batch: 29/29	Loss: 0.583
Epoch: 8	Train Loss: 0.591	Val F1: 0.325
Best Epoch: 6	Best Val F1: 0.341

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.628
Batch: 3/29	Loss: 0.532
Batch: 5/29	Loss: 0.569
Batch: 7/29	Loss: 0.480
Batch: 9/29	Loss: 0.629
Batch: 11/29	Loss: 0.552
Batch: 13/29	Loss: 0.549
Batch: 15/29	Loss: 0.520
Batch: 17/29	Loss: 0.508
Batch: 19/29	Loss: 0.482
Batch: 21/29	Loss: 0.633
Batch: 23/29	Loss: 0.521
Batch: 25/29	Loss: 0.533
Batch: 27/29	Loss: 0.594
Batch: 29/29	Loss: 0.449
Epoch: 9	Train Loss: 0.544	Val F1: 0.353
Best Epoch: 9	Best Val F1: 0.353

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.422
Batch: 3/29	Loss: 0.502
Batch: 5/29	Loss: 0.469
Batch: 7/29	Loss: 0.428
Batch: 9/29	Loss: 0.511
Batch: 11/29	Loss: 0.414
Batch: 13/29	Loss: 0.594
Batch: 15/29	Loss: 0.554
Batch: 17/29	Loss: 0.551
Batch: 19/29	Loss: 0.365
Batch: 21/29	Loss: 0.559
Batch: 23/29	Loss: 0.525
Batch: 25/29	Loss: 0.546
Batch: 27/29	Loss: 0.477
Batch: 29/29	Loss: 0.527
Epoch: 10	Train Loss: 0.488	Val F1: 0.358
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.461
Batch: 3/29	Loss: 0.399
Batch: 5/29	Loss: 0.602
Batch: 7/29	Loss: 0.467
Batch: 9/29	Loss: 0.406
Batch: 11/29	Loss: 0.431
Batch: 13/29	Loss: 0.458
Batch: 15/29	Loss: 0.375
Batch: 17/29	Loss: 0.528
Batch: 19/29	Loss: 0.479
Batch: 21/29	Loss: 0.385
Batch: 23/29	Loss: 0.365
Batch: 25/29	Loss: 0.373
Batch: 27/29	Loss: 0.386
Batch: 29/29	Loss: 0.407
Epoch: 11	Train Loss: 0.439	Val F1: 0.336
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.492
Batch: 3/29	Loss: 0.353
Batch: 5/29	Loss: 0.382
Batch: 7/29	Loss: 0.423
Batch: 9/29	Loss: 0.448
Batch: 11/29	Loss: 0.436
Batch: 13/29	Loss: 0.412
Batch: 15/29	Loss: 0.360
Batch: 17/29	Loss: 0.426
Batch: 19/29	Loss: 0.374
Batch: 21/29	Loss: 0.339
Batch: 23/29	Loss: 0.420
Batch: 25/29	Loss: 0.396
Batch: 27/29	Loss: 0.526
Batch: 29/29	Loss: 0.316
Epoch: 12	Train Loss: 0.402	Val F1: 0.346
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.451
Batch: 3/29	Loss: 0.302
Batch: 5/29	Loss: 0.403
Batch: 7/29	Loss: 0.384
Batch: 9/29	Loss: 0.414
Batch: 11/29	Loss: 0.398
Batch: 13/29	Loss: 0.367
Batch: 15/29	Loss: 0.367
Batch: 17/29	Loss: 0.320
Batch: 19/29	Loss: 0.265
Batch: 21/29	Loss: 0.321
Batch: 23/29	Loss: 0.380
Batch: 25/29	Loss: 0.281
Batch: 27/29	Loss: 0.416
Batch: 29/29	Loss: 0.451
Epoch: 13	Train Loss: 0.376	Val F1: 0.338
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.386
Batch: 3/29	Loss: 0.382
Batch: 5/29	Loss: 0.309
Batch: 7/29	Loss: 0.380
Batch: 9/29	Loss: 0.456
Batch: 11/29	Loss: 0.377
Batch: 13/29	Loss: 0.323
Batch: 15/29	Loss: 0.267
Batch: 17/29	Loss: 0.429
Batch: 19/29	Loss: 0.418
Batch: 21/29	Loss: 0.223
Batch: 23/29	Loss: 0.314
Batch: 25/29	Loss: 0.379
Batch: 27/29	Loss: 0.370
Batch: 29/29	Loss: 0.370
Epoch: 14	Train Loss: 0.361	Val F1: 0.338
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.344
Batch: 3/29	Loss: 0.339
Batch: 5/29	Loss: 0.234
Batch: 7/29	Loss: 0.324
Batch: 9/29	Loss: 0.396
Batch: 11/29	Loss: 0.340
Batch: 13/29	Loss: 0.315
Batch: 15/29	Loss: 0.314
Batch: 17/29	Loss: 0.378
Batch: 19/29	Loss: 0.352
Batch: 21/29	Loss: 0.326
Batch: 23/29	Loss: 0.353
Batch: 25/29	Loss: 0.384
Batch: 27/29	Loss: 0.310
Batch: 29/29	Loss: 0.393
Epoch: 15	Train Loss: 0.343	Val F1: 0.333
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.341
Batch: 3/29	Loss: 0.345
Batch: 5/29	Loss: 0.384
Batch: 7/29	Loss: 0.276
Batch: 9/29	Loss: 0.323
Batch: 11/29	Loss: 0.339
Batch: 13/29	Loss: 0.291
Batch: 15/29	Loss: 0.230
Batch: 17/29	Loss: 0.281
Batch: 19/29	Loss: 0.379
Batch: 21/29	Loss: 0.270
Batch: 23/29	Loss: 0.345
Batch: 25/29	Loss: 0.332
Batch: 27/29	Loss: 0.301
Batch: 29/29	Loss: 0.310
Epoch: 16	Train Loss: 0.319	Val F1: 0.339
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.290
Batch: 3/29	Loss: 0.380
Batch: 5/29	Loss: 0.313
Batch: 7/29	Loss: 0.275
Batch: 9/29	Loss: 0.193
Batch: 11/29	Loss: 0.355
Batch: 13/29	Loss: 0.364
Batch: 15/29	Loss: 0.334
Batch: 17/29	Loss: 0.358
Batch: 19/29	Loss: 0.363
Batch: 21/29	Loss: 0.313
Batch: 23/29	Loss: 0.462
Batch: 25/29	Loss: 0.255
Batch: 27/29	Loss: 0.287
Batch: 29/29	Loss: 0.478
Epoch: 17	Train Loss: 0.321	Val F1: 0.323
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.343
Batch: 3/29	Loss: 0.464
Batch: 5/29	Loss: 0.284
Batch: 7/29	Loss: 0.294
Batch: 9/29	Loss: 0.404
Batch: 11/29	Loss: 0.226
Batch: 13/29	Loss: 0.234
Batch: 15/29	Loss: 0.259
Batch: 17/29	Loss: 0.307
Batch: 19/29	Loss: 0.247
Batch: 21/29	Loss: 0.344
Batch: 23/29	Loss: 0.307
Batch: 25/29	Loss: 0.280
Batch: 27/29	Loss: 0.218
Batch: 29/29	Loss: 0.341
Epoch: 18	Train Loss: 0.305	Val F1: 0.333
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.227
Batch: 3/29	Loss: 0.202
Batch: 5/29	Loss: 0.289
Batch: 7/29	Loss: 0.320
Batch: 9/29	Loss: 0.246
Batch: 11/29	Loss: 0.275
Batch: 13/29	Loss: 0.319
Batch: 15/29	Loss: 0.272
Batch: 17/29	Loss: 0.244
Batch: 19/29	Loss: 0.327
Batch: 21/29	Loss: 0.319
Batch: 23/29	Loss: 0.319
Batch: 25/29	Loss: 0.314
Batch: 27/29	Loss: 0.227
Batch: 29/29	Loss: 0.251
Epoch: 19	Train Loss: 0.281	Val F1: 0.332
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.351
Batch: 3/29	Loss: 0.294
Batch: 5/29	Loss: 0.257
Batch: 7/29	Loss: 0.204
Batch: 9/29	Loss: 0.295
Batch: 11/29	Loss: 0.277
Batch: 13/29	Loss: 0.288
Batch: 15/29	Loss: 0.258
Batch: 17/29	Loss: 0.382
Batch: 19/29	Loss: 0.262
Batch: 21/29	Loss: 0.242
Batch: 23/29	Loss: 0.267
Batch: 25/29	Loss: 0.246
Batch: 27/29	Loss: 0.251
Batch: 29/29	Loss: 0.279
Epoch: 20	Train Loss: 0.274	Val F1: 0.332
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.220
Batch: 3/29	Loss: 0.188
Batch: 5/29	Loss: 0.235
Batch: 7/29	Loss: 0.405
Batch: 9/29	Loss: 0.287
Batch: 11/29	Loss: 0.169
Batch: 13/29	Loss: 0.301
Batch: 15/29	Loss: 0.311
Batch: 17/29	Loss: 0.261
Batch: 19/29	Loss: 0.237
Batch: 21/29	Loss: 0.241
Batch: 23/29	Loss: 0.230
Batch: 25/29	Loss: 0.293
Batch: 27/29	Loss: 0.260
Batch: 29/29	Loss: 0.296
Epoch: 21	Train Loss: 0.263	Val F1: 0.332
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.236
Batch: 3/29	Loss: 0.228
Batch: 5/29	Loss: 0.238
Batch: 7/29	Loss: 0.303
Batch: 9/29	Loss: 0.244
Batch: 11/29	Loss: 0.229
Batch: 13/29	Loss: 0.200
Batch: 15/29	Loss: 0.307
Batch: 17/29	Loss: 0.310
Batch: 19/29	Loss: 0.427
Batch: 21/29	Loss: 0.323
Batch: 23/29	Loss: 0.262
Batch: 25/29	Loss: 0.265
Batch: 27/29	Loss: 0.233
Batch: 29/29	Loss: 0.236
Epoch: 22	Train Loss: 0.259	Val F1: 0.324
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.220
Batch: 3/29	Loss: 0.238
Batch: 5/29	Loss: 0.258
Batch: 7/29	Loss: 0.309
Batch: 9/29	Loss: 0.230
Batch: 11/29	Loss: 0.215
Batch: 13/29	Loss: 0.215
Batch: 15/29	Loss: 0.202
Batch: 17/29	Loss: 0.237
Batch: 19/29	Loss: 0.275
Batch: 21/29	Loss: 0.213
Batch: 23/29	Loss: 0.195
Batch: 25/29	Loss: 0.245
Batch: 27/29	Loss: 0.178
Batch: 29/29	Loss: 0.251
Epoch: 23	Train Loss: 0.232	Val F1: 0.331
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.163
Batch: 3/29	Loss: 0.203
Batch: 5/29	Loss: 0.300
Batch: 7/29	Loss: 0.194
Batch: 9/29	Loss: 0.252
Batch: 11/29	Loss: 0.320
Batch: 13/29	Loss: 0.176
Batch: 15/29	Loss: 0.217
Batch: 17/29	Loss: 0.210
Batch: 19/29	Loss: 0.249
Batch: 21/29	Loss: 0.258
Batch: 23/29	Loss: 0.208
Batch: 25/29	Loss: 0.229
Batch: 27/29	Loss: 0.199
Batch: 29/29	Loss: 0.205
Epoch: 24	Train Loss: 0.223	Val F1: 0.343
Best Epoch: 10	Best Val F1: 0.358

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.189
Batch: 3/29	Loss: 0.279
Batch: 5/29	Loss: 0.297
Batch: 7/29	Loss: 0.289
Batch: 9/29	Loss: 0.299
Batch: 11/29	Loss: 0.220
Batch: 13/29	Loss: 0.261
Batch: 15/29	Loss: 0.259
Batch: 17/29	Loss: 0.213
Batch: 19/29	Loss: 0.155
Batch: 21/29	Loss: 0.216
Batch: 23/29	Loss: 0.200
Batch: 25/29	Loss: 0.231
Batch: 27/29	Loss: 0.245
Batch: 29/29	Loss: 0.195
Epoch: 25	Train Loss: 0.215	Val F1: 0.333
Best Epoch: 10	Best Val F1: 0.358

Saving the best checkpoint....
Inference...
Test F1: 0.380	Test F1_Few: 0.458	Test F1_Zero: 0.373
Starting training with config: {'batch_size': 16, 'epochs': 75, 'l2_reg': 0.0006142417624429186, 'lr': 2.4240377147685964e-05, 'n_layers_freeze': 1, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 0.962
Batch: 23/116	Loss: 0.897
Batch: 34/116	Loss: 0.877
Batch: 45/116	Loss: 0.835
Batch: 56/116	Loss: 0.835
Batch: 67/116	Loss: 0.777
Batch: 78/116	Loss: 0.783
Batch: 89/116	Loss: 0.877
Batch: 100/116	Loss: 0.750
Batch: 111/116	Loss: 0.793
Batch: 116/116	Loss: 0.737
Epoch: 1	Train Loss: 0.846	Val F1: 0.226
Best Epoch: 1	Best Val F1: 0.226

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.836
Batch: 12/116	Loss: 0.776
Batch: 23/116	Loss: 0.736
Batch: 34/116	Loss: 0.736
Batch: 45/116	Loss: 0.800
Batch: 56/116	Loss: 0.765
Batch: 67/116	Loss: 0.776
Batch: 78/116	Loss: 0.763
Batch: 89/116	Loss: 0.709
Batch: 100/116	Loss: 0.747
Batch: 111/116	Loss: 0.731
Batch: 116/116	Loss: 0.656
Epoch: 2	Train Loss: 0.756	Val F1: 0.326
Best Epoch: 2	Best Val F1: 0.326

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.642
Batch: 12/116	Loss: 0.625
Batch: 23/116	Loss: 0.646
Batch: 34/116	Loss: 0.751
Batch: 45/116	Loss: 0.722
Batch: 56/116	Loss: 0.718
Batch: 67/116	Loss: 0.660
Batch: 78/116	Loss: 0.661
Batch: 89/116	Loss: 0.693
Batch: 100/116	Loss: 0.848
Batch: 111/116	Loss: 0.789
Batch: 116/116	Loss: 0.625
Epoch: 3	Train Loss: 0.703	Val F1: 0.323
Best Epoch: 2	Best Val F1: 0.326

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.692
Batch: 12/116	Loss: 0.516
Batch: 23/116	Loss: 0.863
Batch: 34/116	Loss: 0.579
Batch: 45/116	Loss: 0.693
Batch: 56/116	Loss: 0.655
Batch: 67/116	Loss: 0.687
Batch: 78/116	Loss: 0.565
Batch: 89/116	Loss: 0.711
Batch: 100/116	Loss: 0.620
Batch: 111/116	Loss: 0.615
Batch: 116/116	Loss: 0.707
Epoch: 4	Train Loss: 0.645	Val F1: 0.309
Best Epoch: 2	Best Val F1: 0.326

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.462
Batch: 12/116	Loss: 0.609
Batch: 23/116	Loss: 0.657
Batch: 34/116	Loss: 0.592
Batch: 45/116	Loss: 0.640
Batch: 56/116	Loss: 0.591
Batch: 67/116	Loss: 0.544
Batch: 78/116	Loss: 0.645
Batch: 89/116	Loss: 0.727
Batch: 100/116	Loss: 0.683
Batch: 111/116	Loss: 0.613
Batch: 116/116	Loss: 0.473
Epoch: 5	Train Loss: 0.596	Val F1: 0.344
Best Epoch: 5	Best Val F1: 0.344

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.481
Batch: 12/116	Loss: 0.779
Batch: 23/116	Loss: 0.620
Batch: 34/116	Loss: 0.595
Batch: 45/116	Loss: 0.440
Batch: 56/116	Loss: 0.541
Batch: 67/116	Loss: 0.596
Batch: 78/116	Loss: 0.713
Batch: 89/116	Loss: 0.938
Batch: 100/116	Loss: 0.582
Batch: 111/116	Loss: 0.560
Batch: 116/116	Loss: 0.161
Epoch: 6	Train Loss: 0.525	Val F1: 0.346
Best Epoch: 6	Best Val F1: 0.346

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.368
Batch: 12/116	Loss: 0.684
Batch: 23/116	Loss: 0.569
Batch: 34/116	Loss: 0.620
Batch: 45/116	Loss: 0.388
Batch: 56/116	Loss: 0.645
Batch: 67/116	Loss: 0.455
Batch: 78/116	Loss: 0.467
Batch: 89/116	Loss: 0.353
Batch: 100/116	Loss: 0.407
Batch: 111/116	Loss: 0.719
Batch: 116/116	Loss: 0.245
Epoch: 7	Train Loss: 0.462	Val F1: 0.335
Best Epoch: 6	Best Val F1: 0.346

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.486
Batch: 12/116	Loss: 0.394
Batch: 23/116	Loss: 0.212
Batch: 34/116	Loss: 0.338
Batch: 45/116	Loss: 0.468
Batch: 56/116	Loss: 0.373
Batch: 67/116	Loss: 0.687
Batch: 78/116	Loss: 0.347
Batch: 89/116	Loss: 0.254
Batch: 100/116	Loss: 0.513
Batch: 111/116	Loss: 0.430
Batch: 116/116	Loss: 0.351
Epoch: 8	Train Loss: 0.409	Val F1: 0.351
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.304
Batch: 12/116	Loss: 0.443
Batch: 23/116	Loss: 0.305
Batch: 34/116	Loss: 0.245
Batch: 45/116	Loss: 0.333
Batch: 56/116	Loss: 0.443
Batch: 67/116	Loss: 0.413
Batch: 78/116	Loss: 0.442
Batch: 89/116	Loss: 0.183
Batch: 100/116	Loss: 0.459
Batch: 111/116	Loss: 0.239
Batch: 116/116	Loss: 0.437
Epoch: 9	Train Loss: 0.350	Val F1: 0.340
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.392
Batch: 12/116	Loss: 0.234
Batch: 23/116	Loss: 0.267
Batch: 34/116	Loss: 0.359
Batch: 45/116	Loss: 0.161
Batch: 56/116	Loss: 0.415
Batch: 67/116	Loss: 0.361
Batch: 78/116	Loss: 0.238
Batch: 89/116	Loss: 0.204
Batch: 100/116	Loss: 0.420
Batch: 111/116	Loss: 0.181
Batch: 116/116	Loss: 0.193
Epoch: 10	Train Loss: 0.311	Val F1: 0.347
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.272
Batch: 12/116	Loss: 0.221
Batch: 23/116	Loss: 0.176
Batch: 34/116	Loss: 0.171
Batch: 45/116	Loss: 0.330
Batch: 56/116	Loss: 0.264
Batch: 67/116	Loss: 0.271
Batch: 78/116	Loss: 0.222
Batch: 89/116	Loss: 0.202
Batch: 100/116	Loss: 0.250
Batch: 111/116	Loss: 0.262
Batch: 116/116	Loss: 0.078
Epoch: 11	Train Loss: 0.266	Val F1: 0.345
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 12 ******************************
Batch: 1/116	Loss: 0.281
Batch: 12/116	Loss: 0.240
Batch: 23/116	Loss: 0.127
Batch: 34/116	Loss: 0.254
Batch: 45/116	Loss: 0.143
Batch: 56/116	Loss: 0.194
Batch: 67/116	Loss: 0.166
Batch: 78/116	Loss: 0.247
Batch: 89/116	Loss: 0.211
Batch: 100/116	Loss: 0.250
Batch: 111/116	Loss: 0.152
Batch: 116/116	Loss: 0.080
Epoch: 12	Train Loss: 0.222	Val F1: 0.343
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 13 ******************************
Batch: 1/116	Loss: 0.169
Batch: 12/116	Loss: 0.109
Batch: 23/116	Loss: 0.241
Batch: 34/116	Loss: 0.077
Batch: 45/116	Loss: 0.291
Batch: 56/116	Loss: 0.250
Batch: 67/116	Loss: 0.181
Batch: 78/116	Loss: 0.189
Batch: 89/116	Loss: 0.186
Batch: 100/116	Loss: 0.227
Batch: 111/116	Loss: 0.211
Batch: 116/116	Loss: 0.113
Epoch: 13	Train Loss: 0.185	Val F1: 0.340
Best Epoch: 8	Best Val F1: 0.351

Saving the best checkpoint....
Inference...
Test F1: 0.388	Test F1_Few: 0.465	Test F1_Zero: 0.380
Starting training with config: {'batch_size': 16, 'epochs': 75, 'l2_reg': 0.0009694838005054702, 'lr': 5.346180714724335e-06, 'n_layers_freeze': 2, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 1.060
Batch: 23/116	Loss: 1.016
Batch: 34/116	Loss: 0.991
Batch: 45/116	Loss: 0.949
Batch: 56/116	Loss: 0.930
Batch: 67/116	Loss: 0.896
Batch: 78/116	Loss: 0.894
Batch: 89/116	Loss: 0.928
Batch: 100/116	Loss: 0.865
Batch: 111/116	Loss: 0.876
Batch: 116/116	Loss: 0.859
Epoch: 1	Train Loss: 0.949	Val F1: 0.211
Best Epoch: 1	Best Val F1: 0.211

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.894
Batch: 12/116	Loss: 0.863
Batch: 23/116	Loss: 0.845
Batch: 34/116	Loss: 0.832
Batch: 45/116	Loss: 0.877
Batch: 56/116	Loss: 0.844
Batch: 67/116	Loss: 0.847
Batch: 78/116	Loss: 0.817
Batch: 89/116	Loss: 0.829
Batch: 100/116	Loss: 0.833
Batch: 111/116	Loss: 0.829
Batch: 116/116	Loss: 0.808
Epoch: 2	Train Loss: 0.844	Val F1: 0.214
Best Epoch: 2	Best Val F1: 0.214

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.794
Batch: 12/116	Loss: 0.793
Batch: 23/116	Loss: 0.789
Batch: 34/116	Loss: 0.816
Batch: 45/116	Loss: 0.859
Batch: 56/116	Loss: 0.814
Batch: 67/116	Loss: 0.818
Batch: 78/116	Loss: 0.776
Batch: 89/116	Loss: 0.771
Batch: 100/116	Loss: 0.913
Batch: 111/116	Loss: 0.814
Batch: 116/116	Loss: 0.776
Epoch: 3	Train Loss: 0.808	Val F1: 0.250
Best Epoch: 3	Best Val F1: 0.250

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.801
Batch: 12/116	Loss: 0.764
Batch: 23/116	Loss: 0.858
Batch: 34/116	Loss: 0.773
Batch: 45/116	Loss: 0.826
Batch: 56/116	Loss: 0.793
Batch: 67/116	Loss: 0.789
Batch: 78/116	Loss: 0.748
Batch: 89/116	Loss: 0.776
Batch: 100/116	Loss: 0.789
Batch: 111/116	Loss: 0.738
Batch: 116/116	Loss: 0.873
Epoch: 4	Train Loss: 0.774	Val F1: 0.310
Best Epoch: 4	Best Val F1: 0.310

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.698
Batch: 12/116	Loss: 0.720
Batch: 23/116	Loss: 0.771
Batch: 34/116	Loss: 0.713
Batch: 45/116	Loss: 0.816
Batch: 56/116	Loss: 0.778
Batch: 67/116	Loss: 0.678
Batch: 78/116	Loss: 0.701
Batch: 89/116	Loss: 0.810
Batch: 100/116	Loss: 0.767
Batch: 111/116	Loss: 0.689
Batch: 116/116	Loss: 0.586
Epoch: 5	Train Loss: 0.730	Val F1: 0.328
Best Epoch: 5	Best Val F1: 0.328

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.671
Batch: 12/116	Loss: 0.871
Batch: 23/116	Loss: 0.798
Batch: 34/116	Loss: 0.647
Batch: 45/116	Loss: 0.686
Batch: 56/116	Loss: 0.694
Batch: 67/116	Loss: 0.650
Batch: 78/116	Loss: 0.741
Batch: 89/116	Loss: 0.804
Batch: 100/116	Loss: 0.788
Batch: 111/116	Loss: 0.743
Batch: 116/116	Loss: 0.491
Epoch: 6	Train Loss: 0.691	Val F1: 0.345
Best Epoch: 6	Best Val F1: 0.345

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.594
Batch: 12/116	Loss: 0.718
Batch: 23/116	Loss: 0.819
Batch: 34/116	Loss: 0.869
Batch: 45/116	Loss: 0.648
Batch: 56/116	Loss: 0.894
Batch: 67/116	Loss: 0.720
Batch: 78/116	Loss: 0.682
Batch: 89/116	Loss: 0.548
Batch: 100/116	Loss: 0.637
Batch: 111/116	Loss: 0.855
Batch: 116/116	Loss: 0.558
Epoch: 7	Train Loss: 0.660	Val F1: 0.346
Best Epoch: 7	Best Val F1: 0.346

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.647
Batch: 12/116	Loss: 0.706
Batch: 23/116	Loss: 0.498
Batch: 34/116	Loss: 0.562
Batch: 45/116	Loss: 0.608
Batch: 56/116	Loss: 0.544
Batch: 67/116	Loss: 0.860
Batch: 78/116	Loss: 0.470
Batch: 89/116	Loss: 0.507
Batch: 100/116	Loss: 0.695
Batch: 111/116	Loss: 0.511
Batch: 116/116	Loss: 0.513
Epoch: 8	Train Loss: 0.629	Val F1: 0.345
Best Epoch: 7	Best Val F1: 0.346

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.531
Batch: 12/116	Loss: 0.603
Batch: 23/116	Loss: 0.511
Batch: 34/116	Loss: 0.713
Batch: 45/116	Loss: 0.491
Batch: 56/116	Loss: 0.631
Batch: 67/116	Loss: 0.497
Batch: 78/116	Loss: 0.723
Batch: 89/116	Loss: 0.552
Batch: 100/116	Loss: 0.455
Batch: 111/116	Loss: 0.449
Batch: 116/116	Loss: 0.727
Epoch: 9	Train Loss: 0.591	Val F1: 0.340
Best Epoch: 7	Best Val F1: 0.346

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.532
Batch: 12/116	Loss: 0.588
Batch: 23/116	Loss: 0.467
Batch: 34/116	Loss: 0.736
Batch: 45/116	Loss: 0.421
Batch: 56/116	Loss: 0.505
Batch: 67/116	Loss: 0.721
Batch: 78/116	Loss: 0.432
Batch: 89/116	Loss: 0.419
Batch: 100/116	Loss: 0.606
Batch: 111/116	Loss: 0.382
Batch: 116/116	Loss: 0.434
Epoch: 10	Train Loss: 0.554	Val F1: 0.345
Best Epoch: 7	Best Val F1: 0.346

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.539
Batch: 12/116	Loss: 0.484
Batch: 23/116	Loss: 0.462
Batch: 34/116	Loss: 0.455
Batch: 45/116	Loss: 0.539
Batch: 56/116	Loss: 0.586
Batch: 67/116	Loss: 0.624
Batch: 78/116	Loss: 0.455
Batch: 89/116	Loss: 0.373
Batch: 100/116	Loss: 0.464
Batch: 111/116	Loss: 0.564
Batch: 116/116	Loss: 0.277
Epoch: 11	Train Loss: 0.512	Val F1: 0.344
Best Epoch: 7	Best Val F1: 0.346

****************************** Epoch: 12 ******************************
Batch: 1/116	Loss: 0.701
Batch: 12/116	Loss: 0.439
Batch: 23/116	Loss: 0.342
Batch: 34/116	Loss: 0.584
Batch: 45/116	Loss: 0.353
Batch: 56/116	Loss: 0.564
Batch: 67/116	Loss: 0.305
Batch: 78/116	Loss: 0.547
Batch: 89/116	Loss: 0.533
Batch: 100/116	Loss: 0.600
Batch: 111/116	Loss: 0.496
Batch: 116/116	Loss: 0.562
Epoch: 12	Train Loss: 0.478	Val F1: 0.359
Best Epoch: 12	Best Val F1: 0.359

****************************** Epoch: 13 ******************************
Batch: 1/116	Loss: 0.558
Batch: 12/116	Loss: 0.297
Batch: 23/116	Loss: 0.501
Batch: 34/116	Loss: 0.381
Batch: 45/116	Loss: 0.614
Batch: 56/116	Loss: 0.436
Batch: 67/116	Loss: 0.296
Batch: 78/116	Loss: 0.617
Batch: 89/116	Loss: 0.498
Batch: 100/116	Loss: 0.378
Batch: 111/116	Loss: 0.548
Batch: 116/116	Loss: 0.254
Epoch: 13	Train Loss: 0.454	Val F1: 0.354
Best Epoch: 12	Best Val F1: 0.359

****************************** Epoch: 14 ******************************
Batch: 1/116	Loss: 0.575
Batch: 12/116	Loss: 0.654
Batch: 23/116	Loss: 0.300
Batch: 34/116	Loss: 0.589
Batch: 45/116	Loss: 0.652
Batch: 56/116	Loss: 0.529
Batch: 67/116	Loss: 0.670
Batch: 78/116	Loss: 0.552
Batch: 89/116	Loss: 0.301
Batch: 100/116	Loss: 0.498
Batch: 111/116	Loss: 0.347
Batch: 116/116	Loss: 0.524
Epoch: 14	Train Loss: 0.435	Val F1: 0.354
Best Epoch: 12	Best Val F1: 0.359

****************************** Epoch: 15 ******************************
Batch: 1/116	Loss: 0.263
Batch: 12/116	Loss: 0.564
Batch: 23/116	Loss: 0.339
Batch: 34/116	Loss: 0.454
Batch: 45/116	Loss: 0.378
Batch: 56/116	Loss: 0.530
Batch: 67/116	Loss: 0.477
Batch: 78/116	Loss: 0.354
Batch: 89/116	Loss: 0.569
Batch: 100/116	Loss: 0.519
Batch: 111/116	Loss: 0.334
Batch: 116/116	Loss: 0.174
Epoch: 15	Train Loss: 0.411	Val F1: 0.352
Best Epoch: 12	Best Val F1: 0.359

****************************** Epoch: 16 ******************************
Batch: 1/116	Loss: 0.462
Batch: 12/116	Loss: 0.185
Batch: 23/116	Loss: 0.357
Batch: 34/116	Loss: 0.370
Batch: 45/116	Loss: 0.264
Batch: 56/116	Loss: 0.389
Batch: 67/116	Loss: 0.394
Batch: 78/116	Loss: 0.359
Batch: 89/116	Loss: 0.466
Batch: 100/116	Loss: 0.406
Batch: 111/116	Loss: 0.225
Batch: 116/116	Loss: 0.748
Epoch: 16	Train Loss: 0.393	Val F1: 0.356
Best Epoch: 12	Best Val F1: 0.359

****************************** Epoch: 17 ******************************
Batch: 1/116	Loss: 0.265
Batch: 12/116	Loss: 0.459
Batch: 23/116	Loss: 0.511
Batch: 34/116	Loss: 0.288
Batch: 45/116	Loss: 0.315
Batch: 56/116	Loss: 0.329
Batch: 67/116	Loss: 0.450
Batch: 78/116	Loss: 0.394
Batch: 89/116	Loss: 0.480
Batch: 100/116	Loss: 0.188
Batch: 111/116	Loss: 0.375
Batch: 116/116	Loss: 0.508
Epoch: 17	Train Loss: 0.385	Val F1: 0.347
Best Epoch: 12	Best Val F1: 0.359

****************************** Epoch: 18 ******************************
Batch: 1/116	Loss: 0.456
Batch: 12/116	Loss: 0.288
Batch: 23/116	Loss: 0.351
Batch: 34/116	Loss: 0.429
Batch: 45/116	Loss: 0.207
Batch: 56/116	Loss: 0.485
Batch: 67/116	Loss: 0.351
Batch: 78/116	Loss: 0.413
Batch: 89/116	Loss: 0.309
Batch: 100/116	Loss: 0.361
Batch: 111/116	Loss: 0.129
Batch: 116/116	Loss: 1.165
Epoch: 18	Train Loss: 0.363	Val F1: 0.343
Best Epoch: 12	Best Val F1: 0.359

****************************** Epoch: 19 ******************************
Batch: 1/116	Loss: 0.223
Batch: 12/116	Loss: 0.197
Batch: 23/116	Loss: 0.299
Batch: 34/116	Loss: 0.311
Batch: 45/116	Loss: 0.295
Batch: 56/116	Loss: 0.399
Batch: 67/116	Loss: 0.390
Batch: 78/116	Loss: 0.285
Batch: 89/116	Loss: 0.341
Batch: 100/116	Loss: 0.442
Batch: 111/116	Loss: 0.286
Batch: 116/116	Loss: 0.344
Epoch: 19	Train Loss: 0.352	Val F1: 0.349
Best Epoch: 12	Best Val F1: 0.359

****************************** Epoch: 20 ******************************
Batch: 1/116	Loss: 0.439
Batch: 12/116	Loss: 0.366
Batch: 23/116	Loss: 0.304
Batch: 34/116	Loss: 0.442
Batch: 45/116	Loss: 0.306
Batch: 56/116	Loss: 0.493
Batch: 67/116	Loss: 0.365
Batch: 78/116	Loss: 0.356
Batch: 89/116	Loss: 0.295
Batch: 100/116	Loss: 0.328
Batch: 111/116	Loss: 0.229
Batch: 116/116	Loss: 0.467
Epoch: 20	Train Loss: 0.346	Val F1: 0.346
Best Epoch: 12	Best Val F1: 0.359

****************************** Epoch: 21 ******************************
Batch: 1/116	Loss: 0.367
Batch: 12/116	Loss: 0.244
Batch: 23/116	Loss: 0.491
Batch: 34/116	Loss: 0.470
Batch: 45/116	Loss: 0.440
Batch: 56/116	Loss: 0.251
Batch: 67/116	Loss: 0.153
Batch: 78/116	Loss: 0.411
Batch: 89/116	Loss: 0.350
Batch: 100/116	Loss: 0.363
Batch: 111/116	Loss: 0.165
Batch: 116/116	Loss: 0.363
Epoch: 21	Train Loss: 0.332	Val F1: 0.349
Best Epoch: 12	Best Val F1: 0.359

****************************** Epoch: 22 ******************************
Batch: 1/116	Loss: 0.447
Batch: 12/116	Loss: 0.152
Batch: 23/116	Loss: 0.293
Batch: 34/116	Loss: 0.231
Batch: 45/116	Loss: 0.317
Batch: 56/116	Loss: 0.237
Batch: 67/116	Loss: 0.217
Batch: 78/116	Loss: 0.265
Batch: 89/116	Loss: 0.233
Batch: 100/116	Loss: 0.267
Batch: 111/116	Loss: 0.358
Batch: 116/116	Loss: 0.484
Epoch: 22	Train Loss: 0.321	Val F1: 0.349
Best Epoch: 12	Best Val F1: 0.359

Saving the best checkpoint....
Inference...
Test F1: 0.375	Test F1_Few: 0.452	Test F1_Zero: 0.365
Starting training with config: {'batch_size': 16, 'epochs': 75, 'l2_reg': 0.0007792092951827913, 'lr': 2.1270910017941224e-06, 'n_layers_freeze': 0, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 1.081
Batch: 23/116	Loss: 1.064
Batch: 34/116	Loss: 1.055
Batch: 45/116	Loss: 1.029
Batch: 56/116	Loss: 1.014
Batch: 67/116	Loss: 0.982
Batch: 78/116	Loss: 0.972
Batch: 89/116	Loss: 0.980
Batch: 100/116	Loss: 0.945
Batch: 111/116	Loss: 0.941
Batch: 116/116	Loss: 0.934
Epoch: 1	Train Loss: 1.012	Val F1: 0.205
Best Epoch: 1	Best Val F1: 0.205

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.952
Batch: 12/116	Loss: 0.929
Batch: 23/116	Loss: 0.911
Batch: 34/116	Loss: 0.900
Batch: 45/116	Loss: 0.929
Batch: 56/116	Loss: 0.906
Batch: 67/116	Loss: 0.902
Batch: 78/116	Loss: 0.881
Batch: 89/116	Loss: 0.889
Batch: 100/116	Loss: 0.891
Batch: 111/116	Loss: 0.887
Batch: 116/116	Loss: 0.873
Epoch: 2	Train Loss: 0.904	Val F1: 0.187
Best Epoch: 1	Best Val F1: 0.205

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.862
Batch: 12/116	Loss: 0.862
Batch: 23/116	Loss: 0.860
Batch: 34/116	Loss: 0.874
Batch: 45/116	Loss: 0.901
Batch: 56/116	Loss: 0.870
Batch: 67/116	Loss: 0.875
Batch: 78/116	Loss: 0.843
Batch: 89/116	Loss: 0.842
Batch: 100/116	Loss: 0.935
Batch: 111/116	Loss: 0.875
Batch: 116/116	Loss: 0.833
Epoch: 3	Train Loss: 0.867	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.205

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.855
Batch: 12/116	Loss: 0.839
Batch: 23/116	Loss: 0.887
Batch: 34/116	Loss: 0.827
Batch: 45/116	Loss: 0.875
Batch: 56/116	Loss: 0.847
Batch: 67/116	Loss: 0.853
Batch: 78/116	Loss: 0.819
Batch: 89/116	Loss: 0.866
Batch: 100/116	Loss: 0.862
Batch: 111/116	Loss: 0.816
Batch: 116/116	Loss: 0.890
Epoch: 4	Train Loss: 0.845	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.205

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.813
Batch: 12/116	Loss: 0.810
Batch: 23/116	Loss: 0.816
Batch: 34/116	Loss: 0.813
Batch: 45/116	Loss: 0.893
Batch: 56/116	Loss: 0.835
Batch: 67/116	Loss: 0.825
Batch: 78/116	Loss: 0.835
Batch: 89/116	Loss: 0.828
Batch: 100/116	Loss: 0.833
Batch: 111/116	Loss: 0.832
Batch: 116/116	Loss: 0.783
Epoch: 5	Train Loss: 0.828	Val F1: 0.195
Best Epoch: 1	Best Val F1: 0.205

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.798
Batch: 12/116	Loss: 0.919
Batch: 23/116	Loss: 0.783
Batch: 34/116	Loss: 0.783
Batch: 45/116	Loss: 0.792
Batch: 56/116	Loss: 0.822
Batch: 67/116	Loss: 0.783
Batch: 78/116	Loss: 0.848
Batch: 89/116	Loss: 0.814
Batch: 100/116	Loss: 0.846
Batch: 111/116	Loss: 0.842
Batch: 116/116	Loss: 0.765
Epoch: 6	Train Loss: 0.813	Val F1: 0.250
Best Epoch: 6	Best Val F1: 0.250

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.773
Batch: 12/116	Loss: 0.822
Batch: 23/116	Loss: 0.954
Batch: 34/116	Loss: 0.839
Batch: 45/116	Loss: 0.782
Batch: 56/116	Loss: 0.882
Batch: 67/116	Loss: 0.830
Batch: 78/116	Loss: 0.819
Batch: 89/116	Loss: 0.754
Batch: 100/116	Loss: 0.739
Batch: 111/116	Loss: 0.828
Batch: 116/116	Loss: 0.779
Epoch: 7	Train Loss: 0.796	Val F1: 0.271
Best Epoch: 7	Best Val F1: 0.271

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.820
Batch: 12/116	Loss: 0.759
Batch: 23/116	Loss: 0.725
Batch: 34/116	Loss: 0.780
Batch: 45/116	Loss: 0.741
Batch: 56/116	Loss: 0.776
Batch: 67/116	Loss: 0.926
Batch: 78/116	Loss: 0.722
Batch: 89/116	Loss: 0.710
Batch: 100/116	Loss: 0.784
Batch: 111/116	Loss: 0.739
Batch: 116/116	Loss: 0.727
Epoch: 8	Train Loss: 0.774	Val F1: 0.292
Best Epoch: 8	Best Val F1: 0.292

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.803
Batch: 12/116	Loss: 0.746
Batch: 23/116	Loss: 0.731
Batch: 34/116	Loss: 0.832
Batch: 45/116	Loss: 0.735
Batch: 56/116	Loss: 0.774
Batch: 67/116	Loss: 0.719
Batch: 78/116	Loss: 0.712
Batch: 89/116	Loss: 0.677
Batch: 100/116	Loss: 0.662
Batch: 111/116	Loss: 0.643
Batch: 116/116	Loss: 0.760
Epoch: 9	Train Loss: 0.746	Val F1: 0.300
Best Epoch: 9	Best Val F1: 0.300

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.738
Batch: 12/116	Loss: 0.733
Batch: 23/116	Loss: 0.673
Batch: 34/116	Loss: 0.798
Batch: 45/116	Loss: 0.669
Batch: 56/116	Loss: 0.671
Batch: 67/116	Loss: 0.769
Batch: 78/116	Loss: 0.650
Batch: 89/116	Loss: 0.666
Batch: 100/116	Loss: 0.678
Batch: 111/116	Loss: 0.693
Batch: 116/116	Loss: 0.710
Epoch: 10	Train Loss: 0.718	Val F1: 0.300
Best Epoch: 10	Best Val F1: 0.300

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.676
Batch: 12/116	Loss: 0.636
Batch: 23/116	Loss: 0.689
Batch: 34/116	Loss: 0.683
Batch: 45/116	Loss: 0.660
Batch: 56/116	Loss: 0.725
Batch: 67/116	Loss: 0.812
Batch: 78/116	Loss: 0.662
Batch: 89/116	Loss: 0.758
Batch: 100/116	Loss: 0.684
Batch: 111/116	Loss: 0.726
Batch: 116/116	Loss: 0.502
Epoch: 11	Train Loss: 0.704	Val F1: 0.332
Best Epoch: 11	Best Val F1: 0.332

****************************** Epoch: 12 ******************************
Batch: 1/116	Loss: 0.896
Batch: 12/116	Loss: 0.657
Batch: 23/116	Loss: 0.623
Batch: 34/116	Loss: 0.700
Batch: 45/116	Loss: 0.670
Batch: 56/116	Loss: 0.748
Batch: 67/116	Loss: 0.645
Batch: 78/116	Loss: 0.628
Batch: 89/116	Loss: 0.637
Batch: 100/116	Loss: 0.748
Batch: 111/116	Loss: 0.579
Batch: 116/116	Loss: 0.642
Epoch: 12	Train Loss: 0.676	Val F1: 0.318
Best Epoch: 11	Best Val F1: 0.332

****************************** Epoch: 13 ******************************
Batch: 1/116	Loss: 0.715
Batch: 12/116	Loss: 0.578
Batch: 23/116	Loss: 0.692
Batch: 34/116	Loss: 0.580
Batch: 45/116	Loss: 0.702
Batch: 56/116	Loss: 0.688
Batch: 67/116	Loss: 0.555
Batch: 78/116	Loss: 0.795
Batch: 89/116	Loss: 0.654
Batch: 100/116	Loss: 0.599
Batch: 111/116	Loss: 0.795
Batch: 116/116	Loss: 0.479
Epoch: 13	Train Loss: 0.660	Val F1: 0.332
Best Epoch: 13	Best Val F1: 0.332

****************************** Epoch: 14 ******************************
Batch: 1/116	Loss: 0.686
Batch: 12/116	Loss: 0.749
Batch: 23/116	Loss: 0.607
Batch: 34/116	Loss: 0.580
Batch: 45/116	Loss: 0.743
Batch: 56/116	Loss: 0.708
Batch: 67/116	Loss: 0.818
Batch: 78/116	Loss: 0.742
Batch: 89/116	Loss: 0.531
Batch: 100/116	Loss: 0.807
Batch: 111/116	Loss: 0.587
Batch: 116/116	Loss: 0.565
Epoch: 14	Train Loss: 0.638	Val F1: 0.339
Best Epoch: 14	Best Val F1: 0.339

****************************** Epoch: 15 ******************************
Batch: 1/116	Loss: 0.502
Batch: 12/116	Loss: 0.715
Batch: 23/116	Loss: 0.577
Batch: 34/116	Loss: 0.629
Batch: 45/116	Loss: 0.700
Batch: 56/116	Loss: 0.637
Batch: 67/116	Loss: 0.611
Batch: 78/116	Loss: 0.534
Batch: 89/116	Loss: 0.686
Batch: 100/116	Loss: 0.729
Batch: 111/116	Loss: 0.478
Batch: 116/116	Loss: 0.351
Epoch: 15	Train Loss: 0.610	Val F1: 0.336
Best Epoch: 14	Best Val F1: 0.339

****************************** Epoch: 16 ******************************
Batch: 1/116	Loss: 0.690
Batch: 12/116	Loss: 0.358
Batch: 23/116	Loss: 0.555
Batch: 34/116	Loss: 0.607
Batch: 45/116	Loss: 0.538
Batch: 56/116	Loss: 0.565
Batch: 67/116	Loss: 0.530
Batch: 78/116	Loss: 0.525
Batch: 89/116	Loss: 0.530
Batch: 100/116	Loss: 0.626
Batch: 111/116	Loss: 0.546
Batch: 116/116	Loss: 0.675
Epoch: 16	Train Loss: 0.593	Val F1: 0.326
Best Epoch: 14	Best Val F1: 0.339

****************************** Epoch: 17 ******************************
Batch: 1/116	Loss: 0.607
Batch: 12/116	Loss: 0.697
Batch: 23/116	Loss: 0.628
Batch: 34/116	Loss: 0.676
Batch: 45/116	Loss: 0.571
Batch: 56/116	Loss: 0.504
Batch: 67/116	Loss: 0.570
Batch: 78/116	Loss: 0.494
Batch: 89/116	Loss: 0.579
Batch: 100/116	Loss: 0.354
Batch: 111/116	Loss: 0.597
Batch: 116/116	Loss: 0.682
Epoch: 17	Train Loss: 0.575	Val F1: 0.335
Best Epoch: 14	Best Val F1: 0.339

****************************** Epoch: 18 ******************************
Batch: 1/116	Loss: 0.533
Batch: 12/116	Loss: 0.530
Batch: 23/116	Loss: 0.470
Batch: 34/116	Loss: 0.593
Batch: 45/116	Loss: 0.369
Batch: 56/116	Loss: 0.596
Batch: 67/116	Loss: 0.603
Batch: 78/116	Loss: 0.614
Batch: 89/116	Loss: 0.539
Batch: 100/116	Loss: 0.678
Batch: 111/116	Loss: 0.329
Batch: 116/116	Loss: 1.218
Epoch: 18	Train Loss: 0.562	Val F1: 0.339
Best Epoch: 14	Best Val F1: 0.339

****************************** Epoch: 19 ******************************
Batch: 1/116	Loss: 0.401
Batch: 12/116	Loss: 0.421
Batch: 23/116	Loss: 0.488
Batch: 34/116	Loss: 0.416
Batch: 45/116	Loss: 0.441
Batch: 56/116	Loss: 0.535
Batch: 67/116	Loss: 0.571
Batch: 78/116	Loss: 0.505
Batch: 89/116	Loss: 0.534
Batch: 100/116	Loss: 0.559
Batch: 111/116	Loss: 0.431
Batch: 116/116	Loss: 0.428
Epoch: 19	Train Loss: 0.535	Val F1: 0.342
Best Epoch: 19	Best Val F1: 0.342

****************************** Epoch: 20 ******************************
Batch: 1/116	Loss: 0.573
Batch: 12/116	Loss: 0.473
Batch: 23/116	Loss: 0.446
Batch: 34/116	Loss: 0.543
Batch: 45/116	Loss: 0.447
Batch: 56/116	Loss: 0.616
Batch: 67/116	Loss: 0.602
Batch: 78/116	Loss: 0.460
Batch: 89/116	Loss: 0.476
Batch: 100/116	Loss: 0.442
Batch: 111/116	Loss: 0.358
Batch: 116/116	Loss: 0.494
Epoch: 20	Train Loss: 0.518	Val F1: 0.341
Best Epoch: 19	Best Val F1: 0.342

****************************** Epoch: 21 ******************************
Batch: 1/116	Loss: 0.550
Batch: 12/116	Loss: 0.431
Batch: 23/116	Loss: 0.438
Batch: 34/116	Loss: 0.637
Batch: 45/116	Loss: 0.599
Batch: 56/116	Loss: 0.375
Batch: 67/116	Loss: 0.306
Batch: 78/116	Loss: 0.643
Batch: 89/116	Loss: 0.447
Batch: 100/116	Loss: 0.552
Batch: 111/116	Loss: 0.282
Batch: 116/116	Loss: 0.397
Epoch: 21	Train Loss: 0.501	Val F1: 0.338
Best Epoch: 19	Best Val F1: 0.342

****************************** Epoch: 22 ******************************
Batch: 1/116	Loss: 0.605
Batch: 12/116	Loss: 0.448
Batch: 23/116	Loss: 0.512
Batch: 34/116	Loss: 0.324
Batch: 45/116	Loss: 0.448
Batch: 56/116	Loss: 0.412
Batch: 67/116	Loss: 0.479
Batch: 78/116	Loss: 0.447
Batch: 89/116	Loss: 0.378
Batch: 100/116	Loss: 0.328
Batch: 111/116	Loss: 0.551
Batch: 116/116	Loss: 0.622
Epoch: 22	Train Loss: 0.489	Val F1: 0.330
Best Epoch: 19	Best Val F1: 0.342

****************************** Epoch: 23 ******************************
Batch: 1/116	Loss: 0.368
Batch: 12/116	Loss: 0.337
Batch: 23/116	Loss: 0.513
Batch: 34/116	Loss: 0.446
Batch: 45/116	Loss: 0.688
Batch: 56/116	Loss: 0.545
Batch: 67/116	Loss: 0.465
Batch: 78/116	Loss: 0.481
Batch: 89/116	Loss: 0.356
Batch: 100/116	Loss: 0.253
Batch: 111/116	Loss: 0.389
Batch: 116/116	Loss: 0.769
Epoch: 23	Train Loss: 0.476	Val F1: 0.343
Best Epoch: 23	Best Val F1: 0.343

****************************** Epoch: 24 ******************************
Batch: 1/116	Loss: 0.428
Batch: 12/116	Loss: 0.387
Batch: 23/116	Loss: 0.400
Batch: 34/116	Loss: 0.634
Batch: 45/116	Loss: 0.447
Batch: 56/116	Loss: 0.345
Batch: 67/116	Loss: 0.328
Batch: 78/116	Loss: 0.388
Batch: 89/116	Loss: 0.331
Batch: 100/116	Loss: 0.643
Batch: 111/116	Loss: 0.392
Batch: 116/116	Loss: 0.600
Epoch: 24	Train Loss: 0.458	Val F1: 0.340
Best Epoch: 23	Best Val F1: 0.343

****************************** Epoch: 25 ******************************
Batch: 1/116	Loss: 0.465
Batch: 12/116	Loss: 0.730
Batch: 23/116	Loss: 0.563
Batch: 34/116	Loss: 0.368
Batch: 45/116	Loss: 0.411
Batch: 56/116	Loss: 0.420
Batch: 67/116	Loss: 0.660
Batch: 78/116	Loss: 0.464
Batch: 89/116	Loss: 0.353
Batch: 100/116	Loss: 0.353
Batch: 111/116	Loss: 0.375
Batch: 116/116	Loss: 0.534
Epoch: 25	Train Loss: 0.461	Val F1: 0.339
Best Epoch: 23	Best Val F1: 0.343

****************************** Epoch: 26 ******************************
Batch: 1/116	Loss: 0.475
Batch: 12/116	Loss: 0.303
Batch: 23/116	Loss: 0.394
Batch: 34/116	Loss: 0.305
Batch: 45/116	Loss: 0.729
Batch: 56/116	Loss: 0.499
Batch: 67/116	Loss: 0.426
Batch: 78/116	Loss: 0.530
Batch: 89/116	Loss: 0.384
Batch: 100/116	Loss: 0.649
Batch: 111/116	Loss: 0.370
Batch: 116/116	Loss: 0.475
Epoch: 26	Train Loss: 0.450	Val F1: 0.341
Best Epoch: 23	Best Val F1: 0.343

****************************** Epoch: 27 ******************************
Batch: 1/116	Loss: 0.252
Batch: 12/116	Loss: 0.611
Batch: 23/116	Loss: 0.348
Batch: 34/116	Loss: 0.575
Batch: 45/116	Loss: 0.359
Batch: 56/116	Loss: 0.505
Batch: 67/116	Loss: 0.463
Batch: 78/116	Loss: 0.411
Batch: 89/116	Loss: 0.361
Batch: 100/116	Loss: 0.359
Batch: 111/116	Loss: 0.409
Batch: 116/116	Loss: 0.541
Epoch: 27	Train Loss: 0.436	Val F1: 0.341
Best Epoch: 23	Best Val F1: 0.343

****************************** Epoch: 28 ******************************
Batch: 1/116	Loss: 0.404
Batch: 12/116	Loss: 0.274
Batch: 23/116	Loss: 0.456
Batch: 34/116	Loss: 0.508
Batch: 45/116	Loss: 0.287
Batch: 56/116	Loss: 0.433
Batch: 67/116	Loss: 0.575
Batch: 78/116	Loss: 0.509
Batch: 89/116	Loss: 0.447
Batch: 100/116	Loss: 0.391
Batch: 111/116	Loss: 0.718
Batch: 116/116	Loss: 0.440
Epoch: 28	Train Loss: 0.432	Val F1: 0.339
Best Epoch: 23	Best Val F1: 0.343

****************************** Epoch: 29 ******************************
Batch: 1/116	Loss: 0.700
Batch: 12/116	Loss: 0.283
Batch: 23/116	Loss: 0.448
Batch: 34/116	Loss: 0.351
Batch: 45/116	Loss: 0.453
Batch: 56/116	Loss: 0.687
Batch: 67/116	Loss: 0.770
Batch: 78/116	Loss: 0.366
Batch: 89/116	Loss: 0.412
Batch: 100/116	Loss: 0.707
Batch: 111/116	Loss: 0.590
Batch: 116/116	Loss: 0.953
Epoch: 29	Train Loss: 0.431	Val F1: 0.347
Best Epoch: 29	Best Val F1: 0.347

****************************** Epoch: 30 ******************************
Batch: 1/116	Loss: 0.362
Batch: 12/116	Loss: 0.465
Batch: 23/116	Loss: 0.330
Batch: 34/116	Loss: 0.268
Batch: 45/116	Loss: 0.746
Batch: 56/116	Loss: 0.347
Batch: 67/116	Loss: 0.624
Batch: 78/116	Loss: 0.607
Batch: 89/116	Loss: 0.462
Batch: 100/116	Loss: 0.367
Batch: 111/116	Loss: 0.259
Batch: 116/116	Loss: 0.338
Epoch: 30	Train Loss: 0.411	Val F1: 0.329
Best Epoch: 29	Best Val F1: 0.347

****************************** Epoch: 31 ******************************
Batch: 1/116	Loss: 0.346
Batch: 12/116	Loss: 0.284
Batch: 23/116	Loss: 0.391
Batch: 34/116	Loss: 0.410
Batch: 45/116	Loss: 0.388
Batch: 56/116	Loss: 0.499
Batch: 67/116	Loss: 0.407
Batch: 78/116	Loss: 0.440
Batch: 89/116	Loss: 0.433
Batch: 100/116	Loss: 0.402
Batch: 111/116	Loss: 0.709
Batch: 116/116	Loss: 0.264
Epoch: 31	Train Loss: 0.404	Val F1: 0.334
Best Epoch: 29	Best Val F1: 0.347

****************************** Epoch: 32 ******************************
Batch: 1/116	Loss: 0.501
Batch: 12/116	Loss: 0.339
Batch: 23/116	Loss: 0.418
Batch: 34/116	Loss: 0.407
Batch: 45/116	Loss: 0.371
Batch: 56/116	Loss: 0.391
Batch: 67/116	Loss: 0.510
Batch: 78/116	Loss: 0.334
Batch: 89/116	Loss: 0.409
Batch: 100/116	Loss: 0.507
Batch: 111/116	Loss: 0.487
Batch: 116/116	Loss: 0.337
Epoch: 32	Train Loss: 0.400	Val F1: 0.335
Best Epoch: 29	Best Val F1: 0.347

****************************** Epoch: 33 ******************************
Batch: 1/116	Loss: 0.441
Batch: 12/116	Loss: 0.431
Batch: 23/116	Loss: 0.271
Batch: 34/116	Loss: 0.394
Batch: 45/116	Loss: 0.292
Batch: 56/116	Loss: 0.412
Batch: 67/116	Loss: 0.478
Batch: 78/116	Loss: 0.415
Batch: 89/116	Loss: 0.291
Batch: 100/116	Loss: 0.454
Batch: 111/116	Loss: 0.350
Batch: 116/116	Loss: 0.518
Epoch: 33	Train Loss: 0.393	Val F1: 0.337
Best Epoch: 29	Best Val F1: 0.347

****************************** Epoch: 34 ******************************
Batch: 1/116	Loss: 0.461
Batch: 12/116	Loss: 0.600
Batch: 23/116	Loss: 0.322
Batch: 34/116	Loss: 0.365
Batch: 45/116	Loss: 0.427
Batch: 56/116	Loss: 0.372
Batch: 67/116	Loss: 0.589
Batch: 78/116	Loss: 0.330
Batch: 89/116	Loss: 0.429
Batch: 100/116	Loss: 0.315
Batch: 111/116	Loss: 0.349
Batch: 116/116	Loss: 0.474
Epoch: 34	Train Loss: 0.390	Val F1: 0.336
Best Epoch: 29	Best Val F1: 0.347

****************************** Epoch: 35 ******************************
Batch: 1/116	Loss: 0.343
Batch: 12/116	Loss: 0.341
Batch: 23/116	Loss: 0.404
Batch: 34/116	Loss: 0.442
Batch: 45/116	Loss: 0.490
Batch: 56/116	Loss: 0.480
Batch: 67/116	Loss: 0.274
Batch: 78/116	Loss: 0.317
Batch: 89/116	Loss: 0.599
Batch: 100/116	Loss: 0.325
Batch: 111/116	Loss: 0.454
Batch: 116/116	Loss: 0.218
Epoch: 35	Train Loss: 0.390	Val F1: 0.335
Best Epoch: 29	Best Val F1: 0.347

****************************** Epoch: 36 ******************************
Batch: 1/116	Loss: 0.461
Batch: 12/116	Loss: 0.363
Batch: 23/116	Loss: 0.491
Batch: 34/116	Loss: 0.453
Batch: 45/116	Loss: 0.273
Batch: 56/116	Loss: 0.358
Batch: 67/116	Loss: 0.596
Batch: 78/116	Loss: 0.299
Batch: 89/116	Loss: 0.269
Batch: 100/116	Loss: 0.447
Batch: 111/116	Loss: 0.430
Batch: 116/116	Loss: 0.152
Epoch: 36	Train Loss: 0.378	Val F1: 0.342
Best Epoch: 29	Best Val F1: 0.347

****************************** Epoch: 37 ******************************
Batch: 1/116	Loss: 0.253
Batch: 12/116	Loss: 0.417
Batch: 23/116	Loss: 0.486
Batch: 34/116	Loss: 0.296
Batch: 45/116	Loss: 0.443
Batch: 56/116	Loss: 0.475
Batch: 67/116	Loss: 0.337
Batch: 78/116	Loss: 0.540
Batch: 89/116	Loss: 0.358
Batch: 100/116	Loss: 0.354
Batch: 111/116	Loss: 0.362
Batch: 116/116	Loss: 0.108
Epoch: 37	Train Loss: 0.372	Val F1: 0.339
Best Epoch: 29	Best Val F1: 0.347

****************************** Epoch: 38 ******************************
Batch: 1/116	Loss: 0.274
Batch: 12/116	Loss: 0.303
Batch: 23/116	Loss: 0.355
Batch: 34/116	Loss: 0.468
Batch: 45/116	Loss: 0.371
Batch: 56/116	Loss: 0.421
Batch: 67/116	Loss: 0.454
Batch: 78/116	Loss: 0.291
Batch: 89/116	Loss: 0.239
Batch: 100/116	Loss: 0.460
Batch: 111/116	Loss: 0.257
Batch: 116/116	Loss: 0.329
Epoch: 38	Train Loss: 0.369	Val F1: 0.338
Best Epoch: 29	Best Val F1: 0.347

****************************** Epoch: 39 ******************************
Batch: 1/116	Loss: 0.470
Batch: 12/116	Loss: 0.468
Batch: 23/116	Loss: 0.240
Batch: 34/116	Loss: 0.374
Batch: 45/116	Loss: 0.249
Batch: 56/116	Loss: 0.283
Batch: 67/116	Loss: 0.336
Batch: 78/116	Loss: 0.372
Batch: 89/116	Loss: 0.329
Batch: 100/116	Loss: 0.418
Batch: 111/116	Loss: 0.340
Batch: 116/116	Loss: 0.530
Epoch: 39	Train Loss: 0.367	Val F1: 0.328
Best Epoch: 29	Best Val F1: 0.347

Saving the best checkpoint....
Inference...
Test F1: 0.378	Test F1_Few: 0.452	Test F1_Zero: 0.374
Starting training with config: {'batch_size': 8, 'epochs': 75, 'l2_reg': 0.0009288403875750462, 'lr': 1.949892155732423e-05, 'n_layers_freeze': 2, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/231	Loss: 1.080
Batch: 24/231	Loss: 0.914
Batch: 47/231	Loss: 0.847
Batch: 70/231	Loss: 0.835
Batch: 93/231	Loss: 0.776
Batch: 116/231	Loss: 0.877
Batch: 139/231	Loss: 0.827
Batch: 162/231	Loss: 0.834
Batch: 185/231	Loss: 0.734
Batch: 208/231	Loss: 0.745
Batch: 231/231	Loss: 0.687
Epoch: 1	Train Loss: 0.823	Val F1: 0.286
Best Epoch: 1	Best Val F1: 0.286

****************************** Epoch: 2 ******************************
Batch: 1/231	Loss: 0.782
Batch: 24/231	Loss: 0.761
Batch: 47/231	Loss: 0.771
Batch: 70/231	Loss: 0.939
Batch: 93/231	Loss: 0.748
Batch: 116/231	Loss: 0.659
Batch: 139/231	Loss: 1.100
Batch: 162/231	Loss: 0.595
Batch: 185/231	Loss: 0.663
Batch: 208/231	Loss: 0.759
Batch: 231/231	Loss: 0.577
Epoch: 2	Train Loss: 0.723	Val F1: 0.337
Best Epoch: 2	Best Val F1: 0.337

****************************** Epoch: 3 ******************************
Batch: 1/231	Loss: 0.529
Batch: 24/231	Loss: 0.542
Batch: 47/231	Loss: 0.766
Batch: 70/231	Loss: 0.702
Batch: 93/231	Loss: 0.626
Batch: 116/231	Loss: 0.466
Batch: 139/231	Loss: 0.553
Batch: 162/231	Loss: 0.649
Batch: 185/231	Loss: 0.620
Batch: 208/231	Loss: 0.631
Batch: 231/231	Loss: 0.605
Epoch: 3	Train Loss: 0.669	Val F1: 0.311
Best Epoch: 2	Best Val F1: 0.337

****************************** Epoch: 4 ******************************
Batch: 1/231	Loss: 0.875
Batch: 24/231	Loss: 0.541
Batch: 47/231	Loss: 0.646
Batch: 70/231	Loss: 0.679
Batch: 93/231	Loss: 0.708
Batch: 116/231	Loss: 0.613
Batch: 139/231	Loss: 1.650
Batch: 162/231	Loss: 0.687
Batch: 185/231	Loss: 0.475
Batch: 208/231	Loss: 0.480
Batch: 231/231	Loss: 0.672
Epoch: 4	Train Loss: 0.615	Val F1: 0.326
Best Epoch: 2	Best Val F1: 0.337

****************************** Epoch: 5 ******************************
Batch: 1/231	Loss: 0.344
Batch: 24/231	Loss: 0.445
Batch: 47/231	Loss: 0.806
Batch: 70/231	Loss: 0.600
Batch: 93/231	Loss: 0.687
Batch: 116/231	Loss: 0.356
Batch: 139/231	Loss: 0.883
Batch: 162/231	Loss: 0.483
Batch: 185/231	Loss: 0.491
Batch: 208/231	Loss: 0.317
Batch: 231/231	Loss: 0.461
Epoch: 5	Train Loss: 0.557	Val F1: 0.343
Best Epoch: 5	Best Val F1: 0.343

****************************** Epoch: 6 ******************************
Batch: 1/231	Loss: 0.522
Batch: 24/231	Loss: 0.559
Batch: 47/231	Loss: 0.400
Batch: 70/231	Loss: 0.453
Batch: 93/231	Loss: 0.254
Batch: 116/231	Loss: 0.549
Batch: 139/231	Loss: 0.643
Batch: 162/231	Loss: 0.645
Batch: 185/231	Loss: 0.618
Batch: 208/231	Loss: 0.654
Batch: 231/231	Loss: 0.299
Epoch: 6	Train Loss: 0.484	Val F1: 0.361
Best Epoch: 6	Best Val F1: 0.361

****************************** Epoch: 7 ******************************
Batch: 1/231	Loss: 0.506
Batch: 24/231	Loss: 0.580
Batch: 47/231	Loss: 0.322
Batch: 70/231	Loss: 0.563
Batch: 93/231	Loss: 0.475
Batch: 116/231	Loss: 0.286
Batch: 139/231	Loss: 0.210
Batch: 162/231	Loss: 0.458
Batch: 185/231	Loss: 0.378
Batch: 208/231	Loss: 0.632
Batch: 231/231	Loss: 0.183
Epoch: 7	Train Loss: 0.427	Val F1: 0.355
Best Epoch: 6	Best Val F1: 0.361

****************************** Epoch: 8 ******************************
Batch: 1/231	Loss: 0.448
Batch: 24/231	Loss: 0.304
Batch: 47/231	Loss: 0.381
Batch: 70/231	Loss: 0.304
Batch: 93/231	Loss: 0.284
Batch: 116/231	Loss: 0.245
Batch: 139/231	Loss: 0.374
Batch: 162/231	Loss: 0.334
Batch: 185/231	Loss: 0.449
Batch: 208/231	Loss: 0.143
Batch: 231/231	Loss: 0.395
Epoch: 8	Train Loss: 0.378	Val F1: 0.348
Best Epoch: 6	Best Val F1: 0.361

****************************** Epoch: 9 ******************************
Batch: 1/231	Loss: 0.360
Batch: 24/231	Loss: 0.417
Batch: 47/231	Loss: 0.506
Batch: 70/231	Loss: 0.788
Batch: 93/231	Loss: 0.330
Batch: 116/231	Loss: 0.279
Batch: 139/231	Loss: 0.517
Batch: 162/231	Loss: 0.539
Batch: 185/231	Loss: 0.330
Batch: 208/231	Loss: 0.441
Batch: 231/231	Loss: 0.390
Epoch: 9	Train Loss: 0.336	Val F1: 0.356
Best Epoch: 6	Best Val F1: 0.361

****************************** Epoch: 10 ******************************
Batch: 1/231	Loss: 0.303
Batch: 24/231	Loss: 0.183
Batch: 47/231	Loss: 0.328
Batch: 70/231	Loss: 0.121
Batch: 93/231	Loss: 0.350
Batch: 116/231	Loss: 0.143
Batch: 139/231	Loss: 0.166
Batch: 162/231	Loss: 0.218
Batch: 185/231	Loss: 0.749
Batch: 208/231	Loss: 0.238
Batch: 231/231	Loss: 0.240
Epoch: 10	Train Loss: 0.299	Val F1: 0.344
Best Epoch: 6	Best Val F1: 0.361

****************************** Epoch: 11 ******************************
Batch: 1/231	Loss: 0.240
Batch: 24/231	Loss: 0.152
Batch: 47/231	Loss: 0.105
Batch: 70/231	Loss: 0.140
Batch: 93/231	Loss: 0.301
Batch: 116/231	Loss: 0.395
Batch: 139/231	Loss: 0.370
Batch: 162/231	Loss: 0.226
Batch: 185/231	Loss: 0.288
Batch: 208/231	Loss: 0.195
Batch: 231/231	Loss: 0.140
Epoch: 11	Train Loss: 0.276	Val F1: 0.334
Best Epoch: 6	Best Val F1: 0.361

****************************** Epoch: 12 ******************************
Batch: 1/231	Loss: 0.301
Batch: 24/231	Loss: 0.213
Batch: 47/231	Loss: 0.224
Batch: 70/231	Loss: 0.213
Batch: 93/231	Loss: 0.331
Batch: 116/231	Loss: 0.058
Batch: 139/231	Loss: 0.196
Batch: 162/231	Loss: 0.268
Batch: 185/231	Loss: 0.094
Batch: 208/231	Loss: 0.263
Batch: 231/231	Loss: 0.061
Epoch: 12	Train Loss: 0.242	Val F1: 0.340
Best Epoch: 6	Best Val F1: 0.361

****************************** Epoch: 13 ******************************
Batch: 1/231	Loss: 0.117
Batch: 24/231	Loss: 0.104
Batch: 47/231	Loss: 0.066
Batch: 70/231	Loss: 0.173
Batch: 93/231	Loss: 0.152
Batch: 116/231	Loss: 0.241
Batch: 139/231	Loss: 0.129
Batch: 162/231	Loss: 0.083
Batch: 185/231	Loss: 0.187
Batch: 208/231	Loss: 0.072
Batch: 231/231	Loss: 0.059
Epoch: 13	Train Loss: 0.209	Val F1: 0.338
Best Epoch: 6	Best Val F1: 0.361

****************************** Epoch: 14 ******************************
Batch: 1/231	Loss: 0.318
Batch: 24/231	Loss: 0.275
Batch: 47/231	Loss: 0.213
Batch: 70/231	Loss: 0.160
Batch: 93/231	Loss: 0.123
Batch: 116/231	Loss: 0.052
Batch: 139/231	Loss: 0.076
Batch: 162/231	Loss: 0.037
Batch: 185/231	Loss: 0.120
Batch: 208/231	Loss: 0.038
Batch: 231/231	Loss: 0.053
Epoch: 14	Train Loss: 0.163	Val F1: 0.345
Best Epoch: 6	Best Val F1: 0.361

****************************** Epoch: 15 ******************************
Batch: 1/231	Loss: 0.038
Batch: 24/231	Loss: 0.183
Batch: 47/231	Loss: 0.079
Batch: 70/231	Loss: 0.229
Batch: 93/231	Loss: 0.152
Batch: 116/231	Loss: 0.107
Batch: 139/231	Loss: 0.081
Batch: 162/231	Loss: 0.112
Batch: 185/231	Loss: 0.044
Batch: 208/231	Loss: 0.164
Batch: 231/231	Loss: 0.017
Epoch: 15	Train Loss: 0.131	Val F1: 0.352
Best Epoch: 6	Best Val F1: 0.361

****************************** Epoch: 16 ******************************
Batch: 1/231	Loss: 0.132
Batch: 24/231	Loss: 0.087
Batch: 47/231	Loss: 0.077
Batch: 70/231	Loss: 0.224
Batch: 93/231	Loss: 0.226
Batch: 116/231	Loss: 0.028
Batch: 139/231	Loss: 0.013
Batch: 162/231	Loss: 0.103
Batch: 185/231	Loss: 0.013
Batch: 208/231	Loss: 0.070
Batch: 231/231	Loss: 0.246
Epoch: 16	Train Loss: 0.103	Val F1: 0.346
Best Epoch: 6	Best Val F1: 0.361

Saving the best checkpoint....
Inference...
Test F1: 0.381	Test F1_Few: 0.467	Test F1_Zero: 0.363
Starting training with config: {'batch_size': 16, 'epochs': 75, 'l2_reg': 0.0009449681066384798, 'lr': 2.1780851085101593e-05, 'n_layers_freeze': 5, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 0.977
Batch: 23/116	Loss: 0.908
Batch: 34/116	Loss: 0.888
Batch: 45/116	Loss: 0.844
Batch: 56/116	Loss: 0.839
Batch: 67/116	Loss: 0.785
Batch: 78/116	Loss: 0.792
Batch: 89/116	Loss: 0.879
Batch: 100/116	Loss: 0.756
Batch: 111/116	Loss: 0.797
Batch: 116/116	Loss: 0.741
Epoch: 1	Train Loss: 0.855	Val F1: 0.233
Best Epoch: 1	Best Val F1: 0.233

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.837
Batch: 12/116	Loss: 0.780
Batch: 23/116	Loss: 0.746
Batch: 34/116	Loss: 0.742
Batch: 45/116	Loss: 0.809
Batch: 56/116	Loss: 0.752
Batch: 67/116	Loss: 0.742
Batch: 78/116	Loss: 0.760
Batch: 89/116	Loss: 0.721
Batch: 100/116	Loss: 0.690
Batch: 111/116	Loss: 0.711
Batch: 116/116	Loss: 0.676
Epoch: 2	Train Loss: 0.754	Val F1: 0.327
Best Epoch: 2	Best Val F1: 0.327

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.645
Batch: 12/116	Loss: 0.573
Batch: 23/116	Loss: 0.657
Batch: 34/116	Loss: 0.722
Batch: 45/116	Loss: 0.758
Batch: 56/116	Loss: 0.725
Batch: 67/116	Loss: 0.661
Batch: 78/116	Loss: 0.665
Batch: 89/116	Loss: 0.711
Batch: 100/116	Loss: 0.832
Batch: 111/116	Loss: 0.933
Batch: 116/116	Loss: 0.597
Epoch: 3	Train Loss: 0.695	Val F1: 0.331
Best Epoch: 3	Best Val F1: 0.331

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.667
Batch: 12/116	Loss: 0.505
Batch: 23/116	Loss: 0.824
Batch: 34/116	Loss: 0.601
Batch: 45/116	Loss: 0.749
Batch: 56/116	Loss: 0.610
Batch: 67/116	Loss: 0.733
Batch: 78/116	Loss: 0.557
Batch: 89/116	Loss: 0.656
Batch: 100/116	Loss: 0.574
Batch: 111/116	Loss: 0.664
Batch: 116/116	Loss: 0.737
Epoch: 4	Train Loss: 0.643	Val F1: 0.330
Best Epoch: 3	Best Val F1: 0.331

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.453
Batch: 12/116	Loss: 0.545
Batch: 23/116	Loss: 0.636
Batch: 34/116	Loss: 0.489
Batch: 45/116	Loss: 0.670
Batch: 56/116	Loss: 0.508
Batch: 67/116	Loss: 0.567
Batch: 78/116	Loss: 0.575
Batch: 89/116	Loss: 0.657
Batch: 100/116	Loss: 0.654
Batch: 111/116	Loss: 0.567
Batch: 116/116	Loss: 0.483
Epoch: 5	Train Loss: 0.589	Val F1: 0.336
Best Epoch: 5	Best Val F1: 0.336

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.523
Batch: 12/116	Loss: 0.813
Batch: 23/116	Loss: 0.407
Batch: 34/116	Loss: 0.532
Batch: 45/116	Loss: 0.455
Batch: 56/116	Loss: 0.421
Batch: 67/116	Loss: 0.426
Batch: 78/116	Loss: 0.661
Batch: 89/116	Loss: 0.870
Batch: 100/116	Loss: 0.523
Batch: 111/116	Loss: 0.544
Batch: 116/116	Loss: 0.218
Epoch: 6	Train Loss: 0.518	Val F1: 0.356
Best Epoch: 6	Best Val F1: 0.356

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.399
Batch: 12/116	Loss: 0.541
Batch: 23/116	Loss: 0.503
Batch: 34/116	Loss: 0.660
Batch: 45/116	Loss: 0.292
Batch: 56/116	Loss: 0.942
Batch: 67/116	Loss: 0.501
Batch: 78/116	Loss: 0.533
Batch: 89/116	Loss: 0.427
Batch: 100/116	Loss: 0.278
Batch: 111/116	Loss: 0.692
Batch: 116/116	Loss: 0.174
Epoch: 7	Train Loss: 0.474	Val F1: 0.341
Best Epoch: 6	Best Val F1: 0.356

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.592
Batch: 12/116	Loss: 0.474
Batch: 23/116	Loss: 0.234
Batch: 34/116	Loss: 0.466
Batch: 45/116	Loss: 0.400
Batch: 56/116	Loss: 0.250
Batch: 67/116	Loss: 0.714
Batch: 78/116	Loss: 0.331
Batch: 89/116	Loss: 0.280
Batch: 100/116	Loss: 0.563
Batch: 111/116	Loss: 0.300
Batch: 116/116	Loss: 0.453
Epoch: 8	Train Loss: 0.422	Val F1: 0.329
Best Epoch: 6	Best Val F1: 0.356

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.364
Batch: 12/116	Loss: 0.407
Batch: 23/116	Loss: 0.319
Batch: 34/116	Loss: 0.301
Batch: 45/116	Loss: 0.340
Batch: 56/116	Loss: 0.399
Batch: 67/116	Loss: 0.312
Batch: 78/116	Loss: 0.402
Batch: 89/116	Loss: 0.225
Batch: 100/116	Loss: 0.364
Batch: 111/116	Loss: 0.237
Batch: 116/116	Loss: 0.432
Epoch: 9	Train Loss: 0.373	Val F1: 0.344
Best Epoch: 6	Best Val F1: 0.356

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.373
Batch: 12/116	Loss: 0.243
Batch: 23/116	Loss: 0.292
Batch: 34/116	Loss: 0.376
Batch: 45/116	Loss: 0.178
Batch: 56/116	Loss: 0.372
Batch: 67/116	Loss: 0.424
Batch: 78/116	Loss: 0.227
Batch: 89/116	Loss: 0.298
Batch: 100/116	Loss: 0.421
Batch: 111/116	Loss: 0.256
Batch: 116/116	Loss: 0.360
Epoch: 10	Train Loss: 0.340	Val F1: 0.339
Best Epoch: 6	Best Val F1: 0.356

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.297
Batch: 12/116	Loss: 0.229
Batch: 23/116	Loss: 0.136
Batch: 34/116	Loss: 0.268
Batch: 45/116	Loss: 0.394
Batch: 56/116	Loss: 0.428
Batch: 67/116	Loss: 0.294
Batch: 78/116	Loss: 0.274
Batch: 89/116	Loss: 0.171
Batch: 100/116	Loss: 0.316
Batch: 111/116	Loss: 0.352
Batch: 116/116	Loss: 0.101
Epoch: 11	Train Loss: 0.303	Val F1: 0.331
Best Epoch: 6	Best Val F1: 0.356

****************************** Epoch: 12 ******************************
Batch: 1/116	Loss: 0.442
Batch: 12/116	Loss: 0.247
Batch: 23/116	Loss: 0.177
Batch: 34/116	Loss: 0.242
Batch: 45/116	Loss: 0.238
Batch: 56/116	Loss: 0.320
Batch: 67/116	Loss: 0.125
Batch: 78/116	Loss: 0.300
Batch: 89/116	Loss: 0.304
Batch: 100/116	Loss: 0.276
Batch: 111/116	Loss: 0.198
Batch: 116/116	Loss: 0.090
Epoch: 12	Train Loss: 0.274	Val F1: 0.330
Best Epoch: 6	Best Val F1: 0.356

****************************** Epoch: 13 ******************************
Batch: 1/116	Loss: 0.156
Batch: 12/116	Loss: 0.113
Batch: 23/116	Loss: 0.316
Batch: 34/116	Loss: 0.143
Batch: 45/116	Loss: 0.551
Batch: 56/116	Loss: 0.296
Batch: 67/116	Loss: 0.112
Batch: 78/116	Loss: 0.287
Batch: 89/116	Loss: 0.357
Batch: 100/116	Loss: 0.284
Batch: 111/116	Loss: 0.208
Batch: 116/116	Loss: 0.095
Epoch: 13	Train Loss: 0.247	Val F1: 0.331
Best Epoch: 6	Best Val F1: 0.356

****************************** Epoch: 14 ******************************
Batch: 1/116	Loss: 0.442
Batch: 12/116	Loss: 0.370
Batch: 23/116	Loss: 0.223
Batch: 34/116	Loss: 0.336
Batch: 45/116	Loss: 0.244
Batch: 56/116	Loss: 0.316
Batch: 67/116	Loss: 0.226
Batch: 78/116	Loss: 0.438
Batch: 89/116	Loss: 0.178
Batch: 100/116	Loss: 0.191
Batch: 111/116	Loss: 0.148
Batch: 116/116	Loss: 0.201
Epoch: 14	Train Loss: 0.216	Val F1: 0.333
Best Epoch: 6	Best Val F1: 0.356

****************************** Epoch: 15 ******************************
Batch: 1/116	Loss: 0.169
Batch: 12/116	Loss: 0.367
Batch: 23/116	Loss: 0.075
Batch: 34/116	Loss: 0.229
Batch: 45/116	Loss: 0.274
Batch: 56/116	Loss: 0.122
Batch: 67/116	Loss: 0.196
Batch: 78/116	Loss: 0.092
Batch: 89/116	Loss: 0.155
Batch: 100/116	Loss: 0.241
Batch: 111/116	Loss: 0.124
Batch: 116/116	Loss: 0.113
Epoch: 15	Train Loss: 0.172	Val F1: 0.335
Best Epoch: 6	Best Val F1: 0.356

****************************** Epoch: 16 ******************************
Batch: 1/116	Loss: 0.187
Batch: 12/116	Loss: 0.071
Batch: 23/116	Loss: 0.206
Batch: 34/116	Loss: 0.265
Batch: 45/116	Loss: 0.103
Batch: 56/116	Loss: 0.251
Batch: 67/116	Loss: 0.251
Batch: 78/116	Loss: 0.165
Batch: 89/116	Loss: 0.117
Batch: 100/116	Loss: 0.131
Batch: 111/116	Loss: 0.037
Batch: 116/116	Loss: 0.246
Epoch: 16	Train Loss: 0.152	Val F1: 0.345
Best Epoch: 6	Best Val F1: 0.356

Saving the best checkpoint....
Inference...
Test F1: 0.386	Test F1_Few: 0.437	Test F1_Zero: 0.402
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0009396359349293224, 'lr': 3.443863738094544e-05, 'n_layers_freeze': 4, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.050
Batch: 5/29	Loss: 0.998
Batch: 7/29	Loss: 0.968
Batch: 9/29	Loss: 0.936
Batch: 11/29	Loss: 0.931
Batch: 13/29	Loss: 0.916
Batch: 15/29	Loss: 0.929
Batch: 17/29	Loss: 0.878
Batch: 19/29	Loss: 0.882
Batch: 21/29	Loss: 0.853
Batch: 23/29	Loss: 0.870
Batch: 25/29	Loss: 0.827
Batch: 27/29	Loss: 0.826
Batch: 29/29	Loss: 0.838
Epoch: 1	Train Loss: 0.917	Val F1: 0.187
Best Epoch: 1	Best Val F1: 0.187

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.827
Batch: 3/29	Loss: 0.827
Batch: 5/29	Loss: 0.867
Batch: 7/29	Loss: 0.812
Batch: 9/29	Loss: 0.835
Batch: 11/29	Loss: 0.778
Batch: 13/29	Loss: 0.781
Batch: 15/29	Loss: 0.807
Batch: 17/29	Loss: 0.798
Batch: 19/29	Loss: 0.846
Batch: 21/29	Loss: 0.783
Batch: 23/29	Loss: 0.796
Batch: 25/29	Loss: 0.765
Batch: 27/29	Loss: 0.844
Batch: 29/29	Loss: 0.770
Epoch: 2	Train Loss: 0.804	Val F1: 0.206
Best Epoch: 2	Best Val F1: 0.206

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.756
Batch: 3/29	Loss: 0.788
Batch: 5/29	Loss: 0.769
Batch: 7/29	Loss: 0.813
Batch: 9/29	Loss: 0.748
Batch: 11/29	Loss: 0.749
Batch: 13/29	Loss: 0.804
Batch: 15/29	Loss: 0.766
Batch: 17/29	Loss: 0.787
Batch: 19/29	Loss: 0.772
Batch: 21/29	Loss: 0.742
Batch: 23/29	Loss: 0.729
Batch: 25/29	Loss: 0.769
Batch: 27/29	Loss: 0.751
Batch: 29/29	Loss: 0.743
Epoch: 3	Train Loss: 0.767	Val F1: 0.315
Best Epoch: 3	Best Val F1: 0.315

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.708
Batch: 3/29	Loss: 0.725
Batch: 5/29	Loss: 0.710
Batch: 7/29	Loss: 0.770
Batch: 9/29	Loss: 0.721
Batch: 11/29	Loss: 0.657
Batch: 13/29	Loss: 0.702
Batch: 15/29	Loss: 0.662
Batch: 17/29	Loss: 0.682
Batch: 19/29	Loss: 0.720
Batch: 21/29	Loss: 0.717
Batch: 23/29	Loss: 0.699
Batch: 25/29	Loss: 0.671
Batch: 27/29	Loss: 0.705
Batch: 29/29	Loss: 0.697
Epoch: 4	Train Loss: 0.709	Val F1: 0.338
Best Epoch: 4	Best Val F1: 0.338

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.638
Batch: 3/29	Loss: 0.614
Batch: 5/29	Loss: 0.601
Batch: 7/29	Loss: 0.650
Batch: 9/29	Loss: 0.600
Batch: 11/29	Loss: 0.607
Batch: 13/29	Loss: 0.672
Batch: 15/29	Loss: 0.668
Batch: 17/29	Loss: 0.806
Batch: 19/29	Loss: 0.643
Batch: 21/29	Loss: 0.616
Batch: 23/29	Loss: 0.662
Batch: 25/29	Loss: 0.662
Batch: 27/29	Loss: 0.639
Batch: 29/29	Loss: 0.671
Epoch: 5	Train Loss: 0.661	Val F1: 0.326
Best Epoch: 4	Best Val F1: 0.338

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.646
Batch: 3/29	Loss: 0.690
Batch: 5/29	Loss: 0.544
Batch: 7/29	Loss: 0.687
Batch: 9/29	Loss: 0.621
Batch: 11/29	Loss: 0.558
Batch: 13/29	Loss: 0.577
Batch: 15/29	Loss: 0.563
Batch: 17/29	Loss: 0.588
Batch: 19/29	Loss: 0.524
Batch: 21/29	Loss: 0.702
Batch: 23/29	Loss: 0.643
Batch: 25/29	Loss: 0.591
Batch: 27/29	Loss: 0.603
Batch: 29/29	Loss: 0.617
Epoch: 6	Train Loss: 0.606	Val F1: 0.343
Best Epoch: 6	Best Val F1: 0.343

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.565
Batch: 3/29	Loss: 0.624
Batch: 5/29	Loss: 0.680
Batch: 7/29	Loss: 0.577
Batch: 9/29	Loss: 0.588
Batch: 11/29	Loss: 0.489
Batch: 13/29	Loss: 0.542
Batch: 15/29	Loss: 0.515
Batch: 17/29	Loss: 0.629
Batch: 19/29	Loss: 0.618
Batch: 21/29	Loss: 0.563
Batch: 23/29	Loss: 0.505
Batch: 25/29	Loss: 0.455
Batch: 27/29	Loss: 0.486
Batch: 29/29	Loss: 0.528
Epoch: 7	Train Loss: 0.549	Val F1: 0.364
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.499
Batch: 3/29	Loss: 0.416
Batch: 5/29	Loss: 0.574
Batch: 7/29	Loss: 0.545
Batch: 9/29	Loss: 0.499
Batch: 11/29	Loss: 0.555
Batch: 13/29	Loss: 0.528
Batch: 15/29	Loss: 0.466
Batch: 17/29	Loss: 0.515
Batch: 19/29	Loss: 0.397
Batch: 21/29	Loss: 0.496
Batch: 23/29	Loss: 0.501
Batch: 25/29	Loss: 0.600
Batch: 27/29	Loss: 0.596
Batch: 29/29	Loss: 0.535
Epoch: 8	Train Loss: 0.508	Val F1: 0.357
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.584
Batch: 3/29	Loss: 0.514
Batch: 5/29	Loss: 0.479
Batch: 7/29	Loss: 0.399
Batch: 9/29	Loss: 0.502
Batch: 11/29	Loss: 0.513
Batch: 13/29	Loss: 0.434
Batch: 15/29	Loss: 0.424
Batch: 17/29	Loss: 0.466
Batch: 19/29	Loss: 0.379
Batch: 21/29	Loss: 0.548
Batch: 23/29	Loss: 0.486
Batch: 25/29	Loss: 0.522
Batch: 27/29	Loss: 0.546
Batch: 29/29	Loss: 0.385
Epoch: 9	Train Loss: 0.479	Val F1: 0.350
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.377
Batch: 3/29	Loss: 0.480
Batch: 5/29	Loss: 0.390
Batch: 7/29	Loss: 0.388
Batch: 9/29	Loss: 0.409
Batch: 11/29	Loss: 0.366
Batch: 13/29	Loss: 0.493
Batch: 15/29	Loss: 0.448
Batch: 17/29	Loss: 0.511
Batch: 19/29	Loss: 0.336
Batch: 21/29	Loss: 0.507
Batch: 23/29	Loss: 0.513
Batch: 25/29	Loss: 0.600
Batch: 27/29	Loss: 0.455
Batch: 29/29	Loss: 0.478
Epoch: 10	Train Loss: 0.437	Val F1: 0.355
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.472
Batch: 3/29	Loss: 0.333
Batch: 5/29	Loss: 0.552
Batch: 7/29	Loss: 0.401
Batch: 9/29	Loss: 0.393
Batch: 11/29	Loss: 0.431
Batch: 13/29	Loss: 0.352
Batch: 15/29	Loss: 0.338
Batch: 17/29	Loss: 0.483
Batch: 19/29	Loss: 0.429
Batch: 21/29	Loss: 0.344
Batch: 23/29	Loss: 0.331
Batch: 25/29	Loss: 0.317
Batch: 27/29	Loss: 0.360
Batch: 29/29	Loss: 0.428
Epoch: 11	Train Loss: 0.399	Val F1: 0.348
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.456
Batch: 3/29	Loss: 0.330
Batch: 5/29	Loss: 0.358
Batch: 7/29	Loss: 0.361
Batch: 9/29	Loss: 0.383
Batch: 11/29	Loss: 0.395
Batch: 13/29	Loss: 0.355
Batch: 15/29	Loss: 0.390
Batch: 17/29	Loss: 0.326
Batch: 19/29	Loss: 0.327
Batch: 21/29	Loss: 0.342
Batch: 23/29	Loss: 0.386
Batch: 25/29	Loss: 0.339
Batch: 27/29	Loss: 0.481
Batch: 29/29	Loss: 0.311
Epoch: 12	Train Loss: 0.367	Val F1: 0.345
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.395
Batch: 3/29	Loss: 0.283
Batch: 5/29	Loss: 0.385
Batch: 7/29	Loss: 0.305
Batch: 9/29	Loss: 0.373
Batch: 11/29	Loss: 0.383
Batch: 13/29	Loss: 0.352
Batch: 15/29	Loss: 0.310
Batch: 17/29	Loss: 0.289
Batch: 19/29	Loss: 0.209
Batch: 21/29	Loss: 0.327
Batch: 23/29	Loss: 0.317
Batch: 25/29	Loss: 0.247
Batch: 27/29	Loss: 0.373
Batch: 29/29	Loss: 0.398
Epoch: 13	Train Loss: 0.341	Val F1: 0.337
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.351
Batch: 3/29	Loss: 0.381
Batch: 5/29	Loss: 0.250
Batch: 7/29	Loss: 0.332
Batch: 9/29	Loss: 0.359
Batch: 11/29	Loss: 0.297
Batch: 13/29	Loss: 0.282
Batch: 15/29	Loss: 0.260
Batch: 17/29	Loss: 0.323
Batch: 19/29	Loss: 0.390
Batch: 21/29	Loss: 0.209
Batch: 23/29	Loss: 0.263
Batch: 25/29	Loss: 0.325
Batch: 27/29	Loss: 0.309
Batch: 29/29	Loss: 0.301
Epoch: 14	Train Loss: 0.315	Val F1: 0.336
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.307
Batch: 3/29	Loss: 0.312
Batch: 5/29	Loss: 0.215
Batch: 7/29	Loss: 0.253
Batch: 9/29	Loss: 0.343
Batch: 11/29	Loss: 0.292
Batch: 13/29	Loss: 0.285
Batch: 15/29	Loss: 0.269
Batch: 17/29	Loss: 0.323
Batch: 19/29	Loss: 0.291
Batch: 21/29	Loss: 0.343
Batch: 23/29	Loss: 0.280
Batch: 25/29	Loss: 0.324
Batch: 27/29	Loss: 0.303
Batch: 29/29	Loss: 0.301
Epoch: 15	Train Loss: 0.297	Val F1: 0.350
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.293
Batch: 3/29	Loss: 0.272
Batch: 5/29	Loss: 0.313
Batch: 7/29	Loss: 0.246
Batch: 9/29	Loss: 0.258
Batch: 11/29	Loss: 0.273
Batch: 13/29	Loss: 0.258
Batch: 15/29	Loss: 0.214
Batch: 17/29	Loss: 0.274
Batch: 19/29	Loss: 0.320
Batch: 21/29	Loss: 0.236
Batch: 23/29	Loss: 0.307
Batch: 25/29	Loss: 0.357
Batch: 27/29	Loss: 0.269
Batch: 29/29	Loss: 0.299
Epoch: 16	Train Loss: 0.278	Val F1: 0.344
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.273
Batch: 3/29	Loss: 0.287
Batch: 5/29	Loss: 0.307
Batch: 7/29	Loss: 0.263
Batch: 9/29	Loss: 0.142
Batch: 11/29	Loss: 0.245
Batch: 13/29	Loss: 0.305
Batch: 15/29	Loss: 0.288
Batch: 17/29	Loss: 0.325
Batch: 19/29	Loss: 0.224
Batch: 21/29	Loss: 0.259
Batch: 23/29	Loss: 0.374
Batch: 25/29	Loss: 0.168
Batch: 27/29	Loss: 0.241
Batch: 29/29	Loss: 0.262
Epoch: 17	Train Loss: 0.256	Val F1: 0.333
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.292
Batch: 3/29	Loss: 0.306
Batch: 5/29	Loss: 0.245
Batch: 7/29	Loss: 0.217
Batch: 9/29	Loss: 0.333
Batch: 11/29	Loss: 0.227
Batch: 13/29	Loss: 0.180
Batch: 15/29	Loss: 0.251
Batch: 17/29	Loss: 0.262
Batch: 19/29	Loss: 0.191
Batch: 21/29	Loss: 0.246
Batch: 23/29	Loss: 0.264
Batch: 25/29	Loss: 0.231
Batch: 27/29	Loss: 0.182
Batch: 29/29	Loss: 0.250
Epoch: 18	Train Loss: 0.240	Val F1: 0.326
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.166
Batch: 3/29	Loss: 0.162
Batch: 5/29	Loss: 0.281
Batch: 7/29	Loss: 0.291
Batch: 9/29	Loss: 0.205
Batch: 11/29	Loss: 0.201
Batch: 13/29	Loss: 0.242
Batch: 15/29	Loss: 0.205
Batch: 17/29	Loss: 0.150
Batch: 19/29	Loss: 0.219
Batch: 21/29	Loss: 0.206
Batch: 23/29	Loss: 0.235
Batch: 25/29	Loss: 0.266
Batch: 27/29	Loss: 0.163
Batch: 29/29	Loss: 0.223
Epoch: 19	Train Loss: 0.208	Val F1: 0.349
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.225
Batch: 3/29	Loss: 0.195
Batch: 5/29	Loss: 0.196
Batch: 7/29	Loss: 0.118
Batch: 9/29	Loss: 0.190
Batch: 11/29	Loss: 0.168
Batch: 13/29	Loss: 0.172
Batch: 15/29	Loss: 0.183
Batch: 17/29	Loss: 0.203
Batch: 19/29	Loss: 0.133
Batch: 21/29	Loss: 0.194
Batch: 23/29	Loss: 0.192
Batch: 25/29	Loss: 0.188
Batch: 27/29	Loss: 0.203
Batch: 29/29	Loss: 0.176
Epoch: 20	Train Loss: 0.176	Val F1: 0.339
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.147
Batch: 3/29	Loss: 0.129
Batch: 5/29	Loss: 0.171
Batch: 7/29	Loss: 0.275
Batch: 9/29	Loss: 0.124
Batch: 11/29	Loss: 0.103
Batch: 13/29	Loss: 0.179
Batch: 15/29	Loss: 0.194
Batch: 17/29	Loss: 0.095
Batch: 19/29	Loss: 0.148
Batch: 21/29	Loss: 0.186
Batch: 23/29	Loss: 0.157
Batch: 25/29	Loss: 0.178
Batch: 27/29	Loss: 0.180
Batch: 29/29	Loss: 0.254
Epoch: 21	Train Loss: 0.160	Val F1: 0.346
Best Epoch: 7	Best Val F1: 0.364

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.181
Batch: 3/29	Loss: 0.106
Batch: 5/29	Loss: 0.152
Batch: 7/29	Loss: 0.161
Batch: 9/29	Loss: 0.124
Batch: 11/29	Loss: 0.128
Batch: 13/29	Loss: 0.112
Batch: 15/29	Loss: 0.165
Batch: 17/29	Loss: 0.186
Batch: 19/29	Loss: 0.143
Batch: 21/29	Loss: 0.195
Batch: 23/29	Loss: 0.152
Batch: 25/29	Loss: 0.108
Batch: 27/29	Loss: 0.085
Batch: 29/29	Loss: 0.127
Epoch: 22	Train Loss: 0.141	Val F1: 0.344
Best Epoch: 7	Best Val F1: 0.364

Saving the best checkpoint....
Inference...
Test F1: 0.373	Test F1_Few: 0.446	Test F1_Zero: 0.367
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0007833295699910707, 'lr': 2.102547162150615e-05, 'n_layers_freeze': 4, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.068
Batch: 5/29	Loss: 1.035
Batch: 7/29	Loss: 1.012
Batch: 9/29	Loss: 0.984
Batch: 11/29	Loss: 0.968
Batch: 13/29	Loss: 0.955
Batch: 15/29	Loss: 0.960
Batch: 17/29	Loss: 0.917
Batch: 19/29	Loss: 0.915
Batch: 21/29	Loss: 0.894
Batch: 23/29	Loss: 0.901
Batch: 25/29	Loss: 0.868
Batch: 27/29	Loss: 0.864
Batch: 29/29	Loss: 0.872
Epoch: 1	Train Loss: 0.952	Val F1: 0.214
Best Epoch: 1	Best Val F1: 0.214

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.864
Batch: 3/29	Loss: 0.862
Batch: 5/29	Loss: 0.891
Batch: 7/29	Loss: 0.849
Batch: 9/29	Loss: 0.865
Batch: 11/29	Loss: 0.820
Batch: 13/29	Loss: 0.820
Batch: 15/29	Loss: 0.843
Batch: 17/29	Loss: 0.831
Batch: 19/29	Loss: 0.865
Batch: 21/29	Loss: 0.816
Batch: 23/29	Loss: 0.825
Batch: 25/29	Loss: 0.801
Batch: 27/29	Loss: 0.863
Batch: 29/29	Loss: 0.804
Epoch: 2	Train Loss: 0.837	Val F1: 0.186
Best Epoch: 1	Best Val F1: 0.214

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.793
Batch: 3/29	Loss: 0.814
Batch: 5/29	Loss: 0.801
Batch: 7/29	Loss: 0.834
Batch: 9/29	Loss: 0.782
Batch: 11/29	Loss: 0.782
Batch: 13/29	Loss: 0.825
Batch: 15/29	Loss: 0.791
Batch: 17/29	Loss: 0.809
Batch: 19/29	Loss: 0.801
Batch: 21/29	Loss: 0.777
Batch: 23/29	Loss: 0.766
Batch: 25/29	Loss: 0.792
Batch: 27/29	Loss: 0.759
Batch: 29/29	Loss: 0.774
Epoch: 3	Train Loss: 0.796	Val F1: 0.277
Best Epoch: 3	Best Val F1: 0.277

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.748
Batch: 3/29	Loss: 0.761
Batch: 5/29	Loss: 0.741
Batch: 7/29	Loss: 0.806
Batch: 9/29	Loss: 0.767
Batch: 11/29	Loss: 0.716
Batch: 13/29	Loss: 0.731
Batch: 15/29	Loss: 0.722
Batch: 17/29	Loss: 0.717
Batch: 19/29	Loss: 0.762
Batch: 21/29	Loss: 0.748
Batch: 23/29	Loss: 0.745
Batch: 25/29	Loss: 0.723
Batch: 27/29	Loss: 0.746
Batch: 29/29	Loss: 0.735
Epoch: 4	Train Loss: 0.751	Val F1: 0.299
Best Epoch: 4	Best Val F1: 0.299

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.704
Batch: 3/29	Loss: 0.719
Batch: 5/29	Loss: 0.667
Batch: 7/29	Loss: 0.716
Batch: 9/29	Loss: 0.674
Batch: 11/29	Loss: 0.702
Batch: 13/29	Loss: 0.662
Batch: 15/29	Loss: 0.707
Batch: 17/29	Loss: 0.763
Batch: 19/29	Loss: 0.716
Batch: 21/29	Loss: 0.675
Batch: 23/29	Loss: 0.704
Batch: 25/29	Loss: 0.691
Batch: 27/29	Loss: 0.677
Batch: 29/29	Loss: 0.707
Epoch: 5	Train Loss: 0.711	Val F1: 0.333
Best Epoch: 5	Best Val F1: 0.333

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.721
Batch: 3/29	Loss: 0.746
Batch: 5/29	Loss: 0.600
Batch: 7/29	Loss: 0.753
Batch: 9/29	Loss: 0.660
Batch: 11/29	Loss: 0.677
Batch: 13/29	Loss: 0.690
Batch: 15/29	Loss: 0.591
Batch: 17/29	Loss: 0.626
Batch: 19/29	Loss: 0.585
Batch: 21/29	Loss: 0.749
Batch: 23/29	Loss: 0.655
Batch: 25/29	Loss: 0.643
Batch: 27/29	Loss: 0.655
Batch: 29/29	Loss: 0.623
Epoch: 6	Train Loss: 0.665	Val F1: 0.321
Best Epoch: 5	Best Val F1: 0.333

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.635
Batch: 3/29	Loss: 0.683
Batch: 5/29	Loss: 0.718
Batch: 7/29	Loss: 0.617
Batch: 9/29	Loss: 0.652
Batch: 11/29	Loss: 0.558
Batch: 13/29	Loss: 0.603
Batch: 15/29	Loss: 0.559
Batch: 17/29	Loss: 0.637
Batch: 19/29	Loss: 0.645
Batch: 21/29	Loss: 0.611
Batch: 23/29	Loss: 0.593
Batch: 25/29	Loss: 0.531
Batch: 27/29	Loss: 0.601
Batch: 29/29	Loss: 0.619
Epoch: 7	Train Loss: 0.617	Val F1: 0.328
Best Epoch: 5	Best Val F1: 0.333

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.616
Batch: 3/29	Loss: 0.571
Batch: 5/29	Loss: 0.613
Batch: 7/29	Loss: 0.596
Batch: 9/29	Loss: 0.573
Batch: 11/29	Loss: 0.583
Batch: 13/29	Loss: 0.617
Batch: 15/29	Loss: 0.546
Batch: 17/29	Loss: 0.582
Batch: 19/29	Loss: 0.594
Batch: 21/29	Loss: 0.580
Batch: 23/29	Loss: 0.609
Batch: 25/29	Loss: 0.702
Batch: 27/29	Loss: 0.638
Batch: 29/29	Loss: 0.629
Epoch: 8	Train Loss: 0.587	Val F1: 0.328
Best Epoch: 5	Best Val F1: 0.333

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.585
Batch: 3/29	Loss: 0.586
Batch: 5/29	Loss: 0.560
Batch: 7/29	Loss: 0.537
Batch: 9/29	Loss: 0.593
Batch: 11/29	Loss: 0.603
Batch: 13/29	Loss: 0.517
Batch: 15/29	Loss: 0.527
Batch: 17/29	Loss: 0.522
Batch: 19/29	Loss: 0.539
Batch: 21/29	Loss: 0.623
Batch: 23/29	Loss: 0.524
Batch: 25/29	Loss: 0.546
Batch: 27/29	Loss: 0.525
Batch: 29/29	Loss: 0.492
Epoch: 9	Train Loss: 0.552	Val F1: 0.341
Best Epoch: 9	Best Val F1: 0.341

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.438
Batch: 3/29	Loss: 0.517
Batch: 5/29	Loss: 0.495
Batch: 7/29	Loss: 0.502
Batch: 9/29	Loss: 0.473
Batch: 11/29	Loss: 0.401
Batch: 13/29	Loss: 0.596
Batch: 15/29	Loss: 0.554
Batch: 17/29	Loss: 0.616
Batch: 19/29	Loss: 0.369
Batch: 21/29	Loss: 0.622
Batch: 23/29	Loss: 0.540
Batch: 25/29	Loss: 0.557
Batch: 27/29	Loss: 0.506
Batch: 29/29	Loss: 0.581
Epoch: 10	Train Loss: 0.510	Val F1: 0.343
Best Epoch: 10	Best Val F1: 0.343

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.489
Batch: 3/29	Loss: 0.389
Batch: 5/29	Loss: 0.639
Batch: 7/29	Loss: 0.500
Batch: 9/29	Loss: 0.436
Batch: 11/29	Loss: 0.461
Batch: 13/29	Loss: 0.440
Batch: 15/29	Loss: 0.373
Batch: 17/29	Loss: 0.514
Batch: 19/29	Loss: 0.523
Batch: 21/29	Loss: 0.449
Batch: 23/29	Loss: 0.380
Batch: 25/29	Loss: 0.387
Batch: 27/29	Loss: 0.465
Batch: 29/29	Loss: 0.477
Epoch: 11	Train Loss: 0.470	Val F1: 0.321
Best Epoch: 10	Best Val F1: 0.343

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.632
Batch: 3/29	Loss: 0.343
Batch: 5/29	Loss: 0.508
Batch: 7/29	Loss: 0.440
Batch: 9/29	Loss: 0.450
Batch: 11/29	Loss: 0.488
Batch: 13/29	Loss: 0.390
Batch: 15/29	Loss: 0.450
Batch: 17/29	Loss: 0.422
Batch: 19/29	Loss: 0.407
Batch: 21/29	Loss: 0.435
Batch: 23/29	Loss: 0.425
Batch: 25/29	Loss: 0.389
Batch: 27/29	Loss: 0.508
Batch: 29/29	Loss: 0.317
Epoch: 12	Train Loss: 0.438	Val F1: 0.335
Best Epoch: 10	Best Val F1: 0.343

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.409
Batch: 3/29	Loss: 0.309
Batch: 5/29	Loss: 0.441
Batch: 7/29	Loss: 0.368
Batch: 9/29	Loss: 0.448
Batch: 11/29	Loss: 0.440
Batch: 13/29	Loss: 0.425
Batch: 15/29	Loss: 0.419
Batch: 17/29	Loss: 0.344
Batch: 19/29	Loss: 0.278
Batch: 21/29	Loss: 0.403
Batch: 23/29	Loss: 0.408
Batch: 25/29	Loss: 0.279
Batch: 27/29	Loss: 0.407
Batch: 29/29	Loss: 0.506
Epoch: 13	Train Loss: 0.407	Val F1: 0.316
Best Epoch: 10	Best Val F1: 0.343

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.463
Batch: 3/29	Loss: 0.438
Batch: 5/29	Loss: 0.286
Batch: 7/29	Loss: 0.444
Batch: 9/29	Loss: 0.430
Batch: 11/29	Loss: 0.410
Batch: 13/29	Loss: 0.370
Batch: 15/29	Loss: 0.298
Batch: 17/29	Loss: 0.500
Batch: 19/29	Loss: 0.471
Batch: 21/29	Loss: 0.265
Batch: 23/29	Loss: 0.323
Batch: 25/29	Loss: 0.417
Batch: 27/29	Loss: 0.385
Batch: 29/29	Loss: 0.348
Epoch: 14	Train Loss: 0.404	Val F1: 0.326
Best Epoch: 10	Best Val F1: 0.343

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.340
Batch: 3/29	Loss: 0.347
Batch: 5/29	Loss: 0.283
Batch: 7/29	Loss: 0.341
Batch: 9/29	Loss: 0.457
Batch: 11/29	Loss: 0.373
Batch: 13/29	Loss: 0.357
Batch: 15/29	Loss: 0.338
Batch: 17/29	Loss: 0.418
Batch: 19/29	Loss: 0.342
Batch: 21/29	Loss: 0.362
Batch: 23/29	Loss: 0.367
Batch: 25/29	Loss: 0.403
Batch: 27/29	Loss: 0.336
Batch: 29/29	Loss: 0.425
Epoch: 15	Train Loss: 0.371	Val F1: 0.347
Best Epoch: 15	Best Val F1: 0.347

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.369
Batch: 3/29	Loss: 0.359
Batch: 5/29	Loss: 0.391
Batch: 7/29	Loss: 0.282
Batch: 9/29	Loss: 0.319
Batch: 11/29	Loss: 0.365
Batch: 13/29	Loss: 0.306
Batch: 15/29	Loss: 0.290
Batch: 17/29	Loss: 0.370
Batch: 19/29	Loss: 0.453
Batch: 21/29	Loss: 0.321
Batch: 23/29	Loss: 0.388
Batch: 25/29	Loss: 0.414
Batch: 27/29	Loss: 0.324
Batch: 29/29	Loss: 0.427
Epoch: 16	Train Loss: 0.358	Val F1: 0.336
Best Epoch: 15	Best Val F1: 0.347

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.299
Batch: 3/29	Loss: 0.424
Batch: 5/29	Loss: 0.360
Batch: 7/29	Loss: 0.311
Batch: 9/29	Loss: 0.208
Batch: 11/29	Loss: 0.378
Batch: 13/29	Loss: 0.412
Batch: 15/29	Loss: 0.376
Batch: 17/29	Loss: 0.362
Batch: 19/29	Loss: 0.332
Batch: 21/29	Loss: 0.343
Batch: 23/29	Loss: 0.417
Batch: 25/29	Loss: 0.193
Batch: 27/29	Loss: 0.331
Batch: 29/29	Loss: 0.348
Epoch: 17	Train Loss: 0.337	Val F1: 0.313
Best Epoch: 15	Best Val F1: 0.347

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.389
Batch: 3/29	Loss: 0.378
Batch: 5/29	Loss: 0.337
Batch: 7/29	Loss: 0.281
Batch: 9/29	Loss: 0.466
Batch: 11/29	Loss: 0.273
Batch: 13/29	Loss: 0.268
Batch: 15/29	Loss: 0.331
Batch: 17/29	Loss: 0.325
Batch: 19/29	Loss: 0.254
Batch: 21/29	Loss: 0.356
Batch: 23/29	Loss: 0.334
Batch: 25/29	Loss: 0.327
Batch: 27/29	Loss: 0.239
Batch: 29/29	Loss: 0.381
Epoch: 18	Train Loss: 0.326	Val F1: 0.346
Best Epoch: 15	Best Val F1: 0.347

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.210
Batch: 3/29	Loss: 0.259
Batch: 5/29	Loss: 0.329
Batch: 7/29	Loss: 0.367
Batch: 9/29	Loss: 0.245
Batch: 11/29	Loss: 0.341
Batch: 13/29	Loss: 0.355
Batch: 15/29	Loss: 0.307
Batch: 17/29	Loss: 0.250
Batch: 19/29	Loss: 0.350
Batch: 21/29	Loss: 0.292
Batch: 23/29	Loss: 0.313
Batch: 25/29	Loss: 0.365
Batch: 27/29	Loss: 0.253
Batch: 29/29	Loss: 0.302
Epoch: 19	Train Loss: 0.305	Val F1: 0.344
Best Epoch: 15	Best Val F1: 0.347

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.354
Batch: 3/29	Loss: 0.335
Batch: 5/29	Loss: 0.267
Batch: 7/29	Loss: 0.224
Batch: 9/29	Loss: 0.297
Batch: 11/29	Loss: 0.320
Batch: 13/29	Loss: 0.268
Batch: 15/29	Loss: 0.302
Batch: 17/29	Loss: 0.378
Batch: 19/29	Loss: 0.272
Batch: 21/29	Loss: 0.249
Batch: 23/29	Loss: 0.328
Batch: 25/29	Loss: 0.278
Batch: 27/29	Loss: 0.314
Batch: 29/29	Loss: 0.359
Epoch: 20	Train Loss: 0.293	Val F1: 0.335
Best Epoch: 15	Best Val F1: 0.347

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.278
Batch: 3/29	Loss: 0.229
Batch: 5/29	Loss: 0.264
Batch: 7/29	Loss: 0.506
Batch: 9/29	Loss: 0.236
Batch: 11/29	Loss: 0.212
Batch: 13/29	Loss: 0.343
Batch: 15/29	Loss: 0.325
Batch: 17/29	Loss: 0.228
Batch: 19/29	Loss: 0.239
Batch: 21/29	Loss: 0.259
Batch: 23/29	Loss: 0.227
Batch: 25/29	Loss: 0.256
Batch: 27/29	Loss: 0.278
Batch: 29/29	Loss: 0.274
Epoch: 21	Train Loss: 0.274	Val F1: 0.331
Best Epoch: 15	Best Val F1: 0.347

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.247
Batch: 3/29	Loss: 0.202
Batch: 5/29	Loss: 0.286
Batch: 7/29	Loss: 0.297
Batch: 9/29	Loss: 0.251
Batch: 11/29	Loss: 0.265
Batch: 13/29	Loss: 0.212
Batch: 15/29	Loss: 0.234
Batch: 17/29	Loss: 0.347
Batch: 19/29	Loss: 0.309
Batch: 21/29	Loss: 0.347
Batch: 23/29	Loss: 0.241
Batch: 25/29	Loss: 0.229
Batch: 27/29	Loss: 0.261
Batch: 29/29	Loss: 0.203
Epoch: 22	Train Loss: 0.256	Val F1: 0.324
Best Epoch: 15	Best Val F1: 0.347

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.284
Batch: 3/29	Loss: 0.228
Batch: 5/29	Loss: 0.262
Batch: 7/29	Loss: 0.295
Batch: 9/29	Loss: 0.195
Batch: 11/29	Loss: 0.208
Batch: 13/29	Loss: 0.221
Batch: 15/29	Loss: 0.222
Batch: 17/29	Loss: 0.240
Batch: 19/29	Loss: 0.266
Batch: 21/29	Loss: 0.213
Batch: 23/29	Loss: 0.192
Batch: 25/29	Loss: 0.229
Batch: 27/29	Loss: 0.165
Batch: 29/29	Loss: 0.193
Epoch: 23	Train Loss: 0.232	Val F1: 0.339
Best Epoch: 15	Best Val F1: 0.347

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.160
Batch: 3/29	Loss: 0.185
Batch: 5/29	Loss: 0.315
Batch: 7/29	Loss: 0.195
Batch: 9/29	Loss: 0.259
Batch: 11/29	Loss: 0.273
Batch: 13/29	Loss: 0.209
Batch: 15/29	Loss: 0.241
Batch: 17/29	Loss: 0.228
Batch: 19/29	Loss: 0.229
Batch: 21/29	Loss: 0.225
Batch: 23/29	Loss: 0.205
Batch: 25/29	Loss: 0.238
Batch: 27/29	Loss: 0.199
Batch: 29/29	Loss: 0.238
Epoch: 24	Train Loss: 0.213	Val F1: 0.332
Best Epoch: 15	Best Val F1: 0.347

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.216
Batch: 3/29	Loss: 0.221
Batch: 5/29	Loss: 0.231
Batch: 7/29	Loss: 0.185
Batch: 9/29	Loss: 0.242
Batch: 11/29	Loss: 0.178
Batch: 13/29	Loss: 0.284
Batch: 15/29	Loss: 0.204
Batch: 17/29	Loss: 0.258
Batch: 19/29	Loss: 0.172
Batch: 21/29	Loss: 0.236
Batch: 23/29	Loss: 0.152
Batch: 25/29	Loss: 0.218
Batch: 27/29	Loss: 0.227
Batch: 29/29	Loss: 0.206
Epoch: 25	Train Loss: 0.200	Val F1: 0.351
Best Epoch: 25	Best Val F1: 0.351

****************************** Epoch: 26 ******************************
Batch: 1/29	Loss: 0.147
Batch: 3/29	Loss: 0.201
Batch: 5/29	Loss: 0.213
Batch: 7/29	Loss: 0.217
Batch: 9/29	Loss: 0.146
Batch: 11/29	Loss: 0.181
Batch: 13/29	Loss: 0.225
Batch: 15/29	Loss: 0.148
Batch: 17/29	Loss: 0.148
Batch: 19/29	Loss: 0.162
Batch: 21/29	Loss: 0.230
Batch: 23/29	Loss: 0.114
Batch: 25/29	Loss: 0.224
Batch: 27/29	Loss: 0.135
Batch: 29/29	Loss: 0.210
Epoch: 26	Train Loss: 0.174	Val F1: 0.338
Best Epoch: 25	Best Val F1: 0.351

****************************** Epoch: 27 ******************************
Batch: 1/29	Loss: 0.116
Batch: 3/29	Loss: 0.211
Batch: 5/29	Loss: 0.208
Batch: 7/29	Loss: 0.094
Batch: 9/29	Loss: 0.216
Batch: 11/29	Loss: 0.107
Batch: 13/29	Loss: 0.202
Batch: 15/29	Loss: 0.210
Batch: 17/29	Loss: 0.159
Batch: 19/29	Loss: 0.143
Batch: 21/29	Loss: 0.144
Batch: 23/29	Loss: 0.098
Batch: 25/29	Loss: 0.178
Batch: 27/29	Loss: 0.120
Batch: 29/29	Loss: 0.144
Epoch: 27	Train Loss: 0.152	Val F1: 0.334
Best Epoch: 25	Best Val F1: 0.351

****************************** Epoch: 28 ******************************
Batch: 1/29	Loss: 0.106
Batch: 3/29	Loss: 0.141
Batch: 5/29	Loss: 0.133
Batch: 7/29	Loss: 0.177
Batch: 9/29	Loss: 0.130
Batch: 11/29	Loss: 0.120
Batch: 13/29	Loss: 0.118
Batch: 15/29	Loss: 0.147
Batch: 17/29	Loss: 0.156
Batch: 19/29	Loss: 0.114
Batch: 21/29	Loss: 0.116
Batch: 23/29	Loss: 0.183
Batch: 25/29	Loss: 0.181
Batch: 27/29	Loss: 0.126
Batch: 29/29	Loss: 0.116
Epoch: 28	Train Loss: 0.137	Val F1: 0.337
Best Epoch: 25	Best Val F1: 0.351

****************************** Epoch: 29 ******************************
Batch: 1/29	Loss: 0.154
Batch: 3/29	Loss: 0.133
Batch: 5/29	Loss: 0.115
Batch: 7/29	Loss: 0.111
Batch: 9/29	Loss: 0.083
Batch: 11/29	Loss: 0.128
Batch: 13/29	Loss: 0.131
Batch: 15/29	Loss: 0.075
Batch: 17/29	Loss: 0.173
Batch: 19/29	Loss: 0.089
Batch: 21/29	Loss: 0.121
Batch: 23/29	Loss: 0.175
Batch: 25/29	Loss: 0.142
Batch: 27/29	Loss: 0.126
Batch: 29/29	Loss: 0.158
Epoch: 29	Train Loss: 0.125	Val F1: 0.337
Best Epoch: 25	Best Val F1: 0.351

****************************** Epoch: 30 ******************************
Batch: 1/29	Loss: 0.113
Batch: 3/29	Loss: 0.127
Batch: 5/29	Loss: 0.132
Batch: 7/29	Loss: 0.081
Batch: 9/29	Loss: 0.124
Batch: 11/29	Loss: 0.137
Batch: 13/29	Loss: 0.102
Batch: 15/29	Loss: 0.120
Batch: 17/29	Loss: 0.072
Batch: 19/29	Loss: 0.128
Batch: 21/29	Loss: 0.145
Batch: 23/29	Loss: 0.144
Batch: 25/29	Loss: 0.077
Batch: 27/29	Loss: 0.131
Batch: 29/29	Loss: 0.121
Epoch: 30	Train Loss: 0.121	Val F1: 0.348
Best Epoch: 25	Best Val F1: 0.351

****************************** Epoch: 31 ******************************
Batch: 1/29	Loss: 0.088
Batch: 3/29	Loss: 0.137
Batch: 5/29	Loss: 0.088
Batch: 7/29	Loss: 0.149
Batch: 9/29	Loss: 0.099
Batch: 11/29	Loss: 0.170
Batch: 13/29	Loss: 0.118
Batch: 15/29	Loss: 0.091
Batch: 17/29	Loss: 0.103
Batch: 19/29	Loss: 0.095
Batch: 21/29	Loss: 0.128
Batch: 23/29	Loss: 0.094
Batch: 25/29	Loss: 0.157
Batch: 27/29	Loss: 0.089
Batch: 29/29	Loss: 0.077
Epoch: 31	Train Loss: 0.116	Val F1: 0.345
Best Epoch: 25	Best Val F1: 0.351

****************************** Epoch: 32 ******************************
Batch: 1/29	Loss: 0.143
Batch: 3/29	Loss: 0.087
Batch: 5/29	Loss: 0.064
Batch: 7/29	Loss: 0.053
Batch: 9/29	Loss: 0.082
Batch: 11/29	Loss: 0.091
Batch: 13/29	Loss: 0.074
Batch: 15/29	Loss: 0.068
Batch: 17/29	Loss: 0.134
Batch: 19/29	Loss: 0.098
Batch: 21/29	Loss: 0.066
Batch: 23/29	Loss: 0.096
Batch: 25/29	Loss: 0.064
Batch: 27/29	Loss: 0.044
Batch: 29/29	Loss: 0.083
Epoch: 32	Train Loss: 0.085	Val F1: 0.340
Best Epoch: 25	Best Val F1: 0.351

****************************** Epoch: 33 ******************************
Batch: 1/29	Loss: 0.099
Batch: 3/29	Loss: 0.061
Batch: 5/29	Loss: 0.090
Batch: 7/29	Loss: 0.091
Batch: 9/29	Loss: 0.081
Batch: 11/29	Loss: 0.066
Batch: 13/29	Loss: 0.106
Batch: 15/29	Loss: 0.065
Batch: 17/29	Loss: 0.091
Batch: 19/29	Loss: 0.090
Batch: 21/29	Loss: 0.035
Batch: 23/29	Loss: 0.052
Batch: 25/29	Loss: 0.062
Batch: 27/29	Loss: 0.079
Batch: 29/29	Loss: 0.071
Epoch: 33	Train Loss: 0.077	Val F1: 0.345
Best Epoch: 25	Best Val F1: 0.351

****************************** Epoch: 34 ******************************
Batch: 1/29	Loss: 0.055
Batch: 3/29	Loss: 0.059
Batch: 5/29	Loss: 0.063
Batch: 7/29	Loss: 0.072
Batch: 9/29	Loss: 0.107
Batch: 11/29	Loss: 0.086
Batch: 13/29	Loss: 0.095
Batch: 15/29	Loss: 0.079
Batch: 17/29	Loss: 0.105
Batch: 19/29	Loss: 0.109
Batch: 21/29	Loss: 0.084
Batch: 23/29	Loss: 0.108
Batch: 25/29	Loss: 0.073
Batch: 27/29	Loss: 0.067
Batch: 29/29	Loss: 0.105
Epoch: 34	Train Loss: 0.080	Val F1: 0.339
Best Epoch: 25	Best Val F1: 0.351

****************************** Epoch: 35 ******************************
Batch: 1/29	Loss: 0.044
Batch: 3/29	Loss: 0.072
Batch: 5/29	Loss: 0.087
Batch: 7/29	Loss: 0.063
Batch: 9/29	Loss: 0.080
Batch: 11/29	Loss: 0.065
Batch: 13/29	Loss: 0.093
Batch: 15/29	Loss: 0.070
Batch: 17/29	Loss: 0.069
Batch: 19/29	Loss: 0.125
Batch: 21/29	Loss: 0.081
Batch: 23/29	Loss: 0.089
Batch: 25/29	Loss: 0.071
Batch: 27/29	Loss: 0.072
Batch: 29/29	Loss: 0.057
Epoch: 35	Train Loss: 0.074	Val F1: 0.327
Best Epoch: 25	Best Val F1: 0.351

****************************** Epoch: 36 ******************************
Batch: 1/29	Loss: 0.072
Batch: 3/29	Loss: 0.081
Batch: 5/29	Loss: 0.040
Batch: 7/29	Loss: 0.054
Batch: 9/29	Loss: 0.064
Batch: 11/29	Loss: 0.050
Batch: 13/29	Loss: 0.066
Batch: 15/29	Loss: 0.075
Batch: 17/29	Loss: 0.054
Batch: 19/29	Loss: 0.082
Batch: 21/29	Loss: 0.048
Batch: 23/29	Loss: 0.072
Batch: 25/29	Loss: 0.050
Batch: 27/29	Loss: 0.071
Batch: 29/29	Loss: 0.056
Epoch: 36	Train Loss: 0.066	Val F1: 0.337
Best Epoch: 25	Best Val F1: 0.351

****************************** Epoch: 37 ******************************
Batch: 1/29	Loss: 0.030
Batch: 3/29	Loss: 0.121
Batch: 5/29	Loss: 0.074
Batch: 7/29	Loss: 0.069
Batch: 9/29	Loss: 0.071
Batch: 11/29	Loss: 0.061
Batch: 13/29	Loss: 0.048
Batch: 15/29	Loss: 0.047
Batch: 17/29	Loss: 0.054
Batch: 19/29	Loss: 0.072
Batch: 21/29	Loss: 0.072
Batch: 23/29	Loss: 0.055
Batch: 25/29	Loss: 0.052
Batch: 27/29	Loss: 0.042
Batch: 29/29	Loss: 0.060
Epoch: 37	Train Loss: 0.059	Val F1: 0.340
Best Epoch: 25	Best Val F1: 0.351

****************************** Epoch: 38 ******************************
Batch: 1/29	Loss: 0.051
Batch: 3/29	Loss: 0.054
Batch: 5/29	Loss: 0.056
Batch: 7/29	Loss: 0.066
Batch: 9/29	Loss: 0.051
Batch: 11/29	Loss: 0.091
Batch: 13/29	Loss: 0.044
Batch: 15/29	Loss: 0.072
Batch: 17/29	Loss: 0.057
Batch: 19/29	Loss: 0.064
Batch: 21/29	Loss: 0.030
Batch: 23/29	Loss: 0.101
Batch: 25/29	Loss: 0.037
Batch: 27/29	Loss: 0.064
Batch: 29/29	Loss: 0.103
Epoch: 38	Train Loss: 0.056	Val F1: 0.350
Best Epoch: 25	Best Val F1: 0.351

****************************** Epoch: 39 ******************************
Batch: 1/29	Loss: 0.046
Batch: 3/29	Loss: 0.074
Batch: 5/29	Loss: 0.070
Batch: 7/29	Loss: 0.083
Batch: 9/29	Loss: 0.064
Batch: 11/29	Loss: 0.055
Batch: 13/29	Loss: 0.049
Batch: 15/29	Loss: 0.058
Batch: 17/29	Loss: 0.052
Batch: 19/29	Loss: 0.054
Batch: 21/29	Loss: 0.035
Batch: 23/29	Loss: 0.058
Batch: 25/29	Loss: 0.050
Batch: 27/29	Loss: 0.083
Batch: 29/29	Loss: 0.051
Epoch: 39	Train Loss: 0.058	Val F1: 0.340
Best Epoch: 25	Best Val F1: 0.351

****************************** Epoch: 40 ******************************
Batch: 1/29	Loss: 0.047
Batch: 3/29	Loss: 0.022
Batch: 5/29	Loss: 0.067
Batch: 7/29	Loss: 0.060
Batch: 9/29	Loss: 0.060
Batch: 11/29	Loss: 0.019
Batch: 13/29	Loss: 0.041
Batch: 15/29	Loss: 0.039
Batch: 17/29	Loss: 0.050
Batch: 19/29	Loss: 0.064
Batch: 21/29	Loss: 0.056
Batch: 23/29	Loss: 0.036
Batch: 25/29	Loss: 0.036
Batch: 27/29	Loss: 0.026
Batch: 29/29	Loss: 0.062
Epoch: 40	Train Loss: 0.048	Val F1: 0.332
Best Epoch: 25	Best Val F1: 0.351

Saving the best checkpoint....
Inference...
Test F1: 0.368	Test F1_Few: 0.448	Test F1_Zero: 0.358
Starting training with config: {'batch_size': 16, 'epochs': 75, 'l2_reg': 0.0009876324046380822, 'lr': 1.0302477216442128e-05, 'n_layers_freeze': 5, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 1.034
Batch: 23/116	Loss: 0.969
Batch: 34/116	Loss: 0.943
Batch: 45/116	Loss: 0.902
Batch: 56/116	Loss: 0.886
Batch: 67/116	Loss: 0.847
Batch: 78/116	Loss: 0.850
Batch: 89/116	Loss: 0.899
Batch: 100/116	Loss: 0.815
Batch: 111/116	Loss: 0.835
Batch: 116/116	Loss: 0.807
Epoch: 1	Train Loss: 0.908	Val F1: 0.192
Best Epoch: 1	Best Val F1: 0.192

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.860
Batch: 12/116	Loss: 0.823
Batch: 23/116	Loss: 0.797
Batch: 34/116	Loss: 0.782
Batch: 45/116	Loss: 0.842
Batch: 56/116	Loss: 0.804
Batch: 67/116	Loss: 0.811
Batch: 78/116	Loss: 0.770
Batch: 89/116	Loss: 0.786
Batch: 100/116	Loss: 0.793
Batch: 111/116	Loss: 0.788
Batch: 116/116	Loss: 0.768
Epoch: 2	Train Loss: 0.802	Val F1: 0.257
Best Epoch: 2	Best Val F1: 0.257

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.739
Batch: 12/116	Loss: 0.736
Batch: 23/116	Loss: 0.730
Batch: 34/116	Loss: 0.776
Batch: 45/116	Loss: 0.820
Batch: 56/116	Loss: 0.777
Batch: 67/116	Loss: 0.769
Batch: 78/116	Loss: 0.749
Batch: 89/116	Loss: 0.729
Batch: 100/116	Loss: 0.878
Batch: 111/116	Loss: 0.849
Batch: 116/116	Loss: 0.681
Epoch: 3	Train Loss: 0.762	Val F1: 0.311
Best Epoch: 3	Best Val F1: 0.311

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.731
Batch: 12/116	Loss: 0.668
Batch: 23/116	Loss: 0.874
Batch: 34/116	Loss: 0.696
Batch: 45/116	Loss: 0.755
Batch: 56/116	Loss: 0.722
Batch: 67/116	Loss: 0.763
Batch: 78/116	Loss: 0.668
Batch: 89/116	Loss: 0.710
Batch: 100/116	Loss: 0.686
Batch: 111/116	Loss: 0.672
Batch: 116/116	Loss: 0.853
Epoch: 4	Train Loss: 0.709	Val F1: 0.307
Best Epoch: 3	Best Val F1: 0.311

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.568
Batch: 12/116	Loss: 0.655
Batch: 23/116	Loss: 0.713
Batch: 34/116	Loss: 0.662
Batch: 45/116	Loss: 0.701
Batch: 56/116	Loss: 0.727
Batch: 67/116	Loss: 0.614
Batch: 78/116	Loss: 0.687
Batch: 89/116	Loss: 0.779
Batch: 100/116	Loss: 0.688
Batch: 111/116	Loss: 0.618
Batch: 116/116	Loss: 0.546
Epoch: 5	Train Loss: 0.668	Val F1: 0.314
Best Epoch: 5	Best Val F1: 0.314

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.575
Batch: 12/116	Loss: 0.904
Batch: 23/116	Loss: 0.720
Batch: 34/116	Loss: 0.621
Batch: 45/116	Loss: 0.584
Batch: 56/116	Loss: 0.654
Batch: 67/116	Loss: 0.625
Batch: 78/116	Loss: 0.712
Batch: 89/116	Loss: 0.810
Batch: 100/116	Loss: 0.629
Batch: 111/116	Loss: 0.729
Batch: 116/116	Loss: 0.340
Epoch: 6	Train Loss: 0.617	Val F1: 0.343
Best Epoch: 6	Best Val F1: 0.343

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.483
Batch: 12/116	Loss: 0.681
Batch: 23/116	Loss: 0.722
Batch: 34/116	Loss: 0.719
Batch: 45/116	Loss: 0.523
Batch: 56/116	Loss: 0.858
Batch: 67/116	Loss: 0.605
Batch: 78/116	Loss: 0.661
Batch: 89/116	Loss: 0.484
Batch: 100/116	Loss: 0.373
Batch: 111/116	Loss: 0.964
Batch: 116/116	Loss: 0.445
Epoch: 7	Train Loss: 0.583	Val F1: 0.343
Best Epoch: 7	Best Val F1: 0.343

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.640
Batch: 12/116	Loss: 0.613
Batch: 23/116	Loss: 0.370
Batch: 34/116	Loss: 0.477
Batch: 45/116	Loss: 0.508
Batch: 56/116	Loss: 0.415
Batch: 67/116	Loss: 0.818
Batch: 78/116	Loss: 0.373
Batch: 89/116	Loss: 0.327
Batch: 100/116	Loss: 0.717
Batch: 111/116	Loss: 0.455
Batch: 116/116	Loss: 0.454
Epoch: 8	Train Loss: 0.540	Val F1: 0.326
Best Epoch: 7	Best Val F1: 0.343

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.557
Batch: 12/116	Loss: 0.592
Batch: 23/116	Loss: 0.492
Batch: 34/116	Loss: 0.462
Batch: 45/116	Loss: 0.445
Batch: 56/116	Loss: 0.522
Batch: 67/116	Loss: 0.370
Batch: 78/116	Loss: 0.597
Batch: 89/116	Loss: 0.546
Batch: 100/116	Loss: 0.453
Batch: 111/116	Loss: 0.420
Batch: 116/116	Loss: 0.552
Epoch: 9	Train Loss: 0.503	Val F1: 0.333
Best Epoch: 7	Best Val F1: 0.343

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.464
Batch: 12/116	Loss: 0.488
Batch: 23/116	Loss: 0.421
Batch: 34/116	Loss: 0.476
Batch: 45/116	Loss: 0.247
Batch: 56/116	Loss: 0.449
Batch: 67/116	Loss: 0.565
Batch: 78/116	Loss: 0.349
Batch: 89/116	Loss: 0.341
Batch: 100/116	Loss: 0.616
Batch: 111/116	Loss: 0.380
Batch: 116/116	Loss: 0.432
Epoch: 10	Train Loss: 0.460	Val F1: 0.329
Best Epoch: 7	Best Val F1: 0.343

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.436
Batch: 12/116	Loss: 0.343
Batch: 23/116	Loss: 0.369
Batch: 34/116	Loss: 0.393
Batch: 45/116	Loss: 0.496
Batch: 56/116	Loss: 0.492
Batch: 67/116	Loss: 0.636
Batch: 78/116	Loss: 0.358
Batch: 89/116	Loss: 0.291
Batch: 100/116	Loss: 0.389
Batch: 111/116	Loss: 0.489
Batch: 116/116	Loss: 0.224
Epoch: 11	Train Loss: 0.439	Val F1: 0.342
Best Epoch: 7	Best Val F1: 0.343

****************************** Epoch: 12 ******************************
Batch: 1/116	Loss: 0.695
Batch: 12/116	Loss: 0.347
Batch: 23/116	Loss: 0.302
Batch: 34/116	Loss: 0.538
Batch: 45/116	Loss: 0.334
Batch: 56/116	Loss: 0.458
Batch: 67/116	Loss: 0.283
Batch: 78/116	Loss: 0.438
Batch: 89/116	Loss: 0.381
Batch: 100/116	Loss: 0.434
Batch: 111/116	Loss: 0.412
Batch: 116/116	Loss: 0.411
Epoch: 12	Train Loss: 0.406	Val F1: 0.343
Best Epoch: 7	Best Val F1: 0.343

****************************** Epoch: 13 ******************************
Batch: 1/116	Loss: 0.380
Batch: 12/116	Loss: 0.271
Batch: 23/116	Loss: 0.408
Batch: 34/116	Loss: 0.348
Batch: 45/116	Loss: 0.602
Batch: 56/116	Loss: 0.353
Batch: 67/116	Loss: 0.246
Batch: 78/116	Loss: 0.433
Batch: 89/116	Loss: 0.406
Batch: 100/116	Loss: 0.322
Batch: 111/116	Loss: 0.329
Batch: 116/116	Loss: 0.239
Epoch: 13	Train Loss: 0.380	Val F1: 0.334
Best Epoch: 7	Best Val F1: 0.343

****************************** Epoch: 14 ******************************
Batch: 1/116	Loss: 0.617
Batch: 12/116	Loss: 0.473
Batch: 23/116	Loss: 0.276
Batch: 34/116	Loss: 0.365
Batch: 45/116	Loss: 0.416
Batch: 56/116	Loss: 0.402
Batch: 67/116	Loss: 0.430
Batch: 78/116	Loss: 0.587
Batch: 89/116	Loss: 0.274
Batch: 100/116	Loss: 0.410
Batch: 111/116	Loss: 0.327
Batch: 116/116	Loss: 0.306
Epoch: 14	Train Loss: 0.364	Val F1: 0.343
Best Epoch: 7	Best Val F1: 0.343

****************************** Epoch: 15 ******************************
Batch: 1/116	Loss: 0.232
Batch: 12/116	Loss: 0.507
Batch: 23/116	Loss: 0.173
Batch: 34/116	Loss: 0.355
Batch: 45/116	Loss: 0.335
Batch: 56/116	Loss: 0.334
Batch: 67/116	Loss: 0.358
Batch: 78/116	Loss: 0.323
Batch: 89/116	Loss: 0.373
Batch: 100/116	Loss: 0.357
Batch: 111/116	Loss: 0.284
Batch: 116/116	Loss: 0.122
Epoch: 15	Train Loss: 0.336	Val F1: 0.354
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 16 ******************************
Batch: 1/116	Loss: 0.415
Batch: 12/116	Loss: 0.138
Batch: 23/116	Loss: 0.316
Batch: 34/116	Loss: 0.237
Batch: 45/116	Loss: 0.249
Batch: 56/116	Loss: 0.295
Batch: 67/116	Loss: 0.373
Batch: 78/116	Loss: 0.301
Batch: 89/116	Loss: 0.371
Batch: 100/116	Loss: 0.298
Batch: 111/116	Loss: 0.198
Batch: 116/116	Loss: 0.691
Epoch: 16	Train Loss: 0.322	Val F1: 0.342
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 17 ******************************
Batch: 1/116	Loss: 0.217
Batch: 12/116	Loss: 0.358
Batch: 23/116	Loss: 0.346
Batch: 34/116	Loss: 0.264
Batch: 45/116	Loss: 0.303
Batch: 56/116	Loss: 0.284
Batch: 67/116	Loss: 0.348
Batch: 78/116	Loss: 0.249
Batch: 89/116	Loss: 0.414
Batch: 100/116	Loss: 0.137
Batch: 111/116	Loss: 0.269
Batch: 116/116	Loss: 0.494
Epoch: 17	Train Loss: 0.308	Val F1: 0.341
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 18 ******************************
Batch: 1/116	Loss: 0.390
Batch: 12/116	Loss: 0.214
Batch: 23/116	Loss: 0.291
Batch: 34/116	Loss: 0.354
Batch: 45/116	Loss: 0.128
Batch: 56/116	Loss: 0.293
Batch: 67/116	Loss: 0.287
Batch: 78/116	Loss: 0.415
Batch: 89/116	Loss: 0.258
Batch: 100/116	Loss: 0.304
Batch: 111/116	Loss: 0.101
Batch: 116/116	Loss: 0.724
Epoch: 18	Train Loss: 0.279	Val F1: 0.327
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 19 ******************************
Batch: 1/116	Loss: 0.175
Batch: 12/116	Loss: 0.134
Batch: 23/116	Loss: 0.150
Batch: 34/116	Loss: 0.209
Batch: 45/116	Loss: 0.250
Batch: 56/116	Loss: 0.269
Batch: 67/116	Loss: 0.203
Batch: 78/116	Loss: 0.243
Batch: 89/116	Loss: 0.228
Batch: 100/116	Loss: 0.384
Batch: 111/116	Loss: 0.266
Batch: 116/116	Loss: 0.209
Epoch: 19	Train Loss: 0.265	Val F1: 0.335
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 20 ******************************
Batch: 1/116	Loss: 0.299
Batch: 12/116	Loss: 0.237
Batch: 23/116	Loss: 0.173
Batch: 34/116	Loss: 0.190
Batch: 45/116	Loss: 0.228
Batch: 56/116	Loss: 0.269
Batch: 67/116	Loss: 0.274
Batch: 78/116	Loss: 0.292
Batch: 89/116	Loss: 0.240
Batch: 100/116	Loss: 0.196
Batch: 111/116	Loss: 0.233
Batch: 116/116	Loss: 0.309
Epoch: 20	Train Loss: 0.242	Val F1: 0.335
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 21 ******************************
Batch: 1/116	Loss: 0.232
Batch: 12/116	Loss: 0.192
Batch: 23/116	Loss: 0.226
Batch: 34/116	Loss: 0.334
Batch: 45/116	Loss: 0.195
Batch: 56/116	Loss: 0.173
Batch: 67/116	Loss: 0.113
Batch: 78/116	Loss: 0.217
Batch: 89/116	Loss: 0.278
Batch: 100/116	Loss: 0.269
Batch: 111/116	Loss: 0.064
Batch: 116/116	Loss: 0.279
Epoch: 21	Train Loss: 0.221	Val F1: 0.340
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 22 ******************************
Batch: 1/116	Loss: 0.425
Batch: 12/116	Loss: 0.108
Batch: 23/116	Loss: 0.162
Batch: 34/116	Loss: 0.122
Batch: 45/116	Loss: 0.235
Batch: 56/116	Loss: 0.139
Batch: 67/116	Loss: 0.166
Batch: 78/116	Loss: 0.162
Batch: 89/116	Loss: 0.117
Batch: 100/116	Loss: 0.125
Batch: 111/116	Loss: 0.211
Batch: 116/116	Loss: 0.505
Epoch: 22	Train Loss: 0.199	Val F1: 0.338
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 23 ******************************
Batch: 1/116	Loss: 0.215
Batch: 12/116	Loss: 0.131
Batch: 23/116	Loss: 0.138
Batch: 34/116	Loss: 0.219
Batch: 45/116	Loss: 0.268
Batch: 56/116	Loss: 0.285
Batch: 67/116	Loss: 0.180
Batch: 78/116	Loss: 0.213
Batch: 89/116	Loss: 0.209
Batch: 100/116	Loss: 0.067
Batch: 111/116	Loss: 0.146
Batch: 116/116	Loss: 0.399
Epoch: 23	Train Loss: 0.176	Val F1: 0.332
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 24 ******************************
Batch: 1/116	Loss: 0.167
Batch: 12/116	Loss: 0.089
Batch: 23/116	Loss: 0.105
Batch: 34/116	Loss: 0.174
Batch: 45/116	Loss: 0.185
Batch: 56/116	Loss: 0.110
Batch: 67/116	Loss: 0.080
Batch: 78/116	Loss: 0.084
Batch: 89/116	Loss: 0.063
Batch: 100/116	Loss: 0.205
Batch: 111/116	Loss: 0.130
Batch: 116/116	Loss: 0.452
Epoch: 24	Train Loss: 0.156	Val F1: 0.334
Best Epoch: 15	Best Val F1: 0.354

****************************** Epoch: 25 ******************************
Batch: 1/116	Loss: 0.114
Batch: 12/116	Loss: 0.127
Batch: 23/116	Loss: 0.228
Batch: 34/116	Loss: 0.106
Batch: 45/116	Loss: 0.121
Batch: 56/116	Loss: 0.054
Batch: 67/116	Loss: 0.255
Batch: 78/116	Loss: 0.080
Batch: 89/116	Loss: 0.116
Batch: 100/116	Loss: 0.102
Batch: 111/116	Loss: 0.132
Batch: 116/116	Loss: 0.128
Epoch: 25	Train Loss: 0.136	Val F1: 0.337
Best Epoch: 15	Best Val F1: 0.354

Saving the best checkpoint....
Inference...
Test F1: 0.373	Test F1_Few: 0.376	Test F1_Zero: 0.373
Starting training with config: {'batch_size': 16, 'epochs': 75, 'l2_reg': 0.0007628976651914762, 'lr': 1.4825685559493653e-05, 'n_layers_freeze': 5, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 1.010
Batch: 23/116	Loss: 0.936
Batch: 34/116	Loss: 0.916
Batch: 45/116	Loss: 0.873
Batch: 56/116	Loss: 0.863
Batch: 67/116	Loss: 0.817
Batch: 78/116	Loss: 0.822
Batch: 89/116	Loss: 0.888
Batch: 100/116	Loss: 0.785
Batch: 111/116	Loss: 0.814
Batch: 116/116	Loss: 0.775
Epoch: 1	Train Loss: 0.882	Val F1: 0.180
Best Epoch: 1	Best Val F1: 0.180

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.846
Batch: 12/116	Loss: 0.800
Batch: 23/116	Loss: 0.773
Batch: 34/116	Loss: 0.759
Batch: 45/116	Loss: 0.826
Batch: 56/116	Loss: 0.784
Batch: 67/116	Loss: 0.796
Batch: 78/116	Loss: 0.760
Batch: 89/116	Loss: 0.770
Batch: 100/116	Loss: 0.761
Batch: 111/116	Loss: 0.763
Batch: 116/116	Loss: 0.774
Epoch: 2	Train Loss: 0.782	Val F1: 0.319
Best Epoch: 2	Best Val F1: 0.319

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.698
Batch: 12/116	Loss: 0.669
Batch: 23/116	Loss: 0.685
Batch: 34/116	Loss: 0.756
Batch: 45/116	Loss: 0.794
Batch: 56/116	Loss: 0.758
Batch: 67/116	Loss: 0.716
Batch: 78/116	Loss: 0.722
Batch: 89/116	Loss: 0.733
Batch: 100/116	Loss: 0.867
Batch: 111/116	Loss: 0.896
Batch: 116/116	Loss: 0.620
Epoch: 3	Train Loss: 0.730	Val F1: 0.315
Best Epoch: 2	Best Val F1: 0.319

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.700
Batch: 12/116	Loss: 0.589
Batch: 23/116	Loss: 0.864
Batch: 34/116	Loss: 0.622
Batch: 45/116	Loss: 0.741
Batch: 56/116	Loss: 0.631
Batch: 67/116	Loss: 0.724
Batch: 78/116	Loss: 0.629
Batch: 89/116	Loss: 0.685
Batch: 100/116	Loss: 0.638
Batch: 111/116	Loss: 0.665
Batch: 116/116	Loss: 0.781
Epoch: 4	Train Loss: 0.676	Val F1: 0.325
Best Epoch: 4	Best Val F1: 0.325

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.516
Batch: 12/116	Loss: 0.632
Batch: 23/116	Loss: 0.651
Batch: 34/116	Loss: 0.604
Batch: 45/116	Loss: 0.656
Batch: 56/116	Loss: 0.667
Batch: 67/116	Loss: 0.610
Batch: 78/116	Loss: 0.701
Batch: 89/116	Loss: 0.815
Batch: 100/116	Loss: 0.671
Batch: 111/116	Loss: 0.592
Batch: 116/116	Loss: 0.501
Epoch: 5	Train Loss: 0.630	Val F1: 0.334
Best Epoch: 5	Best Val F1: 0.334

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.568
Batch: 12/116	Loss: 0.896
Batch: 23/116	Loss: 0.613
Batch: 34/116	Loss: 0.581
Batch: 45/116	Loss: 0.524
Batch: 56/116	Loss: 0.557
Batch: 67/116	Loss: 0.556
Batch: 78/116	Loss: 0.665
Batch: 89/116	Loss: 0.824
Batch: 100/116	Loss: 0.635
Batch: 111/116	Loss: 0.624
Batch: 116/116	Loss: 0.235
Epoch: 6	Train Loss: 0.578	Val F1: 0.345
Best Epoch: 6	Best Val F1: 0.345

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.457
Batch: 12/116	Loss: 0.621
Batch: 23/116	Loss: 0.687
Batch: 34/116	Loss: 0.703
Batch: 45/116	Loss: 0.382
Batch: 56/116	Loss: 0.822
Batch: 67/116	Loss: 0.585
Batch: 78/116	Loss: 0.598
Batch: 89/116	Loss: 0.436
Batch: 100/116	Loss: 0.299
Batch: 111/116	Loss: 0.920
Batch: 116/116	Loss: 0.348
Epoch: 7	Train Loss: 0.541	Val F1: 0.339
Best Epoch: 6	Best Val F1: 0.345

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.574
Batch: 12/116	Loss: 0.640
Batch: 23/116	Loss: 0.318
Batch: 34/116	Loss: 0.441
Batch: 45/116	Loss: 0.451
Batch: 56/116	Loss: 0.306
Batch: 67/116	Loss: 0.727
Batch: 78/116	Loss: 0.358
Batch: 89/116	Loss: 0.274
Batch: 100/116	Loss: 0.674
Batch: 111/116	Loss: 0.334
Batch: 116/116	Loss: 0.461
Epoch: 8	Train Loss: 0.487	Val F1: 0.331
Best Epoch: 6	Best Val F1: 0.345

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.422
Batch: 12/116	Loss: 0.568
Batch: 23/116	Loss: 0.384
Batch: 34/116	Loss: 0.382
Batch: 45/116	Loss: 0.387
Batch: 56/116	Loss: 0.485
Batch: 67/116	Loss: 0.321
Batch: 78/116	Loss: 0.495
Batch: 89/116	Loss: 0.327
Batch: 100/116	Loss: 0.416
Batch: 111/116	Loss: 0.374
Batch: 116/116	Loss: 0.469
Epoch: 9	Train Loss: 0.434	Val F1: 0.335
Best Epoch: 6	Best Val F1: 0.345

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.375
Batch: 12/116	Loss: 0.370
Batch: 23/116	Loss: 0.373
Batch: 34/116	Loss: 0.467
Batch: 45/116	Loss: 0.219
Batch: 56/116	Loss: 0.358
Batch: 67/116	Loss: 0.452
Batch: 78/116	Loss: 0.320
Batch: 89/116	Loss: 0.291
Batch: 100/116	Loss: 0.515
Batch: 111/116	Loss: 0.317
Batch: 116/116	Loss: 0.396
Epoch: 10	Train Loss: 0.406	Val F1: 0.339
Best Epoch: 6	Best Val F1: 0.345

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.430
Batch: 12/116	Loss: 0.248
Batch: 23/116	Loss: 0.318
Batch: 34/116	Loss: 0.302
Batch: 45/116	Loss: 0.450
Batch: 56/116	Loss: 0.514
Batch: 67/116	Loss: 0.387
Batch: 78/116	Loss: 0.275
Batch: 89/116	Loss: 0.347
Batch: 100/116	Loss: 0.385
Batch: 111/116	Loss: 0.433
Batch: 116/116	Loss: 0.225
Epoch: 11	Train Loss: 0.376	Val F1: 0.346
Best Epoch: 11	Best Val F1: 0.346

****************************** Epoch: 12 ******************************
Batch: 1/116	Loss: 0.598
Batch: 12/116	Loss: 0.319
Batch: 23/116	Loss: 0.251
Batch: 34/116	Loss: 0.454
Batch: 45/116	Loss: 0.257
Batch: 56/116	Loss: 0.402
Batch: 67/116	Loss: 0.205
Batch: 78/116	Loss: 0.447
Batch: 89/116	Loss: 0.361
Batch: 100/116	Loss: 0.338
Batch: 111/116	Loss: 0.290
Batch: 116/116	Loss: 0.318
Epoch: 12	Train Loss: 0.346	Val F1: 0.337
Best Epoch: 11	Best Val F1: 0.346

****************************** Epoch: 13 ******************************
Batch: 1/116	Loss: 0.249
Batch: 12/116	Loss: 0.249
Batch: 23/116	Loss: 0.357
Batch: 34/116	Loss: 0.170
Batch: 45/116	Loss: 0.508
Batch: 56/116	Loss: 0.322
Batch: 67/116	Loss: 0.212
Batch: 78/116	Loss: 0.392
Batch: 89/116	Loss: 0.351
Batch: 100/116	Loss: 0.350
Batch: 111/116	Loss: 0.273
Batch: 116/116	Loss: 0.200
Epoch: 13	Train Loss: 0.322	Val F1: 0.341
Best Epoch: 11	Best Val F1: 0.346

****************************** Epoch: 14 ******************************
Batch: 1/116	Loss: 0.578
Batch: 12/116	Loss: 0.391
Batch: 23/116	Loss: 0.215
Batch: 34/116	Loss: 0.222
Batch: 45/116	Loss: 0.334
Batch: 56/116	Loss: 0.317
Batch: 67/116	Loss: 0.394
Batch: 78/116	Loss: 0.569
Batch: 89/116	Loss: 0.218
Batch: 100/116	Loss: 0.324
Batch: 111/116	Loss: 0.223
Batch: 116/116	Loss: 0.437
Epoch: 14	Train Loss: 0.298	Val F1: 0.339
Best Epoch: 11	Best Val F1: 0.346

****************************** Epoch: 15 ******************************
Batch: 1/116	Loss: 0.179
Batch: 12/116	Loss: 0.450
Batch: 23/116	Loss: 0.126
Batch: 34/116	Loss: 0.267
Batch: 45/116	Loss: 0.372
Batch: 56/116	Loss: 0.259
Batch: 67/116	Loss: 0.310
Batch: 78/116	Loss: 0.216
Batch: 89/116	Loss: 0.334
Batch: 100/116	Loss: 0.365
Batch: 111/116	Loss: 0.233
Batch: 116/116	Loss: 0.081
Epoch: 15	Train Loss: 0.268	Val F1: 0.333
Best Epoch: 11	Best Val F1: 0.346

****************************** Epoch: 16 ******************************
Batch: 1/116	Loss: 0.398
Batch: 12/116	Loss: 0.099
Batch: 23/116	Loss: 0.241
Batch: 34/116	Loss: 0.253
Batch: 45/116	Loss: 0.189
Batch: 56/116	Loss: 0.227
Batch: 67/116	Loss: 0.307
Batch: 78/116	Loss: 0.261
Batch: 89/116	Loss: 0.244
Batch: 100/116	Loss: 0.210
Batch: 111/116	Loss: 0.103
Batch: 116/116	Loss: 0.318
Epoch: 16	Train Loss: 0.248	Val F1: 0.332
Best Epoch: 11	Best Val F1: 0.346

****************************** Epoch: 17 ******************************
Batch: 1/116	Loss: 0.143
Batch: 12/116	Loss: 0.251
Batch: 23/116	Loss: 0.281
Batch: 34/116	Loss: 0.161
Batch: 45/116	Loss: 0.158
Batch: 56/116	Loss: 0.260
Batch: 67/116	Loss: 0.340
Batch: 78/116	Loss: 0.262
Batch: 89/116	Loss: 0.282
Batch: 100/116	Loss: 0.107
Batch: 111/116	Loss: 0.242
Batch: 116/116	Loss: 0.633
Epoch: 17	Train Loss: 0.227	Val F1: 0.328
Best Epoch: 11	Best Val F1: 0.346

****************************** Epoch: 18 ******************************
Batch: 1/116	Loss: 0.296
Batch: 12/116	Loss: 0.138
Batch: 23/116	Loss: 0.189
Batch: 34/116	Loss: 0.257
Batch: 45/116	Loss: 0.070
Batch: 56/116	Loss: 0.224
Batch: 67/116	Loss: 0.171
Batch: 78/116	Loss: 0.155
Batch: 89/116	Loss: 0.193
Batch: 100/116	Loss: 0.213
Batch: 111/116	Loss: 0.048
Batch: 116/116	Loss: 0.494
Epoch: 18	Train Loss: 0.186	Val F1: 0.319
Best Epoch: 11	Best Val F1: 0.346

****************************** Epoch: 19 ******************************
Batch: 1/116	Loss: 0.166
Batch: 12/116	Loss: 0.177
Batch: 23/116	Loss: 0.078
Batch: 34/116	Loss: 0.293
Batch: 45/116	Loss: 0.196
Batch: 56/116	Loss: 0.218
Batch: 67/116	Loss: 0.179
Batch: 78/116	Loss: 0.153
Batch: 89/116	Loss: 0.167
Batch: 100/116	Loss: 0.275
Batch: 111/116	Loss: 0.112
Batch: 116/116	Loss: 0.170
Epoch: 19	Train Loss: 0.167	Val F1: 0.329
Best Epoch: 11	Best Val F1: 0.346

****************************** Epoch: 20 ******************************
Batch: 1/116	Loss: 0.226
Batch: 12/116	Loss: 0.146
Batch: 23/116	Loss: 0.103
Batch: 34/116	Loss: 0.147
Batch: 45/116	Loss: 0.198
Batch: 56/116	Loss: 0.211
Batch: 67/116	Loss: 0.158
Batch: 78/116	Loss: 0.150
Batch: 89/116	Loss: 0.077
Batch: 100/116	Loss: 0.115
Batch: 111/116	Loss: 0.100
Batch: 116/116	Loss: 0.129
Epoch: 20	Train Loss: 0.139	Val F1: 0.320
Best Epoch: 11	Best Val F1: 0.346

****************************** Epoch: 21 ******************************
Batch: 1/116	Loss: 0.181
Batch: 12/116	Loss: 0.058
Batch: 23/116	Loss: 0.121
Batch: 34/116	Loss: 0.142
Batch: 45/116	Loss: 0.141
Batch: 56/116	Loss: 0.074
Batch: 67/116	Loss: 0.058
Batch: 78/116	Loss: 0.144
Batch: 89/116	Loss: 0.069
Batch: 100/116	Loss: 0.156
Batch: 111/116	Loss: 0.103
Batch: 116/116	Loss: 0.061
Epoch: 21	Train Loss: 0.112	Val F1: 0.326
Best Epoch: 11	Best Val F1: 0.346

Saving the best checkpoint....
Inference...
Test F1: 0.378	Test F1_Few: 0.377	Test F1_Zero: 0.380
Starting training with config: {'batch_size': 32, 'epochs': 75, 'l2_reg': 0.0009666276234035128, 'lr': 1.658116991698275e-05, 'n_layers_freeze': 0, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 1.043
Batch: 11/58	Loss: 0.982
Batch: 16/58	Loss: 0.922
Batch: 21/58	Loss: 0.923
Batch: 26/58	Loss: 0.912
Batch: 31/58	Loss: 0.881
Batch: 36/58	Loss: 0.903
Batch: 41/58	Loss: 0.854
Batch: 46/58	Loss: 0.837
Batch: 51/58	Loss: 0.824
Batch: 56/58	Loss: 0.829
Batch: 58/58	Loss: 0.835
Epoch: 1	Train Loss: 0.917	Val F1: 0.214
Best Epoch: 1	Best Val F1: 0.214

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.841
Batch: 6/58	Loss: 0.847
Batch: 11/58	Loss: 0.850
Batch: 16/58	Loss: 0.791
Batch: 21/58	Loss: 0.789
Batch: 26/58	Loss: 0.790
Batch: 31/58	Loss: 0.830
Batch: 36/58	Loss: 0.816
Batch: 41/58	Loss: 0.775
Batch: 46/58	Loss: 0.774
Batch: 51/58	Loss: 0.776
Batch: 56/58	Loss: 0.772
Batch: 58/58	Loss: 0.752
Epoch: 2	Train Loss: 0.805	Val F1: 0.345
Best Epoch: 2	Best Val F1: 0.345

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.732
Batch: 6/58	Loss: 0.712
Batch: 11/58	Loss: 0.796
Batch: 16/58	Loss: 0.728
Batch: 21/58	Loss: 0.750
Batch: 26/58	Loss: 0.730
Batch: 31/58	Loss: 0.859
Batch: 36/58	Loss: 0.769
Batch: 41/58	Loss: 0.679
Batch: 46/58	Loss: 0.691
Batch: 51/58	Loss: 0.756
Batch: 56/58	Loss: 0.699
Batch: 58/58	Loss: 0.758
Epoch: 3	Train Loss: 0.744	Val F1: 0.324
Best Epoch: 2	Best Val F1: 0.345

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.742
Batch: 6/58	Loss: 0.679
Batch: 11/58	Loss: 0.635
Batch: 16/58	Loss: 0.636
Batch: 21/58	Loss: 0.558
Batch: 26/58	Loss: 0.571
Batch: 31/58	Loss: 0.615
Batch: 36/58	Loss: 0.717
Batch: 41/58	Loss: 0.713
Batch: 46/58	Loss: 0.611
Batch: 51/58	Loss: 0.591
Batch: 56/58	Loss: 0.641
Batch: 58/58	Loss: 0.663
Epoch: 4	Train Loss: 0.679	Val F1: 0.344
Best Epoch: 2	Best Val F1: 0.345

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.604
Batch: 6/58	Loss: 0.571
Batch: 11/58	Loss: 0.604
Batch: 16/58	Loss: 0.602
Batch: 21/58	Loss: 0.488
Batch: 26/58	Loss: 0.552
Batch: 31/58	Loss: 0.745
Batch: 36/58	Loss: 0.686
Batch: 41/58	Loss: 0.643
Batch: 46/58	Loss: 0.731
Batch: 51/58	Loss: 0.914
Batch: 56/58	Loss: 0.733
Batch: 58/58	Loss: 0.831
Epoch: 5	Train Loss: 0.637	Val F1: 0.319
Best Epoch: 2	Best Val F1: 0.345

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.582
Batch: 6/58	Loss: 0.713
Batch: 11/58	Loss: 0.644
Batch: 16/58	Loss: 0.623
Batch: 21/58	Loss: 0.641
Batch: 26/58	Loss: 0.534
Batch: 31/58	Loss: 0.575
Batch: 36/58	Loss: 0.452
Batch: 41/58	Loss: 0.567
Batch: 46/58	Loss: 0.599
Batch: 51/58	Loss: 0.553
Batch: 56/58	Loss: 0.601
Batch: 58/58	Loss: 0.473
Epoch: 6	Train Loss: 0.583	Val F1: 0.321
Best Epoch: 2	Best Val F1: 0.345

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.425
Batch: 6/58	Loss: 0.622
Batch: 11/58	Loss: 0.735
Batch: 16/58	Loss: 0.436
Batch: 21/58	Loss: 0.447
Batch: 26/58	Loss: 0.507
Batch: 31/58	Loss: 0.560
Batch: 36/58	Loss: 0.446
Batch: 41/58	Loss: 0.503
Batch: 46/58	Loss: 0.685
Batch: 51/58	Loss: 0.532
Batch: 56/58	Loss: 0.569
Batch: 58/58	Loss: 0.449
Epoch: 7	Train Loss: 0.541	Val F1: 0.370
Best Epoch: 7	Best Val F1: 0.370

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.519
Batch: 6/58	Loss: 0.454
Batch: 11/58	Loss: 0.449
Batch: 16/58	Loss: 0.414
Batch: 21/58	Loss: 0.537
Batch: 26/58	Loss: 0.401
Batch: 31/58	Loss: 0.498
Batch: 36/58	Loss: 0.364
Batch: 41/58	Loss: 0.536
Batch: 46/58	Loss: 0.465
Batch: 51/58	Loss: 0.485
Batch: 56/58	Loss: 0.394
Batch: 58/58	Loss: 0.533
Epoch: 8	Train Loss: 0.480	Val F1: 0.361
Best Epoch: 7	Best Val F1: 0.370

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.494
Batch: 6/58	Loss: 0.557
Batch: 11/58	Loss: 0.478
Batch: 16/58	Loss: 0.345
Batch: 21/58	Loss: 0.358
Batch: 26/58	Loss: 0.326
Batch: 31/58	Loss: 0.350
Batch: 36/58	Loss: 0.442
Batch: 41/58	Loss: 0.435
Batch: 46/58	Loss: 0.381
Batch: 51/58	Loss: 0.503
Batch: 56/58	Loss: 0.397
Batch: 58/58	Loss: 0.384
Epoch: 9	Train Loss: 0.423	Val F1: 0.359
Best Epoch: 7	Best Val F1: 0.370

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.348
Batch: 6/58	Loss: 0.373
Batch: 11/58	Loss: 0.406
Batch: 16/58	Loss: 0.448
Batch: 21/58	Loss: 0.317
Batch: 26/58	Loss: 0.472
Batch: 31/58	Loss: 0.309
Batch: 36/58	Loss: 0.686
Batch: 41/58	Loss: 0.526
Batch: 46/58	Loss: 0.432
Batch: 51/58	Loss: 0.406
Batch: 56/58	Loss: 0.340
Batch: 58/58	Loss: 0.444
Epoch: 10	Train Loss: 0.395	Val F1: 0.372
Best Epoch: 10	Best Val F1: 0.372

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.371
Batch: 6/58	Loss: 0.345
Batch: 11/58	Loss: 0.307
Batch: 16/58	Loss: 0.357
Batch: 21/58	Loss: 0.322
Batch: 26/58	Loss: 0.535
Batch: 31/58	Loss: 0.423
Batch: 36/58	Loss: 0.387
Batch: 41/58	Loss: 0.264
Batch: 46/58	Loss: 0.315
Batch: 51/58	Loss: 0.379
Batch: 56/58	Loss: 0.444
Batch: 58/58	Loss: 0.377
Epoch: 11	Train Loss: 0.362	Val F1: 0.347
Best Epoch: 10	Best Val F1: 0.372

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.414
Batch: 6/58	Loss: 0.255
Batch: 11/58	Loss: 0.304
Batch: 16/58	Loss: 0.289
Batch: 21/58	Loss: 0.438
Batch: 26/58	Loss: 0.326
Batch: 31/58	Loss: 0.376
Batch: 36/58	Loss: 0.330
Batch: 41/58	Loss: 0.311
Batch: 46/58	Loss: 0.344
Batch: 51/58	Loss: 0.461
Batch: 56/58	Loss: 0.264
Batch: 58/58	Loss: 0.163
Epoch: 12	Train Loss: 0.333	Val F1: 0.366
Best Epoch: 10	Best Val F1: 0.372

****************************** Epoch: 13 ******************************
Batch: 1/58	Loss: 0.353
Batch: 6/58	Loss: 0.240
Batch: 11/58	Loss: 0.322
Batch: 16/58	Loss: 0.270
Batch: 21/58	Loss: 0.319
Batch: 26/58	Loss: 0.326
Batch: 31/58	Loss: 0.307
Batch: 36/58	Loss: 0.284
Batch: 41/58	Loss: 0.258
Batch: 46/58	Loss: 0.304
Batch: 51/58	Loss: 0.226
Batch: 56/58	Loss: 0.371
Batch: 58/58	Loss: 0.200
Epoch: 13	Train Loss: 0.309	Val F1: 0.359
Best Epoch: 10	Best Val F1: 0.372

****************************** Epoch: 14 ******************************
Batch: 1/58	Loss: 0.352
Batch: 6/58	Loss: 0.383
Batch: 11/58	Loss: 0.310
Batch: 16/58	Loss: 0.382
Batch: 21/58	Loss: 0.285
Batch: 26/58	Loss: 0.341
Batch: 31/58	Loss: 0.271
Batch: 36/58	Loss: 0.259
Batch: 41/58	Loss: 0.254
Batch: 46/58	Loss: 0.269
Batch: 51/58	Loss: 0.423
Batch: 56/58	Loss: 0.226
Batch: 58/58	Loss: 0.394
Epoch: 14	Train Loss: 0.312	Val F1: 0.362
Best Epoch: 10	Best Val F1: 0.372

****************************** Epoch: 15 ******************************
Batch: 1/58	Loss: 0.234
Batch: 6/58	Loss: 0.348
Batch: 11/58	Loss: 0.236
Batch: 16/58	Loss: 0.281
Batch: 21/58	Loss: 0.352
Batch: 26/58	Loss: 0.283
Batch: 31/58	Loss: 0.245
Batch: 36/58	Loss: 0.299
Batch: 41/58	Loss: 0.322
Batch: 46/58	Loss: 0.221
Batch: 51/58	Loss: 0.229
Batch: 56/58	Loss: 0.223
Batch: 58/58	Loss: 0.364
Epoch: 15	Train Loss: 0.292	Val F1: 0.353
Best Epoch: 10	Best Val F1: 0.372

****************************** Epoch: 16 ******************************
Batch: 1/58	Loss: 0.269
Batch: 6/58	Loss: 0.158
Batch: 11/58	Loss: 0.168
Batch: 16/58	Loss: 0.201
Batch: 21/58	Loss: 0.171
Batch: 26/58	Loss: 0.245
Batch: 31/58	Loss: 0.277
Batch: 36/58	Loss: 0.253
Batch: 41/58	Loss: 0.230
Batch: 46/58	Loss: 0.226
Batch: 51/58	Loss: 0.311
Batch: 56/58	Loss: 0.240
Batch: 58/58	Loss: 0.226
Epoch: 16	Train Loss: 0.264	Val F1: 0.359
Best Epoch: 10	Best Val F1: 0.372

****************************** Epoch: 17 ******************************
Batch: 1/58	Loss: 0.192
Batch: 6/58	Loss: 0.271
Batch: 11/58	Loss: 0.205
Batch: 16/58	Loss: 0.271
Batch: 21/58	Loss: 0.305
Batch: 26/58	Loss: 0.255
Batch: 31/58	Loss: 0.224
Batch: 36/58	Loss: 0.181
Batch: 41/58	Loss: 0.249
Batch: 46/58	Loss: 0.375
Batch: 51/58	Loss: 0.205
Batch: 56/58	Loss: 0.180
Batch: 58/58	Loss: 0.202
Epoch: 17	Train Loss: 0.238	Val F1: 0.348
Best Epoch: 10	Best Val F1: 0.372

****************************** Epoch: 18 ******************************
Batch: 1/58	Loss: 0.238
Batch: 6/58	Loss: 0.283
Batch: 11/58	Loss: 0.221
Batch: 16/58	Loss: 0.268
Batch: 21/58	Loss: 0.168
Batch: 26/58	Loss: 0.236
Batch: 31/58	Loss: 0.192
Batch: 36/58	Loss: 0.171
Batch: 41/58	Loss: 0.142
Batch: 46/58	Loss: 0.215
Batch: 51/58	Loss: 0.174
Batch: 56/58	Loss: 0.232
Batch: 58/58	Loss: 0.357
Epoch: 18	Train Loss: 0.213	Val F1: 0.349
Best Epoch: 10	Best Val F1: 0.372

****************************** Epoch: 19 ******************************
Batch: 1/58	Loss: 0.219
Batch: 6/58	Loss: 0.254
Batch: 11/58	Loss: 0.240
Batch: 16/58	Loss: 0.079
Batch: 21/58	Loss: 0.218
Batch: 26/58	Loss: 0.262
Batch: 31/58	Loss: 0.119
Batch: 36/58	Loss: 0.138
Batch: 41/58	Loss: 0.141
Batch: 46/58	Loss: 0.266
Batch: 51/58	Loss: 0.165
Batch: 56/58	Loss: 0.185
Batch: 58/58	Loss: 0.165
Epoch: 19	Train Loss: 0.203	Val F1: 0.347
Best Epoch: 10	Best Val F1: 0.372

****************************** Epoch: 20 ******************************
Batch: 1/58	Loss: 0.149
Batch: 6/58	Loss: 0.177
Batch: 11/58	Loss: 0.157
Batch: 16/58	Loss: 0.176
Batch: 21/58	Loss: 0.149
Batch: 26/58	Loss: 0.115
Batch: 31/58	Loss: 0.200
Batch: 36/58	Loss: 0.095
Batch: 41/58	Loss: 0.124
Batch: 46/58	Loss: 0.217
Batch: 51/58	Loss: 0.131
Batch: 56/58	Loss: 0.117
Batch: 58/58	Loss: 0.246
Epoch: 20	Train Loss: 0.167	Val F1: 0.358
Best Epoch: 10	Best Val F1: 0.372

Saving the best checkpoint....
Inference...
Test F1: 0.380	Test F1_Few: 0.451	Test F1_Zero: 0.376
Starting training with config: {'batch_size': 16, 'epochs': 75, 'l2_reg': 0.000972136913094378, 'lr': 2.10230458932604e-05, 'n_layers_freeze': 2, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 0.974
Batch: 23/116	Loss: 0.909
Batch: 34/116	Loss: 0.889
Batch: 45/116	Loss: 0.844
Batch: 56/116	Loss: 0.843
Batch: 67/116	Loss: 0.788
Batch: 78/116	Loss: 0.793
Batch: 89/116	Loss: 0.880
Batch: 100/116	Loss: 0.758
Batch: 111/116	Loss: 0.793
Batch: 116/116	Loss: 0.740
Epoch: 1	Train Loss: 0.856	Val F1: 0.231
Best Epoch: 1	Best Val F1: 0.231

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.843
Batch: 12/116	Loss: 0.783
Batch: 23/116	Loss: 0.748
Batch: 34/116	Loss: 0.743
Batch: 45/116	Loss: 0.811
Batch: 56/116	Loss: 0.751
Batch: 67/116	Loss: 0.752
Batch: 78/116	Loss: 0.747
Batch: 89/116	Loss: 0.717
Batch: 100/116	Loss: 0.727
Batch: 111/116	Loss: 0.732
Batch: 116/116	Loss: 0.677
Epoch: 2	Train Loss: 0.760	Val F1: 0.317
Best Epoch: 2	Best Val F1: 0.317

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.680
Batch: 12/116	Loss: 0.603
Batch: 23/116	Loss: 0.632
Batch: 34/116	Loss: 0.769
Batch: 45/116	Loss: 0.777
Batch: 56/116	Loss: 0.745
Batch: 67/116	Loss: 0.673
Batch: 78/116	Loss: 0.684
Batch: 89/116	Loss: 0.707
Batch: 100/116	Loss: 0.860
Batch: 111/116	Loss: 0.978
Batch: 116/116	Loss: 0.587
Epoch: 3	Train Loss: 0.703	Val F1: 0.325
Best Epoch: 3	Best Val F1: 0.325

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.667
Batch: 12/116	Loss: 0.549
Batch: 23/116	Loss: 0.862
Batch: 34/116	Loss: 0.555
Batch: 45/116	Loss: 0.688
Batch: 56/116	Loss: 0.620
Batch: 67/116	Loss: 0.653
Batch: 78/116	Loss: 0.591
Batch: 89/116	Loss: 0.752
Batch: 100/116	Loss: 0.603
Batch: 111/116	Loss: 0.689
Batch: 116/116	Loss: 0.799
Epoch: 4	Train Loss: 0.658	Val F1: 0.325
Best Epoch: 3	Best Val F1: 0.325

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.483
Batch: 12/116	Loss: 0.553
Batch: 23/116	Loss: 0.622
Batch: 34/116	Loss: 0.585
Batch: 45/116	Loss: 0.652
Batch: 56/116	Loss: 0.578
Batch: 67/116	Loss: 0.626
Batch: 78/116	Loss: 0.651
Batch: 89/116	Loss: 0.787
Batch: 100/116	Loss: 0.659
Batch: 111/116	Loss: 0.623
Batch: 116/116	Loss: 0.466
Epoch: 5	Train Loss: 0.602	Val F1: 0.332
Best Epoch: 5	Best Val F1: 0.332

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.499
Batch: 12/116	Loss: 0.856
Batch: 23/116	Loss: 0.616
Batch: 34/116	Loss: 0.510
Batch: 45/116	Loss: 0.446
Batch: 56/116	Loss: 0.498
Batch: 67/116	Loss: 0.477
Batch: 78/116	Loss: 0.648
Batch: 89/116	Loss: 0.891
Batch: 100/116	Loss: 0.650
Batch: 111/116	Loss: 0.578
Batch: 116/116	Loss: 0.184
Epoch: 6	Train Loss: 0.530	Val F1: 0.346
Best Epoch: 6	Best Val F1: 0.346

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.378
Batch: 12/116	Loss: 0.698
Batch: 23/116	Loss: 0.514
Batch: 34/116	Loss: 0.739
Batch: 45/116	Loss: 0.380
Batch: 56/116	Loss: 0.874
Batch: 67/116	Loss: 0.429
Batch: 78/116	Loss: 0.527
Batch: 89/116	Loss: 0.438
Batch: 100/116	Loss: 0.395
Batch: 111/116	Loss: 0.694
Batch: 116/116	Loss: 0.249
Epoch: 7	Train Loss: 0.475	Val F1: 0.348
Best Epoch: 7	Best Val F1: 0.348

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.462
Batch: 12/116	Loss: 0.410
Batch: 23/116	Loss: 0.269
Batch: 34/116	Loss: 0.323
Batch: 45/116	Loss: 0.317
Batch: 56/116	Loss: 0.257
Batch: 67/116	Loss: 0.734
Batch: 78/116	Loss: 0.346
Batch: 89/116	Loss: 0.285
Batch: 100/116	Loss: 0.573
Batch: 111/116	Loss: 0.266
Batch: 116/116	Loss: 0.454
Epoch: 8	Train Loss: 0.406	Val F1: 0.348
Best Epoch: 7	Best Val F1: 0.348

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.339
Batch: 12/116	Loss: 0.402
Batch: 23/116	Loss: 0.340
Batch: 34/116	Loss: 0.361
Batch: 45/116	Loss: 0.329
Batch: 56/116	Loss: 0.382
Batch: 67/116	Loss: 0.320
Batch: 78/116	Loss: 0.384
Batch: 89/116	Loss: 0.210
Batch: 100/116	Loss: 0.427
Batch: 111/116	Loss: 0.309
Batch: 116/116	Loss: 0.596
Epoch: 9	Train Loss: 0.363	Val F1: 0.359
Best Epoch: 9	Best Val F1: 0.359

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.325
Batch: 12/116	Loss: 0.289
Batch: 23/116	Loss: 0.240
Batch: 34/116	Loss: 0.345
Batch: 45/116	Loss: 0.172
Batch: 56/116	Loss: 0.414
Batch: 67/116	Loss: 0.349
Batch: 78/116	Loss: 0.231
Batch: 89/116	Loss: 0.229
Batch: 100/116	Loss: 0.413
Batch: 111/116	Loss: 0.190
Batch: 116/116	Loss: 0.205
Epoch: 10	Train Loss: 0.324	Val F1: 0.343
Best Epoch: 9	Best Val F1: 0.359

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.357
Batch: 12/116	Loss: 0.226
Batch: 23/116	Loss: 0.147
Batch: 34/116	Loss: 0.197
Batch: 45/116	Loss: 0.349
Batch: 56/116	Loss: 0.348
Batch: 67/116	Loss: 0.302
Batch: 78/116	Loss: 0.216
Batch: 89/116	Loss: 0.160
Batch: 100/116	Loss: 0.293
Batch: 111/116	Loss: 0.378
Batch: 116/116	Loss: 0.104
Epoch: 11	Train Loss: 0.298	Val F1: 0.337
Best Epoch: 9	Best Val F1: 0.359

****************************** Epoch: 12 ******************************
Batch: 1/116	Loss: 0.426
Batch: 12/116	Loss: 0.254
Batch: 23/116	Loss: 0.185
Batch: 34/116	Loss: 0.305
Batch: 45/116	Loss: 0.183
Batch: 56/116	Loss: 0.275
Batch: 67/116	Loss: 0.191
Batch: 78/116	Loss: 0.350
Batch: 89/116	Loss: 0.307
Batch: 100/116	Loss: 0.284
Batch: 111/116	Loss: 0.178
Batch: 116/116	Loss: 0.093
Epoch: 12	Train Loss: 0.268	Val F1: 0.338
Best Epoch: 9	Best Val F1: 0.359

****************************** Epoch: 13 ******************************
Batch: 1/116	Loss: 0.181
Batch: 12/116	Loss: 0.108
Batch: 23/116	Loss: 0.266
Batch: 34/116	Loss: 0.112
Batch: 45/116	Loss: 0.573
Batch: 56/116	Loss: 0.287
Batch: 67/116	Loss: 0.134
Batch: 78/116	Loss: 0.335
Batch: 89/116	Loss: 0.337
Batch: 100/116	Loss: 0.200
Batch: 111/116	Loss: 0.277
Batch: 116/116	Loss: 0.111
Epoch: 13	Train Loss: 0.235	Val F1: 0.331
Best Epoch: 9	Best Val F1: 0.359

****************************** Epoch: 14 ******************************
Batch: 1/116	Loss: 0.501
Batch: 12/116	Loss: 0.282
Batch: 23/116	Loss: 0.126
Batch: 34/116	Loss: 0.267
Batch: 45/116	Loss: 0.205
Batch: 56/116	Loss: 0.261
Batch: 67/116	Loss: 0.474
Batch: 78/116	Loss: 0.351
Batch: 89/116	Loss: 0.146
Batch: 100/116	Loss: 0.260
Batch: 111/116	Loss: 0.119
Batch: 116/116	Loss: 0.234
Epoch: 14	Train Loss: 0.199	Val F1: 0.337
Best Epoch: 9	Best Val F1: 0.359

****************************** Epoch: 15 ******************************
Batch: 1/116	Loss: 0.108
Batch: 12/116	Loss: 0.325
Batch: 23/116	Loss: 0.146
Batch: 34/116	Loss: 0.326
Batch: 45/116	Loss: 0.218
Batch: 56/116	Loss: 0.221
Batch: 67/116	Loss: 0.235
Batch: 78/116	Loss: 0.095
Batch: 89/116	Loss: 0.150
Batch: 100/116	Loss: 0.142
Batch: 111/116	Loss: 0.151
Batch: 116/116	Loss: 0.023
Epoch: 15	Train Loss: 0.171	Val F1: 0.333
Best Epoch: 9	Best Val F1: 0.359

****************************** Epoch: 16 ******************************
Batch: 1/116	Loss: 0.176
Batch: 12/116	Loss: 0.060
Batch: 23/116	Loss: 0.215
Batch: 34/116	Loss: 0.097
Batch: 45/116	Loss: 0.048
Batch: 56/116	Loss: 0.131
Batch: 67/116	Loss: 0.113
Batch: 78/116	Loss: 0.235
Batch: 89/116	Loss: 0.146
Batch: 100/116	Loss: 0.124
Batch: 111/116	Loss: 0.052
Batch: 116/116	Loss: 0.683
Epoch: 16	Train Loss: 0.147	Val F1: 0.350
Best Epoch: 9	Best Val F1: 0.359

****************************** Epoch: 17 ******************************
Batch: 1/116	Loss: 0.112
Batch: 12/116	Loss: 0.135
Batch: 23/116	Loss: 0.089
Batch: 34/116	Loss: 0.108
Batch: 45/116	Loss: 0.118
Batch: 56/116	Loss: 0.067
Batch: 67/116	Loss: 0.134
Batch: 78/116	Loss: 0.122
Batch: 89/116	Loss: 0.397
Batch: 100/116	Loss: 0.032
Batch: 111/116	Loss: 0.180
Batch: 116/116	Loss: 0.116
Epoch: 17	Train Loss: 0.112	Val F1: 0.345
Best Epoch: 9	Best Val F1: 0.359

****************************** Epoch: 18 ******************************
Batch: 1/116	Loss: 0.133
Batch: 12/116	Loss: 0.061
Batch: 23/116	Loss: 0.058
Batch: 34/116	Loss: 0.084
Batch: 45/116	Loss: 0.025
Batch: 56/116	Loss: 0.121
Batch: 67/116	Loss: 0.181
Batch: 78/116	Loss: 0.080
Batch: 89/116	Loss: 0.138
Batch: 100/116	Loss: 0.069
Batch: 111/116	Loss: 0.018
Batch: 116/116	Loss: 0.115
Epoch: 18	Train Loss: 0.099	Val F1: 0.335
Best Epoch: 9	Best Val F1: 0.359

****************************** Epoch: 19 ******************************
Batch: 1/116	Loss: 0.048
Batch: 12/116	Loss: 0.212
Batch: 23/116	Loss: 0.047
Batch: 34/116	Loss: 0.079
Batch: 45/116	Loss: 0.050
Batch: 56/116	Loss: 0.086
Batch: 67/116	Loss: 0.112
Batch: 78/116	Loss: 0.118
Batch: 89/116	Loss: 0.052
Batch: 100/116	Loss: 0.103
Batch: 111/116	Loss: 0.062
Batch: 116/116	Loss: 0.027
Epoch: 19	Train Loss: 0.087	Val F1: 0.340
Best Epoch: 9	Best Val F1: 0.359

Saving the best checkpoint....
Inference...
Test F1: 0.392	Test F1_Few: 0.386	Test F1_Zero: 0.392
Starting training with config: {'batch_size': 32, 'epochs': 75, 'l2_reg': 0.000820470999106121, 'lr': 1.8907322696896104e-05, 'n_layers_freeze': 1, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 1.036
Batch: 11/58	Loss: 0.972
Batch: 16/58	Loss: 0.908
Batch: 21/58	Loss: 0.914
Batch: 26/58	Loss: 0.903
Batch: 31/58	Loss: 0.871
Batch: 36/58	Loss: 0.895
Batch: 41/58	Loss: 0.844
Batch: 46/58	Loss: 0.827
Batch: 51/58	Loss: 0.814
Batch: 56/58	Loss: 0.819
Batch: 58/58	Loss: 0.825
Epoch: 1	Train Loss: 0.908	Val F1: 0.213
Best Epoch: 1	Best Val F1: 0.213

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.833
Batch: 6/58	Loss: 0.840
Batch: 11/58	Loss: 0.843
Batch: 16/58	Loss: 0.780
Batch: 21/58	Loss: 0.779
Batch: 26/58	Loss: 0.781
Batch: 31/58	Loss: 0.825
Batch: 36/58	Loss: 0.809
Batch: 41/58	Loss: 0.766
Batch: 46/58	Loss: 0.768
Batch: 51/58	Loss: 0.767
Batch: 56/58	Loss: 0.759
Batch: 58/58	Loss: 0.747
Epoch: 2	Train Loss: 0.796	Val F1: 0.339
Best Epoch: 2	Best Val F1: 0.339

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.715
Batch: 6/58	Loss: 0.729
Batch: 11/58	Loss: 0.797
Batch: 16/58	Loss: 0.726
Batch: 21/58	Loss: 0.732
Batch: 26/58	Loss: 0.714
Batch: 31/58	Loss: 0.872
Batch: 36/58	Loss: 0.758
Batch: 41/58	Loss: 0.650
Batch: 46/58	Loss: 0.686
Batch: 51/58	Loss: 0.740
Batch: 56/58	Loss: 0.710
Batch: 58/58	Loss: 0.731
Epoch: 3	Train Loss: 0.734	Val F1: 0.332
Best Epoch: 2	Best Val F1: 0.339

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.716
Batch: 6/58	Loss: 0.648
Batch: 11/58	Loss: 0.610
Batch: 16/58	Loss: 0.627
Batch: 21/58	Loss: 0.542
Batch: 26/58	Loss: 0.553
Batch: 31/58	Loss: 0.617
Batch: 36/58	Loss: 0.693
Batch: 41/58	Loss: 0.707
Batch: 46/58	Loss: 0.572
Batch: 51/58	Loss: 0.730
Batch: 56/58	Loss: 0.727
Batch: 58/58	Loss: 0.671
Epoch: 4	Train Loss: 0.671	Val F1: 0.333
Best Epoch: 2	Best Val F1: 0.339

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.600
Batch: 6/58	Loss: 0.567
Batch: 11/58	Loss: 0.624
Batch: 16/58	Loss: 0.586
Batch: 21/58	Loss: 0.472
Batch: 26/58	Loss: 0.499
Batch: 31/58	Loss: 0.733
Batch: 36/58	Loss: 0.623
Batch: 41/58	Loss: 0.649
Batch: 46/58	Loss: 0.684
Batch: 51/58	Loss: 0.851
Batch: 56/58	Loss: 0.714
Batch: 58/58	Loss: 0.862
Epoch: 5	Train Loss: 0.626	Val F1: 0.331
Best Epoch: 2	Best Val F1: 0.339

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.526
Batch: 6/58	Loss: 0.714
Batch: 11/58	Loss: 0.576
Batch: 16/58	Loss: 0.630
Batch: 21/58	Loss: 0.604
Batch: 26/58	Loss: 0.463
Batch: 31/58	Loss: 0.570
Batch: 36/58	Loss: 0.406
Batch: 41/58	Loss: 0.511
Batch: 46/58	Loss: 0.565
Batch: 51/58	Loss: 0.510
Batch: 56/58	Loss: 0.583
Batch: 58/58	Loss: 0.496
Epoch: 6	Train Loss: 0.563	Val F1: 0.354
Best Epoch: 6	Best Val F1: 0.354

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.390
Batch: 6/58	Loss: 0.592
Batch: 11/58	Loss: 0.651
Batch: 16/58	Loss: 0.403
Batch: 21/58	Loss: 0.398
Batch: 26/58	Loss: 0.493
Batch: 31/58	Loss: 0.524
Batch: 36/58	Loss: 0.486
Batch: 41/58	Loss: 0.467
Batch: 46/58	Loss: 0.381
Batch: 51/58	Loss: 0.448
Batch: 56/58	Loss: 0.573
Batch: 58/58	Loss: 0.428
Epoch: 7	Train Loss: 0.503	Val F1: 0.356
Best Epoch: 7	Best Val F1: 0.356

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.466
Batch: 6/58	Loss: 0.384
Batch: 11/58	Loss: 0.436
Batch: 16/58	Loss: 0.459
Batch: 21/58	Loss: 0.455
Batch: 26/58	Loss: 0.383
Batch: 31/58	Loss: 0.487
Batch: 36/58	Loss: 0.333
Batch: 41/58	Loss: 0.525
Batch: 46/58	Loss: 0.526
Batch: 51/58	Loss: 0.414
Batch: 56/58	Loss: 0.394
Batch: 58/58	Loss: 0.477
Epoch: 8	Train Loss: 0.452	Val F1: 0.360
Best Epoch: 8	Best Val F1: 0.360

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.456
Batch: 6/58	Loss: 0.509
Batch: 11/58	Loss: 0.471
Batch: 16/58	Loss: 0.341
Batch: 21/58	Loss: 0.352
Batch: 26/58	Loss: 0.312
Batch: 31/58	Loss: 0.354
Batch: 36/58	Loss: 0.354
Batch: 41/58	Loss: 0.450
Batch: 46/58	Loss: 0.342
Batch: 51/58	Loss: 0.561
Batch: 56/58	Loss: 0.300
Batch: 58/58	Loss: 0.361
Epoch: 9	Train Loss: 0.403	Val F1: 0.367
Best Epoch: 9	Best Val F1: 0.367

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.346
Batch: 6/58	Loss: 0.346
Batch: 11/58	Loss: 0.404
Batch: 16/58	Loss: 0.474
Batch: 21/58	Loss: 0.308
Batch: 26/58	Loss: 0.351
Batch: 31/58	Loss: 0.280
Batch: 36/58	Loss: 0.617
Batch: 41/58	Loss: 0.446
Batch: 46/58	Loss: 0.419
Batch: 51/58	Loss: 0.347
Batch: 56/58	Loss: 0.315
Batch: 58/58	Loss: 0.436
Epoch: 10	Train Loss: 0.372	Val F1: 0.350
Best Epoch: 9	Best Val F1: 0.367

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.349
Batch: 6/58	Loss: 0.284
Batch: 11/58	Loss: 0.248
Batch: 16/58	Loss: 0.341
Batch: 21/58	Loss: 0.332
Batch: 26/58	Loss: 0.504
Batch: 31/58	Loss: 0.339
Batch: 36/58	Loss: 0.351
Batch: 41/58	Loss: 0.246
Batch: 46/58	Loss: 0.302
Batch: 51/58	Loss: 0.376
Batch: 56/58	Loss: 0.382
Batch: 58/58	Loss: 0.382
Epoch: 11	Train Loss: 0.343	Val F1: 0.354
Best Epoch: 9	Best Val F1: 0.367

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.381
Batch: 6/58	Loss: 0.250
Batch: 11/58	Loss: 0.323
Batch: 16/58	Loss: 0.282
Batch: 21/58	Loss: 0.389
Batch: 26/58	Loss: 0.305
Batch: 31/58	Loss: 0.406
Batch: 36/58	Loss: 0.290
Batch: 41/58	Loss: 0.273
Batch: 46/58	Loss: 0.321
Batch: 51/58	Loss: 0.472
Batch: 56/58	Loss: 0.248
Batch: 58/58	Loss: 0.139
Epoch: 12	Train Loss: 0.317	Val F1: 0.360
Best Epoch: 9	Best Val F1: 0.367

****************************** Epoch: 13 ******************************
Batch: 1/58	Loss: 0.338
Batch: 6/58	Loss: 0.263
Batch: 11/58	Loss: 0.365
Batch: 16/58	Loss: 0.249
Batch: 21/58	Loss: 0.231
Batch: 26/58	Loss: 0.308
Batch: 31/58	Loss: 0.288
Batch: 36/58	Loss: 0.289
Batch: 41/58	Loss: 0.237
Batch: 46/58	Loss: 0.293
Batch: 51/58	Loss: 0.257
Batch: 56/58	Loss: 0.372
Batch: 58/58	Loss: 0.168
Epoch: 13	Train Loss: 0.308	Val F1: 0.347
Best Epoch: 9	Best Val F1: 0.367

****************************** Epoch: 14 ******************************
Batch: 1/58	Loss: 0.397
Batch: 6/58	Loss: 0.388
Batch: 11/58	Loss: 0.329
Batch: 16/58	Loss: 0.340
Batch: 21/58	Loss: 0.284
Batch: 26/58	Loss: 0.310
Batch: 31/58	Loss: 0.268
Batch: 36/58	Loss: 0.249
Batch: 41/58	Loss: 0.169
Batch: 46/58	Loss: 0.276
Batch: 51/58	Loss: 0.368
Batch: 56/58	Loss: 0.226
Batch: 58/58	Loss: 0.363
Epoch: 14	Train Loss: 0.290	Val F1: 0.351
Best Epoch: 9	Best Val F1: 0.367

Saving the best checkpoint....
Inference...
Test F1: 0.381	Test F1_Few: 0.457	Test F1_Zero: 0.371
Starting training with config: {'batch_size': 32, 'epochs': 75, 'l2_reg': 0.0007949719498260779, 'lr': 4.077546922621709e-06, 'n_layers_freeze': 1, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 1.085
Batch: 11/58	Loss: 1.068
Batch: 16/58	Loss: 1.052
Batch: 21/58	Loss: 1.038
Batch: 26/58	Loss: 1.025
Batch: 31/58	Loss: 1.006
Batch: 36/58	Loss: 1.008
Batch: 41/58	Loss: 0.977
Batch: 46/58	Loss: 0.956
Batch: 51/58	Loss: 0.944
Batch: 56/58	Loss: 0.941
Batch: 58/58	Loss: 0.938
Epoch: 1	Train Loss: 1.015	Val F1: 0.209
Best Epoch: 1	Best Val F1: 0.209

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.941
Batch: 6/58	Loss: 0.939
Batch: 11/58	Loss: 0.933
Batch: 16/58	Loss: 0.903
Batch: 21/58	Loss: 0.895
Batch: 26/58	Loss: 0.894
Batch: 31/58	Loss: 0.912
Batch: 36/58	Loss: 0.907
Batch: 41/58	Loss: 0.882
Batch: 46/58	Loss: 0.877
Batch: 51/58	Loss: 0.876
Batch: 56/58	Loss: 0.878
Batch: 58/58	Loss: 0.865
Epoch: 2	Train Loss: 0.904	Val F1: 0.186
Best Epoch: 1	Best Val F1: 0.209

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.866
Batch: 6/58	Loss: 0.855
Batch: 11/58	Loss: 0.892
Batch: 16/58	Loss: 0.865
Batch: 21/58	Loss: 0.855
Batch: 26/58	Loss: 0.876
Batch: 31/58	Loss: 0.925
Batch: 36/58	Loss: 0.863
Batch: 41/58	Loss: 0.851
Batch: 46/58	Loss: 0.835
Batch: 51/58	Loss: 0.846
Batch: 56/58	Loss: 0.852
Batch: 58/58	Loss: 0.851
Epoch: 3	Train Loss: 0.864	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.209

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.843
Batch: 6/58	Loss: 0.855
Batch: 11/58	Loss: 0.842
Batch: 16/58	Loss: 0.851
Batch: 21/58	Loss: 0.818
Batch: 26/58	Loss: 0.818
Batch: 31/58	Loss: 0.818
Batch: 36/58	Loss: 0.849
Batch: 41/58	Loss: 0.867
Batch: 46/58	Loss: 0.851
Batch: 51/58	Loss: 0.803
Batch: 56/58	Loss: 0.811
Batch: 58/58	Loss: 0.863
Epoch: 4	Train Loss: 0.840	Val F1: 0.187
Best Epoch: 1	Best Val F1: 0.209

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.816
Batch: 6/58	Loss: 0.806
Batch: 11/58	Loss: 0.832
Batch: 16/58	Loss: 0.827
Batch: 21/58	Loss: 0.798
Batch: 26/58	Loss: 0.790
Batch: 31/58	Loss: 0.860
Batch: 36/58	Loss: 0.837
Batch: 41/58	Loss: 0.808
Batch: 46/58	Loss: 0.793
Batch: 51/58	Loss: 0.855
Batch: 56/58	Loss: 0.852
Batch: 58/58	Loss: 0.838
Epoch: 5	Train Loss: 0.821	Val F1: 0.278
Best Epoch: 5	Best Val F1: 0.278

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.783
Batch: 6/58	Loss: 0.843
Batch: 11/58	Loss: 0.856
Batch: 16/58	Loss: 0.799
Batch: 21/58	Loss: 0.825
Batch: 26/58	Loss: 0.792
Batch: 31/58	Loss: 0.797
Batch: 36/58	Loss: 0.766
Batch: 41/58	Loss: 0.799
Batch: 46/58	Loss: 0.765
Batch: 51/58	Loss: 0.770
Batch: 56/58	Loss: 0.805
Batch: 58/58	Loss: 0.747
Epoch: 6	Train Loss: 0.798	Val F1: 0.306
Best Epoch: 6	Best Val F1: 0.306

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.745
Batch: 6/58	Loss: 0.844
Batch: 11/58	Loss: 0.863
Batch: 16/58	Loss: 0.778
Batch: 21/58	Loss: 0.753
Batch: 26/58	Loss: 0.804
Batch: 31/58	Loss: 0.761
Batch: 36/58	Loss: 0.764
Batch: 41/58	Loss: 0.730
Batch: 46/58	Loss: 0.733
Batch: 51/58	Loss: 0.721
Batch: 56/58	Loss: 0.761
Batch: 58/58	Loss: 0.702
Epoch: 7	Train Loss: 0.771	Val F1: 0.331
Best Epoch: 7	Best Val F1: 0.331

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.735
Batch: 6/58	Loss: 0.742
Batch: 11/58	Loss: 0.711
Batch: 16/58	Loss: 0.710
Batch: 21/58	Loss: 0.733
Batch: 26/58	Loss: 0.774
Batch: 31/58	Loss: 0.709
Batch: 36/58	Loss: 0.667
Batch: 41/58	Loss: 0.761
Batch: 46/58	Loss: 0.749
Batch: 51/58	Loss: 0.761
Batch: 56/58	Loss: 0.672
Batch: 58/58	Loss: 0.644
Epoch: 8	Train Loss: 0.738	Val F1: 0.335
Best Epoch: 8	Best Val F1: 0.335

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.717
Batch: 6/58	Loss: 0.730
Batch: 11/58	Loss: 0.767
Batch: 16/58	Loss: 0.721
Batch: 21/58	Loss: 0.734
Batch: 26/58	Loss: 0.683
Batch: 31/58	Loss: 0.685
Batch: 36/58	Loss: 0.682
Batch: 41/58	Loss: 0.786
Batch: 46/58	Loss: 0.697
Batch: 51/58	Loss: 0.718
Batch: 56/58	Loss: 0.602
Batch: 58/58	Loss: 0.634
Epoch: 9	Train Loss: 0.710	Val F1: 0.341
Best Epoch: 9	Best Val F1: 0.341

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.641
Batch: 6/58	Loss: 0.700
Batch: 11/58	Loss: 0.729
Batch: 16/58	Loss: 0.752
Batch: 21/58	Loss: 0.561
Batch: 26/58	Loss: 0.683
Batch: 31/58	Loss: 0.720
Batch: 36/58	Loss: 0.761
Batch: 41/58	Loss: 0.697
Batch: 46/58	Loss: 0.720
Batch: 51/58	Loss: 0.695
Batch: 56/58	Loss: 0.638
Batch: 58/58	Loss: 0.799
Epoch: 10	Train Loss: 0.682	Val F1: 0.329
Best Epoch: 9	Best Val F1: 0.341

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.678
Batch: 6/58	Loss: 0.711
Batch: 11/58	Loss: 0.694
Batch: 16/58	Loss: 0.726
Batch: 21/58	Loss: 0.630
Batch: 26/58	Loss: 0.703
Batch: 31/58	Loss: 0.695
Batch: 36/58	Loss: 0.772
Batch: 41/58	Loss: 0.675
Batch: 46/58	Loss: 0.603
Batch: 51/58	Loss: 0.688
Batch: 56/58	Loss: 0.667
Batch: 58/58	Loss: 0.552
Epoch: 11	Train Loss: 0.666	Val F1: 0.340
Best Epoch: 9	Best Val F1: 0.341

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.818
Batch: 6/58	Loss: 0.620
Batch: 11/58	Loss: 0.613
Batch: 16/58	Loss: 0.610
Batch: 21/58	Loss: 0.665
Batch: 26/58	Loss: 0.561
Batch: 31/58	Loss: 0.664
Batch: 36/58	Loss: 0.592
Batch: 41/58	Loss: 0.629
Batch: 46/58	Loss: 0.685
Batch: 51/58	Loss: 0.650
Batch: 56/58	Loss: 0.574
Batch: 58/58	Loss: 0.456
Epoch: 12	Train Loss: 0.634	Val F1: 0.342
Best Epoch: 12	Best Val F1: 0.342

****************************** Epoch: 13 ******************************
Batch: 1/58	Loss: 0.600
Batch: 6/58	Loss: 0.588
Batch: 11/58	Loss: 0.666
Batch: 16/58	Loss: 0.555
Batch: 21/58	Loss: 0.566
Batch: 26/58	Loss: 0.659
Batch: 31/58	Loss: 0.592
Batch: 36/58	Loss: 0.611
Batch: 41/58	Loss: 0.580
Batch: 46/58	Loss: 0.618
Batch: 51/58	Loss: 0.576
Batch: 56/58	Loss: 0.684
Batch: 58/58	Loss: 0.546
Epoch: 13	Train Loss: 0.610	Val F1: 0.349
Best Epoch: 13	Best Val F1: 0.349

****************************** Epoch: 14 ******************************
Batch: 1/58	Loss: 0.527
Batch: 6/58	Loss: 0.585
Batch: 11/58	Loss: 0.575
Batch: 16/58	Loss: 0.602
Batch: 21/58	Loss: 0.591
Batch: 26/58	Loss: 0.557
Batch: 31/58	Loss: 0.556
Batch: 36/58	Loss: 0.658
Batch: 41/58	Loss: 0.498
Batch: 46/58	Loss: 0.464
Batch: 51/58	Loss: 0.614
Batch: 56/58	Loss: 0.547
Batch: 58/58	Loss: 0.600
Epoch: 14	Train Loss: 0.585	Val F1: 0.349
Best Epoch: 13	Best Val F1: 0.349

****************************** Epoch: 15 ******************************
Batch: 1/58	Loss: 0.517
Batch: 6/58	Loss: 0.585
Batch: 11/58	Loss: 0.573
Batch: 16/58	Loss: 0.562
Batch: 21/58	Loss: 0.551
Batch: 26/58	Loss: 0.670
Batch: 31/58	Loss: 0.492
Batch: 36/58	Loss: 0.707
Batch: 41/58	Loss: 0.564
Batch: 46/58	Loss: 0.583
Batch: 51/58	Loss: 0.528
Batch: 56/58	Loss: 0.506
Batch: 58/58	Loss: 0.640
Epoch: 15	Train Loss: 0.560	Val F1: 0.346
Best Epoch: 13	Best Val F1: 0.349

****************************** Epoch: 16 ******************************
Batch: 1/58	Loss: 0.587
Batch: 6/58	Loss: 0.412
Batch: 11/58	Loss: 0.471
Batch: 16/58	Loss: 0.493
Batch: 21/58	Loss: 0.469
Batch: 26/58	Loss: 0.527
Batch: 31/58	Loss: 0.586
Batch: 36/58	Loss: 0.470
Batch: 41/58	Loss: 0.639
Batch: 46/58	Loss: 0.534
Batch: 51/58	Loss: 0.623
Batch: 56/58	Loss: 0.453
Batch: 58/58	Loss: 0.443
Epoch: 16	Train Loss: 0.542	Val F1: 0.347
Best Epoch: 13	Best Val F1: 0.349

****************************** Epoch: 17 ******************************
Batch: 1/58	Loss: 0.489
Batch: 6/58	Loss: 0.685
Batch: 11/58	Loss: 0.457
Batch: 16/58	Loss: 0.490
Batch: 21/58	Loss: 0.584
Batch: 26/58	Loss: 0.553
Batch: 31/58	Loss: 0.460
Batch: 36/58	Loss: 0.434
Batch: 41/58	Loss: 0.489
Batch: 46/58	Loss: 0.570
Batch: 51/58	Loss: 0.481
Batch: 56/58	Loss: 0.509
Batch: 58/58	Loss: 0.682
Epoch: 17	Train Loss: 0.515	Val F1: 0.343
Best Epoch: 13	Best Val F1: 0.349

****************************** Epoch: 18 ******************************
Batch: 1/58	Loss: 0.525
Batch: 6/58	Loss: 0.514
Batch: 11/58	Loss: 0.550
Batch: 16/58	Loss: 0.671
Batch: 21/58	Loss: 0.516
Batch: 26/58	Loss: 0.533
Batch: 31/58	Loss: 0.478
Batch: 36/58	Loss: 0.422
Batch: 41/58	Loss: 0.451
Batch: 46/58	Loss: 0.499
Batch: 51/58	Loss: 0.455
Batch: 56/58	Loss: 0.371
Batch: 58/58	Loss: 0.742
Epoch: 18	Train Loss: 0.518	Val F1: 0.345
Best Epoch: 13	Best Val F1: 0.349

Saving the best checkpoint....
Inference...
Test F1: 0.382	Test F1_Few: 0.453	Test F1_Zero: 0.378
Starting training with config: {'batch_size': 32, 'epochs': 75, 'l2_reg': 0.000840614212653972, 'lr': 1.4931721402679064e-05, 'n_layers_freeze': 3, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 1.050
Batch: 11/58	Loss: 0.997
Batch: 16/58	Loss: 0.939
Batch: 21/58	Loss: 0.933
Batch: 26/58	Loss: 0.922
Batch: 31/58	Loss: 0.891
Batch: 36/58	Loss: 0.910
Batch: 41/58	Loss: 0.862
Batch: 46/58	Loss: 0.847
Batch: 51/58	Loss: 0.834
Batch: 56/58	Loss: 0.837
Batch: 58/58	Loss: 0.842
Epoch: 1	Train Loss: 0.926	Val F1: 0.205
Best Epoch: 1	Best Val F1: 0.205

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.848
Batch: 6/58	Loss: 0.854
Batch: 11/58	Loss: 0.856
Batch: 16/58	Loss: 0.801
Batch: 21/58	Loss: 0.797
Batch: 26/58	Loss: 0.802
Batch: 31/58	Loss: 0.836
Batch: 36/58	Loss: 0.833
Batch: 41/58	Loss: 0.789
Batch: 46/58	Loss: 0.784
Batch: 51/58	Loss: 0.786
Batch: 56/58	Loss: 0.786
Batch: 58/58	Loss: 0.762
Epoch: 2	Train Loss: 0.815	Val F1: 0.300
Best Epoch: 2	Best Val F1: 0.300

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.769
Batch: 6/58	Loss: 0.747
Batch: 11/58	Loss: 0.794
Batch: 16/58	Loss: 0.762
Batch: 21/58	Loss: 0.764
Batch: 26/58	Loss: 0.771
Batch: 31/58	Loss: 0.896
Batch: 36/58	Loss: 0.770
Batch: 41/58	Loss: 0.719
Batch: 46/58	Loss: 0.723
Batch: 51/58	Loss: 0.764
Batch: 56/58	Loss: 0.710
Batch: 58/58	Loss: 0.773
Epoch: 3	Train Loss: 0.769	Val F1: 0.306
Best Epoch: 3	Best Val F1: 0.306

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.752
Batch: 6/58	Loss: 0.721
Batch: 11/58	Loss: 0.715
Batch: 16/58	Loss: 0.687
Batch: 21/58	Loss: 0.594
Batch: 26/58	Loss: 0.652
Batch: 31/58	Loss: 0.662
Batch: 36/58	Loss: 0.828
Batch: 41/58	Loss: 0.732
Batch: 46/58	Loss: 0.686
Batch: 51/58	Loss: 0.602
Batch: 56/58	Loss: 0.603
Batch: 58/58	Loss: 0.680
Epoch: 4	Train Loss: 0.711	Val F1: 0.334
Best Epoch: 4	Best Val F1: 0.334

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.641
Batch: 6/58	Loss: 0.610
Batch: 11/58	Loss: 0.623
Batch: 16/58	Loss: 0.619
Batch: 21/58	Loss: 0.542
Batch: 26/58	Loss: 0.579
Batch: 31/58	Loss: 0.751
Batch: 36/58	Loss: 0.737
Batch: 41/58	Loss: 0.672
Batch: 46/58	Loss: 0.761
Batch: 51/58	Loss: 0.897
Batch: 56/58	Loss: 0.741
Batch: 58/58	Loss: 0.826
Epoch: 5	Train Loss: 0.663	Val F1: 0.317
Best Epoch: 4	Best Val F1: 0.334

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.598
Batch: 6/58	Loss: 0.731
Batch: 11/58	Loss: 0.689
Batch: 16/58	Loss: 0.610
Batch: 21/58	Loss: 0.632
Batch: 26/58	Loss: 0.584
Batch: 31/58	Loss: 0.603
Batch: 36/58	Loss: 0.542
Batch: 41/58	Loss: 0.604
Batch: 46/58	Loss: 0.590
Batch: 51/58	Loss: 0.563
Batch: 56/58	Loss: 0.608
Batch: 58/58	Loss: 0.537
Epoch: 6	Train Loss: 0.617	Val F1: 0.328
Best Epoch: 4	Best Val F1: 0.334

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.492
Batch: 6/58	Loss: 0.636
Batch: 11/58	Loss: 0.707
Batch: 16/58	Loss: 0.453
Batch: 21/58	Loss: 0.527
Batch: 26/58	Loss: 0.512
Batch: 31/58	Loss: 0.578
Batch: 36/58	Loss: 0.527
Batch: 41/58	Loss: 0.496
Batch: 46/58	Loss: 0.566
Batch: 51/58	Loss: 0.497
Batch: 56/58	Loss: 0.575
Batch: 58/58	Loss: 0.513
Epoch: 7	Train Loss: 0.561	Val F1: 0.356
Best Epoch: 7	Best Val F1: 0.356

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.522
Batch: 6/58	Loss: 0.529
Batch: 11/58	Loss: 0.460
Batch: 16/58	Loss: 0.466
Batch: 21/58	Loss: 0.553
Batch: 26/58	Loss: 0.401
Batch: 31/58	Loss: 0.471
Batch: 36/58	Loss: 0.423
Batch: 41/58	Loss: 0.595
Batch: 46/58	Loss: 0.561
Batch: 51/58	Loss: 0.467
Batch: 56/58	Loss: 0.478
Batch: 58/58	Loss: 0.519
Epoch: 8	Train Loss: 0.520	Val F1: 0.371
Best Epoch: 8	Best Val F1: 0.371

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.548
Batch: 6/58	Loss: 0.607
Batch: 11/58	Loss: 0.557
Batch: 16/58	Loss: 0.351
Batch: 21/58	Loss: 0.392
Batch: 26/58	Loss: 0.381
Batch: 31/58	Loss: 0.396
Batch: 36/58	Loss: 0.455
Batch: 41/58	Loss: 0.467
Batch: 46/58	Loss: 0.537
Batch: 51/58	Loss: 0.560
Batch: 56/58	Loss: 0.418
Batch: 58/58	Loss: 0.417
Epoch: 9	Train Loss: 0.476	Val F1: 0.363
Best Epoch: 8	Best Val F1: 0.371

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.392
Batch: 6/58	Loss: 0.410
Batch: 11/58	Loss: 0.466
Batch: 16/58	Loss: 0.531
Batch: 21/58	Loss: 0.320
Batch: 26/58	Loss: 0.495
Batch: 31/58	Loss: 0.327
Batch: 36/58	Loss: 0.697
Batch: 41/58	Loss: 0.593
Batch: 46/58	Loss: 0.520
Batch: 51/58	Loss: 0.382
Batch: 56/58	Loss: 0.369
Batch: 58/58	Loss: 0.528
Epoch: 10	Train Loss: 0.451	Val F1: 0.356
Best Epoch: 8	Best Val F1: 0.371

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.402
Batch: 6/58	Loss: 0.363
Batch: 11/58	Loss: 0.409
Batch: 16/58	Loss: 0.510
Batch: 21/58	Loss: 0.380
Batch: 26/58	Loss: 0.503
Batch: 31/58	Loss: 0.403
Batch: 36/58	Loss: 0.435
Batch: 41/58	Loss: 0.338
Batch: 46/58	Loss: 0.385
Batch: 51/58	Loss: 0.466
Batch: 56/58	Loss: 0.403
Batch: 58/58	Loss: 0.423
Epoch: 11	Train Loss: 0.414	Val F1: 0.354
Best Epoch: 8	Best Val F1: 0.371

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.482
Batch: 6/58	Loss: 0.291
Batch: 11/58	Loss: 0.366
Batch: 16/58	Loss: 0.412
Batch: 21/58	Loss: 0.437
Batch: 26/58	Loss: 0.322
Batch: 31/58	Loss: 0.445
Batch: 36/58	Loss: 0.406
Batch: 41/58	Loss: 0.375
Batch: 46/58	Loss: 0.434
Batch: 51/58	Loss: 0.525
Batch: 56/58	Loss: 0.338
Batch: 58/58	Loss: 0.191
Epoch: 12	Train Loss: 0.380	Val F1: 0.336
Best Epoch: 8	Best Val F1: 0.371

****************************** Epoch: 13 ******************************
Batch: 1/58	Loss: 0.417
Batch: 6/58	Loss: 0.328
Batch: 11/58	Loss: 0.438
Batch: 16/58	Loss: 0.290
Batch: 21/58	Loss: 0.353
Batch: 26/58	Loss: 0.349
Batch: 31/58	Loss: 0.327
Batch: 36/58	Loss: 0.304
Batch: 41/58	Loss: 0.321
Batch: 46/58	Loss: 0.326
Batch: 51/58	Loss: 0.309
Batch: 56/58	Loss: 0.449
Batch: 58/58	Loss: 0.299
Epoch: 13	Train Loss: 0.357	Val F1: 0.331
Best Epoch: 8	Best Val F1: 0.371

****************************** Epoch: 14 ******************************
Batch: 1/58	Loss: 0.421
Batch: 6/58	Loss: 0.424
Batch: 11/58	Loss: 0.338
Batch: 16/58	Loss: 0.396
Batch: 21/58	Loss: 0.321
Batch: 26/58	Loss: 0.363
Batch: 31/58	Loss: 0.323
Batch: 36/58	Loss: 0.355
Batch: 41/58	Loss: 0.201
Batch: 46/58	Loss: 0.280
Batch: 51/58	Loss: 0.395
Batch: 56/58	Loss: 0.244
Batch: 58/58	Loss: 0.365
Epoch: 14	Train Loss: 0.339	Val F1: 0.350
Best Epoch: 8	Best Val F1: 0.371

****************************** Epoch: 15 ******************************
Batch: 1/58	Loss: 0.247
Batch: 6/58	Loss: 0.362
Batch: 11/58	Loss: 0.245
Batch: 16/58	Loss: 0.288
Batch: 21/58	Loss: 0.434
Batch: 26/58	Loss: 0.293
Batch: 31/58	Loss: 0.272
Batch: 36/58	Loss: 0.359
Batch: 41/58	Loss: 0.403
Batch: 46/58	Loss: 0.249
Batch: 51/58	Loss: 0.274
Batch: 56/58	Loss: 0.255
Batch: 58/58	Loss: 0.454
Epoch: 15	Train Loss: 0.319	Val F1: 0.358
Best Epoch: 8	Best Val F1: 0.371

****************************** Epoch: 16 ******************************
Batch: 1/58	Loss: 0.319
Batch: 6/58	Loss: 0.226
Batch: 11/58	Loss: 0.262
Batch: 16/58	Loss: 0.295
Batch: 21/58	Loss: 0.250
Batch: 26/58	Loss: 0.276
Batch: 31/58	Loss: 0.308
Batch: 36/58	Loss: 0.223
Batch: 41/58	Loss: 0.215
Batch: 46/58	Loss: 0.267
Batch: 51/58	Loss: 0.301
Batch: 56/58	Loss: 0.248
Batch: 58/58	Loss: 0.256
Epoch: 16	Train Loss: 0.308	Val F1: 0.358
Best Epoch: 8	Best Val F1: 0.371

****************************** Epoch: 17 ******************************
Batch: 1/58	Loss: 0.230
Batch: 6/58	Loss: 0.326
Batch: 11/58	Loss: 0.228
Batch: 16/58	Loss: 0.263
Batch: 21/58	Loss: 0.244
Batch: 26/58	Loss: 0.303
Batch: 31/58	Loss: 0.229
Batch: 36/58	Loss: 0.257
Batch: 41/58	Loss: 0.295
Batch: 46/58	Loss: 0.416
Batch: 51/58	Loss: 0.205
Batch: 56/58	Loss: 0.214
Batch: 58/58	Loss: 0.297
Epoch: 17	Train Loss: 0.276	Val F1: 0.343
Best Epoch: 8	Best Val F1: 0.371

****************************** Epoch: 18 ******************************
Batch: 1/58	Loss: 0.299
Batch: 6/58	Loss: 0.328
Batch: 11/58	Loss: 0.253
Batch: 16/58	Loss: 0.297
Batch: 21/58	Loss: 0.259
Batch: 26/58	Loss: 0.307
Batch: 31/58	Loss: 0.167
Batch: 36/58	Loss: 0.243
Batch: 41/58	Loss: 0.189
Batch: 46/58	Loss: 0.320
Batch: 51/58	Loss: 0.188
Batch: 56/58	Loss: 0.218
Batch: 58/58	Loss: 0.400
Epoch: 18	Train Loss: 0.256	Val F1: 0.351
Best Epoch: 8	Best Val F1: 0.371

****************************** Epoch: 19 ******************************
Batch: 1/58	Loss: 0.199
Batch: 6/58	Loss: 0.236
Batch: 11/58	Loss: 0.244
Batch: 16/58	Loss: 0.123
Batch: 21/58	Loss: 0.302
Batch: 26/58	Loss: 0.283
Batch: 31/58	Loss: 0.165
Batch: 36/58	Loss: 0.196
Batch: 41/58	Loss: 0.156
Batch: 46/58	Loss: 0.368
Batch: 51/58	Loss: 0.241
Batch: 56/58	Loss: 0.284
Batch: 58/58	Loss: 0.132
Epoch: 19	Train Loss: 0.244	Val F1: 0.330
Best Epoch: 8	Best Val F1: 0.371

****************************** Epoch: 20 ******************************
Batch: 1/58	Loss: 0.228
Batch: 6/58	Loss: 0.234
Batch: 11/58	Loss: 0.166
Batch: 16/58	Loss: 0.258
Batch: 21/58	Loss: 0.187
Batch: 26/58	Loss: 0.242
Batch: 31/58	Loss: 0.278
Batch: 36/58	Loss: 0.162
Batch: 41/58	Loss: 0.145
Batch: 46/58	Loss: 0.264
Batch: 51/58	Loss: 0.192
Batch: 56/58	Loss: 0.191
Batch: 58/58	Loss: 0.281
Epoch: 20	Train Loss: 0.225	Val F1: 0.349
Best Epoch: 8	Best Val F1: 0.371

****************************** Epoch: 21 ******************************
Batch: 1/58	Loss: 0.252
Batch: 6/58	Loss: 0.151
Batch: 11/58	Loss: 0.196
Batch: 16/58	Loss: 0.220
Batch: 21/58	Loss: 0.107
Batch: 26/58	Loss: 0.209
Batch: 31/58	Loss: 0.099
Batch: 36/58	Loss: 0.247
Batch: 41/58	Loss: 0.235
Batch: 46/58	Loss: 0.169
Batch: 51/58	Loss: 0.118
Batch: 56/58	Loss: 0.137
Batch: 58/58	Loss: 0.208
Epoch: 21	Train Loss: 0.199	Val F1: 0.346
Best Epoch: 8	Best Val F1: 0.371

****************************** Epoch: 22 ******************************
Batch: 1/58	Loss: 0.258
Batch: 6/58	Loss: 0.153
Batch: 11/58	Loss: 0.150
Batch: 16/58	Loss: 0.102
Batch: 21/58	Loss: 0.164
Batch: 26/58	Loss: 0.147
Batch: 31/58	Loss: 0.144
Batch: 36/58	Loss: 0.162
Batch: 41/58	Loss: 0.214
Batch: 46/58	Loss: 0.179
Batch: 51/58	Loss: 0.131
Batch: 56/58	Loss: 0.190
Batch: 58/58	Loss: 0.315
Epoch: 22	Train Loss: 0.177	Val F1: 0.324
Best Epoch: 8	Best Val F1: 0.371

****************************** Epoch: 23 ******************************
Batch: 1/58	Loss: 0.239
Batch: 6/58	Loss: 0.159
Batch: 11/58	Loss: 0.221
Batch: 16/58	Loss: 0.233
Batch: 21/58	Loss: 0.116
Batch: 26/58	Loss: 0.168
Batch: 31/58	Loss: 0.131
Batch: 36/58	Loss: 0.213
Batch: 41/58	Loss: 0.115
Batch: 46/58	Loss: 0.163
Batch: 51/58	Loss: 0.070
Batch: 56/58	Loss: 0.115
Batch: 58/58	Loss: 0.105
Epoch: 23	Train Loss: 0.164	Val F1: 0.347
Best Epoch: 8	Best Val F1: 0.371

Saving the best checkpoint....
Inference...
Test F1: 0.372	Test F1_Few: 0.436	Test F1_Zero: 0.377
Starting training with config: {'batch_size': 16, 'epochs': 75, 'l2_reg': 0.000878767731481421, 'lr': 2.872542547827185e-05, 'n_layers_freeze': 1, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 0.950
Batch: 23/116	Loss: 0.886
Batch: 34/116	Loss: 0.866
Batch: 45/116	Loss: 0.823
Batch: 56/116	Loss: 0.825
Batch: 67/116	Loss: 0.764
Batch: 78/116	Loss: 0.771
Batch: 89/116	Loss: 0.877
Batch: 100/116	Loss: 0.740
Batch: 111/116	Loss: 0.787
Batch: 116/116	Loss: 0.730
Epoch: 1	Train Loss: 0.837	Val F1: 0.246
Best Epoch: 1	Best Val F1: 0.246

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.831
Batch: 12/116	Loss: 0.770
Batch: 23/116	Loss: 0.718
Batch: 34/116	Loss: 0.728
Batch: 45/116	Loss: 0.775
Batch: 56/116	Loss: 0.757
Batch: 67/116	Loss: 0.760
Batch: 78/116	Loss: 0.750
Batch: 89/116	Loss: 0.691
Batch: 100/116	Loss: 0.699
Batch: 111/116	Loss: 0.713
Batch: 116/116	Loss: 0.651
Epoch: 2	Train Loss: 0.748	Val F1: 0.318
Best Epoch: 2	Best Val F1: 0.318

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.660
Batch: 12/116	Loss: 0.570
Batch: 23/116	Loss: 0.666
Batch: 34/116	Loss: 0.745
Batch: 45/116	Loss: 0.734
Batch: 56/116	Loss: 0.729
Batch: 67/116	Loss: 0.597
Batch: 78/116	Loss: 0.677
Batch: 89/116	Loss: 0.736
Batch: 100/116	Loss: 0.906
Batch: 111/116	Loss: 0.911
Batch: 116/116	Loss: 0.622
Epoch: 3	Train Loss: 0.692	Val F1: 0.316
Best Epoch: 2	Best Val F1: 0.318

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.666
Batch: 12/116	Loss: 0.523
Batch: 23/116	Loss: 0.916
Batch: 34/116	Loss: 0.577
Batch: 45/116	Loss: 0.705
Batch: 56/116	Loss: 0.596
Batch: 67/116	Loss: 0.694
Batch: 78/116	Loss: 0.622
Batch: 89/116	Loss: 0.682
Batch: 100/116	Loss: 0.593
Batch: 111/116	Loss: 0.568
Batch: 116/116	Loss: 0.723
Epoch: 4	Train Loss: 0.647	Val F1: 0.299
Best Epoch: 2	Best Val F1: 0.318

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.465
Batch: 12/116	Loss: 0.622
Batch: 23/116	Loss: 0.678
Batch: 34/116	Loss: 0.546
Batch: 45/116	Loss: 0.632
Batch: 56/116	Loss: 0.535
Batch: 67/116	Loss: 0.602
Batch: 78/116	Loss: 0.629
Batch: 89/116	Loss: 0.654
Batch: 100/116	Loss: 0.608
Batch: 111/116	Loss: 0.588
Batch: 116/116	Loss: 0.545
Epoch: 5	Train Loss: 0.587	Val F1: 0.341
Best Epoch: 5	Best Val F1: 0.341

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.482
Batch: 12/116	Loss: 0.753
Batch: 23/116	Loss: 0.590
Batch: 34/116	Loss: 0.633
Batch: 45/116	Loss: 0.414
Batch: 56/116	Loss: 0.474
Batch: 67/116	Loss: 0.438
Batch: 78/116	Loss: 0.657
Batch: 89/116	Loss: 0.803
Batch: 100/116	Loss: 0.555
Batch: 111/116	Loss: 0.536
Batch: 116/116	Loss: 0.188
Epoch: 6	Train Loss: 0.509	Val F1: 0.358
Best Epoch: 6	Best Val F1: 0.358

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.367
Batch: 12/116	Loss: 0.729
Batch: 23/116	Loss: 0.452
Batch: 34/116	Loss: 0.625
Batch: 45/116	Loss: 0.242
Batch: 56/116	Loss: 0.792
Batch: 67/116	Loss: 0.465
Batch: 78/116	Loss: 0.462
Batch: 89/116	Loss: 0.382
Batch: 100/116	Loss: 0.320
Batch: 111/116	Loss: 0.704
Batch: 116/116	Loss: 0.150
Epoch: 7	Train Loss: 0.448	Val F1: 0.354
Best Epoch: 6	Best Val F1: 0.358

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.393
Batch: 12/116	Loss: 0.353
Batch: 23/116	Loss: 0.183
Batch: 34/116	Loss: 0.298
Batch: 45/116	Loss: 0.312
Batch: 56/116	Loss: 0.242
Batch: 67/116	Loss: 0.633
Batch: 78/116	Loss: 0.317
Batch: 89/116	Loss: 0.258
Batch: 100/116	Loss: 0.508
Batch: 111/116	Loss: 0.272
Batch: 116/116	Loss: 0.361
Epoch: 8	Train Loss: 0.377	Val F1: 0.347
Best Epoch: 6	Best Val F1: 0.358

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.292
Batch: 12/116	Loss: 0.302
Batch: 23/116	Loss: 0.354
Batch: 34/116	Loss: 0.278
Batch: 45/116	Loss: 0.501
Batch: 56/116	Loss: 0.452
Batch: 67/116	Loss: 0.334
Batch: 78/116	Loss: 0.396
Batch: 89/116	Loss: 0.209
Batch: 100/116	Loss: 0.386
Batch: 111/116	Loss: 0.262
Batch: 116/116	Loss: 0.435
Epoch: 9	Train Loss: 0.337	Val F1: 0.342
Best Epoch: 6	Best Val F1: 0.358

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.313
Batch: 12/116	Loss: 0.230
Batch: 23/116	Loss: 0.262
Batch: 34/116	Loss: 0.414
Batch: 45/116	Loss: 0.176
Batch: 56/116	Loss: 0.321
Batch: 67/116	Loss: 0.405
Batch: 78/116	Loss: 0.214
Batch: 89/116	Loss: 0.189
Batch: 100/116	Loss: 0.361
Batch: 111/116	Loss: 0.152
Batch: 116/116	Loss: 0.217
Epoch: 10	Train Loss: 0.299	Val F1: 0.360
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.311
Batch: 12/116	Loss: 0.210
Batch: 23/116	Loss: 0.145
Batch: 34/116	Loss: 0.196
Batch: 45/116	Loss: 0.307
Batch: 56/116	Loss: 0.260
Batch: 67/116	Loss: 0.338
Batch: 78/116	Loss: 0.269
Batch: 89/116	Loss: 0.144
Batch: 100/116	Loss: 0.236
Batch: 111/116	Loss: 0.354
Batch: 116/116	Loss: 0.066
Epoch: 11	Train Loss: 0.252	Val F1: 0.351
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 12 ******************************
Batch: 1/116	Loss: 0.235
Batch: 12/116	Loss: 0.228
Batch: 23/116	Loss: 0.159
Batch: 34/116	Loss: 0.355
Batch: 45/116	Loss: 0.120
Batch: 56/116	Loss: 0.250
Batch: 67/116	Loss: 0.120
Batch: 78/116	Loss: 0.242
Batch: 89/116	Loss: 0.204
Batch: 100/116	Loss: 0.222
Batch: 111/116	Loss: 0.122
Batch: 116/116	Loss: 0.034
Epoch: 12	Train Loss: 0.212	Val F1: 0.333
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 13 ******************************
Batch: 1/116	Loss: 0.186
Batch: 12/116	Loss: 0.063
Batch: 23/116	Loss: 0.185
Batch: 34/116	Loss: 0.087
Batch: 45/116	Loss: 0.244
Batch: 56/116	Loss: 0.151
Batch: 67/116	Loss: 0.087
Batch: 78/116	Loss: 0.167
Batch: 89/116	Loss: 0.203
Batch: 100/116	Loss: 0.145
Batch: 111/116	Loss: 0.160
Batch: 116/116	Loss: 0.043
Epoch: 13	Train Loss: 0.158	Val F1: 0.360
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 14 ******************************
Batch: 1/116	Loss: 0.244
Batch: 12/116	Loss: 0.172
Batch: 23/116	Loss: 0.143
Batch: 34/116	Loss: 0.108
Batch: 45/116	Loss: 0.200
Batch: 56/116	Loss: 0.146
Batch: 67/116	Loss: 0.280
Batch: 78/116	Loss: 0.165
Batch: 89/116	Loss: 0.090
Batch: 100/116	Loss: 0.072
Batch: 111/116	Loss: 0.191
Batch: 116/116	Loss: 0.127
Epoch: 14	Train Loss: 0.138	Val F1: 0.354
Best Epoch: 10	Best Val F1: 0.360

****************************** Epoch: 15 ******************************
Batch: 1/116	Loss: 0.036
Batch: 12/116	Loss: 0.228
Batch: 23/116	Loss: 0.047
Batch: 34/116	Loss: 0.080
Batch: 45/116	Loss: 0.105
Batch: 56/116	Loss: 0.087
Batch: 67/116	Loss: 0.168
Batch: 78/116	Loss: 0.058
Batch: 89/116	Loss: 0.078
Batch: 100/116	Loss: 0.067
Batch: 111/116	Loss: 0.068
Batch: 116/116	Loss: 0.010
Epoch: 15	Train Loss: 0.096	Val F1: 0.348
Best Epoch: 10	Best Val F1: 0.360

Saving the best checkpoint....
Inference...
Test F1: 0.381	Test F1_Few: 0.388	Test F1_Zero: 0.372
Starting training with config: {'batch_size': 32, 'epochs': 75, 'l2_reg': 0.0006380290434070241, 'lr': 1.7077240019326946e-05, 'n_layers_freeze': 5, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 1.047
Batch: 11/58	Loss: 0.991
Batch: 16/58	Loss: 0.930
Batch: 21/58	Loss: 0.926
Batch: 26/58	Loss: 0.914
Batch: 31/58	Loss: 0.882
Batch: 36/58	Loss: 0.903
Batch: 41/58	Loss: 0.852
Batch: 46/58	Loss: 0.837
Batch: 51/58	Loss: 0.823
Batch: 56/58	Loss: 0.827
Batch: 58/58	Loss: 0.833
Epoch: 1	Train Loss: 0.918	Val F1: 0.220
Best Epoch: 1	Best Val F1: 0.220

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.840
Batch: 6/58	Loss: 0.846
Batch: 11/58	Loss: 0.849
Batch: 16/58	Loss: 0.789
Batch: 21/58	Loss: 0.786
Batch: 26/58	Loss: 0.793
Batch: 31/58	Loss: 0.829
Batch: 36/58	Loss: 0.825
Batch: 41/58	Loss: 0.779
Batch: 46/58	Loss: 0.773
Batch: 51/58	Loss: 0.777
Batch: 56/58	Loss: 0.774
Batch: 58/58	Loss: 0.751
Epoch: 2	Train Loss: 0.806	Val F1: 0.307
Best Epoch: 2	Best Val F1: 0.307

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.752
Batch: 6/58	Loss: 0.730
Batch: 11/58	Loss: 0.785
Batch: 16/58	Loss: 0.742
Batch: 21/58	Loss: 0.759
Batch: 26/58	Loss: 0.769
Batch: 31/58	Loss: 0.897
Batch: 36/58	Loss: 0.767
Batch: 41/58	Loss: 0.698
Batch: 46/58	Loss: 0.727
Batch: 51/58	Loss: 0.745
Batch: 56/58	Loss: 0.686
Batch: 58/58	Loss: 0.752
Epoch: 3	Train Loss: 0.757	Val F1: 0.314
Best Epoch: 3	Best Val F1: 0.314

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.733
Batch: 6/58	Loss: 0.709
Batch: 11/58	Loss: 0.690
Batch: 16/58	Loss: 0.673
Batch: 21/58	Loss: 0.588
Batch: 26/58	Loss: 0.653
Batch: 31/58	Loss: 0.631
Batch: 36/58	Loss: 0.815
Batch: 41/58	Loss: 0.745
Batch: 46/58	Loss: 0.680
Batch: 51/58	Loss: 0.616
Batch: 56/58	Loss: 0.595
Batch: 58/58	Loss: 0.686
Epoch: 4	Train Loss: 0.699	Val F1: 0.316
Best Epoch: 4	Best Val F1: 0.316

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.604
Batch: 6/58	Loss: 0.612
Batch: 11/58	Loss: 0.607
Batch: 16/58	Loss: 0.640
Batch: 21/58	Loss: 0.554
Batch: 26/58	Loss: 0.708
Batch: 31/58	Loss: 0.759
Batch: 36/58	Loss: 0.700
Batch: 41/58	Loss: 0.607
Batch: 46/58	Loss: 0.625
Batch: 51/58	Loss: 0.759
Batch: 56/58	Loss: 0.742
Batch: 58/58	Loss: 0.837
Epoch: 5	Train Loss: 0.663	Val F1: 0.326
Best Epoch: 5	Best Val F1: 0.326

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.656
Batch: 6/58	Loss: 0.722
Batch: 11/58	Loss: 0.724
Batch: 16/58	Loss: 0.600
Batch: 21/58	Loss: 0.620
Batch: 26/58	Loss: 0.504
Batch: 31/58	Loss: 0.629
Batch: 36/58	Loss: 0.502
Batch: 41/58	Loss: 0.640
Batch: 46/58	Loss: 0.602
Batch: 51/58	Loss: 0.611
Batch: 56/58	Loss: 0.604
Batch: 58/58	Loss: 0.533
Epoch: 6	Train Loss: 0.613	Val F1: 0.333
Best Epoch: 6	Best Val F1: 0.333

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.480
Batch: 6/58	Loss: 0.632
Batch: 11/58	Loss: 0.713
Batch: 16/58	Loss: 0.443
Batch: 21/58	Loss: 0.530
Batch: 26/58	Loss: 0.588
Batch: 31/58	Loss: 0.603
Batch: 36/58	Loss: 0.546
Batch: 41/58	Loss: 0.533
Batch: 46/58	Loss: 0.508
Batch: 51/58	Loss: 0.516
Batch: 56/58	Loss: 0.604
Batch: 58/58	Loss: 0.432
Epoch: 7	Train Loss: 0.575	Val F1: 0.334
Best Epoch: 7	Best Val F1: 0.334

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.558
Batch: 6/58	Loss: 0.481
Batch: 11/58	Loss: 0.447
Batch: 16/58	Loss: 0.504
Batch: 21/58	Loss: 0.560
Batch: 26/58	Loss: 0.430
Batch: 31/58	Loss: 0.469
Batch: 36/58	Loss: 0.390
Batch: 41/58	Loss: 0.573
Batch: 46/58	Loss: 0.512
Batch: 51/58	Loss: 0.546
Batch: 56/58	Loss: 0.450
Batch: 58/58	Loss: 0.485
Epoch: 8	Train Loss: 0.527	Val F1: 0.320
Best Epoch: 7	Best Val F1: 0.334

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.516
Batch: 6/58	Loss: 0.551
Batch: 11/58	Loss: 0.600
Batch: 16/58	Loss: 0.453
Batch: 21/58	Loss: 0.399
Batch: 26/58	Loss: 0.402
Batch: 31/58	Loss: 0.416
Batch: 36/58	Loss: 0.480
Batch: 41/58	Loss: 0.566
Batch: 46/58	Loss: 0.542
Batch: 51/58	Loss: 0.583
Batch: 56/58	Loss: 0.404
Batch: 58/58	Loss: 0.388
Epoch: 9	Train Loss: 0.489	Val F1: 0.341
Best Epoch: 9	Best Val F1: 0.341

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.414
Batch: 6/58	Loss: 0.411
Batch: 11/58	Loss: 0.466
Batch: 16/58	Loss: 0.494
Batch: 21/58	Loss: 0.328
Batch: 26/58	Loss: 0.513
Batch: 31/58	Loss: 0.357
Batch: 36/58	Loss: 0.684
Batch: 41/58	Loss: 0.586
Batch: 46/58	Loss: 0.559
Batch: 51/58	Loss: 0.400
Batch: 56/58	Loss: 0.403
Batch: 58/58	Loss: 0.645
Epoch: 10	Train Loss: 0.456	Val F1: 0.333
Best Epoch: 9	Best Val F1: 0.341

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.402
Batch: 6/58	Loss: 0.385
Batch: 11/58	Loss: 0.403
Batch: 16/58	Loss: 0.407
Batch: 21/58	Loss: 0.438
Batch: 26/58	Loss: 0.465
Batch: 31/58	Loss: 0.468
Batch: 36/58	Loss: 0.474
Batch: 41/58	Loss: 0.462
Batch: 46/58	Loss: 0.401
Batch: 51/58	Loss: 0.483
Batch: 56/58	Loss: 0.450
Batch: 58/58	Loss: 0.399
Epoch: 11	Train Loss: 0.429	Val F1: 0.334
Best Epoch: 9	Best Val F1: 0.341

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.543
Batch: 6/58	Loss: 0.296
Batch: 11/58	Loss: 0.356
Batch: 16/58	Loss: 0.374
Batch: 21/58	Loss: 0.493
Batch: 26/58	Loss: 0.326
Batch: 31/58	Loss: 0.555
Batch: 36/58	Loss: 0.404
Batch: 41/58	Loss: 0.400
Batch: 46/58	Loss: 0.446
Batch: 51/58	Loss: 0.521
Batch: 56/58	Loss: 0.338
Batch: 58/58	Loss: 0.223
Epoch: 12	Train Loss: 0.407	Val F1: 0.333
Best Epoch: 9	Best Val F1: 0.341

****************************** Epoch: 13 ******************************
Batch: 1/58	Loss: 0.479
Batch: 6/58	Loss: 0.303
Batch: 11/58	Loss: 0.410
Batch: 16/58	Loss: 0.279
Batch: 21/58	Loss: 0.390
Batch: 26/58	Loss: 0.366
Batch: 31/58	Loss: 0.331
Batch: 36/58	Loss: 0.330
Batch: 41/58	Loss: 0.349
Batch: 46/58	Loss: 0.423
Batch: 51/58	Loss: 0.356
Batch: 56/58	Loss: 0.441
Batch: 58/58	Loss: 0.300
Epoch: 13	Train Loss: 0.380	Val F1: 0.332
Best Epoch: 9	Best Val F1: 0.341

****************************** Epoch: 14 ******************************
Batch: 1/58	Loss: 0.419
Batch: 6/58	Loss: 0.421
Batch: 11/58	Loss: 0.347
Batch: 16/58	Loss: 0.401
Batch: 21/58	Loss: 0.337
Batch: 26/58	Loss: 0.359
Batch: 31/58	Loss: 0.322
Batch: 36/58	Loss: 0.313
Batch: 41/58	Loss: 0.227
Batch: 46/58	Loss: 0.286
Batch: 51/58	Loss: 0.434
Batch: 56/58	Loss: 0.321
Batch: 58/58	Loss: 0.378
Epoch: 14	Train Loss: 0.355	Val F1: 0.332
Best Epoch: 9	Best Val F1: 0.341

Saving the best checkpoint....
Inference...
Test F1: 0.370	Test F1_Few: 0.434	Test F1_Zero: 0.376
Starting training with config: {'batch_size': 16, 'epochs': 75, 'l2_reg': 0.0008912262545120592, 'lr': 7.415926296473864e-06, 'n_layers_freeze': 1, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 1.045
Batch: 23/116	Loss: 0.986
Batch: 34/116	Loss: 0.960
Batch: 45/116	Loss: 0.922
Batch: 56/116	Loss: 0.906
Batch: 67/116	Loss: 0.870
Batch: 78/116	Loss: 0.870
Batch: 89/116	Loss: 0.914
Batch: 100/116	Loss: 0.840
Batch: 111/116	Loss: 0.856
Batch: 116/116	Loss: 0.832
Epoch: 1	Train Loss: 0.926	Val F1: 0.188
Best Epoch: 1	Best Val F1: 0.188

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.878
Batch: 12/116	Loss: 0.842
Batch: 23/116	Loss: 0.820
Batch: 34/116	Loss: 0.807
Batch: 45/116	Loss: 0.859
Batch: 56/116	Loss: 0.823
Batch: 67/116	Loss: 0.829
Batch: 78/116	Loss: 0.800
Batch: 89/116	Loss: 0.808
Batch: 100/116	Loss: 0.813
Batch: 111/116	Loss: 0.809
Batch: 116/116	Loss: 0.785
Epoch: 2	Train Loss: 0.823	Val F1: 0.260
Best Epoch: 2	Best Val F1: 0.260

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.768
Batch: 12/116	Loss: 0.765
Batch: 23/116	Loss: 0.759
Batch: 34/116	Loss: 0.798
Batch: 45/116	Loss: 0.846
Batch: 56/116	Loss: 0.796
Batch: 67/116	Loss: 0.797
Batch: 78/116	Loss: 0.771
Batch: 89/116	Loss: 0.748
Batch: 100/116	Loss: 0.904
Batch: 111/116	Loss: 0.849
Batch: 116/116	Loss: 0.731
Epoch: 3	Train Loss: 0.788	Val F1: 0.255
Best Epoch: 2	Best Val F1: 0.260

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.765
Batch: 12/116	Loss: 0.719
Batch: 23/116	Loss: 0.855
Batch: 34/116	Loss: 0.755
Batch: 45/116	Loss: 0.804
Batch: 56/116	Loss: 0.765
Batch: 67/116	Loss: 0.754
Batch: 78/116	Loss: 0.704
Batch: 89/116	Loss: 0.753
Batch: 100/116	Loss: 0.779
Batch: 111/116	Loss: 0.705
Batch: 116/116	Loss: 0.905
Epoch: 4	Train Loss: 0.748	Val F1: 0.326
Best Epoch: 4	Best Val F1: 0.326

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.666
Batch: 12/116	Loss: 0.691
Batch: 23/116	Loss: 0.778
Batch: 34/116	Loss: 0.682
Batch: 45/116	Loss: 0.807
Batch: 56/116	Loss: 0.780
Batch: 67/116	Loss: 0.655
Batch: 78/116	Loss: 0.704
Batch: 89/116	Loss: 0.800
Batch: 100/116	Loss: 0.747
Batch: 111/116	Loss: 0.663
Batch: 116/116	Loss: 0.568
Epoch: 5	Train Loss: 0.708	Val F1: 0.327
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.648
Batch: 12/116	Loss: 0.882
Batch: 23/116	Loss: 0.825
Batch: 34/116	Loss: 0.635
Batch: 45/116	Loss: 0.664
Batch: 56/116	Loss: 0.642
Batch: 67/116	Loss: 0.633
Batch: 78/116	Loss: 0.749
Batch: 89/116	Loss: 0.808
Batch: 100/116	Loss: 0.787
Batch: 111/116	Loss: 0.721
Batch: 116/116	Loss: 0.489
Epoch: 6	Train Loss: 0.674	Val F1: 0.337
Best Epoch: 6	Best Val F1: 0.337

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.567
Batch: 12/116	Loss: 0.725
Batch: 23/116	Loss: 0.822
Batch: 34/116	Loss: 0.855
Batch: 45/116	Loss: 0.643
Batch: 56/116	Loss: 0.891
Batch: 67/116	Loss: 0.709
Batch: 78/116	Loss: 0.663
Batch: 89/116	Loss: 0.518
Batch: 100/116	Loss: 0.577
Batch: 111/116	Loss: 0.963
Batch: 116/116	Loss: 0.594
Epoch: 7	Train Loss: 0.647	Val F1: 0.358
Best Epoch: 7	Best Val F1: 0.358

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.644
Batch: 12/116	Loss: 0.682
Batch: 23/116	Loss: 0.484
Batch: 34/116	Loss: 0.590
Batch: 45/116	Loss: 0.630
Batch: 56/116	Loss: 0.489
Batch: 67/116	Loss: 0.837
Batch: 78/116	Loss: 0.449
Batch: 89/116	Loss: 0.461
Batch: 100/116	Loss: 0.640
Batch: 111/116	Loss: 0.499
Batch: 116/116	Loss: 0.543
Epoch: 8	Train Loss: 0.616	Val F1: 0.339
Best Epoch: 7	Best Val F1: 0.358

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.542
Batch: 12/116	Loss: 0.607
Batch: 23/116	Loss: 0.476
Batch: 34/116	Loss: 0.677
Batch: 45/116	Loss: 0.488
Batch: 56/116	Loss: 0.553
Batch: 67/116	Loss: 0.478
Batch: 78/116	Loss: 0.613
Batch: 89/116	Loss: 0.505
Batch: 100/116	Loss: 0.482
Batch: 111/116	Loss: 0.440
Batch: 116/116	Loss: 0.779
Epoch: 9	Train Loss: 0.573	Val F1: 0.332
Best Epoch: 7	Best Val F1: 0.358

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.516
Batch: 12/116	Loss: 0.540
Batch: 23/116	Loss: 0.427
Batch: 34/116	Loss: 0.655
Batch: 45/116	Loss: 0.357
Batch: 56/116	Loss: 0.551
Batch: 67/116	Loss: 0.700
Batch: 78/116	Loss: 0.418
Batch: 89/116	Loss: 0.369
Batch: 100/116	Loss: 0.509
Batch: 111/116	Loss: 0.371
Batch: 116/116	Loss: 0.524
Epoch: 10	Train Loss: 0.531	Val F1: 0.347
Best Epoch: 7	Best Val F1: 0.358

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.477
Batch: 12/116	Loss: 0.488
Batch: 23/116	Loss: 0.376
Batch: 34/116	Loss: 0.464
Batch: 45/116	Loss: 0.495
Batch: 56/116	Loss: 0.536
Batch: 67/116	Loss: 0.672
Batch: 78/116	Loss: 0.397
Batch: 89/116	Loss: 0.398
Batch: 100/116	Loss: 0.508
Batch: 111/116	Loss: 0.521
Batch: 116/116	Loss: 0.254
Epoch: 11	Train Loss: 0.489	Val F1: 0.322
Best Epoch: 7	Best Val F1: 0.358

****************************** Epoch: 12 ******************************
Batch: 1/116	Loss: 0.662
Batch: 12/116	Loss: 0.486
Batch: 23/116	Loss: 0.347
Batch: 34/116	Loss: 0.666
Batch: 45/116	Loss: 0.267
Batch: 56/116	Loss: 0.504
Batch: 67/116	Loss: 0.383
Batch: 78/116	Loss: 0.454
Batch: 89/116	Loss: 0.443
Batch: 100/116	Loss: 0.678
Batch: 111/116	Loss: 0.409
Batch: 116/116	Loss: 0.269
Epoch: 12	Train Loss: 0.452	Val F1: 0.343
Best Epoch: 7	Best Val F1: 0.358

Saving the best checkpoint....
Inference...
Test F1: 0.354	Test F1_Few: 0.427	Test F1_Zero: 0.345
Starting training with config: {'batch_size': 16, 'epochs': 75, 'l2_reg': 0.0007700793999604591, 'lr': 1.5702713937972732e-05, 'n_layers_freeze': 3, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 0.998
Batch: 23/116	Loss: 0.932
Batch: 34/116	Loss: 0.911
Batch: 45/116	Loss: 0.868
Batch: 56/116	Loss: 0.859
Batch: 67/116	Loss: 0.811
Batch: 78/116	Loss: 0.815
Batch: 89/116	Loss: 0.887
Batch: 100/116	Loss: 0.780
Batch: 111/116	Loss: 0.809
Batch: 116/116	Loss: 0.767
Epoch: 1	Train Loss: 0.876	Val F1: 0.179
Best Epoch: 1	Best Val F1: 0.179

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.845
Batch: 12/116	Loss: 0.795
Batch: 23/116	Loss: 0.764
Batch: 34/116	Loss: 0.758
Batch: 45/116	Loss: 0.820
Batch: 56/116	Loss: 0.764
Batch: 67/116	Loss: 0.763
Batch: 78/116	Loss: 0.776
Batch: 89/116	Loss: 0.751
Batch: 100/116	Loss: 0.727
Batch: 111/116	Loss: 0.741
Batch: 116/116	Loss: 0.723
Epoch: 2	Train Loss: 0.771	Val F1: 0.346
Best Epoch: 2	Best Val F1: 0.346

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.667
Batch: 12/116	Loss: 0.633
Batch: 23/116	Loss: 0.663
Batch: 34/116	Loss: 0.775
Batch: 45/116	Loss: 0.768
Batch: 56/116	Loss: 0.749
Batch: 67/116	Loss: 0.735
Batch: 78/116	Loss: 0.700
Batch: 89/116	Loss: 0.682
Batch: 100/116	Loss: 0.837
Batch: 111/116	Loss: 0.787
Batch: 116/116	Loss: 0.737
Epoch: 3	Train Loss: 0.723	Val F1: 0.286
Best Epoch: 2	Best Val F1: 0.346

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.770
Batch: 12/116	Loss: 0.642
Batch: 23/116	Loss: 0.840
Batch: 34/116	Loss: 0.623
Batch: 45/116	Loss: 0.763
Batch: 56/116	Loss: 0.615
Batch: 67/116	Loss: 0.770
Batch: 78/116	Loss: 0.596
Batch: 89/116	Loss: 0.728
Batch: 100/116	Loss: 0.651
Batch: 111/116	Loss: 0.665
Batch: 116/116	Loss: 0.827
Epoch: 4	Train Loss: 0.669	Val F1: 0.339
Best Epoch: 2	Best Val F1: 0.346

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.428
Batch: 12/116	Loss: 0.657
Batch: 23/116	Loss: 0.693
Batch: 34/116	Loss: 0.599
Batch: 45/116	Loss: 0.669
Batch: 56/116	Loss: 0.649
Batch: 67/116	Loss: 0.593
Batch: 78/116	Loss: 0.641
Batch: 89/116	Loss: 0.912
Batch: 100/116	Loss: 0.723
Batch: 111/116	Loss: 0.631
Batch: 116/116	Loss: 0.509
Epoch: 5	Train Loss: 0.641	Val F1: 0.315
Best Epoch: 2	Best Val F1: 0.346

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.538
Batch: 12/116	Loss: 0.976
Batch: 23/116	Loss: 0.741
Batch: 34/116	Loss: 0.559
Batch: 45/116	Loss: 0.609
Batch: 56/116	Loss: 0.505
Batch: 67/116	Loss: 0.545
Batch: 78/116	Loss: 0.729
Batch: 89/116	Loss: 0.917
Batch: 100/116	Loss: 0.642
Batch: 111/116	Loss: 0.687
Batch: 116/116	Loss: 0.386
Epoch: 6	Train Loss: 0.587	Val F1: 0.357
Best Epoch: 6	Best Val F1: 0.357

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.401
Batch: 12/116	Loss: 0.660
Batch: 23/116	Loss: 0.674
Batch: 34/116	Loss: 0.858
Batch: 45/116	Loss: 0.445
Batch: 56/116	Loss: 0.776
Batch: 67/116	Loss: 0.529
Batch: 78/116	Loss: 0.540
Batch: 89/116	Loss: 0.480
Batch: 100/116	Loss: 0.409
Batch: 111/116	Loss: 0.723
Batch: 116/116	Loss: 0.468
Epoch: 7	Train Loss: 0.539	Val F1: 0.362
Best Epoch: 7	Best Val F1: 0.362

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.531
Batch: 12/116	Loss: 0.451
Batch: 23/116	Loss: 0.231
Batch: 34/116	Loss: 0.428
Batch: 45/116	Loss: 0.341
Batch: 56/116	Loss: 0.319
Batch: 67/116	Loss: 0.830
Batch: 78/116	Loss: 0.333
Batch: 89/116	Loss: 0.329
Batch: 100/116	Loss: 0.693
Batch: 111/116	Loss: 0.362
Batch: 116/116	Loss: 0.446
Epoch: 8	Train Loss: 0.478	Val F1: 0.356
Best Epoch: 7	Best Val F1: 0.362

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.427
Batch: 12/116	Loss: 0.480
Batch: 23/116	Loss: 0.357
Batch: 34/116	Loss: 0.375
Batch: 45/116	Loss: 0.365
Batch: 56/116	Loss: 0.468
Batch: 67/116	Loss: 0.333
Batch: 78/116	Loss: 0.353
Batch: 89/116	Loss: 0.330
Batch: 100/116	Loss: 0.437
Batch: 111/116	Loss: 0.372
Batch: 116/116	Loss: 0.723
Epoch: 9	Train Loss: 0.433	Val F1: 0.364
Best Epoch: 9	Best Val F1: 0.364

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.358
Batch: 12/116	Loss: 0.378
Batch: 23/116	Loss: 0.288
Batch: 34/116	Loss: 0.473
Batch: 45/116	Loss: 0.250
Batch: 56/116	Loss: 0.381
Batch: 67/116	Loss: 0.702
Batch: 78/116	Loss: 0.347
Batch: 89/116	Loss: 0.261
Batch: 100/116	Loss: 0.527
Batch: 111/116	Loss: 0.256
Batch: 116/116	Loss: 0.378
Epoch: 10	Train Loss: 0.405	Val F1: 0.364
Best Epoch: 9	Best Val F1: 0.364

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.390
Batch: 12/116	Loss: 0.299
Batch: 23/116	Loss: 0.312
Batch: 34/116	Loss: 0.276
Batch: 45/116	Loss: 0.402
Batch: 56/116	Loss: 0.358
Batch: 67/116	Loss: 0.367
Batch: 78/116	Loss: 0.267
Batch: 89/116	Loss: 0.221
Batch: 100/116	Loss: 0.301
Batch: 111/116	Loss: 0.416
Batch: 116/116	Loss: 0.159
Epoch: 11	Train Loss: 0.360	Val F1: 0.347
Best Epoch: 9	Best Val F1: 0.364

****************************** Epoch: 12 ******************************
Batch: 1/116	Loss: 0.466
Batch: 12/116	Loss: 0.304
Batch: 23/116	Loss: 0.242
Batch: 34/116	Loss: 0.400
Batch: 45/116	Loss: 0.235
Batch: 56/116	Loss: 0.432
Batch: 67/116	Loss: 0.242
Batch: 78/116	Loss: 0.419
Batch: 89/116	Loss: 0.349
Batch: 100/116	Loss: 0.379
Batch: 111/116	Loss: 0.305
Batch: 116/116	Loss: 0.159
Epoch: 12	Train Loss: 0.332	Val F1: 0.357
Best Epoch: 9	Best Val F1: 0.364

****************************** Epoch: 13 ******************************
Batch: 1/116	Loss: 0.268
Batch: 12/116	Loss: 0.185
Batch: 23/116	Loss: 0.373
Batch: 34/116	Loss: 0.156
Batch: 45/116	Loss: 0.520
Batch: 56/116	Loss: 0.325
Batch: 67/116	Loss: 0.192
Batch: 78/116	Loss: 0.442
Batch: 89/116	Loss: 0.366
Batch: 100/116	Loss: 0.299
Batch: 111/116	Loss: 0.287
Batch: 116/116	Loss: 0.201
Epoch: 13	Train Loss: 0.307	Val F1: 0.358
Best Epoch: 9	Best Val F1: 0.364

****************************** Epoch: 14 ******************************
Batch: 1/116	Loss: 0.579
Batch: 12/116	Loss: 0.443
Batch: 23/116	Loss: 0.198
Batch: 34/116	Loss: 0.185
Batch: 45/116	Loss: 0.358
Batch: 56/116	Loss: 0.396
Batch: 67/116	Loss: 0.471
Batch: 78/116	Loss: 0.466
Batch: 89/116	Loss: 0.237
Batch: 100/116	Loss: 0.296
Batch: 111/116	Loss: 0.232
Batch: 116/116	Loss: 0.287
Epoch: 14	Train Loss: 0.284	Val F1: 0.353
Best Epoch: 9	Best Val F1: 0.364

Saving the best checkpoint....
Inference...
Test F1: 0.367	Test F1_Few: 0.374	Test F1_Zero: 0.355
Starting training with config: {'batch_size': 8, 'epochs': 75, 'l2_reg': 0.0008858176980479334, 'lr': 2.566582525659751e-05, 'n_layers_freeze': 4, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/231	Loss: 1.080
Batch: 24/231	Loss: 0.896
Batch: 47/231	Loss: 0.826
Batch: 70/231	Loss: 0.816
Batch: 93/231	Loss: 0.755
Batch: 116/231	Loss: 0.879
Batch: 139/231	Loss: 0.821
Batch: 162/231	Loss: 0.834
Batch: 185/231	Loss: 0.727
Batch: 208/231	Loss: 0.738
Batch: 231/231	Loss: 0.688
Epoch: 1	Train Loss: 0.812	Val F1: 0.276
Best Epoch: 1	Best Val F1: 0.276

****************************** Epoch: 2 ******************************
Batch: 1/231	Loss: 0.755
Batch: 24/231	Loss: 0.757
Batch: 47/231	Loss: 0.761
Batch: 70/231	Loss: 0.949
Batch: 93/231	Loss: 0.716
Batch: 116/231	Loss: 0.628
Batch: 139/231	Loss: 1.130
Batch: 162/231	Loss: 0.547
Batch: 185/231	Loss: 0.632
Batch: 208/231	Loss: 0.755
Batch: 231/231	Loss: 0.578
Epoch: 2	Train Loss: 0.718	Val F1: 0.341
Best Epoch: 2	Best Val F1: 0.341

****************************** Epoch: 3 ******************************
Batch: 1/231	Loss: 0.492
Batch: 24/231	Loss: 0.570
Batch: 47/231	Loss: 0.611
Batch: 70/231	Loss: 0.661
Batch: 93/231	Loss: 0.589
Batch: 116/231	Loss: 0.464
Batch: 139/231	Loss: 0.695
Batch: 162/231	Loss: 0.612
Batch: 185/231	Loss: 0.662
Batch: 208/231	Loss: 0.602
Batch: 231/231	Loss: 0.729
Epoch: 3	Train Loss: 0.661	Val F1: 0.283
Best Epoch: 2	Best Val F1: 0.341

****************************** Epoch: 4 ******************************
Batch: 1/231	Loss: 0.860
Batch: 24/231	Loss: 0.405
Batch: 47/231	Loss: 0.651
Batch: 70/231	Loss: 0.730
Batch: 93/231	Loss: 0.676
Batch: 116/231	Loss: 0.463
Batch: 139/231	Loss: 1.415
Batch: 162/231	Loss: 0.659
Batch: 185/231	Loss: 0.472
Batch: 208/231	Loss: 0.418
Batch: 231/231	Loss: 0.631
Epoch: 4	Train Loss: 0.597	Val F1: 0.336
Best Epoch: 2	Best Val F1: 0.341

****************************** Epoch: 5 ******************************
Batch: 1/231	Loss: 0.333
Batch: 24/231	Loss: 0.547
Batch: 47/231	Loss: 0.880
Batch: 70/231	Loss: 0.507
Batch: 93/231	Loss: 0.741
Batch: 116/231	Loss: 0.338
Batch: 139/231	Loss: 0.861
Batch: 162/231	Loss: 0.590
Batch: 185/231	Loss: 0.617
Batch: 208/231	Loss: 0.399
Batch: 231/231	Loss: 0.451
Epoch: 5	Train Loss: 0.531	Val F1: 0.346
Best Epoch: 5	Best Val F1: 0.346

****************************** Epoch: 6 ******************************
Batch: 1/231	Loss: 0.476
Batch: 24/231	Loss: 0.483
Batch: 47/231	Loss: 0.382
Batch: 70/231	Loss: 0.480
Batch: 93/231	Loss: 0.293
Batch: 116/231	Loss: 0.843
Batch: 139/231	Loss: 0.621
Batch: 162/231	Loss: 0.596
Batch: 185/231	Loss: 0.738
Batch: 208/231	Loss: 0.492
Batch: 231/231	Loss: 0.146
Epoch: 6	Train Loss: 0.444	Val F1: 0.344
Best Epoch: 5	Best Val F1: 0.346

****************************** Epoch: 7 ******************************
Batch: 1/231	Loss: 0.384
Batch: 24/231	Loss: 0.435
Batch: 47/231	Loss: 0.254
Batch: 70/231	Loss: 0.445
Batch: 93/231	Loss: 0.499
Batch: 116/231	Loss: 0.259
Batch: 139/231	Loss: 0.154
Batch: 162/231	Loss: 0.467
Batch: 185/231	Loss: 0.220
Batch: 208/231	Loss: 0.532
Batch: 231/231	Loss: 0.144
Epoch: 7	Train Loss: 0.382	Val F1: 0.340
Best Epoch: 5	Best Val F1: 0.346

****************************** Epoch: 8 ******************************
Batch: 1/231	Loss: 0.411
Batch: 24/231	Loss: 0.254
Batch: 47/231	Loss: 0.368
Batch: 70/231	Loss: 0.222
Batch: 93/231	Loss: 0.273
Batch: 116/231	Loss: 0.158
Batch: 139/231	Loss: 0.390
Batch: 162/231	Loss: 0.228
Batch: 185/231	Loss: 0.457
Batch: 208/231	Loss: 0.121
Batch: 231/231	Loss: 0.348
Epoch: 8	Train Loss: 0.341	Val F1: 0.341
Best Epoch: 5	Best Val F1: 0.346

****************************** Epoch: 9 ******************************
Batch: 1/231	Loss: 0.349
Batch: 24/231	Loss: 0.433
Batch: 47/231	Loss: 0.545
Batch: 70/231	Loss: 0.734
Batch: 93/231	Loss: 0.324
Batch: 116/231	Loss: 0.237
Batch: 139/231	Loss: 0.367
Batch: 162/231	Loss: 0.380
Batch: 185/231	Loss: 0.237
Batch: 208/231	Loss: 0.502
Batch: 231/231	Loss: 0.485
Epoch: 9	Train Loss: 0.294	Val F1: 0.329
Best Epoch: 5	Best Val F1: 0.346

****************************** Epoch: 10 ******************************
Batch: 1/231	Loss: 0.233
Batch: 24/231	Loss: 0.171
Batch: 47/231	Loss: 0.287
Batch: 70/231	Loss: 0.112
Batch: 93/231	Loss: 0.214
Batch: 116/231	Loss: 0.072
Batch: 139/231	Loss: 0.118
Batch: 162/231	Loss: 0.256
Batch: 185/231	Loss: 0.774
Batch: 208/231	Loss: 0.218
Batch: 231/231	Loss: 0.145
Epoch: 10	Train Loss: 0.240	Val F1: 0.352
Best Epoch: 10	Best Val F1: 0.352

****************************** Epoch: 11 ******************************
Batch: 1/231	Loss: 0.184
Batch: 24/231	Loss: 0.066
Batch: 47/231	Loss: 0.144
Batch: 70/231	Loss: 0.127
Batch: 93/231	Loss: 0.391
Batch: 116/231	Loss: 0.459
Batch: 139/231	Loss: 0.162
Batch: 162/231	Loss: 0.190
Batch: 185/231	Loss: 0.163
Batch: 208/231	Loss: 0.190
Batch: 231/231	Loss: 0.072
Epoch: 11	Train Loss: 0.193	Val F1: 0.330
Best Epoch: 10	Best Val F1: 0.352

****************************** Epoch: 12 ******************************
Batch: 1/231	Loss: 0.140
Batch: 24/231	Loss: 0.182
Batch: 47/231	Loss: 0.122
Batch: 70/231	Loss: 0.105
Batch: 93/231	Loss: 0.158
Batch: 116/231	Loss: 0.048
Batch: 139/231	Loss: 0.204
Batch: 162/231	Loss: 0.180
Batch: 185/231	Loss: 0.058
Batch: 208/231	Loss: 0.188
Batch: 231/231	Loss: 0.019
Epoch: 12	Train Loss: 0.149	Val F1: 0.339
Best Epoch: 10	Best Val F1: 0.352

****************************** Epoch: 13 ******************************
Batch: 1/231	Loss: 0.084
Batch: 24/231	Loss: 0.039
Batch: 47/231	Loss: 0.119
Batch: 70/231	Loss: 0.129
Batch: 93/231	Loss: 0.060
Batch: 116/231	Loss: 0.089
Batch: 139/231	Loss: 0.053
Batch: 162/231	Loss: 0.029
Batch: 185/231	Loss: 0.047
Batch: 208/231	Loss: 0.071
Batch: 231/231	Loss: 0.024
Epoch: 13	Train Loss: 0.105	Val F1: 0.352
Best Epoch: 10	Best Val F1: 0.352

****************************** Epoch: 14 ******************************
Batch: 1/231	Loss: 0.163
Batch: 24/231	Loss: 0.188
Batch: 47/231	Loss: 0.049
Batch: 70/231	Loss: 0.042
Batch: 93/231	Loss: 0.051
Batch: 116/231	Loss: 0.030
Batch: 139/231	Loss: 0.015
Batch: 162/231	Loss: 0.076
Batch: 185/231	Loss: 0.175
Batch: 208/231	Loss: 0.013
Batch: 231/231	Loss: 0.141
Epoch: 14	Train Loss: 0.082	Val F1: 0.345
Best Epoch: 10	Best Val F1: 0.352

****************************** Epoch: 15 ******************************
Batch: 1/231	Loss: 0.017
Batch: 24/231	Loss: 0.069
Batch: 47/231	Loss: 0.018
Batch: 70/231	Loss: 0.025
Batch: 93/231	Loss: 0.065
Batch: 116/231	Loss: 0.035
Batch: 139/231	Loss: 0.037
Batch: 162/231	Loss: 0.047
Batch: 185/231	Loss: 0.046
Batch: 208/231	Loss: 0.171
Batch: 231/231	Loss: 0.008
Epoch: 15	Train Loss: 0.063	Val F1: 0.336
Best Epoch: 10	Best Val F1: 0.352

****************************** Epoch: 16 ******************************
Batch: 1/231	Loss: 0.059
Batch: 24/231	Loss: 0.115
Batch: 47/231	Loss: 0.175
Batch: 70/231	Loss: 0.261
Batch: 93/231	Loss: 0.055
Batch: 116/231	Loss: 0.011
Batch: 139/231	Loss: 0.007
Batch: 162/231	Loss: 0.019
Batch: 185/231	Loss: 0.010
Batch: 208/231	Loss: 0.035
Batch: 231/231	Loss: 0.037
Epoch: 16	Train Loss: 0.060	Val F1: 0.352
Best Epoch: 10	Best Val F1: 0.352

****************************** Epoch: 17 ******************************
Batch: 1/231	Loss: 0.033
Batch: 24/231	Loss: 0.034
Batch: 47/231	Loss: 0.099
Batch: 70/231	Loss: 0.026
Batch: 93/231	Loss: 0.089
Batch: 116/231	Loss: 0.078
Batch: 139/231	Loss: 0.036
Batch: 162/231	Loss: 0.068
Batch: 185/231	Loss: 0.026
Batch: 208/231	Loss: 0.040
Batch: 231/231	Loss: 0.033
Epoch: 17	Train Loss: 0.046	Val F1: 0.334
Best Epoch: 10	Best Val F1: 0.352

****************************** Epoch: 18 ******************************
Batch: 1/231	Loss: 0.056
Batch: 24/231	Loss: 0.005
Batch: 47/231	Loss: 0.014
Batch: 70/231	Loss: 0.016
Batch: 93/231	Loss: 0.043
Batch: 116/231	Loss: 0.016
Batch: 139/231	Loss: 0.068
Batch: 162/231	Loss: 0.004
Batch: 185/231	Loss: 0.012
Batch: 208/231	Loss: 0.059
Batch: 231/231	Loss: 0.080
Epoch: 18	Train Loss: 0.030	Val F1: 0.342
Best Epoch: 10	Best Val F1: 0.352

****************************** Epoch: 19 ******************************
Batch: 1/231	Loss: 0.026
Batch: 24/231	Loss: 0.004
Batch: 47/231	Loss: 0.009
Batch: 70/231	Loss: 0.032
Batch: 93/231	Loss: 0.004
Batch: 116/231	Loss: 0.008
Batch: 139/231	Loss: 0.016
Batch: 162/231	Loss: 0.006
Batch: 185/231	Loss: 0.015
Batch: 208/231	Loss: 0.037
Batch: 231/231	Loss: 0.004
Epoch: 19	Train Loss: 0.030	Val F1: 0.341
Best Epoch: 10	Best Val F1: 0.352

****************************** Epoch: 20 ******************************
Batch: 1/231	Loss: 0.028
Batch: 24/231	Loss: 0.018
Batch: 47/231	Loss: 0.004
Batch: 70/231	Loss: 0.024
Batch: 93/231	Loss: 0.009
Batch: 116/231	Loss: 0.033
Batch: 139/231	Loss: 0.009
Batch: 162/231	Loss: 0.010
Batch: 185/231	Loss: 0.015
Batch: 208/231	Loss: 0.002
Batch: 231/231	Loss: 0.070
Epoch: 20	Train Loss: 0.025	Val F1: 0.338
Best Epoch: 10	Best Val F1: 0.352

Saving the best checkpoint....
Inference...
Test F1: 0.375	Test F1_Few: 0.370	Test F1_Zero: 0.383
Starting training with config: {'batch_size': 32, 'epochs': 75, 'l2_reg': 0.0007866614089626123, 'lr': 1.5997061754999656e-05, 'n_layers_freeze': 4, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 1.048
Batch: 11/58	Loss: 0.994
Batch: 16/58	Loss: 0.935
Batch: 21/58	Loss: 0.930
Batch: 26/58	Loss: 0.918
Batch: 31/58	Loss: 0.887
Batch: 36/58	Loss: 0.907
Batch: 41/58	Loss: 0.857
Batch: 46/58	Loss: 0.842
Batch: 51/58	Loss: 0.828
Batch: 56/58	Loss: 0.832
Batch: 58/58	Loss: 0.837
Epoch: 1	Train Loss: 0.922	Val F1: 0.217
Best Epoch: 1	Best Val F1: 0.217

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.844
Batch: 6/58	Loss: 0.850
Batch: 11/58	Loss: 0.852
Batch: 16/58	Loss: 0.795
Batch: 21/58	Loss: 0.791
Batch: 26/58	Loss: 0.797
Batch: 31/58	Loss: 0.832
Batch: 36/58	Loss: 0.828
Batch: 41/58	Loss: 0.783
Batch: 46/58	Loss: 0.778
Batch: 51/58	Loss: 0.781
Batch: 56/58	Loss: 0.778
Batch: 58/58	Loss: 0.755
Epoch: 2	Train Loss: 0.810	Val F1: 0.303
Best Epoch: 2	Best Val F1: 0.303

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.755
Batch: 6/58	Loss: 0.734
Batch: 11/58	Loss: 0.797
Batch: 16/58	Loss: 0.738
Batch: 21/58	Loss: 0.758
Batch: 26/58	Loss: 0.767
Batch: 31/58	Loss: 0.887
Batch: 36/58	Loss: 0.768
Batch: 41/58	Loss: 0.687
Batch: 46/58	Loss: 0.713
Batch: 51/58	Loss: 0.747
Batch: 56/58	Loss: 0.731
Batch: 58/58	Loss: 0.753
Epoch: 3	Train Loss: 0.756	Val F1: 0.323
Best Epoch: 3	Best Val F1: 0.323

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.740
Batch: 6/58	Loss: 0.689
Batch: 11/58	Loss: 0.686
Batch: 16/58	Loss: 0.670
Batch: 21/58	Loss: 0.560
Batch: 26/58	Loss: 0.638
Batch: 31/58	Loss: 0.632
Batch: 36/58	Loss: 0.825
Batch: 41/58	Loss: 0.737
Batch: 46/58	Loss: 0.666
Batch: 51/58	Loss: 0.605
Batch: 56/58	Loss: 0.583
Batch: 58/58	Loss: 0.677
Epoch: 4	Train Loss: 0.695	Val F1: 0.328
Best Epoch: 4	Best Val F1: 0.328

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.619
Batch: 6/58	Loss: 0.607
Batch: 11/58	Loss: 0.603
Batch: 16/58	Loss: 0.619
Batch: 21/58	Loss: 0.529
Batch: 26/58	Loss: 0.560
Batch: 31/58	Loss: 0.738
Batch: 36/58	Loss: 0.741
Batch: 41/58	Loss: 0.659
Batch: 46/58	Loss: 0.771
Batch: 51/58	Loss: 0.926
Batch: 56/58	Loss: 0.734
Batch: 58/58	Loss: 0.818
Epoch: 5	Train Loss: 0.650	Val F1: 0.336
Best Epoch: 5	Best Val F1: 0.336

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.616
Batch: 6/58	Loss: 0.709
Batch: 11/58	Loss: 0.707
Batch: 16/58	Loss: 0.601
Batch: 21/58	Loss: 0.627
Batch: 26/58	Loss: 0.490
Batch: 31/58	Loss: 0.600
Batch: 36/58	Loss: 0.504
Batch: 41/58	Loss: 0.570
Batch: 46/58	Loss: 0.596
Batch: 51/58	Loss: 0.579
Batch: 56/58	Loss: 0.616
Batch: 58/58	Loss: 0.533
Epoch: 6	Train Loss: 0.600	Val F1: 0.364
Best Epoch: 6	Best Val F1: 0.364

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.472
Batch: 6/58	Loss: 0.637
Batch: 11/58	Loss: 0.689
Batch: 16/58	Loss: 0.411
Batch: 21/58	Loss: 0.505
Batch: 26/58	Loss: 0.534
Batch: 31/58	Loss: 0.623
Batch: 36/58	Loss: 0.531
Batch: 41/58	Loss: 0.514
Batch: 46/58	Loss: 0.526
Batch: 51/58	Loss: 0.481
Batch: 56/58	Loss: 0.577
Batch: 58/58	Loss: 0.472
Epoch: 7	Train Loss: 0.558	Val F1: 0.352
Best Epoch: 6	Best Val F1: 0.364

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.532
Batch: 6/58	Loss: 0.482
Batch: 11/58	Loss: 0.447
Batch: 16/58	Loss: 0.470
Batch: 21/58	Loss: 0.498
Batch: 26/58	Loss: 0.380
Batch: 31/58	Loss: 0.481
Batch: 36/58	Loss: 0.414
Batch: 41/58	Loss: 0.567
Batch: 46/58	Loss: 0.556
Batch: 51/58	Loss: 0.535
Batch: 56/58	Loss: 0.494
Batch: 58/58	Loss: 0.478
Epoch: 8	Train Loss: 0.513	Val F1: 0.346
Best Epoch: 6	Best Val F1: 0.364

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.525
Batch: 6/58	Loss: 0.595
Batch: 11/58	Loss: 0.530
Batch: 16/58	Loss: 0.370
Batch: 21/58	Loss: 0.386
Batch: 26/58	Loss: 0.374
Batch: 31/58	Loss: 0.402
Batch: 36/58	Loss: 0.439
Batch: 41/58	Loss: 0.447
Batch: 46/58	Loss: 0.504
Batch: 51/58	Loss: 0.571
Batch: 56/58	Loss: 0.375
Batch: 58/58	Loss: 0.390
Epoch: 9	Train Loss: 0.475	Val F1: 0.361
Best Epoch: 6	Best Val F1: 0.364

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.416
Batch: 6/58	Loss: 0.403
Batch: 11/58	Loss: 0.462
Batch: 16/58	Loss: 0.534
Batch: 21/58	Loss: 0.324
Batch: 26/58	Loss: 0.482
Batch: 31/58	Loss: 0.319
Batch: 36/58	Loss: 0.605
Batch: 41/58	Loss: 0.546
Batch: 46/58	Loss: 0.527
Batch: 51/58	Loss: 0.372
Batch: 56/58	Loss: 0.376
Batch: 58/58	Loss: 0.528
Epoch: 10	Train Loss: 0.439	Val F1: 0.326
Best Epoch: 6	Best Val F1: 0.364

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.409
Batch: 6/58	Loss: 0.355
Batch: 11/58	Loss: 0.340
Batch: 16/58	Loss: 0.374
Batch: 21/58	Loss: 0.451
Batch: 26/58	Loss: 0.502
Batch: 31/58	Loss: 0.418
Batch: 36/58	Loss: 0.440
Batch: 41/58	Loss: 0.383
Batch: 46/58	Loss: 0.351
Batch: 51/58	Loss: 0.413
Batch: 56/58	Loss: 0.427
Batch: 58/58	Loss: 0.407
Epoch: 11	Train Loss: 0.415	Val F1: 0.346
Best Epoch: 6	Best Val F1: 0.364

Saving the best checkpoint....
Inference...
Test F1: 0.383	Test F1_Few: 0.450	Test F1_Zero: 0.383
Starting training with config: {'batch_size': 16, 'epochs': 75, 'l2_reg': 0.0006583161846854237, 'lr': 2.047261896563563e-05, 'n_layers_freeze': 3, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 0.977
Batch: 23/116	Loss: 0.911
Batch: 34/116	Loss: 0.890
Batch: 45/116	Loss: 0.849
Batch: 56/116	Loss: 0.843
Batch: 67/116	Loss: 0.791
Batch: 78/116	Loss: 0.797
Batch: 89/116	Loss: 0.880
Batch: 100/116	Loss: 0.762
Batch: 111/116	Loss: 0.798
Batch: 116/116	Loss: 0.748
Epoch: 1	Train Loss: 0.858	Val F1: 0.207
Best Epoch: 1	Best Val F1: 0.207

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.839
Batch: 12/116	Loss: 0.783
Batch: 23/116	Loss: 0.752
Batch: 34/116	Loss: 0.744
Batch: 45/116	Loss: 0.811
Batch: 56/116	Loss: 0.757
Batch: 67/116	Loss: 0.753
Batch: 78/116	Loss: 0.749
Batch: 89/116	Loss: 0.707
Batch: 100/116	Loss: 0.697
Batch: 111/116	Loss: 0.733
Batch: 116/116	Loss: 0.683
Epoch: 2	Train Loss: 0.760	Val F1: 0.325
Best Epoch: 2	Best Val F1: 0.325

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.662
Batch: 12/116	Loss: 0.606
Batch: 23/116	Loss: 0.651
Batch: 34/116	Loss: 0.744
Batch: 45/116	Loss: 0.756
Batch: 56/116	Loss: 0.745
Batch: 67/116	Loss: 0.690
Batch: 78/116	Loss: 0.685
Batch: 89/116	Loss: 0.722
Batch: 100/116	Loss: 0.851
Batch: 111/116	Loss: 0.949
Batch: 116/116	Loss: 0.602
Epoch: 3	Train Loss: 0.701	Val F1: 0.331
Best Epoch: 3	Best Val F1: 0.331

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.671
Batch: 12/116	Loss: 0.535
Batch: 23/116	Loss: 0.823
Batch: 34/116	Loss: 0.501
Batch: 45/116	Loss: 0.699
Batch: 56/116	Loss: 0.675
Batch: 67/116	Loss: 0.702
Batch: 78/116	Loss: 0.588
Batch: 89/116	Loss: 0.690
Batch: 100/116	Loss: 0.579
Batch: 111/116	Loss: 0.670
Batch: 116/116	Loss: 0.773
Epoch: 4	Train Loss: 0.651	Val F1: 0.322
Best Epoch: 3	Best Val F1: 0.331

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.508
Batch: 12/116	Loss: 0.553
Batch: 23/116	Loss: 0.665
Batch: 34/116	Loss: 0.517
Batch: 45/116	Loss: 0.632
Batch: 56/116	Loss: 0.629
Batch: 67/116	Loss: 0.599
Batch: 78/116	Loss: 0.622
Batch: 89/116	Loss: 0.719
Batch: 100/116	Loss: 0.666
Batch: 111/116	Loss: 0.604
Batch: 116/116	Loss: 0.542
Epoch: 5	Train Loss: 0.601	Val F1: 0.328
Best Epoch: 3	Best Val F1: 0.331

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.539
Batch: 12/116	Loss: 0.836
Batch: 23/116	Loss: 0.685
Batch: 34/116	Loss: 0.493
Batch: 45/116	Loss: 0.424
Batch: 56/116	Loss: 0.569
Batch: 67/116	Loss: 0.497
Batch: 78/116	Loss: 0.632
Batch: 89/116	Loss: 0.917
Batch: 100/116	Loss: 0.596
Batch: 111/116	Loss: 0.623
Batch: 116/116	Loss: 0.339
Epoch: 6	Train Loss: 0.532	Val F1: 0.361
Best Epoch: 6	Best Val F1: 0.361

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.353
Batch: 12/116	Loss: 0.714
Batch: 23/116	Loss: 0.582
Batch: 34/116	Loss: 0.685
Batch: 45/116	Loss: 0.325
Batch: 56/116	Loss: 0.770
Batch: 67/116	Loss: 0.391
Batch: 78/116	Loss: 0.482
Batch: 89/116	Loss: 0.403
Batch: 100/116	Loss: 0.341
Batch: 111/116	Loss: 0.786
Batch: 116/116	Loss: 0.401
Epoch: 7	Train Loss: 0.475	Val F1: 0.357
Best Epoch: 6	Best Val F1: 0.361

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.536
Batch: 12/116	Loss: 0.514
Batch: 23/116	Loss: 0.261
Batch: 34/116	Loss: 0.431
Batch: 45/116	Loss: 0.395
Batch: 56/116	Loss: 0.231
Batch: 67/116	Loss: 0.655
Batch: 78/116	Loss: 0.332
Batch: 89/116	Loss: 0.274
Batch: 100/116	Loss: 0.616
Batch: 111/116	Loss: 0.291
Batch: 116/116	Loss: 0.381
Epoch: 8	Train Loss: 0.422	Val F1: 0.334
Best Epoch: 6	Best Val F1: 0.361

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.394
Batch: 12/116	Loss: 0.438
Batch: 23/116	Loss: 0.336
Batch: 34/116	Loss: 0.298
Batch: 45/116	Loss: 0.344
Batch: 56/116	Loss: 0.375
Batch: 67/116	Loss: 0.325
Batch: 78/116	Loss: 0.433
Batch: 89/116	Loss: 0.225
Batch: 100/116	Loss: 0.418
Batch: 111/116	Loss: 0.279
Batch: 116/116	Loss: 0.730
Epoch: 9	Train Loss: 0.369	Val F1: 0.353
Best Epoch: 6	Best Val F1: 0.361

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.319
Batch: 12/116	Loss: 0.390
Batch: 23/116	Loss: 0.328
Batch: 34/116	Loss: 0.426
Batch: 45/116	Loss: 0.191
Batch: 56/116	Loss: 0.369
Batch: 67/116	Loss: 0.377
Batch: 78/116	Loss: 0.338
Batch: 89/116	Loss: 0.214
Batch: 100/116	Loss: 0.397
Batch: 111/116	Loss: 0.200
Batch: 116/116	Loss: 0.305
Epoch: 10	Train Loss: 0.339	Val F1: 0.345
Best Epoch: 6	Best Val F1: 0.361

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.322
Batch: 12/116	Loss: 0.298
Batch: 23/116	Loss: 0.339
Batch: 34/116	Loss: 0.206
Batch: 45/116	Loss: 0.351
Batch: 56/116	Loss: 0.401
Batch: 67/116	Loss: 0.307
Batch: 78/116	Loss: 0.233
Batch: 89/116	Loss: 0.188
Batch: 100/116	Loss: 0.327
Batch: 111/116	Loss: 0.376
Batch: 116/116	Loss: 0.152
Epoch: 11	Train Loss: 0.311	Val F1: 0.329
Best Epoch: 6	Best Val F1: 0.361

Saving the best checkpoint....
Inference...
Test F1: 0.379	Test F1_Few: 0.455	Test F1_Zero: 0.369
Starting training with config: {'batch_size': 16, 'epochs': 75, 'l2_reg': 0.0009208530680452592, 'lr': 4.193731622367604e-06, 'n_layers_freeze': 5, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 1.070
Batch: 23/116	Loss: 1.043
Batch: 34/116	Loss: 1.025
Batch: 45/116	Loss: 0.988
Batch: 56/116	Loss: 0.965
Batch: 67/116	Loss: 0.926
Batch: 78/116	Loss: 0.918
Batch: 89/116	Loss: 0.942
Batch: 100/116	Loss: 0.888
Batch: 111/116	Loss: 0.895
Batch: 116/116	Loss: 0.881
Epoch: 1	Train Loss: 0.974	Val F1: 0.207
Best Epoch: 1	Best Val F1: 0.207

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.909
Batch: 12/116	Loss: 0.884
Batch: 23/116	Loss: 0.864
Batch: 34/116	Loss: 0.850
Batch: 45/116	Loss: 0.891
Batch: 56/116	Loss: 0.863
Batch: 67/116	Loss: 0.861
Batch: 78/116	Loss: 0.834
Batch: 89/116	Loss: 0.845
Batch: 100/116	Loss: 0.850
Batch: 111/116	Loss: 0.845
Batch: 116/116	Loss: 0.824
Epoch: 2	Train Loss: 0.860	Val F1: 0.206
Best Epoch: 1	Best Val F1: 0.207

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.811
Batch: 12/116	Loss: 0.813
Batch: 23/116	Loss: 0.810
Batch: 34/116	Loss: 0.832
Batch: 45/116	Loss: 0.869
Batch: 56/116	Loss: 0.828
Batch: 67/116	Loss: 0.834
Batch: 78/116	Loss: 0.792
Batch: 89/116	Loss: 0.793
Batch: 100/116	Loss: 0.919
Batch: 111/116	Loss: 0.836
Batch: 116/116	Loss: 0.785
Epoch: 3	Train Loss: 0.824	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.207

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.810
Batch: 12/116	Loss: 0.786
Batch: 23/116	Loss: 0.860
Batch: 34/116	Loss: 0.775
Batch: 45/116	Loss: 0.841
Batch: 56/116	Loss: 0.803
Batch: 67/116	Loss: 0.812
Batch: 78/116	Loss: 0.773
Batch: 89/116	Loss: 0.830
Batch: 100/116	Loss: 0.828
Batch: 111/116	Loss: 0.762
Batch: 116/116	Loss: 0.868
Epoch: 4	Train Loss: 0.801	Val F1: 0.225
Best Epoch: 4	Best Val F1: 0.225

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.757
Batch: 12/116	Loss: 0.753
Batch: 23/116	Loss: 0.765
Batch: 34/116	Loss: 0.762
Batch: 45/116	Loss: 0.863
Batch: 56/116	Loss: 0.798
Batch: 67/116	Loss: 0.766
Batch: 78/116	Loss: 0.803
Batch: 89/116	Loss: 0.779
Batch: 100/116	Loss: 0.775
Batch: 111/116	Loss: 0.734
Batch: 116/116	Loss: 0.702
Epoch: 5	Train Loss: 0.777	Val F1: 0.316
Best Epoch: 5	Best Val F1: 0.316

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.720
Batch: 12/116	Loss: 0.913
Batch: 23/116	Loss: 0.754
Batch: 34/116	Loss: 0.697
Batch: 45/116	Loss: 0.722
Batch: 56/116	Loss: 0.727
Batch: 67/116	Loss: 0.699
Batch: 78/116	Loss: 0.759
Batch: 89/116	Loss: 0.785
Batch: 100/116	Loss: 0.768
Batch: 111/116	Loss: 0.814
Batch: 116/116	Loss: 0.653
Epoch: 6	Train Loss: 0.740	Val F1: 0.316
Best Epoch: 5	Best Val F1: 0.316

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.679
Batch: 12/116	Loss: 0.753
Batch: 23/116	Loss: 0.863
Batch: 34/116	Loss: 0.791
Batch: 45/116	Loss: 0.708
Batch: 56/116	Loss: 0.896
Batch: 67/116	Loss: 0.781
Batch: 78/116	Loss: 0.774
Batch: 89/116	Loss: 0.644
Batch: 100/116	Loss: 0.634
Batch: 111/116	Loss: 0.853
Batch: 116/116	Loss: 0.671
Epoch: 7	Train Loss: 0.712	Val F1: 0.327
Best Epoch: 7	Best Val F1: 0.327

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.700
Batch: 12/116	Loss: 0.710
Batch: 23/116	Loss: 0.554
Batch: 34/116	Loss: 0.651
Batch: 45/116	Loss: 0.647
Batch: 56/116	Loss: 0.667
Batch: 67/116	Loss: 0.895
Batch: 78/116	Loss: 0.574
Batch: 89/116	Loss: 0.618
Batch: 100/116	Loss: 0.768
Batch: 111/116	Loss: 0.600
Batch: 116/116	Loss: 0.603
Epoch: 8	Train Loss: 0.686	Val F1: 0.315
Best Epoch: 7	Best Val F1: 0.327

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.714
Batch: 12/116	Loss: 0.653
Batch: 23/116	Loss: 0.584
Batch: 34/116	Loss: 0.756
Batch: 45/116	Loss: 0.598
Batch: 56/116	Loss: 0.695
Batch: 67/116	Loss: 0.571
Batch: 78/116	Loss: 0.663
Batch: 89/116	Loss: 0.706
Batch: 100/116	Loss: 0.598
Batch: 111/116	Loss: 0.505
Batch: 116/116	Loss: 0.797
Epoch: 9	Train Loss: 0.658	Val F1: 0.325
Best Epoch: 7	Best Val F1: 0.327

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.651
Batch: 12/116	Loss: 0.611
Batch: 23/116	Loss: 0.568
Batch: 34/116	Loss: 0.637
Batch: 45/116	Loss: 0.583
Batch: 56/116	Loss: 0.572
Batch: 67/116	Loss: 0.733
Batch: 78/116	Loss: 0.502
Batch: 89/116	Loss: 0.526
Batch: 100/116	Loss: 0.594
Batch: 111/116	Loss: 0.571
Batch: 116/116	Loss: 0.799
Epoch: 10	Train Loss: 0.635	Val F1: 0.322
Best Epoch: 7	Best Val F1: 0.327

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.606
Batch: 12/116	Loss: 0.575
Batch: 23/116	Loss: 0.555
Batch: 34/116	Loss: 0.652
Batch: 45/116	Loss: 0.587
Batch: 56/116	Loss: 0.738
Batch: 67/116	Loss: 0.674
Batch: 78/116	Loss: 0.565
Batch: 89/116	Loss: 0.651
Batch: 100/116	Loss: 0.543
Batch: 111/116	Loss: 0.612
Batch: 116/116	Loss: 0.355
Epoch: 11	Train Loss: 0.622	Val F1: 0.332
Best Epoch: 11	Best Val F1: 0.332

****************************** Epoch: 12 ******************************
Batch: 1/116	Loss: 0.870
Batch: 12/116	Loss: 0.514
Batch: 23/116	Loss: 0.511
Batch: 34/116	Loss: 0.599
Batch: 45/116	Loss: 0.438
Batch: 56/116	Loss: 0.586
Batch: 67/116	Loss: 0.567
Batch: 78/116	Loss: 0.571
Batch: 89/116	Loss: 0.562
Batch: 100/116	Loss: 0.735
Batch: 111/116	Loss: 0.552
Batch: 116/116	Loss: 0.748
Epoch: 12	Train Loss: 0.593	Val F1: 0.321
Best Epoch: 11	Best Val F1: 0.332

****************************** Epoch: 13 ******************************
Batch: 1/116	Loss: 0.643
Batch: 12/116	Loss: 0.434
Batch: 23/116	Loss: 0.590
Batch: 34/116	Loss: 0.473
Batch: 45/116	Loss: 0.705
Batch: 56/116	Loss: 0.631
Batch: 67/116	Loss: 0.388
Batch: 78/116	Loss: 0.701
Batch: 89/116	Loss: 0.554
Batch: 100/116	Loss: 0.514
Batch: 111/116	Loss: 0.602
Batch: 116/116	Loss: 0.398
Epoch: 13	Train Loss: 0.576	Val F1: 0.322
Best Epoch: 11	Best Val F1: 0.332

****************************** Epoch: 14 ******************************
Batch: 1/116	Loss: 0.619
Batch: 12/116	Loss: 0.673
Batch: 23/116	Loss: 0.507
Batch: 34/116	Loss: 0.545
Batch: 45/116	Loss: 0.720
Batch: 56/116	Loss: 0.600
Batch: 67/116	Loss: 0.696
Batch: 78/116	Loss: 0.733
Batch: 89/116	Loss: 0.450
Batch: 100/116	Loss: 0.619
Batch: 111/116	Loss: 0.591
Batch: 116/116	Loss: 0.522
Epoch: 14	Train Loss: 0.549	Val F1: 0.338
Best Epoch: 14	Best Val F1: 0.338

****************************** Epoch: 15 ******************************
Batch: 1/116	Loss: 0.448
Batch: 12/116	Loss: 0.688
Batch: 23/116	Loss: 0.460
Batch: 34/116	Loss: 0.626
Batch: 45/116	Loss: 0.466
Batch: 56/116	Loss: 0.519
Batch: 67/116	Loss: 0.506
Batch: 78/116	Loss: 0.480
Batch: 89/116	Loss: 0.604
Batch: 100/116	Loss: 0.734
Batch: 111/116	Loss: 0.513
Batch: 116/116	Loss: 0.420
Epoch: 15	Train Loss: 0.529	Val F1: 0.325
Best Epoch: 14	Best Val F1: 0.338

****************************** Epoch: 16 ******************************
Batch: 1/116	Loss: 0.756
Batch: 12/116	Loss: 0.260
Batch: 23/116	Loss: 0.370
Batch: 34/116	Loss: 0.431
Batch: 45/116	Loss: 0.489
Batch: 56/116	Loss: 0.487
Batch: 67/116	Loss: 0.507
Batch: 78/116	Loss: 0.458
Batch: 89/116	Loss: 0.463
Batch: 100/116	Loss: 0.606
Batch: 111/116	Loss: 0.482
Batch: 116/116	Loss: 0.655
Epoch: 16	Train Loss: 0.517	Val F1: 0.328
Best Epoch: 14	Best Val F1: 0.338

****************************** Epoch: 17 ******************************
Batch: 1/116	Loss: 0.441
Batch: 12/116	Loss: 0.548
Batch: 23/116	Loss: 0.583
Batch: 34/116	Loss: 0.539
Batch: 45/116	Loss: 0.477
Batch: 56/116	Loss: 0.396
Batch: 67/116	Loss: 0.475
Batch: 78/116	Loss: 0.436
Batch: 89/116	Loss: 0.518
Batch: 100/116	Loss: 0.225
Batch: 111/116	Loss: 0.572
Batch: 116/116	Loss: 0.588
Epoch: 17	Train Loss: 0.496	Val F1: 0.332
Best Epoch: 14	Best Val F1: 0.338

****************************** Epoch: 18 ******************************
Batch: 1/116	Loss: 0.466
Batch: 12/116	Loss: 0.350
Batch: 23/116	Loss: 0.401
Batch: 34/116	Loss: 0.681
Batch: 45/116	Loss: 0.275
Batch: 56/116	Loss: 0.599
Batch: 67/116	Loss: 0.557
Batch: 78/116	Loss: 0.639
Batch: 89/116	Loss: 0.401
Batch: 100/116	Loss: 0.537
Batch: 111/116	Loss: 0.204
Batch: 116/116	Loss: 1.637
Epoch: 18	Train Loss: 0.483	Val F1: 0.338
Best Epoch: 18	Best Val F1: 0.338

****************************** Epoch: 19 ******************************
Batch: 1/116	Loss: 0.349
Batch: 12/116	Loss: 0.291
Batch: 23/116	Loss: 0.373
Batch: 34/116	Loss: 0.331
Batch: 45/116	Loss: 0.329
Batch: 56/116	Loss: 0.442
Batch: 67/116	Loss: 0.456
Batch: 78/116	Loss: 0.437
Batch: 89/116	Loss: 0.431
Batch: 100/116	Loss: 0.605
Batch: 111/116	Loss: 0.437
Batch: 116/116	Loss: 0.395
Epoch: 19	Train Loss: 0.460	Val F1: 0.327
Best Epoch: 18	Best Val F1: 0.338

****************************** Epoch: 20 ******************************
Batch: 1/116	Loss: 0.616
Batch: 12/116	Loss: 0.430
Batch: 23/116	Loss: 0.328
Batch: 34/116	Loss: 0.469
Batch: 45/116	Loss: 0.361
Batch: 56/116	Loss: 0.581
Batch: 67/116	Loss: 0.526
Batch: 78/116	Loss: 0.393
Batch: 89/116	Loss: 0.358
Batch: 100/116	Loss: 0.463
Batch: 111/116	Loss: 0.296
Batch: 116/116	Loss: 0.479
Epoch: 20	Train Loss: 0.442	Val F1: 0.326
Best Epoch: 18	Best Val F1: 0.338

****************************** Epoch: 21 ******************************
Batch: 1/116	Loss: 0.578
Batch: 12/116	Loss: 0.363
Batch: 23/116	Loss: 0.336
Batch: 34/116	Loss: 0.628
Batch: 45/116	Loss: 0.608
Batch: 56/116	Loss: 0.321
Batch: 67/116	Loss: 0.210
Batch: 78/116	Loss: 0.548
Batch: 89/116	Loss: 0.386
Batch: 100/116	Loss: 0.447
Batch: 111/116	Loss: 0.290
Batch: 116/116	Loss: 0.374
Epoch: 21	Train Loss: 0.428	Val F1: 0.325
Best Epoch: 18	Best Val F1: 0.338

****************************** Epoch: 22 ******************************
Batch: 1/116	Loss: 0.545
Batch: 12/116	Loss: 0.259
Batch: 23/116	Loss: 0.363
Batch: 34/116	Loss: 0.284
Batch: 45/116	Loss: 0.465
Batch: 56/116	Loss: 0.386
Batch: 67/116	Loss: 0.363
Batch: 78/116	Loss: 0.324
Batch: 89/116	Loss: 0.368
Batch: 100/116	Loss: 0.331
Batch: 111/116	Loss: 0.425
Batch: 116/116	Loss: 0.566
Epoch: 22	Train Loss: 0.424	Val F1: 0.328
Best Epoch: 18	Best Val F1: 0.338

****************************** Epoch: 23 ******************************
Batch: 1/116	Loss: 0.354
Batch: 12/116	Loss: 0.312
Batch: 23/116	Loss: 0.412
Batch: 34/116	Loss: 0.341
Batch: 45/116	Loss: 0.554
Batch: 56/116	Loss: 0.573
Batch: 67/116	Loss: 0.387
Batch: 78/116	Loss: 0.581
Batch: 89/116	Loss: 0.376
Batch: 100/116	Loss: 0.213
Batch: 111/116	Loss: 0.363
Batch: 116/116	Loss: 0.443
Epoch: 23	Train Loss: 0.415	Val F1: 0.331
Best Epoch: 18	Best Val F1: 0.338

Saving the best checkpoint....
Inference...
Test F1: 0.370	Test F1_Few: 0.438	Test F1_Zero: 0.370
Starting training with config: {'batch_size': 8, 'epochs': 50, 'l2_reg': 0.0007828656509605164, 'lr': 2.9576328172710252e-05, 'n_layers_freeze': 2, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/231	Loss: 1.080
Batch: 24/231	Loss: 0.884
Batch: 47/231	Loss: 0.815
Batch: 70/231	Loss: 0.806
Batch: 93/231	Loss: 0.745
Batch: 116/231	Loss: 0.871
Batch: 139/231	Loss: 0.822
Batch: 162/231	Loss: 0.867
Batch: 185/231	Loss: 0.738
Batch: 208/231	Loss: 0.730
Batch: 231/231	Loss: 0.679
Epoch: 1	Train Loss: 0.801	Val F1: 0.277
Best Epoch: 1	Best Val F1: 0.277

****************************** Epoch: 2 ******************************
Batch: 1/231	Loss: 0.760
Batch: 24/231	Loss: 0.762
Batch: 47/231	Loss: 0.875
Batch: 70/231	Loss: 0.941
Batch: 93/231	Loss: 0.702
Batch: 116/231	Loss: 0.579
Batch: 139/231	Loss: 1.077
Batch: 162/231	Loss: 0.552
Batch: 185/231	Loss: 0.616
Batch: 208/231	Loss: 0.724
Batch: 231/231	Loss: 0.586
Epoch: 2	Train Loss: 0.703	Val F1: 0.326
Best Epoch: 2	Best Val F1: 0.326

****************************** Epoch: 3 ******************************
Batch: 1/231	Loss: 0.444
Batch: 24/231	Loss: 0.485
Batch: 47/231	Loss: 0.753
Batch: 70/231	Loss: 0.571
Batch: 93/231	Loss: 0.488
Batch: 116/231	Loss: 0.713
Batch: 139/231	Loss: 0.649
Batch: 162/231	Loss: 0.672
Batch: 185/231	Loss: 0.594
Batch: 208/231	Loss: 0.602
Batch: 231/231	Loss: 0.710
Epoch: 3	Train Loss: 0.654	Val F1: 0.279
Best Epoch: 2	Best Val F1: 0.326

****************************** Epoch: 4 ******************************
Batch: 1/231	Loss: 0.869
Batch: 24/231	Loss: 0.365
Batch: 47/231	Loss: 0.725
Batch: 70/231	Loss: 0.719
Batch: 93/231	Loss: 0.724
Batch: 116/231	Loss: 0.540
Batch: 139/231	Loss: 1.771
Batch: 162/231	Loss: 0.703
Batch: 185/231	Loss: 0.479
Batch: 208/231	Loss: 0.414
Batch: 231/231	Loss: 0.652
Epoch: 4	Train Loss: 0.596	Val F1: 0.351
Best Epoch: 4	Best Val F1: 0.351

****************************** Epoch: 5 ******************************
Batch: 1/231	Loss: 0.320
Batch: 24/231	Loss: 0.406
Batch: 47/231	Loss: 0.818
Batch: 70/231	Loss: 0.636
Batch: 93/231	Loss: 0.740
Batch: 116/231	Loss: 0.328
Batch: 139/231	Loss: 0.836
Batch: 162/231	Loss: 0.539
Batch: 185/231	Loss: 0.611
Batch: 208/231	Loss: 0.350
Batch: 231/231	Loss: 0.488
Epoch: 5	Train Loss: 0.522	Val F1: 0.345
Best Epoch: 4	Best Val F1: 0.351

****************************** Epoch: 6 ******************************
Batch: 1/231	Loss: 0.473
Batch: 24/231	Loss: 0.616
Batch: 47/231	Loss: 0.281
Batch: 70/231	Loss: 0.391
Batch: 93/231	Loss: 0.183
Batch: 116/231	Loss: 0.710
Batch: 139/231	Loss: 0.601
Batch: 162/231	Loss: 0.783
Batch: 185/231	Loss: 0.928
Batch: 208/231	Loss: 0.654
Batch: 231/231	Loss: 0.259
Epoch: 6	Train Loss: 0.480	Val F1: 0.339
Best Epoch: 4	Best Val F1: 0.351

****************************** Epoch: 7 ******************************
Batch: 1/231	Loss: 0.687
Batch: 24/231	Loss: 0.834
Batch: 47/231	Loss: 0.312
Batch: 70/231	Loss: 0.611
Batch: 93/231	Loss: 0.414
Batch: 116/231	Loss: 0.294
Batch: 139/231	Loss: 0.174
Batch: 162/231	Loss: 0.427
Batch: 185/231	Loss: 0.257
Batch: 208/231	Loss: 0.628
Batch: 231/231	Loss: 0.374
Epoch: 7	Train Loss: 0.446	Val F1: 0.359
Best Epoch: 7	Best Val F1: 0.359

****************************** Epoch: 8 ******************************
Batch: 1/231	Loss: 0.408
Batch: 24/231	Loss: 0.366
Batch: 47/231	Loss: 0.462
Batch: 70/231	Loss: 0.379
Batch: 93/231	Loss: 0.339
Batch: 116/231	Loss: 0.229
Batch: 139/231	Loss: 0.341
Batch: 162/231	Loss: 0.216
Batch: 185/231	Loss: 0.405
Batch: 208/231	Loss: 0.173
Batch: 231/231	Loss: 0.328
Epoch: 8	Train Loss: 0.370	Val F1: 0.345
Best Epoch: 7	Best Val F1: 0.359

****************************** Epoch: 9 ******************************
Batch: 1/231	Loss: 0.362
Batch: 24/231	Loss: 0.692
Batch: 47/231	Loss: 0.508
Batch: 70/231	Loss: 0.678
Batch: 93/231	Loss: 0.339
Batch: 116/231	Loss: 0.337
Batch: 139/231	Loss: 0.812
Batch: 162/231	Loss: 0.439
Batch: 185/231	Loss: 0.274
Batch: 208/231	Loss: 0.422
Batch: 231/231	Loss: 0.425
Epoch: 9	Train Loss: 0.316	Val F1: 0.346
Best Epoch: 7	Best Val F1: 0.359

****************************** Epoch: 10 ******************************
Batch: 1/231	Loss: 0.251
Batch: 24/231	Loss: 0.456
Batch: 47/231	Loss: 0.289
Batch: 70/231	Loss: 0.090
Batch: 93/231	Loss: 0.321
Batch: 116/231	Loss: 0.131
Batch: 139/231	Loss: 0.144
Batch: 162/231	Loss: 0.221
Batch: 185/231	Loss: 0.754
Batch: 208/231	Loss: 0.204
Batch: 231/231	Loss: 0.156
Epoch: 10	Train Loss: 0.283	Val F1: 0.338
Best Epoch: 7	Best Val F1: 0.359

****************************** Epoch: 11 ******************************
Batch: 1/231	Loss: 0.189
Batch: 24/231	Loss: 0.103
Batch: 47/231	Loss: 0.079
Batch: 70/231	Loss: 0.229
Batch: 93/231	Loss: 0.363
Batch: 116/231	Loss: 0.125
Batch: 139/231	Loss: 0.285
Batch: 162/231	Loss: 0.230
Batch: 185/231	Loss: 0.159
Batch: 208/231	Loss: 0.202
Batch: 231/231	Loss: 0.060
Epoch: 11	Train Loss: 0.248	Val F1: 0.344
Best Epoch: 7	Best Val F1: 0.359

****************************** Epoch: 12 ******************************
Batch: 1/231	Loss: 0.193
Batch: 24/231	Loss: 0.433
Batch: 47/231	Loss: 0.100
Batch: 70/231	Loss: 0.260
Batch: 93/231	Loss: 0.303
Batch: 116/231	Loss: 0.152
Batch: 139/231	Loss: 0.169
Batch: 162/231	Loss: 0.199
Batch: 185/231	Loss: 0.106
Batch: 208/231	Loss: 0.178
Batch: 231/231	Loss: 0.018
Epoch: 12	Train Loss: 0.205	Val F1: 0.342
Best Epoch: 7	Best Val F1: 0.359

Saving the best checkpoint....
Inference...
Test F1: 0.386	Test F1_Few: 0.396	Test F1_Zero: 0.375
Starting training with config: {'batch_size': 32, 'epochs': 75, 'l2_reg': 0.0008624540746231739, 'lr': 2.5891167441457824e-05, 'n_layers_freeze': 3, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 1.017
Batch: 11/58	Loss: 0.944
Batch: 16/58	Loss: 0.878
Batch: 21/58	Loss: 0.892
Batch: 26/58	Loss: 0.882
Batch: 31/58	Loss: 0.848
Batch: 36/58	Loss: 0.877
Batch: 41/58	Loss: 0.821
Batch: 46/58	Loss: 0.801
Batch: 51/58	Loss: 0.788
Batch: 56/58	Loss: 0.796
Batch: 58/58	Loss: 0.803
Epoch: 1	Train Loss: 0.887	Val F1: 0.188
Best Epoch: 1	Best Val F1: 0.188

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.813
Batch: 6/58	Loss: 0.825
Batch: 11/58	Loss: 0.826
Batch: 16/58	Loss: 0.754
Batch: 21/58	Loss: 0.757
Batch: 26/58	Loss: 0.756
Batch: 31/58	Loss: 0.812
Batch: 36/58	Loss: 0.789
Batch: 41/58	Loss: 0.735
Batch: 46/58	Loss: 0.750
Batch: 51/58	Loss: 0.748
Batch: 56/58	Loss: 0.743
Batch: 58/58	Loss: 0.719
Epoch: 2	Train Loss: 0.777	Val F1: 0.339
Best Epoch: 2	Best Val F1: 0.339

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.691
Batch: 6/58	Loss: 0.653
Batch: 11/58	Loss: 0.772
Batch: 16/58	Loss: 0.683
Batch: 21/58	Loss: 0.687
Batch: 26/58	Loss: 0.667
Batch: 31/58	Loss: 0.896
Batch: 36/58	Loss: 0.753
Batch: 41/58	Loss: 0.610
Batch: 46/58	Loss: 0.642
Batch: 51/58	Loss: 0.735
Batch: 56/58	Loss: 0.784
Batch: 58/58	Loss: 0.734
Epoch: 3	Train Loss: 0.709	Val F1: 0.332
Best Epoch: 2	Best Val F1: 0.339

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.698
Batch: 6/58	Loss: 0.643
Batch: 11/58	Loss: 0.626
Batch: 16/58	Loss: 0.608
Batch: 21/58	Loss: 0.468
Batch: 26/58	Loss: 0.562
Batch: 31/58	Loss: 0.570
Batch: 36/58	Loss: 0.758
Batch: 41/58	Loss: 0.718
Batch: 46/58	Loss: 0.610
Batch: 51/58	Loss: 0.520
Batch: 56/58	Loss: 0.503
Batch: 58/58	Loss: 0.544
Epoch: 4	Train Loss: 0.656	Val F1: 0.334
Best Epoch: 2	Best Val F1: 0.339

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.571
Batch: 6/58	Loss: 0.552
Batch: 11/58	Loss: 0.578
Batch: 16/58	Loss: 0.573
Batch: 21/58	Loss: 0.475
Batch: 26/58	Loss: 0.501
Batch: 31/58	Loss: 0.724
Batch: 36/58	Loss: 0.681
Batch: 41/58	Loss: 0.596
Batch: 46/58	Loss: 0.653
Batch: 51/58	Loss: 0.820
Batch: 56/58	Loss: 0.668
Batch: 58/58	Loss: 0.741
Epoch: 5	Train Loss: 0.607	Val F1: 0.362
Best Epoch: 5	Best Val F1: 0.362

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.526
Batch: 6/58	Loss: 0.691
Batch: 11/58	Loss: 0.562
Batch: 16/58	Loss: 0.628
Batch: 21/58	Loss: 0.604
Batch: 26/58	Loss: 0.425
Batch: 31/58	Loss: 0.520
Batch: 36/58	Loss: 0.388
Batch: 41/58	Loss: 0.486
Batch: 46/58	Loss: 0.541
Batch: 51/58	Loss: 0.487
Batch: 56/58	Loss: 0.596
Batch: 58/58	Loss: 0.472
Epoch: 6	Train Loss: 0.549	Val F1: 0.343
Best Epoch: 5	Best Val F1: 0.362

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.382
Batch: 6/58	Loss: 0.594
Batch: 11/58	Loss: 0.572
Batch: 16/58	Loss: 0.436
Batch: 21/58	Loss: 0.544
Batch: 26/58	Loss: 0.471
Batch: 31/58	Loss: 0.464
Batch: 36/58	Loss: 0.464
Batch: 41/58	Loss: 0.511
Batch: 46/58	Loss: 0.442
Batch: 51/58	Loss: 0.457
Batch: 56/58	Loss: 0.516
Batch: 58/58	Loss: 0.321
Epoch: 7	Train Loss: 0.491	Val F1: 0.367
Best Epoch: 7	Best Val F1: 0.367

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.463
Batch: 6/58	Loss: 0.437
Batch: 11/58	Loss: 0.392
Batch: 16/58	Loss: 0.405
Batch: 21/58	Loss: 0.397
Batch: 26/58	Loss: 0.356
Batch: 31/58	Loss: 0.388
Batch: 36/58	Loss: 0.345
Batch: 41/58	Loss: 0.443
Batch: 46/58	Loss: 0.507
Batch: 51/58	Loss: 0.412
Batch: 56/58	Loss: 0.432
Batch: 58/58	Loss: 0.587
Epoch: 8	Train Loss: 0.454	Val F1: 0.332
Best Epoch: 7	Best Val F1: 0.367

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.597
Batch: 6/58	Loss: 0.521
Batch: 11/58	Loss: 0.485
Batch: 16/58	Loss: 0.329
Batch: 21/58	Loss: 0.333
Batch: 26/58	Loss: 0.341
Batch: 31/58	Loss: 0.336
Batch: 36/58	Loss: 0.367
Batch: 41/58	Loss: 0.459
Batch: 46/58	Loss: 0.350
Batch: 51/58	Loss: 0.536
Batch: 56/58	Loss: 0.310
Batch: 58/58	Loss: 0.354
Epoch: 9	Train Loss: 0.397	Val F1: 0.353
Best Epoch: 7	Best Val F1: 0.367

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.337
Batch: 6/58	Loss: 0.333
Batch: 11/58	Loss: 0.422
Batch: 16/58	Loss: 0.437
Batch: 21/58	Loss: 0.299
Batch: 26/58	Loss: 0.390
Batch: 31/58	Loss: 0.278
Batch: 36/58	Loss: 0.559
Batch: 41/58	Loss: 0.438
Batch: 46/58	Loss: 0.443
Batch: 51/58	Loss: 0.345
Batch: 56/58	Loss: 0.284
Batch: 58/58	Loss: 0.454
Epoch: 10	Train Loss: 0.355	Val F1: 0.345
Best Epoch: 7	Best Val F1: 0.367

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.319
Batch: 6/58	Loss: 0.304
Batch: 11/58	Loss: 0.220
Batch: 16/58	Loss: 0.331
Batch: 21/58	Loss: 0.373
Batch: 26/58	Loss: 0.333
Batch: 31/58	Loss: 0.307
Batch: 36/58	Loss: 0.359
Batch: 41/58	Loss: 0.244
Batch: 46/58	Loss: 0.288
Batch: 51/58	Loss: 0.364
Batch: 56/58	Loss: 0.365
Batch: 58/58	Loss: 0.362
Epoch: 11	Train Loss: 0.324	Val F1: 0.352
Best Epoch: 7	Best Val F1: 0.367

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.353
Batch: 6/58	Loss: 0.234
Batch: 11/58	Loss: 0.301
Batch: 16/58	Loss: 0.305
Batch: 21/58	Loss: 0.363
Batch: 26/58	Loss: 0.264
Batch: 31/58	Loss: 0.386
Batch: 36/58	Loss: 0.330
Batch: 41/58	Loss: 0.276
Batch: 46/58	Loss: 0.267
Batch: 51/58	Loss: 0.454
Batch: 56/58	Loss: 0.224
Batch: 58/58	Loss: 0.153
Epoch: 12	Train Loss: 0.300	Val F1: 0.348
Best Epoch: 7	Best Val F1: 0.367

Saving the best checkpoint....
Inference...
Test F1: 0.352	Test F1_Few: 0.414	Test F1_Zero: 0.353
Starting training with config: {'batch_size': 32, 'epochs': 50, 'l2_reg': 0.0009704631825898404, 'lr': 1.0115489171548183e-05, 'n_layers_freeze': 0, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 1.064
Batch: 11/58	Loss: 1.023
Batch: 16/58	Loss: 0.979
Batch: 21/58	Loss: 0.964
Batch: 26/58	Loss: 0.949
Batch: 31/58	Loss: 0.921
Batch: 36/58	Loss: 0.935
Batch: 41/58	Loss: 0.892
Batch: 46/58	Loss: 0.876
Batch: 51/58	Loss: 0.864
Batch: 56/58	Loss: 0.865
Batch: 58/58	Loss: 0.869
Epoch: 1	Train Loss: 0.951	Val F1: 0.193
Best Epoch: 1	Best Val F1: 0.193

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.873
Batch: 6/58	Loss: 0.877
Batch: 11/58	Loss: 0.878
Batch: 16/58	Loss: 0.831
Batch: 21/58	Loss: 0.826
Batch: 26/58	Loss: 0.829
Batch: 31/58	Loss: 0.858
Batch: 36/58	Loss: 0.855
Batch: 41/58	Loss: 0.817
Batch: 46/58	Loss: 0.812
Batch: 51/58	Loss: 0.812
Batch: 56/58	Loss: 0.814
Batch: 58/58	Loss: 0.795
Epoch: 2	Train Loss: 0.841	Val F1: 0.230
Best Epoch: 2	Best Val F1: 0.230

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.802
Batch: 6/58	Loss: 0.784
Batch: 11/58	Loss: 0.835
Batch: 16/58	Loss: 0.802
Batch: 21/58	Loss: 0.791
Batch: 26/58	Loss: 0.809
Batch: 31/58	Loss: 0.889
Batch: 36/58	Loss: 0.801
Batch: 41/58	Loss: 0.767
Batch: 46/58	Loss: 0.758
Batch: 51/58	Loss: 0.788
Batch: 56/58	Loss: 0.769
Batch: 58/58	Loss: 0.787
Epoch: 3	Train Loss: 0.800	Val F1: 0.301
Best Epoch: 3	Best Val F1: 0.301

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.779
Batch: 6/58	Loss: 0.763
Batch: 11/58	Loss: 0.757
Batch: 16/58	Loss: 0.730
Batch: 21/58	Loss: 0.672
Batch: 26/58	Loss: 0.691
Batch: 31/58	Loss: 0.709
Batch: 36/58	Loss: 0.783
Batch: 41/58	Loss: 0.759
Batch: 46/58	Loss: 0.714
Batch: 51/58	Loss: 0.742
Batch: 56/58	Loss: 0.725
Batch: 58/58	Loss: 0.725
Epoch: 4	Train Loss: 0.746	Val F1: 0.339
Best Epoch: 4	Best Val F1: 0.339

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.667
Batch: 6/58	Loss: 0.668
Batch: 11/58	Loss: 0.685
Batch: 16/58	Loss: 0.657
Batch: 21/58	Loss: 0.606
Batch: 26/58	Loss: 0.678
Batch: 31/58	Loss: 0.772
Batch: 36/58	Loss: 0.720
Batch: 41/58	Loss: 0.678
Batch: 46/58	Loss: 0.678
Batch: 51/58	Loss: 0.796
Batch: 56/58	Loss: 0.730
Batch: 58/58	Loss: 0.799
Epoch: 5	Train Loss: 0.696	Val F1: 0.339
Best Epoch: 4	Best Val F1: 0.339

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.649
Batch: 6/58	Loss: 0.736
Batch: 11/58	Loss: 0.696
Batch: 16/58	Loss: 0.645
Batch: 21/58	Loss: 0.648
Batch: 26/58	Loss: 0.595
Batch: 31/58	Loss: 0.632
Batch: 36/58	Loss: 0.570
Batch: 41/58	Loss: 0.631
Batch: 46/58	Loss: 0.618
Batch: 51/58	Loss: 0.604
Batch: 56/58	Loss: 0.633
Batch: 58/58	Loss: 0.531
Epoch: 6	Train Loss: 0.648	Val F1: 0.325
Best Epoch: 4	Best Val F1: 0.339

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.524
Batch: 6/58	Loss: 0.664
Batch: 11/58	Loss: 0.767
Batch: 16/58	Loss: 0.511
Batch: 21/58	Loss: 0.531
Batch: 26/58	Loss: 0.617
Batch: 31/58	Loss: 0.616
Batch: 36/58	Loss: 0.587
Batch: 41/58	Loss: 0.545
Batch: 46/58	Loss: 0.616
Batch: 51/58	Loss: 0.553
Batch: 56/58	Loss: 0.627
Batch: 58/58	Loss: 0.463
Epoch: 7	Train Loss: 0.592	Val F1: 0.359
Best Epoch: 7	Best Val F1: 0.359

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.518
Batch: 6/58	Loss: 0.551
Batch: 11/58	Loss: 0.486
Batch: 16/58	Loss: 0.491
Batch: 21/58	Loss: 0.575
Batch: 26/58	Loss: 0.420
Batch: 31/58	Loss: 0.538
Batch: 36/58	Loss: 0.465
Batch: 41/58	Loss: 0.581
Batch: 46/58	Loss: 0.610
Batch: 51/58	Loss: 0.497
Batch: 56/58	Loss: 0.505
Batch: 58/58	Loss: 0.641
Epoch: 8	Train Loss: 0.544	Val F1: 0.365
Best Epoch: 8	Best Val F1: 0.365

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.526
Batch: 6/58	Loss: 0.606
Batch: 11/58	Loss: 0.538
Batch: 16/58	Loss: 0.397
Batch: 21/58	Loss: 0.411
Batch: 26/58	Loss: 0.452
Batch: 31/58	Loss: 0.482
Batch: 36/58	Loss: 0.483
Batch: 41/58	Loss: 0.596
Batch: 46/58	Loss: 0.500
Batch: 51/58	Loss: 0.573
Batch: 56/58	Loss: 0.415
Batch: 58/58	Loss: 0.430
Epoch: 9	Train Loss: 0.501	Val F1: 0.357
Best Epoch: 8	Best Val F1: 0.365

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.400
Batch: 6/58	Loss: 0.449
Batch: 11/58	Loss: 0.451
Batch: 16/58	Loss: 0.525
Batch: 21/58	Loss: 0.337
Batch: 26/58	Loss: 0.493
Batch: 31/58	Loss: 0.337
Batch: 36/58	Loss: 0.726
Batch: 41/58	Loss: 0.592
Batch: 46/58	Loss: 0.518
Batch: 51/58	Loss: 0.382
Batch: 56/58	Loss: 0.385
Batch: 58/58	Loss: 0.639
Epoch: 10	Train Loss: 0.460	Val F1: 0.368
Best Epoch: 10	Best Val F1: 0.368

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.420
Batch: 6/58	Loss: 0.457
Batch: 11/58	Loss: 0.315
Batch: 16/58	Loss: 0.501
Batch: 21/58	Loss: 0.434
Batch: 26/58	Loss: 0.516
Batch: 31/58	Loss: 0.466
Batch: 36/58	Loss: 0.451
Batch: 41/58	Loss: 0.415
Batch: 46/58	Loss: 0.342
Batch: 51/58	Loss: 0.438
Batch: 56/58	Loss: 0.440
Batch: 58/58	Loss: 0.392
Epoch: 11	Train Loss: 0.419	Val F1: 0.367
Best Epoch: 10	Best Val F1: 0.368

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.458
Batch: 6/58	Loss: 0.318
Batch: 11/58	Loss: 0.367
Batch: 16/58	Loss: 0.414
Batch: 21/58	Loss: 0.462
Batch: 26/58	Loss: 0.367
Batch: 31/58	Loss: 0.447
Batch: 36/58	Loss: 0.432
Batch: 41/58	Loss: 0.350
Batch: 46/58	Loss: 0.461
Batch: 51/58	Loss: 0.478
Batch: 56/58	Loss: 0.391
Batch: 58/58	Loss: 0.207
Epoch: 12	Train Loss: 0.405	Val F1: 0.361
Best Epoch: 10	Best Val F1: 0.368

****************************** Epoch: 13 ******************************
Batch: 1/58	Loss: 0.450
Batch: 6/58	Loss: 0.295
Batch: 11/58	Loss: 0.462
Batch: 16/58	Loss: 0.290
Batch: 21/58	Loss: 0.372
Batch: 26/58	Loss: 0.405
Batch: 31/58	Loss: 0.355
Batch: 36/58	Loss: 0.413
Batch: 41/58	Loss: 0.304
Batch: 46/58	Loss: 0.430
Batch: 51/58	Loss: 0.387
Batch: 56/58	Loss: 0.432
Batch: 58/58	Loss: 0.335
Epoch: 13	Train Loss: 0.387	Val F1: 0.352
Best Epoch: 10	Best Val F1: 0.368

****************************** Epoch: 14 ******************************
Batch: 1/58	Loss: 0.418
Batch: 6/58	Loss: 0.460
Batch: 11/58	Loss: 0.397
Batch: 16/58	Loss: 0.436
Batch: 21/58	Loss: 0.333
Batch: 26/58	Loss: 0.393
Batch: 31/58	Loss: 0.323
Batch: 36/58	Loss: 0.297
Batch: 41/58	Loss: 0.305
Batch: 46/58	Loss: 0.312
Batch: 51/58	Loss: 0.434
Batch: 56/58	Loss: 0.282
Batch: 58/58	Loss: 0.369
Epoch: 14	Train Loss: 0.366	Val F1: 0.362
Best Epoch: 10	Best Val F1: 0.368

****************************** Epoch: 15 ******************************
Batch: 1/58	Loss: 0.269
Batch: 6/58	Loss: 0.374
Batch: 11/58	Loss: 0.336
Batch: 16/58	Loss: 0.318
Batch: 21/58	Loss: 0.394
Batch: 26/58	Loss: 0.312
Batch: 31/58	Loss: 0.306
Batch: 36/58	Loss: 0.361
Batch: 41/58	Loss: 0.403
Batch: 46/58	Loss: 0.259
Batch: 51/58	Loss: 0.244
Batch: 56/58	Loss: 0.269
Batch: 58/58	Loss: 0.495
Epoch: 15	Train Loss: 0.343	Val F1: 0.359
Best Epoch: 10	Best Val F1: 0.368

****************************** Epoch: 16 ******************************
Batch: 1/58	Loss: 0.329
Batch: 6/58	Loss: 0.238
Batch: 11/58	Loss: 0.206
Batch: 16/58	Loss: 0.354
Batch: 21/58	Loss: 0.250
Batch: 26/58	Loss: 0.309
Batch: 31/58	Loss: 0.362
Batch: 36/58	Loss: 0.251
Batch: 41/58	Loss: 0.234
Batch: 46/58	Loss: 0.326
Batch: 51/58	Loss: 0.388
Batch: 56/58	Loss: 0.303
Batch: 58/58	Loss: 0.281
Epoch: 16	Train Loss: 0.332	Val F1: 0.350
Best Epoch: 10	Best Val F1: 0.368

****************************** Epoch: 17 ******************************
Batch: 1/58	Loss: 0.255
Batch: 6/58	Loss: 0.367
Batch: 11/58	Loss: 0.263
Batch: 16/58	Loss: 0.313
Batch: 21/58	Loss: 0.392
Batch: 26/58	Loss: 0.382
Batch: 31/58	Loss: 0.269
Batch: 36/58	Loss: 0.287
Batch: 41/58	Loss: 0.332
Batch: 46/58	Loss: 0.409
Batch: 51/58	Loss: 0.304
Batch: 56/58	Loss: 0.265
Batch: 58/58	Loss: 0.336
Epoch: 17	Train Loss: 0.314	Val F1: 0.356
Best Epoch: 10	Best Val F1: 0.368

****************************** Epoch: 18 ******************************
Batch: 1/58	Loss: 0.363
Batch: 6/58	Loss: 0.333
Batch: 11/58	Loss: 0.317
Batch: 16/58	Loss: 0.392
Batch: 21/58	Loss: 0.314
Batch: 26/58	Loss: 0.297
Batch: 31/58	Loss: 0.227
Batch: 36/58	Loss: 0.247
Batch: 41/58	Loss: 0.271
Batch: 46/58	Loss: 0.407
Batch: 51/58	Loss: 0.246
Batch: 56/58	Loss: 0.296
Batch: 58/58	Loss: 0.499
Epoch: 18	Train Loss: 0.307	Val F1: 0.358
Best Epoch: 10	Best Val F1: 0.368

****************************** Epoch: 19 ******************************
Batch: 1/58	Loss: 0.266
Batch: 6/58	Loss: 0.280
Batch: 11/58	Loss: 0.329
Batch: 16/58	Loss: 0.146
Batch: 21/58	Loss: 0.430
Batch: 26/58	Loss: 0.352
Batch: 31/58	Loss: 0.230
Batch: 36/58	Loss: 0.232
Batch: 41/58	Loss: 0.246
Batch: 46/58	Loss: 0.354
Batch: 51/58	Loss: 0.388
Batch: 56/58	Loss: 0.283
Batch: 58/58	Loss: 0.213
Epoch: 19	Train Loss: 0.299	Val F1: 0.364
Best Epoch: 10	Best Val F1: 0.368

****************************** Epoch: 20 ******************************
Batch: 1/58	Loss: 0.319
Batch: 6/58	Loss: 0.243
Batch: 11/58	Loss: 0.219
Batch: 16/58	Loss: 0.260
Batch: 21/58	Loss: 0.277
Batch: 26/58	Loss: 0.284
Batch: 31/58	Loss: 0.310
Batch: 36/58	Loss: 0.206
Batch: 41/58	Loss: 0.217
Batch: 46/58	Loss: 0.358
Batch: 51/58	Loss: 0.282
Batch: 56/58	Loss: 0.186
Batch: 58/58	Loss: 0.445
Epoch: 20	Train Loss: 0.279	Val F1: 0.363
Best Epoch: 10	Best Val F1: 0.368

****************************** Epoch: 21 ******************************
Batch: 1/58	Loss: 0.306
Batch: 6/58	Loss: 0.211
Batch: 11/58	Loss: 0.248
Batch: 16/58	Loss: 0.230
Batch: 21/58	Loss: 0.206
Batch: 26/58	Loss: 0.242
Batch: 31/58	Loss: 0.152
Batch: 36/58	Loss: 0.363
Batch: 41/58	Loss: 0.268
Batch: 46/58	Loss: 0.174
Batch: 51/58	Loss: 0.148
Batch: 56/58	Loss: 0.131
Batch: 58/58	Loss: 0.184
Epoch: 21	Train Loss: 0.263	Val F1: 0.354
Best Epoch: 10	Best Val F1: 0.368

****************************** Epoch: 22 ******************************
Batch: 1/58	Loss: 0.311
Batch: 6/58	Loss: 0.186
Batch: 11/58	Loss: 0.240
Batch: 16/58	Loss: 0.154
Batch: 21/58	Loss: 0.271
Batch: 26/58	Loss: 0.204
Batch: 31/58	Loss: 0.215
Batch: 36/58	Loss: 0.251
Batch: 41/58	Loss: 0.324
Batch: 46/58	Loss: 0.243
Batch: 51/58	Loss: 0.151
Batch: 56/58	Loss: 0.242
Batch: 58/58	Loss: 0.295
Epoch: 22	Train Loss: 0.253	Val F1: 0.358
Best Epoch: 10	Best Val F1: 0.368

****************************** Epoch: 23 ******************************
Batch: 1/58	Loss: 0.232
Batch: 6/58	Loss: 0.197
Batch: 11/58	Loss: 0.209
Batch: 16/58	Loss: 0.314
Batch: 21/58	Loss: 0.194
Batch: 26/58	Loss: 0.228
Batch: 31/58	Loss: 0.174
Batch: 36/58	Loss: 0.242
Batch: 41/58	Loss: 0.174
Batch: 46/58	Loss: 0.228
Batch: 51/58	Loss: 0.117
Batch: 56/58	Loss: 0.201
Batch: 58/58	Loss: 0.153
Epoch: 23	Train Loss: 0.233	Val F1: 0.347
Best Epoch: 10	Best Val F1: 0.368

****************************** Epoch: 24 ******************************
Batch: 1/58	Loss: 0.196
Batch: 6/58	Loss: 0.283
Batch: 11/58	Loss: 0.222
Batch: 16/58	Loss: 0.293
Batch: 21/58	Loss: 0.260
Batch: 26/58	Loss: 0.149
Batch: 31/58	Loss: 0.240
Batch: 36/58	Loss: 0.238
Batch: 41/58	Loss: 0.151
Batch: 46/58	Loss: 0.177
Batch: 51/58	Loss: 0.208
Batch: 56/58	Loss: 0.224
Batch: 58/58	Loss: 0.252
Epoch: 24	Train Loss: 0.227	Val F1: 0.353
Best Epoch: 10	Best Val F1: 0.368

****************************** Epoch: 25 ******************************
Batch: 1/58	Loss: 0.237
Batch: 6/58	Loss: 0.332
Batch: 11/58	Loss: 0.231
Batch: 16/58	Loss: 0.165
Batch: 21/58	Loss: 0.153
Batch: 26/58	Loss: 0.198
Batch: 31/58	Loss: 0.197
Batch: 36/58	Loss: 0.135
Batch: 41/58	Loss: 0.223
Batch: 46/58	Loss: 0.214
Batch: 51/58	Loss: 0.174
Batch: 56/58	Loss: 0.264
Batch: 58/58	Loss: 0.153
Epoch: 25	Train Loss: 0.210	Val F1: 0.344
Best Epoch: 10	Best Val F1: 0.368

Saving the best checkpoint....
Inference...
Test F1: 0.377	Test F1_Few: 0.450	Test F1_Zero: 0.370
Starting training with config: {'batch_size': 16, 'epochs': 75, 'l2_reg': 0.0008695735579899172, 'lr': 2.106679601285374e-05, 'n_layers_freeze': 0, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/116	Loss: 1.096
Batch: 12/116	Loss: 0.972
Batch: 23/116	Loss: 0.906
Batch: 34/116	Loss: 0.886
Batch: 45/116	Loss: 0.846
Batch: 56/116	Loss: 0.843
Batch: 67/116	Loss: 0.788
Batch: 78/116	Loss: 0.794
Batch: 89/116	Loss: 0.877
Batch: 100/116	Loss: 0.760
Batch: 111/116	Loss: 0.789
Batch: 116/116	Loss: 0.755
Epoch: 1	Train Loss: 0.854	Val F1: 0.263
Best Epoch: 1	Best Val F1: 0.263

****************************** Epoch: 2 ******************************
Batch: 1/116	Loss: 0.827
Batch: 12/116	Loss: 0.785
Batch: 23/116	Loss: 0.717
Batch: 34/116	Loss: 0.734
Batch: 45/116	Loss: 0.787
Batch: 56/116	Loss: 0.715
Batch: 67/116	Loss: 0.735
Batch: 78/116	Loss: 0.721
Batch: 89/116	Loss: 0.688
Batch: 100/116	Loss: 0.676
Batch: 111/116	Loss: 0.718
Batch: 116/116	Loss: 0.658
Epoch: 2	Train Loss: 0.747	Val F1: 0.291
Best Epoch: 2	Best Val F1: 0.291

****************************** Epoch: 3 ******************************
Batch: 1/116	Loss: 0.660
Batch: 12/116	Loss: 0.558
Batch: 23/116	Loss: 0.697
Batch: 34/116	Loss: 0.742
Batch: 45/116	Loss: 0.716
Batch: 56/116	Loss: 0.685
Batch: 67/116	Loss: 0.611
Batch: 78/116	Loss: 0.646
Batch: 89/116	Loss: 0.680
Batch: 100/116	Loss: 0.804
Batch: 111/116	Loss: 0.760
Batch: 116/116	Loss: 0.714
Epoch: 3	Train Loss: 0.697	Val F1: 0.322
Best Epoch: 3	Best Val F1: 0.322

****************************** Epoch: 4 ******************************
Batch: 1/116	Loss: 0.712
Batch: 12/116	Loss: 0.546
Batch: 23/116	Loss: 0.919
Batch: 34/116	Loss: 0.598
Batch: 45/116	Loss: 0.754
Batch: 56/116	Loss: 0.610
Batch: 67/116	Loss: 0.738
Batch: 78/116	Loss: 0.586
Batch: 89/116	Loss: 0.705
Batch: 100/116	Loss: 0.582
Batch: 111/116	Loss: 0.680
Batch: 116/116	Loss: 0.819
Epoch: 4	Train Loss: 0.657	Val F1: 0.305
Best Epoch: 3	Best Val F1: 0.322

****************************** Epoch: 5 ******************************
Batch: 1/116	Loss: 0.416
Batch: 12/116	Loss: 0.605
Batch: 23/116	Loss: 0.622
Batch: 34/116	Loss: 0.611
Batch: 45/116	Loss: 0.709
Batch: 56/116	Loss: 0.633
Batch: 67/116	Loss: 0.523
Batch: 78/116	Loss: 0.657
Batch: 89/116	Loss: 0.761
Batch: 100/116	Loss: 0.670
Batch: 111/116	Loss: 0.608
Batch: 116/116	Loss: 0.466
Epoch: 5	Train Loss: 0.611	Val F1: 0.336
Best Epoch: 5	Best Val F1: 0.336

****************************** Epoch: 6 ******************************
Batch: 1/116	Loss: 0.504
Batch: 12/116	Loss: 0.797
Batch: 23/116	Loss: 0.694
Batch: 34/116	Loss: 0.623
Batch: 45/116	Loss: 0.543
Batch: 56/116	Loss: 0.581
Batch: 67/116	Loss: 0.568
Batch: 78/116	Loss: 0.682
Batch: 89/116	Loss: 0.855
Batch: 100/116	Loss: 0.648
Batch: 111/116	Loss: 0.585
Batch: 116/116	Loss: 0.475
Epoch: 6	Train Loss: 0.549	Val F1: 0.356
Best Epoch: 6	Best Val F1: 0.356

****************************** Epoch: 7 ******************************
Batch: 1/116	Loss: 0.404
Batch: 12/116	Loss: 0.723
Batch: 23/116	Loss: 0.669
Batch: 34/116	Loss: 0.661
Batch: 45/116	Loss: 0.327
Batch: 56/116	Loss: 0.773
Batch: 67/116	Loss: 0.469
Batch: 78/116	Loss: 0.590
Batch: 89/116	Loss: 0.369
Batch: 100/116	Loss: 0.428
Batch: 111/116	Loss: 0.760
Batch: 116/116	Loss: 0.253
Epoch: 7	Train Loss: 0.487	Val F1: 0.337
Best Epoch: 6	Best Val F1: 0.356

****************************** Epoch: 8 ******************************
Batch: 1/116	Loss: 0.483
Batch: 12/116	Loss: 0.595
Batch: 23/116	Loss: 0.300
Batch: 34/116	Loss: 0.357
Batch: 45/116	Loss: 0.304
Batch: 56/116	Loss: 0.271
Batch: 67/116	Loss: 0.762
Batch: 78/116	Loss: 0.308
Batch: 89/116	Loss: 0.294
Batch: 100/116	Loss: 0.447
Batch: 111/116	Loss: 0.326
Batch: 116/116	Loss: 0.369
Epoch: 8	Train Loss: 0.419	Val F1: 0.335
Best Epoch: 6	Best Val F1: 0.356

****************************** Epoch: 9 ******************************
Batch: 1/116	Loss: 0.324
Batch: 12/116	Loss: 0.396
Batch: 23/116	Loss: 0.329
Batch: 34/116	Loss: 0.413
Batch: 45/116	Loss: 0.385
Batch: 56/116	Loss: 0.425
Batch: 67/116	Loss: 0.295
Batch: 78/116	Loss: 0.497
Batch: 89/116	Loss: 0.294
Batch: 100/116	Loss: 0.366
Batch: 111/116	Loss: 0.295
Batch: 116/116	Loss: 0.493
Epoch: 9	Train Loss: 0.365	Val F1: 0.343
Best Epoch: 6	Best Val F1: 0.356

****************************** Epoch: 10 ******************************
Batch: 1/116	Loss: 0.344
Batch: 12/116	Loss: 0.372
Batch: 23/116	Loss: 0.235
Batch: 34/116	Loss: 0.390
Batch: 45/116	Loss: 0.182
Batch: 56/116	Loss: 0.421
Batch: 67/116	Loss: 0.427
Batch: 78/116	Loss: 0.256
Batch: 89/116	Loss: 0.239
Batch: 100/116	Loss: 0.350
Batch: 111/116	Loss: 0.203
Batch: 116/116	Loss: 0.230
Epoch: 10	Train Loss: 0.332	Val F1: 0.342
Best Epoch: 6	Best Val F1: 0.356

****************************** Epoch: 11 ******************************
Batch: 1/116	Loss: 0.363
Batch: 12/116	Loss: 0.261
Batch: 23/116	Loss: 0.166
Batch: 34/116	Loss: 0.222
Batch: 45/116	Loss: 0.385
Batch: 56/116	Loss: 0.285
Batch: 67/116	Loss: 0.324
Batch: 78/116	Loss: 0.209
Batch: 89/116	Loss: 0.245
Batch: 100/116	Loss: 0.274
Batch: 111/116	Loss: 0.378
Batch: 116/116	Loss: 0.145
Epoch: 11	Train Loss: 0.308	Val F1: 0.331
Best Epoch: 6	Best Val F1: 0.356

Saving the best checkpoint....
Inference...
Test F1: 0.384	Test F1_Few: 0.458	Test F1_Zero: 0.381
Starting training with config: {'batch_size': 8, 'epochs': 25, 'l2_reg': 0.0001134647211499672, 'lr': 9.422859014362302e-05, 'n_layers_freeze': 7, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/231	Loss: 1.080
Batch: 24/231	Loss: 0.799
Batch: 47/231	Loss: 0.737
Batch: 70/231	Loss: 0.756
Batch: 93/231	Loss: 0.714
Batch: 116/231	Loss: 0.803
Batch: 139/231	Loss: 0.812
Batch: 162/231	Loss: 0.943
Batch: 185/231	Loss: 0.715
Batch: 208/231	Loss: 0.720
Batch: 231/231	Loss: 0.701
Epoch: 1	Train Loss: 0.784	Val F1: 0.180
Best Epoch: 1	Best Val F1: 0.180

****************************** Epoch: 2 ******************************
Batch: 1/231	Loss: 0.725
Batch: 24/231	Loss: 0.781
Batch: 47/231	Loss: 0.712
Batch: 70/231	Loss: 1.110
Batch: 93/231	Loss: 0.716
Batch: 116/231	Loss: 0.744
Batch: 139/231	Loss: 1.042
Batch: 162/231	Loss: 0.661
Batch: 185/231	Loss: 0.732
Batch: 208/231	Loss: 0.809
Batch: 231/231	Loss: 0.729
Epoch: 2	Train Loss: 0.763	Val F1: 0.187
Best Epoch: 2	Best Val F1: 0.187

****************************** Epoch: 3 ******************************
Batch: 1/231	Loss: 0.699
Batch: 24/231	Loss: 0.694
Batch: 47/231	Loss: 0.804
Batch: 70/231	Loss: 0.758
Batch: 93/231	Loss: 0.688
Batch: 116/231	Loss: 0.724
Batch: 139/231	Loss: 0.766
Batch: 162/231	Loss: 0.662
Batch: 185/231	Loss: 0.650
Batch: 208/231	Loss: 0.823
Batch: 231/231	Loss: 0.725
Epoch: 3	Train Loss: 0.768	Val F1: 0.185
Best Epoch: 2	Best Val F1: 0.187

****************************** Epoch: 4 ******************************
Batch: 1/231	Loss: 0.831
Batch: 24/231	Loss: 0.690
Batch: 47/231	Loss: 0.701
Batch: 70/231	Loss: 0.815
Batch: 93/231	Loss: 0.830
Batch: 116/231	Loss: 0.718
Batch: 139/231	Loss: 1.310
Batch: 162/231	Loss: 0.822
Batch: 185/231	Loss: 0.719
Batch: 208/231	Loss: 0.737
Batch: 231/231	Loss: 0.879
Epoch: 4	Train Loss: 0.766	Val F1: 0.187
Best Epoch: 2	Best Val F1: 0.187

****************************** Epoch: 5 ******************************
Batch: 1/231	Loss: 0.735
Batch: 24/231	Loss: 0.707
Batch: 47/231	Loss: 0.946
Batch: 70/231	Loss: 0.692
Batch: 93/231	Loss: 0.684
Batch: 116/231	Loss: 0.729
Batch: 139/231	Loss: 0.900
Batch: 162/231	Loss: 0.750
Batch: 185/231	Loss: 0.880
Batch: 208/231	Loss: 0.731
Batch: 231/231	Loss: 0.731
Epoch: 5	Train Loss: 0.767	Val F1: 0.185
Best Epoch: 2	Best Val F1: 0.187

****************************** Epoch: 6 ******************************
Batch: 1/231	Loss: 0.684
Batch: 24/231	Loss: 1.005
Batch: 47/231	Loss: 0.721
Batch: 70/231	Loss: 0.716
Batch: 93/231	Loss: 0.709
Batch: 116/231	Loss: 0.712
Batch: 139/231	Loss: 0.935
Batch: 162/231	Loss: 0.821
Batch: 185/231	Loss: 0.914
Batch: 208/231	Loss: 1.009
Batch: 231/231	Loss: 0.666
Epoch: 6	Train Loss: 0.765	Val F1: 0.185
Best Epoch: 2	Best Val F1: 0.187

****************************** Epoch: 7 ******************************
Batch: 1/231	Loss: 0.700
Batch: 24/231	Loss: 0.778
Batch: 47/231	Loss: 0.732
Batch: 70/231	Loss: 0.711
Batch: 93/231	Loss: 0.686
Batch: 116/231	Loss: 0.716
Batch: 139/231	Loss: 0.718
Batch: 162/231	Loss: 0.717
Batch: 185/231	Loss: 0.706
Batch: 208/231	Loss: 0.877
Batch: 231/231	Loss: 0.694
Epoch: 7	Train Loss: 0.765	Val F1: 0.180
Best Epoch: 2	Best Val F1: 0.187

Saving the best checkpoint....
Inference...
Test F1: 0.201	Test F1_Few: 0.237	Test F1_Zero: 0.205
Starting training with config: {'batch_size': 64, 'epochs': 75, 'l2_reg': 0.0008066179442030389, 'lr': 1.3145266944028448e-05, 'n_layers_freeze': 3, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.078
Batch: 5/29	Loss: 1.057
Batch: 7/29	Loss: 1.041
Batch: 9/29	Loss: 1.022
Batch: 11/29	Loss: 1.006
Batch: 13/29	Loss: 0.993
Batch: 15/29	Loss: 0.991
Batch: 17/29	Loss: 0.955
Batch: 19/29	Loss: 0.949
Batch: 21/29	Loss: 0.934
Batch: 23/29	Loss: 0.933
Batch: 25/29	Loss: 0.908
Batch: 27/29	Loss: 0.902
Batch: 29/29	Loss: 0.906
Epoch: 1	Train Loss: 0.984	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.185

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.898
Batch: 3/29	Loss: 0.896
Batch: 5/29	Loss: 0.917
Batch: 7/29	Loss: 0.883
Batch: 9/29	Loss: 0.894
Batch: 11/29	Loss: 0.858
Batch: 13/29	Loss: 0.856
Batch: 15/29	Loss: 0.876
Batch: 17/29	Loss: 0.865
Batch: 19/29	Loss: 0.889
Batch: 21/29	Loss: 0.851
Batch: 23/29	Loss: 0.857
Batch: 25/29	Loss: 0.838
Batch: 27/29	Loss: 0.886
Batch: 29/29	Loss: 0.839
Epoch: 2	Train Loss: 0.870	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.185

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.830
Batch: 3/29	Loss: 0.845
Batch: 5/29	Loss: 0.836
Batch: 7/29	Loss: 0.860
Batch: 9/29	Loss: 0.820
Batch: 11/29	Loss: 0.819
Batch: 13/29	Loss: 0.853
Batch: 15/29	Loss: 0.824
Batch: 17/29	Loss: 0.839
Batch: 19/29	Loss: 0.833
Batch: 21/29	Loss: 0.815
Batch: 23/29	Loss: 0.809
Batch: 25/29	Loss: 0.825
Batch: 27/29	Loss: 0.802
Batch: 29/29	Loss: 0.811
Epoch: 3	Train Loss: 0.829	Val F1: 0.186
Best Epoch: 3	Best Val F1: 0.186

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.796
Batch: 3/29	Loss: 0.810
Batch: 5/29	Loss: 0.791
Batch: 7/29	Loss: 0.834
Batch: 9/29	Loss: 0.819
Batch: 11/29	Loss: 0.780
Batch: 13/29	Loss: 0.790
Batch: 15/29	Loss: 0.775
Batch: 17/29	Loss: 0.786
Batch: 19/29	Loss: 0.806
Batch: 21/29	Loss: 0.813
Batch: 23/29	Loss: 0.809
Batch: 25/29	Loss: 0.792
Batch: 27/29	Loss: 0.809
Batch: 29/29	Loss: 0.796
Epoch: 4	Train Loss: 0.800	Val F1: 0.263
Best Epoch: 4	Best Val F1: 0.263

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.772
Batch: 3/29	Loss: 0.769
Batch: 5/29	Loss: 0.753
Batch: 7/29	Loss: 0.760
Batch: 9/29	Loss: 0.741
Batch: 11/29	Loss: 0.765
Batch: 13/29	Loss: 0.741
Batch: 15/29	Loss: 0.762
Batch: 17/29	Loss: 0.801
Batch: 19/29	Loss: 0.754
Batch: 21/29	Loss: 0.734
Batch: 23/29	Loss: 0.765
Batch: 25/29	Loss: 0.752
Batch: 27/29	Loss: 0.719
Batch: 29/29	Loss: 0.759
Epoch: 5	Train Loss: 0.763	Val F1: 0.318
Best Epoch: 5	Best Val F1: 0.318

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.759
Batch: 3/29	Loss: 0.781
Batch: 5/29	Loss: 0.700
Batch: 7/29	Loss: 0.783
Batch: 9/29	Loss: 0.731
Batch: 11/29	Loss: 0.707
Batch: 13/29	Loss: 0.725
Batch: 15/29	Loss: 0.672
Batch: 17/29	Loss: 0.694
Batch: 19/29	Loss: 0.666
Batch: 21/29	Loss: 0.766
Batch: 23/29	Loss: 0.693
Batch: 25/29	Loss: 0.706
Batch: 27/29	Loss: 0.706
Batch: 29/29	Loss: 0.694
Epoch: 6	Train Loss: 0.719	Val F1: 0.324
Best Epoch: 6	Best Val F1: 0.324

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.684
Batch: 3/29	Loss: 0.775
Batch: 5/29	Loss: 0.760
Batch: 7/29	Loss: 0.697
Batch: 9/29	Loss: 0.709
Batch: 11/29	Loss: 0.635
Batch: 13/29	Loss: 0.669
Batch: 15/29	Loss: 0.621
Batch: 17/29	Loss: 0.709
Batch: 19/29	Loss: 0.715
Batch: 21/29	Loss: 0.639
Batch: 23/29	Loss: 0.630
Batch: 25/29	Loss: 0.604
Batch: 27/29	Loss: 0.650
Batch: 29/29	Loss: 0.645
Epoch: 7	Train Loss: 0.676	Val F1: 0.344
Best Epoch: 7	Best Val F1: 0.344

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.642
Batch: 3/29	Loss: 0.615
Batch: 5/29	Loss: 0.664
Batch: 7/29	Loss: 0.621
Batch: 9/29	Loss: 0.615
Batch: 11/29	Loss: 0.651
Batch: 13/29	Loss: 0.661
Batch: 15/29	Loss: 0.601
Batch: 17/29	Loss: 0.666
Batch: 19/29	Loss: 0.635
Batch: 21/29	Loss: 0.661
Batch: 23/29	Loss: 0.668
Batch: 25/29	Loss: 0.723
Batch: 27/29	Loss: 0.635
Batch: 29/29	Loss: 0.634
Epoch: 8	Train Loss: 0.636	Val F1: 0.331
Best Epoch: 7	Best Val F1: 0.344

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.650
Batch: 3/29	Loss: 0.589
Batch: 5/29	Loss: 0.595
Batch: 7/29	Loss: 0.570
Batch: 9/29	Loss: 0.633
Batch: 11/29	Loss: 0.604
Batch: 13/29	Loss: 0.613
Batch: 15/29	Loss: 0.532
Batch: 17/29	Loss: 0.573
Batch: 19/29	Loss: 0.540
Batch: 21/29	Loss: 0.649
Batch: 23/29	Loss: 0.651
Batch: 25/29	Loss: 0.559
Batch: 27/29	Loss: 0.763
Batch: 29/29	Loss: 0.537
Epoch: 9	Train Loss: 0.600	Val F1: 0.331
Best Epoch: 7	Best Val F1: 0.344

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.559
Batch: 3/29	Loss: 0.609
Batch: 5/29	Loss: 0.574
Batch: 7/29	Loss: 0.548
Batch: 9/29	Loss: 0.561
Batch: 11/29	Loss: 0.484
Batch: 13/29	Loss: 0.664
Batch: 15/29	Loss: 0.626
Batch: 17/29	Loss: 0.678
Batch: 19/29	Loss: 0.402
Batch: 21/29	Loss: 0.645
Batch: 23/29	Loss: 0.587
Batch: 25/29	Loss: 0.582
Batch: 27/29	Loss: 0.533
Batch: 29/29	Loss: 0.615
Epoch: 10	Train Loss: 0.577	Val F1: 0.357
Best Epoch: 10	Best Val F1: 0.357

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.556
Batch: 3/29	Loss: 0.478
Batch: 5/29	Loss: 0.655
Batch: 7/29	Loss: 0.558
Batch: 9/29	Loss: 0.514
Batch: 11/29	Loss: 0.523
Batch: 13/29	Loss: 0.469
Batch: 15/29	Loss: 0.415
Batch: 17/29	Loss: 0.613
Batch: 19/29	Loss: 0.523
Batch: 21/29	Loss: 0.464
Batch: 23/29	Loss: 0.441
Batch: 25/29	Loss: 0.451
Batch: 27/29	Loss: 0.451
Batch: 29/29	Loss: 0.486
Epoch: 11	Train Loss: 0.521	Val F1: 0.341
Best Epoch: 10	Best Val F1: 0.357

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.645
Batch: 3/29	Loss: 0.398
Batch: 5/29	Loss: 0.531
Batch: 7/29	Loss: 0.495
Batch: 9/29	Loss: 0.514
Batch: 11/29	Loss: 0.514
Batch: 13/29	Loss: 0.515
Batch: 15/29	Loss: 0.456
Batch: 17/29	Loss: 0.627
Batch: 19/29	Loss: 0.482
Batch: 21/29	Loss: 0.523
Batch: 23/29	Loss: 0.514
Batch: 25/29	Loss: 0.501
Batch: 27/29	Loss: 0.599
Batch: 29/29	Loss: 0.391
Epoch: 12	Train Loss: 0.510	Val F1: 0.335
Best Epoch: 10	Best Val F1: 0.357

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.601
Batch: 3/29	Loss: 0.395
Batch: 5/29	Loss: 0.545
Batch: 7/29	Loss: 0.502
Batch: 9/29	Loss: 0.530
Batch: 11/29	Loss: 0.476
Batch: 13/29	Loss: 0.494
Batch: 15/29	Loss: 0.503
Batch: 17/29	Loss: 0.443
Batch: 19/29	Loss: 0.375
Batch: 21/29	Loss: 0.449
Batch: 23/29	Loss: 0.528
Batch: 25/29	Loss: 0.330
Batch: 27/29	Loss: 0.503
Batch: 29/29	Loss: 0.571
Epoch: 13	Train Loss: 0.493	Val F1: 0.316
Best Epoch: 10	Best Val F1: 0.357

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.579
Batch: 3/29	Loss: 0.456
Batch: 5/29	Loss: 0.368
Batch: 7/29	Loss: 0.437
Batch: 9/29	Loss: 0.472
Batch: 11/29	Loss: 0.446
Batch: 13/29	Loss: 0.411
Batch: 15/29	Loss: 0.367
Batch: 17/29	Loss: 0.538
Batch: 19/29	Loss: 0.478
Batch: 21/29	Loss: 0.317
Batch: 23/29	Loss: 0.367
Batch: 25/29	Loss: 0.436
Batch: 27/29	Loss: 0.464
Batch: 29/29	Loss: 0.465
Epoch: 14	Train Loss: 0.445	Val F1: 0.350
Best Epoch: 10	Best Val F1: 0.357

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.402
Batch: 3/29	Loss: 0.426
Batch: 5/29	Loss: 0.324
Batch: 7/29	Loss: 0.383
Batch: 9/29	Loss: 0.455
Batch: 11/29	Loss: 0.417
Batch: 13/29	Loss: 0.420
Batch: 15/29	Loss: 0.410
Batch: 17/29	Loss: 0.439
Batch: 19/29	Loss: 0.407
Batch: 21/29	Loss: 0.426
Batch: 23/29	Loss: 0.486
Batch: 25/29	Loss: 0.442
Batch: 27/29	Loss: 0.389
Batch: 29/29	Loss: 0.541
Epoch: 15	Train Loss: 0.429	Val F1: 0.347
Best Epoch: 10	Best Val F1: 0.357

Saving the best checkpoint....
Inference...
Test F1: 0.374	Test F1_Few: 0.441	Test F1_Zero: 0.374
Starting training with config: {'batch_size': 8, 'epochs': 50, 'l2_reg': 0.0002018774706709355, 'lr': 5.522205217488851e-05, 'n_layers_freeze': 0, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/231	Loss: 1.080
Batch: 24/231	Loss: 0.835
Batch: 47/231	Loss: 0.767
Batch: 70/231	Loss: 0.773
Batch: 93/231	Loss: 0.722
Batch: 116/231	Loss: 0.889
Batch: 139/231	Loss: 0.803
Batch: 162/231	Loss: 0.858
Batch: 185/231	Loss: 0.695
Batch: 208/231	Loss: 0.698
Batch: 231/231	Loss: 0.682
Epoch: 1	Train Loss: 0.788	Val F1: 0.288
Best Epoch: 1	Best Val F1: 0.288

****************************** Epoch: 2 ******************************
Batch: 1/231	Loss: 0.736
Batch: 24/231	Loss: 0.727
Batch: 47/231	Loss: 0.863
Batch: 70/231	Loss: 0.966
Batch: 93/231	Loss: 0.704
Batch: 116/231	Loss: 0.619
Batch: 139/231	Loss: 1.070
Batch: 162/231	Loss: 0.723
Batch: 185/231	Loss: 0.715
Batch: 208/231	Loss: 0.747
Batch: 231/231	Loss: 0.694
Epoch: 2	Train Loss: 0.717	Val F1: 0.320
Best Epoch: 2	Best Val F1: 0.320

****************************** Epoch: 3 ******************************
Batch: 1/231	Loss: 0.608
Batch: 24/231	Loss: 0.542
Batch: 47/231	Loss: 0.957
Batch: 70/231	Loss: 0.675
Batch: 93/231	Loss: 0.575
Batch: 116/231	Loss: 0.435
Batch: 139/231	Loss: 0.606
Batch: 162/231	Loss: 0.578
Batch: 185/231	Loss: 0.568
Batch: 208/231	Loss: 0.651
Batch: 231/231	Loss: 0.658
Epoch: 3	Train Loss: 0.682	Val F1: 0.306
Best Epoch: 2	Best Val F1: 0.320

****************************** Epoch: 4 ******************************
Batch: 1/231	Loss: 0.806
Batch: 24/231	Loss: 0.496
Batch: 47/231	Loss: 0.743
Batch: 70/231	Loss: 0.725
Batch: 93/231	Loss: 0.800
Batch: 116/231	Loss: 0.533
Batch: 139/231	Loss: 1.249
Batch: 162/231	Loss: 0.837
Batch: 185/231	Loss: 0.717
Batch: 208/231	Loss: 0.705
Batch: 231/231	Loss: 0.877
Epoch: 4	Train Loss: 0.718	Val F1: 0.180
Best Epoch: 2	Best Val F1: 0.320

****************************** Epoch: 5 ******************************
Batch: 1/231	Loss: 0.720
Batch: 24/231	Loss: 0.700
Batch: 47/231	Loss: 0.951
Batch: 70/231	Loss: 0.689
Batch: 93/231	Loss: 0.671
Batch: 116/231	Loss: 0.741
Batch: 139/231	Loss: 0.904
Batch: 162/231	Loss: 0.767
Batch: 185/231	Loss: 0.884
Batch: 208/231	Loss: 0.733
Batch: 231/231	Loss: 0.726
Epoch: 5	Train Loss: 0.769	Val F1: 0.180
Best Epoch: 2	Best Val F1: 0.320

****************************** Epoch: 6 ******************************
Batch: 1/231	Loss: 0.688
Batch: 24/231	Loss: 0.984
Batch: 47/231	Loss: 0.714
Batch: 70/231	Loss: 0.716
Batch: 93/231	Loss: 0.709
Batch: 116/231	Loss: 0.711
Batch: 139/231	Loss: 0.929
Batch: 162/231	Loss: 0.815
Batch: 185/231	Loss: 0.918
Batch: 208/231	Loss: 1.005
Batch: 231/231	Loss: 0.659
Epoch: 6	Train Loss: 0.764	Val F1: 0.185
Best Epoch: 2	Best Val F1: 0.320

****************************** Epoch: 7 ******************************
Batch: 1/231	Loss: 0.698
Batch: 24/231	Loss: 0.777
Batch: 47/231	Loss: 0.723
Batch: 70/231	Loss: 0.717
Batch: 93/231	Loss: 0.697
Batch: 116/231	Loss: 0.716
Batch: 139/231	Loss: 0.720
Batch: 162/231	Loss: 0.720
Batch: 185/231	Loss: 0.706
Batch: 208/231	Loss: 0.879
Batch: 231/231	Loss: 0.693
Epoch: 7	Train Loss: 0.765	Val F1: 0.180
Best Epoch: 2	Best Val F1: 0.320

Saving the best checkpoint....
Inference...
Test F1: 0.329	Test F1_Few: 0.409	Test F1_Zero: 0.313
Starting training with config: {'batch_size': 32, 'epochs': 75, 'l2_reg': 0.0008955316236934297, 'lr': 1.4413536831428553e-05, 'n_layers_freeze': 4, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 1.053
Batch: 11/58	Loss: 1.002
Batch: 16/58	Loss: 0.947
Batch: 21/58	Loss: 0.937
Batch: 26/58	Loss: 0.925
Batch: 31/58	Loss: 0.895
Batch: 36/58	Loss: 0.913
Batch: 41/58	Loss: 0.865
Batch: 46/58	Loss: 0.850
Batch: 51/58	Loss: 0.837
Batch: 56/58	Loss: 0.840
Batch: 58/58	Loss: 0.845
Epoch: 1	Train Loss: 0.929	Val F1: 0.202
Best Epoch: 1	Best Val F1: 0.202

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.851
Batch: 6/58	Loss: 0.856
Batch: 11/58	Loss: 0.858
Batch: 16/58	Loss: 0.803
Batch: 21/58	Loss: 0.799
Batch: 26/58	Loss: 0.804
Batch: 31/58	Loss: 0.838
Batch: 36/58	Loss: 0.834
Batch: 41/58	Loss: 0.791
Batch: 46/58	Loss: 0.786
Batch: 51/58	Loss: 0.788
Batch: 56/58	Loss: 0.787
Batch: 58/58	Loss: 0.765
Epoch: 2	Train Loss: 0.817	Val F1: 0.291
Best Epoch: 2	Best Val F1: 0.291

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.771
Batch: 6/58	Loss: 0.749
Batch: 11/58	Loss: 0.796
Batch: 16/58	Loss: 0.762
Batch: 21/58	Loss: 0.764
Batch: 26/58	Loss: 0.754
Batch: 31/58	Loss: 0.887
Batch: 36/58	Loss: 0.770
Batch: 41/58	Loss: 0.714
Batch: 46/58	Loss: 0.728
Batch: 51/58	Loss: 0.756
Batch: 56/58	Loss: 0.712
Batch: 58/58	Loss: 0.762
Epoch: 3	Train Loss: 0.770	Val F1: 0.316
Best Epoch: 3	Best Val F1: 0.316

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.750
Batch: 6/58	Loss: 0.715
Batch: 11/58	Loss: 0.705
Batch: 16/58	Loss: 0.691
Batch: 21/58	Loss: 0.604
Batch: 26/58	Loss: 0.657
Batch: 31/58	Loss: 0.659
Batch: 36/58	Loss: 0.796
Batch: 41/58	Loss: 0.749
Batch: 46/58	Loss: 0.682
Batch: 51/58	Loss: 0.670
Batch: 56/58	Loss: 0.615
Batch: 58/58	Loss: 0.703
Epoch: 4	Train Loss: 0.709	Val F1: 0.323
Best Epoch: 4	Best Val F1: 0.323

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.636
Batch: 6/58	Loss: 0.621
Batch: 11/58	Loss: 0.620
Batch: 16/58	Loss: 0.627
Batch: 21/58	Loss: 0.540
Batch: 26/58	Loss: 0.597
Batch: 31/58	Loss: 0.742
Batch: 36/58	Loss: 0.760
Batch: 41/58	Loss: 0.678
Batch: 46/58	Loss: 0.789
Batch: 51/58	Loss: 0.885
Batch: 56/58	Loss: 0.733
Batch: 58/58	Loss: 0.814
Epoch: 5	Train Loss: 0.664	Val F1: 0.323
Best Epoch: 5	Best Val F1: 0.323

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.628
Batch: 6/58	Loss: 0.711
Batch: 11/58	Loss: 0.722
Batch: 16/58	Loss: 0.597
Batch: 21/58	Loss: 0.630
Batch: 26/58	Loss: 0.503
Batch: 31/58	Loss: 0.633
Batch: 36/58	Loss: 0.539
Batch: 41/58	Loss: 0.593
Batch: 46/58	Loss: 0.596
Batch: 51/58	Loss: 0.602
Batch: 56/58	Loss: 0.616
Batch: 58/58	Loss: 0.550
Epoch: 6	Train Loss: 0.612	Val F1: 0.348
Best Epoch: 6	Best Val F1: 0.348

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.494
Batch: 6/58	Loss: 0.633
Batch: 11/58	Loss: 0.719
Batch: 16/58	Loss: 0.421
Batch: 21/58	Loss: 0.542
Batch: 26/58	Loss: 0.552
Batch: 31/58	Loss: 0.659
Batch: 36/58	Loss: 0.594
Batch: 41/58	Loss: 0.517
Batch: 46/58	Loss: 0.556
Batch: 51/58	Loss: 0.495
Batch: 56/58	Loss: 0.597
Batch: 58/58	Loss: 0.452
Epoch: 7	Train Loss: 0.569	Val F1: 0.355
Best Epoch: 7	Best Val F1: 0.355

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.542
Batch: 6/58	Loss: 0.454
Batch: 11/58	Loss: 0.444
Batch: 16/58	Loss: 0.515
Batch: 21/58	Loss: 0.519
Batch: 26/58	Loss: 0.391
Batch: 31/58	Loss: 0.529
Batch: 36/58	Loss: 0.456
Batch: 41/58	Loss: 0.609
Batch: 46/58	Loss: 0.552
Batch: 51/58	Loss: 0.578
Batch: 56/58	Loss: 0.497
Batch: 58/58	Loss: 0.467
Epoch: 8	Train Loss: 0.521	Val F1: 0.346
Best Epoch: 7	Best Val F1: 0.355

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.528
Batch: 6/58	Loss: 0.565
Batch: 11/58	Loss: 0.556
Batch: 16/58	Loss: 0.375
Batch: 21/58	Loss: 0.427
Batch: 26/58	Loss: 0.384
Batch: 31/58	Loss: 0.423
Batch: 36/58	Loss: 0.416
Batch: 41/58	Loss: 0.476
Batch: 46/58	Loss: 0.533
Batch: 51/58	Loss: 0.571
Batch: 56/58	Loss: 0.376
Batch: 58/58	Loss: 0.386
Epoch: 9	Train Loss: 0.484	Val F1: 0.355
Best Epoch: 7	Best Val F1: 0.355

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.412
Batch: 6/58	Loss: 0.405
Batch: 11/58	Loss: 0.471
Batch: 16/58	Loss: 0.545
Batch: 21/58	Loss: 0.339
Batch: 26/58	Loss: 0.472
Batch: 31/58	Loss: 0.347
Batch: 36/58	Loss: 0.624
Batch: 41/58	Loss: 0.578
Batch: 46/58	Loss: 0.551
Batch: 51/58	Loss: 0.437
Batch: 56/58	Loss: 0.500
Batch: 58/58	Loss: 0.585
Epoch: 10	Train Loss: 0.466	Val F1: 0.338
Best Epoch: 7	Best Val F1: 0.355

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.430
Batch: 6/58	Loss: 0.394
Batch: 11/58	Loss: 0.424
Batch: 16/58	Loss: 0.422
Batch: 21/58	Loss: 0.418
Batch: 26/58	Loss: 0.515
Batch: 31/58	Loss: 0.417
Batch: 36/58	Loss: 0.431
Batch: 41/58	Loss: 0.366
Batch: 46/58	Loss: 0.389
Batch: 51/58	Loss: 0.418
Batch: 56/58	Loss: 0.438
Batch: 58/58	Loss: 0.428
Epoch: 11	Train Loss: 0.432	Val F1: 0.352
Best Epoch: 7	Best Val F1: 0.355

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.534
Batch: 6/58	Loss: 0.324
Batch: 11/58	Loss: 0.345
Batch: 16/58	Loss: 0.391
Batch: 21/58	Loss: 0.462
Batch: 26/58	Loss: 0.339
Batch: 31/58	Loss: 0.475
Batch: 36/58	Loss: 0.403
Batch: 41/58	Loss: 0.335
Batch: 46/58	Loss: 0.414
Batch: 51/58	Loss: 0.525
Batch: 56/58	Loss: 0.330
Batch: 58/58	Loss: 0.189
Epoch: 12	Train Loss: 0.391	Val F1: 0.350
Best Epoch: 7	Best Val F1: 0.355

Saving the best checkpoint....
Inference...
Test F1: 0.371	Test F1_Few: 0.441	Test F1_Zero: 0.367
Starting training with config: {'batch_size': 64, 'epochs': 75, 'l2_reg': 0.0008487985283367393, 'lr': 9.82276878396056e-06, 'n_layers_freeze': 3, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.083
Batch: 5/29	Loss: 1.068
Batch: 7/29	Loss: 1.055
Batch: 9/29	Loss: 1.042
Batch: 11/29	Loss: 1.028
Batch: 13/29	Loss: 1.016
Batch: 15/29	Loss: 1.014
Batch: 17/29	Loss: 0.983
Batch: 19/29	Loss: 0.976
Batch: 21/29	Loss: 0.961
Batch: 23/29	Loss: 0.957
Batch: 25/29	Loss: 0.936
Batch: 27/29	Loss: 0.926
Batch: 29/29	Loss: 0.930
Epoch: 1	Train Loss: 1.004	Val F1: 0.193
Best Epoch: 1	Best Val F1: 0.193

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.922
Batch: 3/29	Loss: 0.919
Batch: 5/29	Loss: 0.935
Batch: 7/29	Loss: 0.906
Batch: 9/29	Loss: 0.914
Batch: 11/29	Loss: 0.882
Batch: 13/29	Loss: 0.879
Batch: 15/29	Loss: 0.897
Batch: 17/29	Loss: 0.885
Batch: 19/29	Loss: 0.905
Batch: 21/29	Loss: 0.872
Batch: 23/29	Loss: 0.876
Batch: 25/29	Loss: 0.860
Batch: 27/29	Loss: 0.901
Batch: 29/29	Loss: 0.861
Epoch: 2	Train Loss: 0.892	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.193

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.853
Batch: 3/29	Loss: 0.864
Batch: 5/29	Loss: 0.857
Batch: 7/29	Loss: 0.878
Batch: 9/29	Loss: 0.843
Batch: 11/29	Loss: 0.842
Batch: 13/29	Loss: 0.872
Batch: 15/29	Loss: 0.844
Batch: 17/29	Loss: 0.857
Batch: 19/29	Loss: 0.853
Batch: 21/29	Loss: 0.836
Batch: 23/29	Loss: 0.832
Batch: 25/29	Loss: 0.845
Batch: 27/29	Loss: 0.824
Batch: 29/29	Loss: 0.832
Epoch: 3	Train Loss: 0.849	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.193

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.819
Batch: 3/29	Loss: 0.832
Batch: 5/29	Loss: 0.812
Batch: 7/29	Loss: 0.851
Batch: 9/29	Loss: 0.839
Batch: 11/29	Loss: 0.806
Batch: 13/29	Loss: 0.814
Batch: 15/29	Loss: 0.801
Batch: 17/29	Loss: 0.811
Batch: 19/29	Loss: 0.828
Batch: 21/29	Loss: 0.836
Batch: 23/29	Loss: 0.837
Batch: 25/29	Loss: 0.825
Batch: 27/29	Loss: 0.837
Batch: 29/29	Loss: 0.821
Epoch: 4	Train Loss: 0.824	Val F1: 0.228
Best Epoch: 4	Best Val F1: 0.228

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.807
Batch: 3/29	Loss: 0.801
Batch: 5/29	Loss: 0.791
Batch: 7/29	Loss: 0.788
Batch: 9/29	Loss: 0.785
Batch: 11/29	Loss: 0.792
Batch: 13/29	Loss: 0.782
Batch: 15/29	Loss: 0.807
Batch: 17/29	Loss: 0.831
Batch: 19/29	Loss: 0.794
Batch: 21/29	Loss: 0.774
Batch: 23/29	Loss: 0.797
Batch: 25/29	Loss: 0.804
Batch: 27/29	Loss: 0.768
Batch: 29/29	Loss: 0.787
Epoch: 5	Train Loss: 0.800	Val F1: 0.293
Best Epoch: 5	Best Val F1: 0.293

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.783
Batch: 3/29	Loss: 0.820
Batch: 5/29	Loss: 0.756
Batch: 7/29	Loss: 0.819
Batch: 9/29	Loss: 0.772
Batch: 11/29	Loss: 0.778
Batch: 13/29	Loss: 0.761
Batch: 15/29	Loss: 0.732
Batch: 17/29	Loss: 0.745
Batch: 19/29	Loss: 0.727
Batch: 21/29	Loss: 0.781
Batch: 23/29	Loss: 0.735
Batch: 25/29	Loss: 0.753
Batch: 27/29	Loss: 0.749
Batch: 29/29	Loss: 0.735
Epoch: 6	Train Loss: 0.764	Val F1: 0.316
Best Epoch: 6	Best Val F1: 0.316

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.728
Batch: 3/29	Loss: 0.798
Batch: 5/29	Loss: 0.797
Batch: 7/29	Loss: 0.736
Batch: 9/29	Loss: 0.763
Batch: 11/29	Loss: 0.707
Batch: 13/29	Loss: 0.721
Batch: 15/29	Loss: 0.719
Batch: 17/29	Loss: 0.753
Batch: 19/29	Loss: 0.754
Batch: 21/29	Loss: 0.689
Batch: 23/29	Loss: 0.684
Batch: 25/29	Loss: 0.659
Batch: 27/29	Loss: 0.712
Batch: 29/29	Loss: 0.692
Epoch: 7	Train Loss: 0.726	Val F1: 0.341
Best Epoch: 7	Best Val F1: 0.341

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.702
Batch: 3/29	Loss: 0.662
Batch: 5/29	Loss: 0.708
Batch: 7/29	Loss: 0.672
Batch: 9/29	Loss: 0.674
Batch: 11/29	Loss: 0.696
Batch: 13/29	Loss: 0.737
Batch: 15/29	Loss: 0.652
Batch: 17/29	Loss: 0.733
Batch: 19/29	Loss: 0.720
Batch: 21/29	Loss: 0.713
Batch: 23/29	Loss: 0.727
Batch: 25/29	Loss: 0.735
Batch: 27/29	Loss: 0.691
Batch: 29/29	Loss: 0.677
Epoch: 8	Train Loss: 0.691	Val F1: 0.336
Best Epoch: 7	Best Val F1: 0.341

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.697
Batch: 3/29	Loss: 0.636
Batch: 5/29	Loss: 0.648
Batch: 7/29	Loss: 0.634
Batch: 9/29	Loss: 0.697
Batch: 11/29	Loss: 0.653
Batch: 13/29	Loss: 0.682
Batch: 15/29	Loss: 0.649
Batch: 17/29	Loss: 0.636
Batch: 19/29	Loss: 0.626
Batch: 21/29	Loss: 0.711
Batch: 23/29	Loss: 0.613
Batch: 25/29	Loss: 0.638
Batch: 27/29	Loss: 0.671
Batch: 29/29	Loss: 0.591
Epoch: 9	Train Loss: 0.652	Val F1: 0.351
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.558
Batch: 3/29	Loss: 0.631
Batch: 5/29	Loss: 0.629
Batch: 7/29	Loss: 0.590
Batch: 9/29	Loss: 0.577
Batch: 11/29	Loss: 0.524
Batch: 13/29	Loss: 0.704
Batch: 15/29	Loss: 0.681
Batch: 17/29	Loss: 0.712
Batch: 19/29	Loss: 0.483
Batch: 21/29	Loss: 0.667
Batch: 23/29	Loss: 0.641
Batch: 25/29	Loss: 0.634
Batch: 27/29	Loss: 0.584
Batch: 29/29	Loss: 0.686
Epoch: 10	Train Loss: 0.624	Val F1: 0.347
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.599
Batch: 3/29	Loss: 0.549
Batch: 5/29	Loss: 0.686
Batch: 7/29	Loss: 0.614
Batch: 9/29	Loss: 0.584
Batch: 11/29	Loss: 0.608
Batch: 13/29	Loss: 0.533
Batch: 15/29	Loss: 0.470
Batch: 17/29	Loss: 0.662
Batch: 19/29	Loss: 0.594
Batch: 21/29	Loss: 0.552
Batch: 23/29	Loss: 0.502
Batch: 25/29	Loss: 0.525
Batch: 27/29	Loss: 0.558
Batch: 29/29	Loss: 0.537
Epoch: 11	Train Loss: 0.587	Val F1: 0.343
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.694
Batch: 3/29	Loss: 0.497
Batch: 5/29	Loss: 0.635
Batch: 7/29	Loss: 0.511
Batch: 9/29	Loss: 0.595
Batch: 11/29	Loss: 0.566
Batch: 13/29	Loss: 0.578
Batch: 15/29	Loss: 0.539
Batch: 17/29	Loss: 0.557
Batch: 19/29	Loss: 0.543
Batch: 21/29	Loss: 0.570
Batch: 23/29	Loss: 0.558
Batch: 25/29	Loss: 0.544
Batch: 27/29	Loss: 0.598
Batch: 29/29	Loss: 0.476
Epoch: 12	Train Loss: 0.562	Val F1: 0.345
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.553
Batch: 3/29	Loss: 0.463
Batch: 5/29	Loss: 0.538
Batch: 7/29	Loss: 0.492
Batch: 9/29	Loss: 0.525
Batch: 11/29	Loss: 0.544
Batch: 13/29	Loss: 0.546
Batch: 15/29	Loss: 0.508
Batch: 17/29	Loss: 0.479
Batch: 19/29	Loss: 0.408
Batch: 21/29	Loss: 0.484
Batch: 23/29	Loss: 0.570
Batch: 25/29	Loss: 0.388
Batch: 27/29	Loss: 0.520
Batch: 29/29	Loss: 0.629
Epoch: 13	Train Loss: 0.521	Val F1: 0.341
Best Epoch: 9	Best Val F1: 0.351

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.489
Batch: 3/29	Loss: 0.584
Batch: 5/29	Loss: 0.411
Batch: 7/29	Loss: 0.528
Batch: 9/29	Loss: 0.545
Batch: 11/29	Loss: 0.487
Batch: 13/29	Loss: 0.520
Batch: 15/29	Loss: 0.416
Batch: 17/29	Loss: 0.573
Batch: 19/29	Loss: 0.520
Batch: 21/29	Loss: 0.402
Batch: 23/29	Loss: 0.405
Batch: 25/29	Loss: 0.501
Batch: 27/29	Loss: 0.476
Batch: 29/29	Loss: 0.483
Epoch: 14	Train Loss: 0.499	Val F1: 0.351
Best Epoch: 9	Best Val F1: 0.351

Saving the best checkpoint....
Inference...
Test F1: 0.381	Test F1_Few: 0.447	Test F1_Zero: 0.385
Starting training with config: {'batch_size': 32, 'epochs': 50, 'l2_reg': 0.000976680367478526, 'lr': 3.6823861307129328e-06, 'n_layers_freeze': 0, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 1.086
Batch: 11/58	Loss: 1.070
Batch: 16/58	Loss: 1.057
Batch: 21/58	Loss: 1.044
Batch: 26/58	Loss: 1.033
Batch: 31/58	Loss: 1.014
Batch: 36/58	Loss: 1.016
Batch: 41/58	Loss: 0.988
Batch: 46/58	Loss: 0.968
Batch: 51/58	Loss: 0.956
Batch: 56/58	Loss: 0.952
Batch: 58/58	Loss: 0.948
Epoch: 1	Train Loss: 1.022	Val F1: 0.219
Best Epoch: 1	Best Val F1: 0.219

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.951
Batch: 6/58	Loss: 0.949
Batch: 11/58	Loss: 0.941
Batch: 16/58	Loss: 0.913
Batch: 21/58	Loss: 0.904
Batch: 26/58	Loss: 0.903
Batch: 31/58	Loss: 0.919
Batch: 36/58	Loss: 0.914
Batch: 41/58	Loss: 0.889
Batch: 46/58	Loss: 0.884
Batch: 51/58	Loss: 0.883
Batch: 56/58	Loss: 0.885
Batch: 58/58	Loss: 0.872
Epoch: 2	Train Loss: 0.912	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.219

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.873
Batch: 6/58	Loss: 0.863
Batch: 11/58	Loss: 0.897
Batch: 16/58	Loss: 0.872
Batch: 21/58	Loss: 0.863
Batch: 26/58	Loss: 0.882
Batch: 31/58	Loss: 0.928
Batch: 36/58	Loss: 0.869
Batch: 41/58	Loss: 0.858
Batch: 46/58	Loss: 0.842
Batch: 51/58	Loss: 0.852
Batch: 56/58	Loss: 0.859
Batch: 58/58	Loss: 0.858
Epoch: 3	Train Loss: 0.870	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.219

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.850
Batch: 6/58	Loss: 0.861
Batch: 11/58	Loss: 0.848
Batch: 16/58	Loss: 0.857
Batch: 21/58	Loss: 0.826
Batch: 26/58	Loss: 0.825
Batch: 31/58	Loss: 0.826
Batch: 36/58	Loss: 0.855
Batch: 41/58	Loss: 0.872
Batch: 46/58	Loss: 0.857
Batch: 51/58	Loss: 0.810
Batch: 56/58	Loss: 0.819
Batch: 58/58	Loss: 0.868
Epoch: 4	Train Loss: 0.847	Val F1: 0.187
Best Epoch: 1	Best Val F1: 0.219

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.823
Batch: 6/58	Loss: 0.814
Batch: 11/58	Loss: 0.840
Batch: 16/58	Loss: 0.835
Batch: 21/58	Loss: 0.806
Batch: 26/58	Loss: 0.799
Batch: 31/58	Loss: 0.865
Batch: 36/58	Loss: 0.842
Batch: 41/58	Loss: 0.815
Batch: 46/58	Loss: 0.801
Batch: 51/58	Loss: 0.856
Batch: 56/58	Loss: 0.860
Batch: 58/58	Loss: 0.840
Epoch: 5	Train Loss: 0.829	Val F1: 0.256
Best Epoch: 5	Best Val F1: 0.256

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.795
Batch: 6/58	Loss: 0.851
Batch: 11/58	Loss: 0.861
Batch: 16/58	Loss: 0.811
Batch: 21/58	Loss: 0.835
Batch: 26/58	Loss: 0.806
Batch: 31/58	Loss: 0.806
Batch: 36/58	Loss: 0.780
Batch: 41/58	Loss: 0.809
Batch: 46/58	Loss: 0.778
Batch: 51/58	Loss: 0.780
Batch: 56/58	Loss: 0.814
Batch: 58/58	Loss: 0.763
Epoch: 6	Train Loss: 0.806	Val F1: 0.303
Best Epoch: 6	Best Val F1: 0.303

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.757
Batch: 6/58	Loss: 0.838
Batch: 11/58	Loss: 0.857
Batch: 16/58	Loss: 0.784
Batch: 21/58	Loss: 0.777
Batch: 26/58	Loss: 0.805
Batch: 31/58	Loss: 0.783
Batch: 36/58	Loss: 0.776
Batch: 41/58	Loss: 0.738
Batch: 46/58	Loss: 0.737
Batch: 51/58	Loss: 0.727
Batch: 56/58	Loss: 0.759
Batch: 58/58	Loss: 0.691
Epoch: 7	Train Loss: 0.776	Val F1: 0.323
Best Epoch: 7	Best Val F1: 0.323

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.739
Batch: 6/58	Loss: 0.755
Batch: 11/58	Loss: 0.727
Batch: 16/58	Loss: 0.715
Batch: 21/58	Loss: 0.742
Batch: 26/58	Loss: 0.771
Batch: 31/58	Loss: 0.717
Batch: 36/58	Loss: 0.669
Batch: 41/58	Loss: 0.779
Batch: 46/58	Loss: 0.741
Batch: 51/58	Loss: 0.765
Batch: 56/58	Loss: 0.716
Batch: 58/58	Loss: 0.658
Epoch: 8	Train Loss: 0.746	Val F1: 0.334
Best Epoch: 8	Best Val F1: 0.334

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.722
Batch: 6/58	Loss: 0.734
Batch: 11/58	Loss: 0.774
Batch: 16/58	Loss: 0.739
Batch: 21/58	Loss: 0.725
Batch: 26/58	Loss: 0.699
Batch: 31/58	Loss: 0.694
Batch: 36/58	Loss: 0.680
Batch: 41/58	Loss: 0.781
Batch: 46/58	Loss: 0.697
Batch: 51/58	Loss: 0.721
Batch: 56/58	Loss: 0.616
Batch: 58/58	Loss: 0.636
Epoch: 9	Train Loss: 0.712	Val F1: 0.337
Best Epoch: 9	Best Val F1: 0.337

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.651
Batch: 6/58	Loss: 0.702
Batch: 11/58	Loss: 0.731
Batch: 16/58	Loss: 0.744
Batch: 21/58	Loss: 0.561
Batch: 26/58	Loss: 0.677
Batch: 31/58	Loss: 0.716
Batch: 36/58	Loss: 0.769
Batch: 41/58	Loss: 0.703
Batch: 46/58	Loss: 0.717
Batch: 51/58	Loss: 0.709
Batch: 56/58	Loss: 0.640
Batch: 58/58	Loss: 0.804
Epoch: 10	Train Loss: 0.682	Val F1: 0.316
Best Epoch: 9	Best Val F1: 0.337

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.704
Batch: 6/58	Loss: 0.692
Batch: 11/58	Loss: 0.675
Batch: 16/58	Loss: 0.732
Batch: 21/58	Loss: 0.654
Batch: 26/58	Loss: 0.684
Batch: 31/58	Loss: 0.698
Batch: 36/58	Loss: 0.734
Batch: 41/58	Loss: 0.633
Batch: 46/58	Loss: 0.589
Batch: 51/58	Loss: 0.689
Batch: 56/58	Loss: 0.652
Batch: 58/58	Loss: 0.571
Epoch: 11	Train Loss: 0.661	Val F1: 0.334
Best Epoch: 9	Best Val F1: 0.337

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.798
Batch: 6/58	Loss: 0.572
Batch: 11/58	Loss: 0.622
Batch: 16/58	Loss: 0.609
Batch: 21/58	Loss: 0.651
Batch: 26/58	Loss: 0.534
Batch: 31/58	Loss: 0.670
Batch: 36/58	Loss: 0.579
Batch: 41/58	Loss: 0.585
Batch: 46/58	Loss: 0.642
Batch: 51/58	Loss: 0.643
Batch: 56/58	Loss: 0.597
Batch: 58/58	Loss: 0.445
Epoch: 12	Train Loss: 0.621	Val F1: 0.351
Best Epoch: 12	Best Val F1: 0.351

****************************** Epoch: 13 ******************************
Batch: 1/58	Loss: 0.593
Batch: 6/58	Loss: 0.534
Batch: 11/58	Loss: 0.653
Batch: 16/58	Loss: 0.527
Batch: 21/58	Loss: 0.566
Batch: 26/58	Loss: 0.597
Batch: 31/58	Loss: 0.630
Batch: 36/58	Loss: 0.605
Batch: 41/58	Loss: 0.594
Batch: 46/58	Loss: 0.622
Batch: 51/58	Loss: 0.570
Batch: 56/58	Loss: 0.649
Batch: 58/58	Loss: 0.523
Epoch: 13	Train Loss: 0.603	Val F1: 0.341
Best Epoch: 12	Best Val F1: 0.351

****************************** Epoch: 14 ******************************
Batch: 1/58	Loss: 0.547
Batch: 6/58	Loss: 0.622
Batch: 11/58	Loss: 0.563
Batch: 16/58	Loss: 0.592
Batch: 21/58	Loss: 0.555
Batch: 26/58	Loss: 0.556
Batch: 31/58	Loss: 0.512
Batch: 36/58	Loss: 0.632
Batch: 41/58	Loss: 0.501
Batch: 46/58	Loss: 0.460
Batch: 51/58	Loss: 0.609
Batch: 56/58	Loss: 0.554
Batch: 58/58	Loss: 0.589
Epoch: 14	Train Loss: 0.572	Val F1: 0.355
Best Epoch: 14	Best Val F1: 0.355

****************************** Epoch: 15 ******************************
Batch: 1/58	Loss: 0.522
Batch: 6/58	Loss: 0.560
Batch: 11/58	Loss: 0.518
Batch: 16/58	Loss: 0.567
Batch: 21/58	Loss: 0.559
Batch: 26/58	Loss: 0.645
Batch: 31/58	Loss: 0.496
Batch: 36/58	Loss: 0.647
Batch: 41/58	Loss: 0.561
Batch: 46/58	Loss: 0.539
Batch: 51/58	Loss: 0.491
Batch: 56/58	Loss: 0.496
Batch: 58/58	Loss: 0.590
Epoch: 15	Train Loss: 0.543	Val F1: 0.344
Best Epoch: 14	Best Val F1: 0.355

****************************** Epoch: 16 ******************************
Batch: 1/58	Loss: 0.590
Batch: 6/58	Loss: 0.416
Batch: 11/58	Loss: 0.452
Batch: 16/58	Loss: 0.501
Batch: 21/58	Loss: 0.417
Batch: 26/58	Loss: 0.533
Batch: 31/58	Loss: 0.571
Batch: 36/58	Loss: 0.433
Batch: 41/58	Loss: 0.495
Batch: 46/58	Loss: 0.470
Batch: 51/58	Loss: 0.560
Batch: 56/58	Loss: 0.463
Batch: 58/58	Loss: 0.460
Epoch: 16	Train Loss: 0.528	Val F1: 0.352
Best Epoch: 14	Best Val F1: 0.355

****************************** Epoch: 17 ******************************
Batch: 1/58	Loss: 0.476
Batch: 6/58	Loss: 0.597
Batch: 11/58	Loss: 0.438
Batch: 16/58	Loss: 0.458
Batch: 21/58	Loss: 0.531
Batch: 26/58	Loss: 0.522
Batch: 31/58	Loss: 0.451
Batch: 36/58	Loss: 0.433
Batch: 41/58	Loss: 0.486
Batch: 46/58	Loss: 0.556
Batch: 51/58	Loss: 0.432
Batch: 56/58	Loss: 0.468
Batch: 58/58	Loss: 0.682
Epoch: 17	Train Loss: 0.498	Val F1: 0.351
Best Epoch: 14	Best Val F1: 0.355

****************************** Epoch: 18 ******************************
Batch: 1/58	Loss: 0.503
Batch: 6/58	Loss: 0.461
Batch: 11/58	Loss: 0.530
Batch: 16/58	Loss: 0.626
Batch: 21/58	Loss: 0.531
Batch: 26/58	Loss: 0.469
Batch: 31/58	Loss: 0.411
Batch: 36/58	Loss: 0.396
Batch: 41/58	Loss: 0.397
Batch: 46/58	Loss: 0.490
Batch: 51/58	Loss: 0.426
Batch: 56/58	Loss: 0.364
Batch: 58/58	Loss: 0.678
Epoch: 18	Train Loss: 0.482	Val F1: 0.345
Best Epoch: 14	Best Val F1: 0.355

****************************** Epoch: 19 ******************************
Batch: 1/58	Loss: 0.415
Batch: 6/58	Loss: 0.396
Batch: 11/58	Loss: 0.480
Batch: 16/58	Loss: 0.342
Batch: 21/58	Loss: 0.590
Batch: 26/58	Loss: 0.476
Batch: 31/58	Loss: 0.380
Batch: 36/58	Loss: 0.426
Batch: 41/58	Loss: 0.390
Batch: 46/58	Loss: 0.609
Batch: 51/58	Loss: 0.491
Batch: 56/58	Loss: 0.481
Batch: 58/58	Loss: 0.391
Epoch: 19	Train Loss: 0.470	Val F1: 0.348
Best Epoch: 14	Best Val F1: 0.355

****************************** Epoch: 20 ******************************
Batch: 1/58	Loss: 0.536
Batch: 6/58	Loss: 0.382
Batch: 11/58	Loss: 0.381
Batch: 16/58	Loss: 0.404
Batch: 21/58	Loss: 0.414
Batch: 26/58	Loss: 0.482
Batch: 31/58	Loss: 0.510
Batch: 36/58	Loss: 0.367
Batch: 41/58	Loss: 0.390
Batch: 46/58	Loss: 0.623
Batch: 51/58	Loss: 0.440
Batch: 56/58	Loss: 0.315
Batch: 58/58	Loss: 0.486
Epoch: 20	Train Loss: 0.454	Val F1: 0.332
Best Epoch: 14	Best Val F1: 0.355

****************************** Epoch: 21 ******************************
Batch: 1/58	Loss: 0.503
Batch: 6/58	Loss: 0.382
Batch: 11/58	Loss: 0.367
Batch: 16/58	Loss: 0.378
Batch: 21/58	Loss: 0.405
Batch: 26/58	Loss: 0.419
Batch: 31/58	Loss: 0.286
Batch: 36/58	Loss: 0.525
Batch: 41/58	Loss: 0.408
Batch: 46/58	Loss: 0.324
Batch: 51/58	Loss: 0.383
Batch: 56/58	Loss: 0.352
Batch: 58/58	Loss: 0.328
Epoch: 21	Train Loss: 0.430	Val F1: 0.340
Best Epoch: 14	Best Val F1: 0.355

****************************** Epoch: 22 ******************************
Batch: 1/58	Loss: 0.485
Batch: 6/58	Loss: 0.360
Batch: 11/58	Loss: 0.395
Batch: 16/58	Loss: 0.349
Batch: 21/58	Loss: 0.427
Batch: 26/58	Loss: 0.341
Batch: 31/58	Loss: 0.467
Batch: 36/58	Loss: 0.411
Batch: 41/58	Loss: 0.585
Batch: 46/58	Loss: 0.478
Batch: 51/58	Loss: 0.325
Batch: 56/58	Loss: 0.387
Batch: 58/58	Loss: 0.643
Epoch: 22	Train Loss: 0.435	Val F1: 0.326
Best Epoch: 14	Best Val F1: 0.355

****************************** Epoch: 23 ******************************
Batch: 1/58	Loss: 0.401
Batch: 6/58	Loss: 0.401
Batch: 11/58	Loss: 0.311
Batch: 16/58	Loss: 0.547
Batch: 21/58	Loss: 0.518
Batch: 26/58	Loss: 0.391
Batch: 31/58	Loss: 0.374
Batch: 36/58	Loss: 0.484
Batch: 41/58	Loss: 0.338
Batch: 46/58	Loss: 0.379
Batch: 51/58	Loss: 0.266
Batch: 56/58	Loss: 0.276
Batch: 58/58	Loss: 0.419
Epoch: 23	Train Loss: 0.422	Val F1: 0.346
Best Epoch: 14	Best Val F1: 0.355

****************************** Epoch: 24 ******************************
Batch: 1/58	Loss: 0.428
Batch: 6/58	Loss: 0.472
Batch: 11/58	Loss: 0.377
Batch: 16/58	Loss: 0.441
Batch: 21/58	Loss: 0.524
Batch: 26/58	Loss: 0.299
Batch: 31/58	Loss: 0.380
Batch: 36/58	Loss: 0.325
Batch: 41/58	Loss: 0.310
Batch: 46/58	Loss: 0.355
Batch: 51/58	Loss: 0.403
Batch: 56/58	Loss: 0.429
Batch: 58/58	Loss: 0.372
Epoch: 24	Train Loss: 0.409	Val F1: 0.347
Best Epoch: 14	Best Val F1: 0.355

Saving the best checkpoint....
Inference...
Test F1: 0.388	Test F1_Few: 0.469	Test F1_Zero: 0.380
Starting training with config: {'batch_size': 32, 'epochs': 75, 'l2_reg': 0.0007968355324335026, 'lr': 9.657936934462376e-06, 'n_layers_freeze': 2, 'patience': 5}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/58	Loss: 1.091
Batch: 6/58	Loss: 1.067
Batch: 11/58	Loss: 1.029
Batch: 16/58	Loss: 0.987
Batch: 21/58	Loss: 0.970
Batch: 26/58	Loss: 0.954
Batch: 31/58	Loss: 0.927
Batch: 36/58	Loss: 0.939
Batch: 41/58	Loss: 0.896
Batch: 46/58	Loss: 0.880
Batch: 51/58	Loss: 0.868
Batch: 56/58	Loss: 0.869
Batch: 58/58	Loss: 0.872
Epoch: 1	Train Loss: 0.955	Val F1: 0.194
Best Epoch: 1	Best Val F1: 0.194

****************************** Epoch: 2 ******************************
Batch: 1/58	Loss: 0.877
Batch: 6/58	Loss: 0.880
Batch: 11/58	Loss: 0.881
Batch: 16/58	Loss: 0.835
Batch: 21/58	Loss: 0.830
Batch: 26/58	Loss: 0.832
Batch: 31/58	Loss: 0.861
Batch: 36/58	Loss: 0.857
Batch: 41/58	Loss: 0.821
Batch: 46/58	Loss: 0.815
Batch: 51/58	Loss: 0.815
Batch: 56/58	Loss: 0.818
Batch: 58/58	Loss: 0.799
Epoch: 2	Train Loss: 0.844	Val F1: 0.224
Best Epoch: 2	Best Val F1: 0.224

****************************** Epoch: 3 ******************************
Batch: 1/58	Loss: 0.804
Batch: 6/58	Loss: 0.786
Batch: 11/58	Loss: 0.837
Batch: 16/58	Loss: 0.804
Batch: 21/58	Loss: 0.794
Batch: 26/58	Loss: 0.810
Batch: 31/58	Loss: 0.891
Batch: 36/58	Loss: 0.802
Batch: 41/58	Loss: 0.770
Batch: 46/58	Loss: 0.758
Batch: 51/58	Loss: 0.791
Batch: 56/58	Loss: 0.767
Batch: 58/58	Loss: 0.789
Epoch: 3	Train Loss: 0.802	Val F1: 0.316
Best Epoch: 3	Best Val F1: 0.316

****************************** Epoch: 4 ******************************
Batch: 1/58	Loss: 0.781
Batch: 6/58	Loss: 0.757
Batch: 11/58	Loss: 0.765
Batch: 16/58	Loss: 0.735
Batch: 21/58	Loss: 0.668
Batch: 26/58	Loss: 0.700
Batch: 31/58	Loss: 0.707
Batch: 36/58	Loss: 0.785
Batch: 41/58	Loss: 0.763
Batch: 46/58	Loss: 0.705
Batch: 51/58	Loss: 0.729
Batch: 56/58	Loss: 0.703
Batch: 58/58	Loss: 0.727
Epoch: 4	Train Loss: 0.746	Val F1: 0.337
Best Epoch: 4	Best Val F1: 0.337

****************************** Epoch: 5 ******************************
Batch: 1/58	Loss: 0.673
Batch: 6/58	Loss: 0.647
Batch: 11/58	Loss: 0.680
Batch: 16/58	Loss: 0.658
Batch: 21/58	Loss: 0.596
Batch: 26/58	Loss: 0.644
Batch: 31/58	Loss: 0.776
Batch: 36/58	Loss: 0.762
Batch: 41/58	Loss: 0.734
Batch: 46/58	Loss: 0.710
Batch: 51/58	Loss: 0.792
Batch: 56/58	Loss: 0.744
Batch: 58/58	Loss: 0.796
Epoch: 5	Train Loss: 0.699	Val F1: 0.343
Best Epoch: 5	Best Val F1: 0.343

****************************** Epoch: 6 ******************************
Batch: 1/58	Loss: 0.656
Batch: 6/58	Loss: 0.722
Batch: 11/58	Loss: 0.716
Batch: 16/58	Loss: 0.646
Batch: 21/58	Loss: 0.661
Batch: 26/58	Loss: 0.610
Batch: 31/58	Loss: 0.647
Batch: 36/58	Loss: 0.580
Batch: 41/58	Loss: 0.641
Batch: 46/58	Loss: 0.618
Batch: 51/58	Loss: 0.593
Batch: 56/58	Loss: 0.636
Batch: 58/58	Loss: 0.540
Epoch: 6	Train Loss: 0.646	Val F1: 0.341
Best Epoch: 5	Best Val F1: 0.343

****************************** Epoch: 7 ******************************
Batch: 1/58	Loss: 0.537
Batch: 6/58	Loss: 0.650
Batch: 11/58	Loss: 0.744
Batch: 16/58	Loss: 0.495
Batch: 21/58	Loss: 0.557
Batch: 26/58	Loss: 0.606
Batch: 31/58	Loss: 0.629
Batch: 36/58	Loss: 0.558
Batch: 41/58	Loss: 0.540
Batch: 46/58	Loss: 0.582
Batch: 51/58	Loss: 0.536
Batch: 56/58	Loss: 0.601
Batch: 58/58	Loss: 0.480
Epoch: 7	Train Loss: 0.598	Val F1: 0.359
Best Epoch: 7	Best Val F1: 0.359

****************************** Epoch: 8 ******************************
Batch: 1/58	Loss: 0.548
Batch: 6/58	Loss: 0.551
Batch: 11/58	Loss: 0.483
Batch: 16/58	Loss: 0.531
Batch: 21/58	Loss: 0.563
Batch: 26/58	Loss: 0.474
Batch: 31/58	Loss: 0.505
Batch: 36/58	Loss: 0.472
Batch: 41/58	Loss: 0.600
Batch: 46/58	Loss: 0.599
Batch: 51/58	Loss: 0.538
Batch: 56/58	Loss: 0.512
Batch: 58/58	Loss: 0.529
Epoch: 8	Train Loss: 0.557	Val F1: 0.338
Best Epoch: 7	Best Val F1: 0.359

****************************** Epoch: 9 ******************************
Batch: 1/58	Loss: 0.518
Batch: 6/58	Loss: 0.581
Batch: 11/58	Loss: 0.571
Batch: 16/58	Loss: 0.411
Batch: 21/58	Loss: 0.422
Batch: 26/58	Loss: 0.430
Batch: 31/58	Loss: 0.410
Batch: 36/58	Loss: 0.543
Batch: 41/58	Loss: 0.590
Batch: 46/58	Loss: 0.529
Batch: 51/58	Loss: 0.637
Batch: 56/58	Loss: 0.439
Batch: 58/58	Loss: 0.431
Epoch: 9	Train Loss: 0.514	Val F1: 0.354
Best Epoch: 7	Best Val F1: 0.359

****************************** Epoch: 10 ******************************
Batch: 1/58	Loss: 0.426
Batch: 6/58	Loss: 0.465
Batch: 11/58	Loss: 0.489
Batch: 16/58	Loss: 0.557
Batch: 21/58	Loss: 0.394
Batch: 26/58	Loss: 0.525
Batch: 31/58	Loss: 0.386
Batch: 36/58	Loss: 0.611
Batch: 41/58	Loss: 0.554
Batch: 46/58	Loss: 0.550
Batch: 51/58	Loss: 0.446
Batch: 56/58	Loss: 0.414
Batch: 58/58	Loss: 0.649
Epoch: 10	Train Loss: 0.484	Val F1: 0.347
Best Epoch: 7	Best Val F1: 0.359

****************************** Epoch: 11 ******************************
Batch: 1/58	Loss: 0.470
Batch: 6/58	Loss: 0.444
Batch: 11/58	Loss: 0.347
Batch: 16/58	Loss: 0.466
Batch: 21/58	Loss: 0.430
Batch: 26/58	Loss: 0.540
Batch: 31/58	Loss: 0.465
Batch: 36/58	Loss: 0.504
Batch: 41/58	Loss: 0.429
Batch: 46/58	Loss: 0.371
Batch: 51/58	Loss: 0.451
Batch: 56/58	Loss: 0.465
Batch: 58/58	Loss: 0.425
Epoch: 11	Train Loss: 0.455	Val F1: 0.361
Best Epoch: 11	Best Val F1: 0.361

****************************** Epoch: 12 ******************************
Batch: 1/58	Loss: 0.498
Batch: 6/58	Loss: 0.333
Batch: 11/58	Loss: 0.364
Batch: 16/58	Loss: 0.436
Batch: 21/58	Loss: 0.497
Batch: 26/58	Loss: 0.354
Batch: 31/58	Loss: 0.485
Batch: 36/58	Loss: 0.412
Batch: 41/58	Loss: 0.350
Batch: 46/58	Loss: 0.435
Batch: 51/58	Loss: 0.541
Batch: 56/58	Loss: 0.396
Batch: 58/58	Loss: 0.200
Epoch: 12	Train Loss: 0.417	Val F1: 0.364
Best Epoch: 12	Best Val F1: 0.364

****************************** Epoch: 13 ******************************
Batch: 1/58	Loss: 0.456
Batch: 6/58	Loss: 0.345
Batch: 11/58	Loss: 0.438
Batch: 16/58	Loss: 0.322
Batch: 21/58	Loss: 0.371
Batch: 26/58	Loss: 0.376
Batch: 31/58	Loss: 0.386
Batch: 36/58	Loss: 0.427
Batch: 41/58	Loss: 0.375
Batch: 46/58	Loss: 0.477
Batch: 51/58	Loss: 0.345
Batch: 56/58	Loss: 0.478
Batch: 58/58	Loss: 0.425
Epoch: 13	Train Loss: 0.406	Val F1: 0.355
Best Epoch: 12	Best Val F1: 0.364

****************************** Epoch: 14 ******************************
Batch: 1/58	Loss: 0.428
Batch: 6/58	Loss: 0.483
Batch: 11/58	Loss: 0.409
Batch: 16/58	Loss: 0.465
Batch: 21/58	Loss: 0.358
Batch: 26/58	Loss: 0.376
Batch: 31/58	Loss: 0.387
Batch: 36/58	Loss: 0.368
Batch: 41/58	Loss: 0.249
Batch: 46/58	Loss: 0.310
Batch: 51/58	Loss: 0.440
Batch: 56/58	Loss: 0.311
Batch: 58/58	Loss: 0.419
Epoch: 14	Train Loss: 0.386	Val F1: 0.357
Best Epoch: 12	Best Val F1: 0.364

****************************** Epoch: 15 ******************************
Batch: 1/58	Loss: 0.280
Batch: 6/58	Loss: 0.439
Batch: 11/58	Loss: 0.372
Batch: 16/58	Loss: 0.357
Batch: 21/58	Loss: 0.459
Batch: 26/58	Loss: 0.338
Batch: 31/58	Loss: 0.303
Batch: 36/58	Loss: 0.391
Batch: 41/58	Loss: 0.459
Batch: 46/58	Loss: 0.323
Batch: 51/58	Loss: 0.285
Batch: 56/58	Loss: 0.279
Batch: 58/58	Loss: 0.598
Epoch: 15	Train Loss: 0.371	Val F1: 0.350
Best Epoch: 12	Best Val F1: 0.364

****************************** Epoch: 16 ******************************
Batch: 1/58	Loss: 0.340
Batch: 6/58	Loss: 0.258
Batch: 11/58	Loss: 0.234
Batch: 16/58	Loss: 0.340
Batch: 21/58	Loss: 0.319
Batch: 26/58	Loss: 0.354
Batch: 31/58	Loss: 0.404
Batch: 36/58	Loss: 0.313
Batch: 41/58	Loss: 0.299
Batch: 46/58	Loss: 0.293
Batch: 51/58	Loss: 0.437
Batch: 56/58	Loss: 0.295
Batch: 58/58	Loss: 0.308
Epoch: 16	Train Loss: 0.368	Val F1: 0.358
Best Epoch: 12	Best Val F1: 0.364

****************************** Epoch: 17 ******************************
Batch: 1/58	Loss: 0.266
Batch: 6/58	Loss: 0.404
Batch: 11/58	Loss: 0.276
Batch: 16/58	Loss: 0.365
Batch: 21/58	Loss: 0.414
Batch: 26/58	Loss: 0.420
Batch: 31/58	Loss: 0.283
Batch: 36/58	Loss: 0.300
Batch: 41/58	Loss: 0.362
Batch: 46/58	Loss: 0.433
Batch: 51/58	Loss: 0.309
Batch: 56/58	Loss: 0.271
Batch: 58/58	Loss: 0.340
Epoch: 17	Train Loss: 0.340	Val F1: 0.350
Best Epoch: 12	Best Val F1: 0.364

Saving the best checkpoint....
Inference...
Test F1: 0.375	Test F1_Few: 0.453	Test F1_Zero: 0.367
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0009734259272678764, 'lr': 3.763552708073967e-05, 'n_layers_freeze': 2, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.044
Batch: 5/29	Loss: 0.985
Batch: 7/29	Loss: 0.956
Batch: 9/29	Loss: 0.926
Batch: 11/29	Loss: 0.923
Batch: 13/29	Loss: 0.908
Batch: 15/29	Loss: 0.923
Batch: 17/29	Loss: 0.871
Batch: 19/29	Loss: 0.876
Batch: 21/29	Loss: 0.846
Batch: 23/29	Loss: 0.864
Batch: 25/29	Loss: 0.818
Batch: 27/29	Loss: 0.820
Batch: 29/29	Loss: 0.832
Epoch: 1	Train Loss: 0.910	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.185

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.821
Batch: 3/29	Loss: 0.820
Batch: 5/29	Loss: 0.863
Batch: 7/29	Loss: 0.805
Batch: 9/29	Loss: 0.830
Batch: 11/29	Loss: 0.771
Batch: 13/29	Loss: 0.775
Batch: 15/29	Loss: 0.801
Batch: 17/29	Loss: 0.793
Batch: 19/29	Loss: 0.844
Batch: 21/29	Loss: 0.779
Batch: 23/29	Loss: 0.792
Batch: 25/29	Loss: 0.759
Batch: 27/29	Loss: 0.843
Batch: 29/29	Loss: 0.764
Epoch: 2	Train Loss: 0.798	Val F1: 0.222
Best Epoch: 2	Best Val F1: 0.222

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.750
Batch: 3/29	Loss: 0.783
Batch: 5/29	Loss: 0.763
Batch: 7/29	Loss: 0.814
Batch: 9/29	Loss: 0.740
Batch: 11/29	Loss: 0.743
Batch: 13/29	Loss: 0.807
Batch: 15/29	Loss: 0.757
Batch: 17/29	Loss: 0.780
Batch: 19/29	Loss: 0.770
Batch: 21/29	Loss: 0.727
Batch: 23/29	Loss: 0.724
Batch: 25/29	Loss: 0.757
Batch: 27/29	Loss: 0.760
Batch: 29/29	Loss: 0.744
Epoch: 3	Train Loss: 0.760	Val F1: 0.328
Best Epoch: 3	Best Val F1: 0.328

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.709
Batch: 3/29	Loss: 0.727
Batch: 5/29	Loss: 0.705
Batch: 7/29	Loss: 0.771
Batch: 9/29	Loss: 0.724
Batch: 11/29	Loss: 0.635
Batch: 13/29	Loss: 0.685
Batch: 15/29	Loss: 0.676
Batch: 17/29	Loss: 0.683
Batch: 19/29	Loss: 0.735
Batch: 21/29	Loss: 0.691
Batch: 23/29	Loss: 0.703
Batch: 25/29	Loss: 0.684
Batch: 27/29	Loss: 0.739
Batch: 29/29	Loss: 0.699
Epoch: 4	Train Loss: 0.706	Val F1: 0.336
Best Epoch: 4	Best Val F1: 0.336

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.658
Batch: 3/29	Loss: 0.626
Batch: 5/29	Loss: 0.609
Batch: 7/29	Loss: 0.642
Batch: 9/29	Loss: 0.604
Batch: 11/29	Loss: 0.649
Batch: 13/29	Loss: 0.634
Batch: 15/29	Loss: 0.685
Batch: 17/29	Loss: 0.688
Batch: 19/29	Loss: 0.698
Batch: 21/29	Loss: 0.661
Batch: 23/29	Loss: 0.640
Batch: 25/29	Loss: 0.674
Batch: 27/29	Loss: 0.633
Batch: 29/29	Loss: 0.688
Epoch: 5	Train Loss: 0.662	Val F1: 0.343
Best Epoch: 5	Best Val F1: 0.343

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.631
Batch: 3/29	Loss: 0.704
Batch: 5/29	Loss: 0.529
Batch: 7/29	Loss: 0.697
Batch: 9/29	Loss: 0.665
Batch: 11/29	Loss: 0.590
Batch: 13/29	Loss: 0.676
Batch: 15/29	Loss: 0.561
Batch: 17/29	Loss: 0.565
Batch: 19/29	Loss: 0.636
Batch: 21/29	Loss: 0.621
Batch: 23/29	Loss: 0.658
Batch: 25/29	Loss: 0.639
Batch: 27/29	Loss: 0.608
Batch: 29/29	Loss: 0.576
Epoch: 6	Train Loss: 0.615	Val F1: 0.362
Best Epoch: 6	Best Val F1: 0.362

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.549
Batch: 3/29	Loss: 0.616
Batch: 5/29	Loss: 0.684
Batch: 7/29	Loss: 0.602
Batch: 9/29	Loss: 0.595
Batch: 11/29	Loss: 0.459
Batch: 13/29	Loss: 0.537
Batch: 15/29	Loss: 0.536
Batch: 17/29	Loss: 0.622
Batch: 19/29	Loss: 0.582
Batch: 21/29	Loss: 0.571
Batch: 23/29	Loss: 0.504
Batch: 25/29	Loss: 0.457
Batch: 27/29	Loss: 0.505
Batch: 29/29	Loss: 0.517
Epoch: 7	Train Loss: 0.553	Val F1: 0.368
Best Epoch: 7	Best Val F1: 0.368

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.519
Batch: 3/29	Loss: 0.411
Batch: 5/29	Loss: 0.538
Batch: 7/29	Loss: 0.540
Batch: 9/29	Loss: 0.421
Batch: 11/29	Loss: 0.534
Batch: 13/29	Loss: 0.529
Batch: 15/29	Loss: 0.494
Batch: 17/29	Loss: 0.550
Batch: 19/29	Loss: 0.438
Batch: 21/29	Loss: 0.523
Batch: 23/29	Loss: 0.564
Batch: 25/29	Loss: 0.649
Batch: 27/29	Loss: 0.532
Batch: 29/29	Loss: 0.477
Epoch: 8	Train Loss: 0.502	Val F1: 0.346
Best Epoch: 7	Best Val F1: 0.368

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.517
Batch: 3/29	Loss: 0.488
Batch: 5/29	Loss: 0.496
Batch: 7/29	Loss: 0.380
Batch: 9/29	Loss: 0.497
Batch: 11/29	Loss: 0.452
Batch: 13/29	Loss: 0.442
Batch: 15/29	Loss: 0.376
Batch: 17/29	Loss: 0.399
Batch: 19/29	Loss: 0.352
Batch: 21/29	Loss: 0.505
Batch: 23/29	Loss: 0.428
Batch: 25/29	Loss: 0.410
Batch: 27/29	Loss: 0.479
Batch: 29/29	Loss: 0.378
Epoch: 9	Train Loss: 0.441	Val F1: 0.347
Best Epoch: 7	Best Val F1: 0.368

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.329
Batch: 3/29	Loss: 0.404
Batch: 5/29	Loss: 0.330
Batch: 7/29	Loss: 0.493
Batch: 9/29	Loss: 0.380
Batch: 11/29	Loss: 0.338
Batch: 13/29	Loss: 0.417
Batch: 15/29	Loss: 0.375
Batch: 17/29	Loss: 0.483
Batch: 19/29	Loss: 0.275
Batch: 21/29	Loss: 0.474
Batch: 23/29	Loss: 0.504
Batch: 25/29	Loss: 0.580
Batch: 27/29	Loss: 0.369
Batch: 29/29	Loss: 0.536
Epoch: 10	Train Loss: 0.408	Val F1: 0.351
Best Epoch: 7	Best Val F1: 0.368

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.390
Batch: 3/29	Loss: 0.419
Batch: 5/29	Loss: 0.499
Batch: 7/29	Loss: 0.401
Batch: 9/29	Loss: 0.348
Batch: 11/29	Loss: 0.442
Batch: 13/29	Loss: 0.366
Batch: 15/29	Loss: 0.309
Batch: 17/29	Loss: 0.381
Batch: 19/29	Loss: 0.433
Batch: 21/29	Loss: 0.311
Batch: 23/29	Loss: 0.315
Batch: 25/29	Loss: 0.323
Batch: 27/29	Loss: 0.357
Batch: 29/29	Loss: 0.371
Epoch: 11	Train Loss: 0.383	Val F1: 0.356
Best Epoch: 7	Best Val F1: 0.368

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.433
Batch: 3/29	Loss: 0.300
Batch: 5/29	Loss: 0.314
Batch: 7/29	Loss: 0.316
Batch: 9/29	Loss: 0.350
Batch: 11/29	Loss: 0.348
Batch: 13/29	Loss: 0.342
Batch: 15/29	Loss: 0.341
Batch: 17/29	Loss: 0.306
Batch: 19/29	Loss: 0.289
Batch: 21/29	Loss: 0.373
Batch: 23/29	Loss: 0.349
Batch: 25/29	Loss: 0.324
Batch: 27/29	Loss: 0.426
Batch: 29/29	Loss: 0.259
Epoch: 12	Train Loss: 0.341	Val F1: 0.346
Best Epoch: 7	Best Val F1: 0.368

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.329
Batch: 3/29	Loss: 0.250
Batch: 5/29	Loss: 0.364
Batch: 7/29	Loss: 0.277
Batch: 9/29	Loss: 0.380
Batch: 11/29	Loss: 0.331
Batch: 13/29	Loss: 0.343
Batch: 15/29	Loss: 0.272
Batch: 17/29	Loss: 0.297
Batch: 19/29	Loss: 0.202
Batch: 21/29	Loss: 0.284
Batch: 23/29	Loss: 0.307
Batch: 25/29	Loss: 0.232
Batch: 27/29	Loss: 0.343
Batch: 29/29	Loss: 0.359
Epoch: 13	Train Loss: 0.319	Val F1: 0.346
Best Epoch: 7	Best Val F1: 0.368

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.323
Batch: 3/29	Loss: 0.332
Batch: 5/29	Loss: 0.240
Batch: 7/29	Loss: 0.298
Batch: 9/29	Loss: 0.302
Batch: 11/29	Loss: 0.275
Batch: 13/29	Loss: 0.279
Batch: 15/29	Loss: 0.238
Batch: 17/29	Loss: 0.360
Batch: 19/29	Loss: 0.339
Batch: 21/29	Loss: 0.169
Batch: 23/29	Loss: 0.223
Batch: 25/29	Loss: 0.337
Batch: 27/29	Loss: 0.254
Batch: 29/29	Loss: 0.260
Epoch: 14	Train Loss: 0.285	Val F1: 0.351
Best Epoch: 7	Best Val F1: 0.368

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.266
Batch: 3/29	Loss: 0.265
Batch: 5/29	Loss: 0.182
Batch: 7/29	Loss: 0.232
Batch: 9/29	Loss: 0.283
Batch: 11/29	Loss: 0.263
Batch: 13/29	Loss: 0.267
Batch: 15/29	Loss: 0.256
Batch: 17/29	Loss: 0.318
Batch: 19/29	Loss: 0.215
Batch: 21/29	Loss: 0.272
Batch: 23/29	Loss: 0.255
Batch: 25/29	Loss: 0.319
Batch: 27/29	Loss: 0.225
Batch: 29/29	Loss: 0.261
Epoch: 15	Train Loss: 0.262	Val F1: 0.359
Best Epoch: 7	Best Val F1: 0.368

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.261
Batch: 3/29	Loss: 0.251
Batch: 5/29	Loss: 0.259
Batch: 7/29	Loss: 0.202
Batch: 9/29	Loss: 0.246
Batch: 11/29	Loss: 0.207
Batch: 13/29	Loss: 0.208
Batch: 15/29	Loss: 0.195
Batch: 17/29	Loss: 0.232
Batch: 19/29	Loss: 0.288
Batch: 21/29	Loss: 0.202
Batch: 23/29	Loss: 0.235
Batch: 25/29	Loss: 0.347
Batch: 27/29	Loss: 0.255
Batch: 29/29	Loss: 0.218
Epoch: 16	Train Loss: 0.239	Val F1: 0.352
Best Epoch: 7	Best Val F1: 0.368

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.264
Batch: 3/29	Loss: 0.261
Batch: 5/29	Loss: 0.245
Batch: 7/29	Loss: 0.255
Batch: 9/29	Loss: 0.152
Batch: 11/29	Loss: 0.203
Batch: 13/29	Loss: 0.237
Batch: 15/29	Loss: 0.218
Batch: 17/29	Loss: 0.240
Batch: 19/29	Loss: 0.216
Batch: 21/29	Loss: 0.220
Batch: 23/29	Loss: 0.332
Batch: 25/29	Loss: 0.123
Batch: 27/29	Loss: 0.173
Batch: 29/29	Loss: 0.205
Epoch: 17	Train Loss: 0.218	Val F1: 0.352
Best Epoch: 7	Best Val F1: 0.368

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.169
Batch: 3/29	Loss: 0.252
Batch: 5/29	Loss: 0.216
Batch: 7/29	Loss: 0.138
Batch: 9/29	Loss: 0.296
Batch: 11/29	Loss: 0.119
Batch: 13/29	Loss: 0.146
Batch: 15/29	Loss: 0.170
Batch: 17/29	Loss: 0.165
Batch: 19/29	Loss: 0.101
Batch: 21/29	Loss: 0.167
Batch: 23/29	Loss: 0.132
Batch: 25/29	Loss: 0.165
Batch: 27/29	Loss: 0.126
Batch: 29/29	Loss: 0.202
Epoch: 18	Train Loss: 0.169	Val F1: 0.340
Best Epoch: 7	Best Val F1: 0.368

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.182
Batch: 3/29	Loss: 0.120
Batch: 5/29	Loss: 0.197
Batch: 7/29	Loss: 0.167
Batch: 9/29	Loss: 0.156
Batch: 11/29	Loss: 0.177
Batch: 13/29	Loss: 0.128
Batch: 15/29	Loss: 0.151
Batch: 17/29	Loss: 0.118
Batch: 19/29	Loss: 0.189
Batch: 21/29	Loss: 0.123
Batch: 23/29	Loss: 0.135
Batch: 25/29	Loss: 0.151
Batch: 27/29	Loss: 0.091
Batch: 29/29	Loss: 0.146
Epoch: 19	Train Loss: 0.140	Val F1: 0.358
Best Epoch: 7	Best Val F1: 0.368

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.135
Batch: 3/29	Loss: 0.134
Batch: 5/29	Loss: 0.103
Batch: 7/29	Loss: 0.070
Batch: 9/29	Loss: 0.151
Batch: 11/29	Loss: 0.122
Batch: 13/29	Loss: 0.137
Batch: 15/29	Loss: 0.097
Batch: 17/29	Loss: 0.161
Batch: 19/29	Loss: 0.081
Batch: 21/29	Loss: 0.087
Batch: 23/29	Loss: 0.138
Batch: 25/29	Loss: 0.113
Batch: 27/29	Loss: 0.123
Batch: 29/29	Loss: 0.098
Epoch: 20	Train Loss: 0.120	Val F1: 0.347
Best Epoch: 7	Best Val F1: 0.368

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.094
Batch: 3/29	Loss: 0.100
Batch: 5/29	Loss: 0.100
Batch: 7/29	Loss: 0.240
Batch: 9/29	Loss: 0.091
Batch: 11/29	Loss: 0.081
Batch: 13/29	Loss: 0.215
Batch: 15/29	Loss: 0.123
Batch: 17/29	Loss: 0.080
Batch: 19/29	Loss: 0.078
Batch: 21/29	Loss: 0.118
Batch: 23/29	Loss: 0.171
Batch: 25/29	Loss: 0.085
Batch: 27/29	Loss: 0.126
Batch: 29/29	Loss: 0.080
Epoch: 21	Train Loss: 0.114	Val F1: 0.346
Best Epoch: 7	Best Val F1: 0.368

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.077
Batch: 3/29	Loss: 0.122
Batch: 5/29	Loss: 0.074
Batch: 7/29	Loss: 0.102
Batch: 9/29	Loss: 0.083
Batch: 11/29	Loss: 0.130
Batch: 13/29	Loss: 0.113
Batch: 15/29	Loss: 0.051
Batch: 17/29	Loss: 0.111
Batch: 19/29	Loss: 0.106
Batch: 21/29	Loss: 0.094
Batch: 23/29	Loss: 0.084
Batch: 25/29	Loss: 0.108
Batch: 27/29	Loss: 0.060
Batch: 29/29	Loss: 0.114
Epoch: 22	Train Loss: 0.090	Val F1: 0.353
Best Epoch: 7	Best Val F1: 0.368

Saving the best checkpoint....
Inference...
Test F1: 0.373	Test F1_Few: 0.447	Test F1_Zero: 0.369
Starting training with config: {'batch_size': 64, 'epochs': 25, 'l2_reg': 0.0008577237048958042, 'lr': 2.0158494575231805e-05, 'n_layers_freeze': 3, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.068
Batch: 5/29	Loss: 1.035
Batch: 7/29	Loss: 1.012
Batch: 9/29	Loss: 0.985
Batch: 11/29	Loss: 0.969
Batch: 13/29	Loss: 0.956
Batch: 15/29	Loss: 0.960
Batch: 17/29	Loss: 0.920
Batch: 19/29	Loss: 0.917
Batch: 21/29	Loss: 0.897
Batch: 23/29	Loss: 0.904
Batch: 25/29	Loss: 0.871
Batch: 27/29	Loss: 0.867
Batch: 29/29	Loss: 0.875
Epoch: 1	Train Loss: 0.954	Val F1: 0.199
Best Epoch: 1	Best Val F1: 0.199

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.866
Batch: 3/29	Loss: 0.865
Batch: 5/29	Loss: 0.894
Batch: 7/29	Loss: 0.852
Batch: 9/29	Loss: 0.867
Batch: 11/29	Loss: 0.823
Batch: 13/29	Loss: 0.823
Batch: 15/29	Loss: 0.845
Batch: 17/29	Loss: 0.834
Batch: 19/29	Loss: 0.868
Batch: 21/29	Loss: 0.820
Batch: 23/29	Loss: 0.828
Batch: 25/29	Loss: 0.805
Batch: 27/29	Loss: 0.865
Batch: 29/29	Loss: 0.807
Epoch: 2	Train Loss: 0.840	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.199

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.797
Batch: 3/29	Loss: 0.817
Batch: 5/29	Loss: 0.805
Batch: 7/29	Loss: 0.837
Batch: 9/29	Loss: 0.786
Batch: 11/29	Loss: 0.786
Batch: 13/29	Loss: 0.828
Batch: 15/29	Loss: 0.796
Batch: 17/29	Loss: 0.813
Batch: 19/29	Loss: 0.806
Batch: 21/29	Loss: 0.782
Batch: 23/29	Loss: 0.775
Batch: 25/29	Loss: 0.796
Batch: 27/29	Loss: 0.768
Batch: 29/29	Loss: 0.781
Epoch: 3	Train Loss: 0.800	Val F1: 0.264
Best Epoch: 3	Best Val F1: 0.264

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.757
Batch: 3/29	Loss: 0.774
Batch: 5/29	Loss: 0.751
Batch: 7/29	Loss: 0.812
Batch: 9/29	Loss: 0.786
Batch: 11/29	Loss: 0.734
Batch: 13/29	Loss: 0.743
Batch: 15/29	Loss: 0.736
Batch: 17/29	Loss: 0.736
Batch: 19/29	Loss: 0.772
Batch: 21/29	Loss: 0.761
Batch: 23/29	Loss: 0.761
Batch: 25/29	Loss: 0.737
Batch: 27/29	Loss: 0.770
Batch: 29/29	Loss: 0.748
Epoch: 4	Train Loss: 0.764	Val F1: 0.253
Best Epoch: 3	Best Val F1: 0.264

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.726
Batch: 3/29	Loss: 0.738
Batch: 5/29	Loss: 0.691
Batch: 7/29	Loss: 0.722
Batch: 9/29	Loss: 0.705
Batch: 11/29	Loss: 0.705
Batch: 13/29	Loss: 0.674
Batch: 15/29	Loss: 0.731
Batch: 17/29	Loss: 0.774
Batch: 19/29	Loss: 0.729
Batch: 21/29	Loss: 0.692
Batch: 23/29	Loss: 0.752
Batch: 25/29	Loss: 0.719
Batch: 27/29	Loss: 0.686
Batch: 29/29	Loss: 0.729
Epoch: 5	Train Loss: 0.726	Val F1: 0.328
Best Epoch: 5	Best Val F1: 0.328

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.728
Batch: 3/29	Loss: 0.759
Batch: 5/29	Loss: 0.628
Batch: 7/29	Loss: 0.763
Batch: 9/29	Loss: 0.671
Batch: 11/29	Loss: 0.654
Batch: 13/29	Loss: 0.702
Batch: 15/29	Loss: 0.604
Batch: 17/29	Loss: 0.641
Batch: 19/29	Loss: 0.649
Batch: 21/29	Loss: 0.744
Batch: 23/29	Loss: 0.692
Batch: 25/29	Loss: 0.650
Batch: 27/29	Loss: 0.650
Batch: 29/29	Loss: 0.679
Epoch: 6	Train Loss: 0.680	Val F1: 0.318
Best Epoch: 5	Best Val F1: 0.328

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.645
Batch: 3/29	Loss: 0.732
Batch: 5/29	Loss: 0.725
Batch: 7/29	Loss: 0.653
Batch: 9/29	Loss: 0.674
Batch: 11/29	Loss: 0.577
Batch: 13/29	Loss: 0.610
Batch: 15/29	Loss: 0.576
Batch: 17/29	Loss: 0.652
Batch: 19/29	Loss: 0.654
Batch: 21/29	Loss: 0.599
Batch: 23/29	Loss: 0.610
Batch: 25/29	Loss: 0.556
Batch: 27/29	Loss: 0.617
Batch: 29/29	Loss: 0.622
Epoch: 7	Train Loss: 0.635	Val F1: 0.333
Best Epoch: 7	Best Val F1: 0.333

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.591
Batch: 3/29	Loss: 0.611
Batch: 5/29	Loss: 0.616
Batch: 7/29	Loss: 0.600
Batch: 9/29	Loss: 0.583
Batch: 11/29	Loss: 0.616
Batch: 13/29	Loss: 0.646
Batch: 15/29	Loss: 0.542
Batch: 17/29	Loss: 0.600
Batch: 19/29	Loss: 0.615
Batch: 21/29	Loss: 0.621
Batch: 23/29	Loss: 0.645
Batch: 25/29	Loss: 0.691
Batch: 27/29	Loss: 0.593
Batch: 29/29	Loss: 0.592
Epoch: 8	Train Loss: 0.599	Val F1: 0.342
Best Epoch: 8	Best Val F1: 0.342

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.603
Batch: 3/29	Loss: 0.563
Batch: 5/29	Loss: 0.550
Batch: 7/29	Loss: 0.505
Batch: 9/29	Loss: 0.601
Batch: 11/29	Loss: 0.591
Batch: 13/29	Loss: 0.603
Batch: 15/29	Loss: 0.497
Batch: 17/29	Loss: 0.502
Batch: 19/29	Loss: 0.465
Batch: 21/29	Loss: 0.595
Batch: 23/29	Loss: 0.586
Batch: 25/29	Loss: 0.503
Batch: 27/29	Loss: 0.648
Batch: 29/29	Loss: 0.513
Epoch: 9	Train Loss: 0.551	Val F1: 0.341
Best Epoch: 8	Best Val F1: 0.342

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.487
Batch: 3/29	Loss: 0.504
Batch: 5/29	Loss: 0.536
Batch: 7/29	Loss: 0.567
Batch: 9/29	Loss: 0.561
Batch: 11/29	Loss: 0.446
Batch: 13/29	Loss: 0.689
Batch: 15/29	Loss: 0.587
Batch: 17/29	Loss: 0.634
Batch: 19/29	Loss: 0.408
Batch: 21/29	Loss: 0.603
Batch: 23/29	Loss: 0.541
Batch: 25/29	Loss: 0.550
Batch: 27/29	Loss: 0.491
Batch: 29/29	Loss: 0.619
Epoch: 10	Train Loss: 0.534	Val F1: 0.346
Best Epoch: 10	Best Val F1: 0.346

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.489
Batch: 3/29	Loss: 0.435
Batch: 5/29	Loss: 0.614
Batch: 7/29	Loss: 0.507
Batch: 9/29	Loss: 0.456
Batch: 11/29	Loss: 0.480
Batch: 13/29	Loss: 0.438
Batch: 15/29	Loss: 0.362
Batch: 17/29	Loss: 0.539
Batch: 19/29	Loss: 0.507
Batch: 21/29	Loss: 0.423
Batch: 23/29	Loss: 0.387
Batch: 25/29	Loss: 0.425
Batch: 27/29	Loss: 0.433
Batch: 29/29	Loss: 0.475
Epoch: 11	Train Loss: 0.472	Val F1: 0.339
Best Epoch: 10	Best Val F1: 0.346

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.591
Batch: 3/29	Loss: 0.377
Batch: 5/29	Loss: 0.453
Batch: 7/29	Loss: 0.470
Batch: 9/29	Loss: 0.461
Batch: 11/29	Loss: 0.485
Batch: 13/29	Loss: 0.385
Batch: 15/29	Loss: 0.398
Batch: 17/29	Loss: 0.467
Batch: 19/29	Loss: 0.377
Batch: 21/29	Loss: 0.462
Batch: 23/29	Loss: 0.477
Batch: 25/29	Loss: 0.453
Batch: 27/29	Loss: 0.530
Batch: 29/29	Loss: 0.307
Epoch: 12	Train Loss: 0.440	Val F1: 0.336
Best Epoch: 10	Best Val F1: 0.346

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.419
Batch: 3/29	Loss: 0.399
Batch: 5/29	Loss: 0.444
Batch: 7/29	Loss: 0.467
Batch: 9/29	Loss: 0.481
Batch: 11/29	Loss: 0.447
Batch: 13/29	Loss: 0.433
Batch: 15/29	Loss: 0.528
Batch: 17/29	Loss: 0.365
Batch: 19/29	Loss: 0.284
Batch: 21/29	Loss: 0.401
Batch: 23/29	Loss: 0.400
Batch: 25/29	Loss: 0.293
Batch: 27/29	Loss: 0.430
Batch: 29/29	Loss: 0.556
Epoch: 13	Train Loss: 0.437	Val F1: 0.329
Best Epoch: 10	Best Val F1: 0.346

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.450
Batch: 3/29	Loss: 0.422
Batch: 5/29	Loss: 0.318
Batch: 7/29	Loss: 0.416
Batch: 9/29	Loss: 0.450
Batch: 11/29	Loss: 0.338
Batch: 13/29	Loss: 0.341
Batch: 15/29	Loss: 0.303
Batch: 17/29	Loss: 0.454
Batch: 19/29	Loss: 0.437
Batch: 21/29	Loss: 0.250
Batch: 23/29	Loss: 0.329
Batch: 25/29	Loss: 0.370
Batch: 27/29	Loss: 0.364
Batch: 29/29	Loss: 0.363
Epoch: 14	Train Loss: 0.386	Val F1: 0.338
Best Epoch: 10	Best Val F1: 0.346

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.373
Batch: 3/29	Loss: 0.358
Batch: 5/29	Loss: 0.282
Batch: 7/29	Loss: 0.349
Batch: 9/29	Loss: 0.397
Batch: 11/29	Loss: 0.364
Batch: 13/29	Loss: 0.363
Batch: 15/29	Loss: 0.346
Batch: 17/29	Loss: 0.418
Batch: 19/29	Loss: 0.361
Batch: 21/29	Loss: 0.381
Batch: 23/29	Loss: 0.413
Batch: 25/29	Loss: 0.416
Batch: 27/29	Loss: 0.323
Batch: 29/29	Loss: 0.461
Epoch: 15	Train Loss: 0.376	Val F1: 0.347
Best Epoch: 15	Best Val F1: 0.347

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.392
Batch: 3/29	Loss: 0.366
Batch: 5/29	Loss: 0.379
Batch: 7/29	Loss: 0.296
Batch: 9/29	Loss: 0.345
Batch: 11/29	Loss: 0.376
Batch: 13/29	Loss: 0.312
Batch: 15/29	Loss: 0.292
Batch: 17/29	Loss: 0.333
Batch: 19/29	Loss: 0.419
Batch: 21/29	Loss: 0.301
Batch: 23/29	Loss: 0.388
Batch: 25/29	Loss: 0.401
Batch: 27/29	Loss: 0.375
Batch: 29/29	Loss: 0.353
Epoch: 16	Train Loss: 0.358	Val F1: 0.347
Best Epoch: 16	Best Val F1: 0.347

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.307
Batch: 3/29	Loss: 0.475
Batch: 5/29	Loss: 0.332
Batch: 7/29	Loss: 0.313
Batch: 9/29	Loss: 0.247
Batch: 11/29	Loss: 0.384
Batch: 13/29	Loss: 0.394
Batch: 15/29	Loss: 0.361
Batch: 17/29	Loss: 0.373
Batch: 19/29	Loss: 0.312
Batch: 21/29	Loss: 0.354
Batch: 23/29	Loss: 0.423
Batch: 25/29	Loss: 0.209
Batch: 27/29	Loss: 0.358
Batch: 29/29	Loss: 0.366
Epoch: 17	Train Loss: 0.343	Val F1: 0.320
Best Epoch: 16	Best Val F1: 0.347

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.403
Batch: 3/29	Loss: 0.409
Batch: 5/29	Loss: 0.322
Batch: 7/29	Loss: 0.300
Batch: 9/29	Loss: 0.456
Batch: 11/29	Loss: 0.302
Batch: 13/29	Loss: 0.245
Batch: 15/29	Loss: 0.316
Batch: 17/29	Loss: 0.329
Batch: 19/29	Loss: 0.256
Batch: 21/29	Loss: 0.325
Batch: 23/29	Loss: 0.360
Batch: 25/29	Loss: 0.372
Batch: 27/29	Loss: 0.249
Batch: 29/29	Loss: 0.351
Epoch: 18	Train Loss: 0.329	Val F1: 0.342
Best Epoch: 16	Best Val F1: 0.347

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.251
Batch: 3/29	Loss: 0.231
Batch: 5/29	Loss: 0.340
Batch: 7/29	Loss: 0.366
Batch: 9/29	Loss: 0.252
Batch: 11/29	Loss: 0.354
Batch: 13/29	Loss: 0.362
Batch: 15/29	Loss: 0.301
Batch: 17/29	Loss: 0.258
Batch: 19/29	Loss: 0.342
Batch: 21/29	Loss: 0.275
Batch: 23/29	Loss: 0.322
Batch: 25/29	Loss: 0.350
Batch: 27/29	Loss: 0.279
Batch: 29/29	Loss: 0.296
Epoch: 19	Train Loss: 0.309	Val F1: 0.349
Best Epoch: 19	Best Val F1: 0.349

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.357
Batch: 3/29	Loss: 0.307
Batch: 5/29	Loss: 0.284
Batch: 7/29	Loss: 0.228
Batch: 9/29	Loss: 0.307
Batch: 11/29	Loss: 0.339
Batch: 13/29	Loss: 0.264
Batch: 15/29	Loss: 0.308
Batch: 17/29	Loss: 0.381
Batch: 19/29	Loss: 0.256
Batch: 21/29	Loss: 0.260
Batch: 23/29	Loss: 0.376
Batch: 25/29	Loss: 0.292
Batch: 27/29	Loss: 0.323
Batch: 29/29	Loss: 0.329
Epoch: 20	Train Loss: 0.294	Val F1: 0.359
Best Epoch: 20	Best Val F1: 0.359

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.260
Batch: 3/29	Loss: 0.217
Batch: 5/29	Loss: 0.257
Batch: 7/29	Loss: 0.448
Batch: 9/29	Loss: 0.265
Batch: 11/29	Loss: 0.204
Batch: 13/29	Loss: 0.351
Batch: 15/29	Loss: 0.345
Batch: 17/29	Loss: 0.239
Batch: 19/29	Loss: 0.292
Batch: 21/29	Loss: 0.260
Batch: 23/29	Loss: 0.223
Batch: 25/29	Loss: 0.280
Batch: 27/29	Loss: 0.249
Batch: 29/29	Loss: 0.318
Epoch: 21	Train Loss: 0.280	Val F1: 0.345
Best Epoch: 20	Best Val F1: 0.359

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.296
Batch: 3/29	Loss: 0.253
Batch: 5/29	Loss: 0.296
Batch: 7/29	Loss: 0.315
Batch: 9/29	Loss: 0.244
Batch: 11/29	Loss: 0.348
Batch: 13/29	Loss: 0.191
Batch: 15/29	Loss: 0.235
Batch: 17/29	Loss: 0.354
Batch: 19/29	Loss: 0.304
Batch: 21/29	Loss: 0.337
Batch: 23/29	Loss: 0.270
Batch: 25/29	Loss: 0.269
Batch: 27/29	Loss: 0.229
Batch: 29/29	Loss: 0.214
Epoch: 22	Train Loss: 0.271	Val F1: 0.369
Best Epoch: 22	Best Val F1: 0.369

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.284
Batch: 3/29	Loss: 0.256
Batch: 5/29	Loss: 0.270
Batch: 7/29	Loss: 0.355
Batch: 9/29	Loss: 0.191
Batch: 11/29	Loss: 0.214
Batch: 13/29	Loss: 0.229
Batch: 15/29	Loss: 0.230
Batch: 17/29	Loss: 0.293
Batch: 19/29	Loss: 0.284
Batch: 21/29	Loss: 0.246
Batch: 23/29	Loss: 0.205
Batch: 25/29	Loss: 0.240
Batch: 27/29	Loss: 0.209
Batch: 29/29	Loss: 0.205
Epoch: 23	Train Loss: 0.249	Val F1: 0.379
Best Epoch: 23	Best Val F1: 0.379

****************************** Epoch: 24 ******************************
Batch: 1/29	Loss: 0.190
Batch: 3/29	Loss: 0.245
Batch: 5/29	Loss: 0.305
Batch: 7/29	Loss: 0.195
Batch: 9/29	Loss: 0.269
Batch: 11/29	Loss: 0.264
Batch: 13/29	Loss: 0.186
Batch: 15/29	Loss: 0.245
Batch: 17/29	Loss: 0.226
Batch: 19/29	Loss: 0.244
Batch: 21/29	Loss: 0.225
Batch: 23/29	Loss: 0.220
Batch: 25/29	Loss: 0.261
Batch: 27/29	Loss: 0.223
Batch: 29/29	Loss: 0.235
Epoch: 24	Train Loss: 0.224	Val F1: 0.357
Best Epoch: 23	Best Val F1: 0.379

****************************** Epoch: 25 ******************************
Batch: 1/29	Loss: 0.270
Batch: 3/29	Loss: 0.214
Batch: 5/29	Loss: 0.223
Batch: 7/29	Loss: 0.180
Batch: 9/29	Loss: 0.261
Batch: 11/29	Loss: 0.227
Batch: 13/29	Loss: 0.262
Batch: 15/29	Loss: 0.238
Batch: 17/29	Loss: 0.233
Batch: 19/29	Loss: 0.173
Batch: 21/29	Loss: 0.238
Batch: 23/29	Loss: 0.191
Batch: 25/29	Loss: 0.230
Batch: 27/29	Loss: 0.225
Batch: 29/29	Loss: 0.199
Epoch: 25	Train Loss: 0.205	Val F1: 0.356
Best Epoch: 23	Best Val F1: 0.379

Saving the best checkpoint....
Inference...
Test F1: 0.374	Test F1_Few: 0.384	Test F1_Zero: 0.360
Starting training with config: {'batch_size': 64, 'epochs': 75, 'l2_reg': 0.0009203491832932996, 'lr': 1.59555542716849e-05, 'n_layers_freeze': 3, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.074
Batch: 5/29	Loss: 1.048
Batch: 7/29	Loss: 1.029
Batch: 9/29	Loss: 1.006
Batch: 11/29	Loss: 0.989
Batch: 13/29	Loss: 0.976
Batch: 15/29	Loss: 0.977
Batch: 17/29	Loss: 0.939
Batch: 19/29	Loss: 0.934
Batch: 21/29	Loss: 0.917
Batch: 23/29	Loss: 0.920
Batch: 25/29	Loss: 0.890
Batch: 27/29	Loss: 0.886
Batch: 29/29	Loss: 0.892
Epoch: 1	Train Loss: 0.970	Val F1: 0.188
Best Epoch: 1	Best Val F1: 0.188

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.884
Batch: 3/29	Loss: 0.882
Batch: 5/29	Loss: 0.906
Batch: 7/29	Loss: 0.869
Batch: 9/29	Loss: 0.882
Batch: 11/29	Loss: 0.842
Batch: 13/29	Loss: 0.841
Batch: 15/29	Loss: 0.862
Batch: 17/29	Loss: 0.851
Batch: 19/29	Loss: 0.879
Batch: 21/29	Loss: 0.837
Batch: 23/29	Loss: 0.844
Batch: 25/29	Loss: 0.823
Batch: 27/29	Loss: 0.876
Batch: 29/29	Loss: 0.824
Epoch: 2	Train Loss: 0.856	Val F1: 0.185
Best Epoch: 1	Best Val F1: 0.188

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.815
Batch: 3/29	Loss: 0.832
Batch: 5/29	Loss: 0.822
Batch: 7/29	Loss: 0.849
Batch: 9/29	Loss: 0.805
Batch: 11/29	Loss: 0.804
Batch: 13/29	Loss: 0.841
Batch: 15/29	Loss: 0.811
Batch: 17/29	Loss: 0.826
Batch: 19/29	Loss: 0.820
Batch: 21/29	Loss: 0.799
Batch: 23/29	Loss: 0.793
Batch: 25/29	Loss: 0.812
Batch: 27/29	Loss: 0.786
Batch: 29/29	Loss: 0.796
Epoch: 3	Train Loss: 0.815	Val F1: 0.237
Best Epoch: 3	Best Val F1: 0.237

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.778
Batch: 3/29	Loss: 0.792
Batch: 5/29	Loss: 0.775
Batch: 7/29	Loss: 0.823
Batch: 9/29	Loss: 0.800
Batch: 11/29	Loss: 0.755
Batch: 13/29	Loss: 0.765
Batch: 15/29	Loss: 0.753
Batch: 17/29	Loss: 0.756
Batch: 19/29	Loss: 0.785
Batch: 21/29	Loss: 0.782
Batch: 23/29	Loss: 0.773
Batch: 25/29	Loss: 0.763
Batch: 27/29	Loss: 0.778
Batch: 29/29	Loss: 0.772
Epoch: 4	Train Loss: 0.780	Val F1: 0.276
Best Epoch: 4	Best Val F1: 0.276

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.738
Batch: 3/29	Loss: 0.733
Batch: 5/29	Loss: 0.714
Batch: 7/29	Loss: 0.730
Batch: 9/29	Loss: 0.694
Batch: 11/29	Loss: 0.747
Batch: 13/29	Loss: 0.703
Batch: 15/29	Loss: 0.731
Batch: 17/29	Loss: 0.773
Batch: 19/29	Loss: 0.728
Batch: 21/29	Loss: 0.710
Batch: 23/29	Loss: 0.732
Batch: 25/29	Loss: 0.725
Batch: 27/29	Loss: 0.691
Batch: 29/29	Loss: 0.741
Epoch: 5	Train Loss: 0.734	Val F1: 0.327
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.734
Batch: 3/29	Loss: 0.751
Batch: 5/29	Loss: 0.648
Batch: 7/29	Loss: 0.762
Batch: 9/29	Loss: 0.694
Batch: 11/29	Loss: 0.672
Batch: 13/29	Loss: 0.699
Batch: 15/29	Loss: 0.639
Batch: 17/29	Loss: 0.646
Batch: 19/29	Loss: 0.615
Batch: 21/29	Loss: 0.761
Batch: 23/29	Loss: 0.680
Batch: 25/29	Loss: 0.673
Batch: 27/29	Loss: 0.671
Batch: 29/29	Loss: 0.680
Epoch: 6	Train Loss: 0.688	Val F1: 0.310
Best Epoch: 5	Best Val F1: 0.327

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.674
Batch: 3/29	Loss: 0.748
Batch: 5/29	Loss: 0.733
Batch: 7/29	Loss: 0.660
Batch: 9/29	Loss: 0.669
Batch: 11/29	Loss: 0.594
Batch: 13/29	Loss: 0.639
Batch: 15/29	Loss: 0.592
Batch: 17/29	Loss: 0.669
Batch: 19/29	Loss: 0.697
Batch: 21/29	Loss: 0.612
Batch: 23/29	Loss: 0.602
Batch: 25/29	Loss: 0.558
Batch: 27/29	Loss: 0.614
Batch: 29/29	Loss: 0.614
Epoch: 7	Train Loss: 0.645	Val F1: 0.348
Best Epoch: 7	Best Val F1: 0.348

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.609
Batch: 3/29	Loss: 0.589
Batch: 5/29	Loss: 0.652
Batch: 7/29	Loss: 0.605
Batch: 9/29	Loss: 0.585
Batch: 11/29	Loss: 0.614
Batch: 13/29	Loss: 0.644
Batch: 15/29	Loss: 0.543
Batch: 17/29	Loss: 0.599
Batch: 19/29	Loss: 0.579
Batch: 21/29	Loss: 0.639
Batch: 23/29	Loss: 0.626
Batch: 25/29	Loss: 0.708
Batch: 27/29	Loss: 0.604
Batch: 29/29	Loss: 0.598
Epoch: 8	Train Loss: 0.607	Val F1: 0.340
Best Epoch: 7	Best Val F1: 0.348

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.633
Batch: 3/29	Loss: 0.567
Batch: 5/29	Loss: 0.561
Batch: 7/29	Loss: 0.518
Batch: 9/29	Loss: 0.608
Batch: 11/29	Loss: 0.597
Batch: 13/29	Loss: 0.632
Batch: 15/29	Loss: 0.495
Batch: 17/29	Loss: 0.528
Batch: 19/29	Loss: 0.488
Batch: 21/29	Loss: 0.626
Batch: 23/29	Loss: 0.535
Batch: 25/29	Loss: 0.527
Batch: 27/29	Loss: 0.582
Batch: 29/29	Loss: 0.511
Epoch: 9	Train Loss: 0.559	Val F1: 0.345
Best Epoch: 7	Best Val F1: 0.348

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.471
Batch: 3/29	Loss: 0.524
Batch: 5/29	Loss: 0.516
Batch: 7/29	Loss: 0.625
Batch: 9/29	Loss: 0.480
Batch: 11/29	Loss: 0.513
Batch: 13/29	Loss: 0.613
Batch: 15/29	Loss: 0.649
Batch: 17/29	Loss: 0.615
Batch: 19/29	Loss: 0.430
Batch: 21/29	Loss: 0.569
Batch: 23/29	Loss: 0.570
Batch: 25/29	Loss: 0.576
Batch: 27/29	Loss: 0.516
Batch: 29/29	Loss: 0.608
Epoch: 10	Train Loss: 0.536	Val F1: 0.359
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.607
Batch: 3/29	Loss: 0.442
Batch: 5/29	Loss: 0.630
Batch: 7/29	Loss: 0.540
Batch: 9/29	Loss: 0.489
Batch: 11/29	Loss: 0.487
Batch: 13/29	Loss: 0.442
Batch: 15/29	Loss: 0.394
Batch: 17/29	Loss: 0.571
Batch: 19/29	Loss: 0.522
Batch: 21/29	Loss: 0.493
Batch: 23/29	Loss: 0.406
Batch: 25/29	Loss: 0.407
Batch: 27/29	Loss: 0.452
Batch: 29/29	Loss: 0.469
Epoch: 11	Train Loss: 0.494	Val F1: 0.342
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.585
Batch: 3/29	Loss: 0.368
Batch: 5/29	Loss: 0.469
Batch: 7/29	Loss: 0.450
Batch: 9/29	Loss: 0.485
Batch: 11/29	Loss: 0.487
Batch: 13/29	Loss: 0.467
Batch: 15/29	Loss: 0.448
Batch: 17/29	Loss: 0.428
Batch: 19/29	Loss: 0.445
Batch: 21/29	Loss: 0.408
Batch: 23/29	Loss: 0.496
Batch: 25/29	Loss: 0.468
Batch: 27/29	Loss: 0.528
Batch: 29/29	Loss: 0.362
Epoch: 12	Train Loss: 0.454	Val F1: 0.345
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.431
Batch: 3/29	Loss: 0.335
Batch: 5/29	Loss: 0.474
Batch: 7/29	Loss: 0.381
Batch: 9/29	Loss: 0.475
Batch: 11/29	Loss: 0.472
Batch: 13/29	Loss: 0.440
Batch: 15/29	Loss: 0.408
Batch: 17/29	Loss: 0.353
Batch: 19/29	Loss: 0.276
Batch: 21/29	Loss: 0.432
Batch: 23/29	Loss: 0.469
Batch: 25/29	Loss: 0.305
Batch: 27/29	Loss: 0.428
Batch: 29/29	Loss: 0.543
Epoch: 13	Train Loss: 0.429	Val F1: 0.341
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.427
Batch: 3/29	Loss: 0.437
Batch: 5/29	Loss: 0.324
Batch: 7/29	Loss: 0.430
Batch: 9/29	Loss: 0.431
Batch: 11/29	Loss: 0.387
Batch: 13/29	Loss: 0.422
Batch: 15/29	Loss: 0.351
Batch: 17/29	Loss: 0.528
Batch: 19/29	Loss: 0.439
Batch: 21/29	Loss: 0.292
Batch: 23/29	Loss: 0.353
Batch: 25/29	Loss: 0.389
Batch: 27/29	Loss: 0.416
Batch: 29/29	Loss: 0.419
Epoch: 14	Train Loss: 0.410	Val F1: 0.350
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.355
Batch: 3/29	Loss: 0.381
Batch: 5/29	Loss: 0.289
Batch: 7/29	Loss: 0.362
Batch: 9/29	Loss: 0.436
Batch: 11/29	Loss: 0.416
Batch: 13/29	Loss: 0.369
Batch: 15/29	Loss: 0.381
Batch: 17/29	Loss: 0.473
Batch: 19/29	Loss: 0.375
Batch: 21/29	Loss: 0.404
Batch: 23/29	Loss: 0.450
Batch: 25/29	Loss: 0.446
Batch: 27/29	Loss: 0.377
Batch: 29/29	Loss: 0.534
Epoch: 15	Train Loss: 0.403	Val F1: 0.352
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.409
Batch: 3/29	Loss: 0.414
Batch: 5/29	Loss: 0.414
Batch: 7/29	Loss: 0.330
Batch: 9/29	Loss: 0.435
Batch: 11/29	Loss: 0.384
Batch: 13/29	Loss: 0.337
Batch: 15/29	Loss: 0.302
Batch: 17/29	Loss: 0.389
Batch: 19/29	Loss: 0.444
Batch: 21/29	Loss: 0.299
Batch: 23/29	Loss: 0.406
Batch: 25/29	Loss: 0.389
Batch: 27/29	Loss: 0.351
Batch: 29/29	Loss: 0.382
Epoch: 16	Train Loss: 0.383	Val F1: 0.355
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.344
Batch: 3/29	Loss: 0.461
Batch: 5/29	Loss: 0.350
Batch: 7/29	Loss: 0.342
Batch: 9/29	Loss: 0.289
Batch: 11/29	Loss: 0.393
Batch: 13/29	Loss: 0.436
Batch: 15/29	Loss: 0.375
Batch: 17/29	Loss: 0.388
Batch: 19/29	Loss: 0.348
Batch: 21/29	Loss: 0.377
Batch: 23/29	Loss: 0.502
Batch: 25/29	Loss: 0.218
Batch: 27/29	Loss: 0.369
Batch: 29/29	Loss: 0.367
Epoch: 17	Train Loss: 0.365	Val F1: 0.351
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.418
Batch: 3/29	Loss: 0.405
Batch: 5/29	Loss: 0.359
Batch: 7/29	Loss: 0.330
Batch: 9/29	Loss: 0.493
Batch: 11/29	Loss: 0.309
Batch: 13/29	Loss: 0.285
Batch: 15/29	Loss: 0.324
Batch: 17/29	Loss: 0.322
Batch: 19/29	Loss: 0.303
Batch: 21/29	Loss: 0.331
Batch: 23/29	Loss: 0.355
Batch: 25/29	Loss: 0.380
Batch: 27/29	Loss: 0.272
Batch: 29/29	Loss: 0.390
Epoch: 18	Train Loss: 0.350	Val F1: 0.349
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.223
Batch: 3/29	Loss: 0.256
Batch: 5/29	Loss: 0.332
Batch: 7/29	Loss: 0.402
Batch: 9/29	Loss: 0.261
Batch: 11/29	Loss: 0.417
Batch: 13/29	Loss: 0.418
Batch: 15/29	Loss: 0.325
Batch: 17/29	Loss: 0.284
Batch: 19/29	Loss: 0.412
Batch: 21/29	Loss: 0.346
Batch: 23/29	Loss: 0.352
Batch: 25/29	Loss: 0.352
Batch: 27/29	Loss: 0.328
Batch: 29/29	Loss: 0.317
Epoch: 19	Train Loss: 0.338	Val F1: 0.355
Best Epoch: 10	Best Val F1: 0.359

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.376
Batch: 3/29	Loss: 0.367
Batch: 5/29	Loss: 0.335
Batch: 7/29	Loss: 0.263
Batch: 9/29	Loss: 0.349
Batch: 11/29	Loss: 0.338
Batch: 13/29	Loss: 0.314
Batch: 15/29	Loss: 0.343
Batch: 17/29	Loss: 0.422
Batch: 19/29	Loss: 0.281
Batch: 21/29	Loss: 0.297
Batch: 23/29	Loss: 0.338
Batch: 25/29	Loss: 0.274
Batch: 27/29	Loss: 0.350
Batch: 29/29	Loss: 0.416
Epoch: 20	Train Loss: 0.330	Val F1: 0.349
Best Epoch: 10	Best Val F1: 0.359

Saving the best checkpoint....
Inference...
Test F1: 0.377	Test F1_Few: 0.450	Test F1_Zero: 0.373
Starting training with config: {'batch_size': 8, 'epochs': 50, 'l2_reg': 0.0009078273922638292, 'lr': 5.654305647918958e-06, 'n_layers_freeze': 1, 'patience': 10}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/231	Loss: 1.080
Batch: 24/231	Loss: 1.017
Batch: 47/231	Loss: 0.946
Batch: 70/231	Loss: 0.927
Batch: 93/231	Loss: 0.877
Batch: 116/231	Loss: 0.916
Batch: 139/231	Loss: 0.884
Batch: 162/231	Loss: 0.852
Batch: 185/231	Loss: 0.817
Batch: 208/231	Loss: 0.829
Batch: 231/231	Loss: 0.806
Epoch: 1	Train Loss: 0.904	Val F1: 0.197
Best Epoch: 1	Best Val F1: 0.197

****************************** Epoch: 2 ******************************
Batch: 1/231	Loss: 0.815
Batch: 24/231	Loss: 0.841
Batch: 47/231	Loss: 0.784
Batch: 70/231	Loss: 0.976
Batch: 93/231	Loss: 0.780
Batch: 116/231	Loss: 0.790
Batch: 139/231	Loss: 0.926
Batch: 162/231	Loss: 0.760
Batch: 185/231	Loss: 0.782
Batch: 208/231	Loss: 0.811
Batch: 231/231	Loss: 0.762
Epoch: 2	Train Loss: 0.801	Val F1: 0.287
Best Epoch: 2	Best Val F1: 0.287

****************************** Epoch: 3 ******************************
Batch: 1/231	Loss: 0.732
Batch: 24/231	Loss: 0.704
Batch: 47/231	Loss: 0.825
Batch: 70/231	Loss: 0.754
Batch: 93/231	Loss: 0.718
Batch: 116/231	Loss: 0.594
Batch: 139/231	Loss: 0.653
Batch: 162/231	Loss: 0.682
Batch: 185/231	Loss: 0.642
Batch: 208/231	Loss: 0.628
Batch: 231/231	Loss: 0.682
Epoch: 3	Train Loss: 0.743	Val F1: 0.319
Best Epoch: 3	Best Val F1: 0.319

****************************** Epoch: 4 ******************************
Batch: 1/231	Loss: 0.824
Batch: 24/231	Loss: 0.629
Batch: 47/231	Loss: 0.691
Batch: 70/231	Loss: 0.840
Batch: 93/231	Loss: 0.819
Batch: 116/231	Loss: 0.662
Batch: 139/231	Loss: 1.292
Batch: 162/231	Loss: 0.767
Batch: 185/231	Loss: 0.541
Batch: 208/231	Loss: 0.538
Batch: 231/231	Loss: 0.755
Epoch: 4	Train Loss: 0.700	Val F1: 0.312
Best Epoch: 3	Best Val F1: 0.319

****************************** Epoch: 5 ******************************
Batch: 1/231	Loss: 0.538
Batch: 24/231	Loss: 0.718
Batch: 47/231	Loss: 0.796
Batch: 70/231	Loss: 0.601
Batch: 93/231	Loss: 0.719
Batch: 116/231	Loss: 0.453
Batch: 139/231	Loss: 0.991
Batch: 162/231	Loss: 0.691
Batch: 185/231	Loss: 0.641
Batch: 208/231	Loss: 0.553
Batch: 231/231	Loss: 0.521
Epoch: 5	Train Loss: 0.658	Val F1: 0.332
Best Epoch: 5	Best Val F1: 0.332

****************************** Epoch: 6 ******************************
Batch: 1/231	Loss: 0.622
Batch: 24/231	Loss: 0.891
Batch: 47/231	Loss: 0.548
Batch: 70/231	Loss: 0.652
Batch: 93/231	Loss: 0.496
Batch: 116/231	Loss: 0.753
Batch: 139/231	Loss: 0.830
Batch: 162/231	Loss: 0.696
Batch: 185/231	Loss: 0.899
Batch: 208/231	Loss: 0.757
Batch: 231/231	Loss: 0.381
Epoch: 6	Train Loss: 0.632	Val F1: 0.352
Best Epoch: 6	Best Val F1: 0.352

****************************** Epoch: 7 ******************************
Batch: 1/231	Loss: 0.632
Batch: 24/231	Loss: 0.600
Batch: 47/231	Loss: 0.404
Batch: 70/231	Loss: 0.702
Batch: 93/231	Loss: 0.692
Batch: 116/231	Loss: 0.458
Batch: 139/231	Loss: 0.412
Batch: 162/231	Loss: 0.543
Batch: 185/231	Loss: 0.379
Batch: 208/231	Loss: 0.783
Batch: 231/231	Loss: 0.497
Epoch: 7	Train Loss: 0.597	Val F1: 0.351
Best Epoch: 6	Best Val F1: 0.352

****************************** Epoch: 8 ******************************
Batch: 1/231	Loss: 0.563
Batch: 24/231	Loss: 0.558
Batch: 47/231	Loss: 0.527
Batch: 70/231	Loss: 0.752
Batch: 93/231	Loss: 0.444
Batch: 116/231	Loss: 0.370
Batch: 139/231	Loss: 0.477
Batch: 162/231	Loss: 0.350
Batch: 185/231	Loss: 0.692
Batch: 208/231	Loss: 0.440
Batch: 231/231	Loss: 0.523
Epoch: 8	Train Loss: 0.559	Val F1: 0.350
Best Epoch: 6	Best Val F1: 0.352

****************************** Epoch: 9 ******************************
Batch: 1/231	Loss: 0.639
Batch: 24/231	Loss: 0.760
Batch: 47/231	Loss: 0.698
Batch: 70/231	Loss: 0.753
Batch: 93/231	Loss: 0.624
Batch: 116/231	Loss: 0.400
Batch: 139/231	Loss: 1.015
Batch: 162/231	Loss: 0.502
Batch: 185/231	Loss: 0.430
Batch: 208/231	Loss: 0.570
Batch: 231/231	Loss: 0.575
Epoch: 9	Train Loss: 0.520	Val F1: 0.349
Best Epoch: 6	Best Val F1: 0.352

****************************** Epoch: 10 ******************************
Batch: 1/231	Loss: 0.489
Batch: 24/231	Loss: 0.479
Batch: 47/231	Loss: 0.447
Batch: 70/231	Loss: 0.382
Batch: 93/231	Loss: 0.541
Batch: 116/231	Loss: 0.189
Batch: 139/231	Loss: 0.433
Batch: 162/231	Loss: 0.414
Batch: 185/231	Loss: 0.872
Batch: 208/231	Loss: 0.416
Batch: 231/231	Loss: 0.456
Epoch: 10	Train Loss: 0.483	Val F1: 0.347
Best Epoch: 6	Best Val F1: 0.352

****************************** Epoch: 11 ******************************
Batch: 1/231	Loss: 0.608
Batch: 24/231	Loss: 0.283
Batch: 47/231	Loss: 0.260
Batch: 70/231	Loss: 0.283
Batch: 93/231	Loss: 0.425
Batch: 116/231	Loss: 0.570
Batch: 139/231	Loss: 0.567
Batch: 162/231	Loss: 0.628
Batch: 185/231	Loss: 0.338
Batch: 208/231	Loss: 0.632
Batch: 231/231	Loss: 0.225
Epoch: 11	Train Loss: 0.446	Val F1: 0.353
Best Epoch: 11	Best Val F1: 0.353

****************************** Epoch: 12 ******************************
Batch: 1/231	Loss: 0.786
Batch: 24/231	Loss: 0.355
Batch: 47/231	Loss: 0.383
Batch: 70/231	Loss: 0.371
Batch: 93/231	Loss: 0.499
Batch: 116/231	Loss: 0.209
Batch: 139/231	Loss: 0.327
Batch: 162/231	Loss: 0.381
Batch: 185/231	Loss: 0.182
Batch: 208/231	Loss: 0.457
Batch: 231/231	Loss: 0.278
Epoch: 12	Train Loss: 0.420	Val F1: 0.351
Best Epoch: 11	Best Val F1: 0.353

****************************** Epoch: 13 ******************************
Batch: 1/231	Loss: 0.542
Batch: 24/231	Loss: 0.299
Batch: 47/231	Loss: 0.321
Batch: 70/231	Loss: 0.606
Batch: 93/231	Loss: 0.289
Batch: 116/231	Loss: 0.410
Batch: 139/231	Loss: 0.267
Batch: 162/231	Loss: 0.181
Batch: 185/231	Loss: 0.628
Batch: 208/231	Loss: 0.172
Batch: 231/231	Loss: 0.241
Epoch: 13	Train Loss: 0.392	Val F1: 0.347
Best Epoch: 11	Best Val F1: 0.353

****************************** Epoch: 14 ******************************
Batch: 1/231	Loss: 0.641
Batch: 24/231	Loss: 0.657
Batch: 47/231	Loss: 0.285
Batch: 70/231	Loss: 0.498
Batch: 93/231	Loss: 0.305
Batch: 116/231	Loss: 0.345
Batch: 139/231	Loss: 0.188
Batch: 162/231	Loss: 0.265
Batch: 185/231	Loss: 0.365
Batch: 208/231	Loss: 0.140
Batch: 231/231	Loss: 0.399
Epoch: 14	Train Loss: 0.378	Val F1: 0.342
Best Epoch: 11	Best Val F1: 0.353

****************************** Epoch: 15 ******************************
Batch: 1/231	Loss: 0.263
Batch: 24/231	Loss: 0.528
Batch: 47/231	Loss: 0.129
Batch: 70/231	Loss: 0.421
Batch: 93/231	Loss: 0.685
Batch: 116/231	Loss: 0.287
Batch: 139/231	Loss: 0.345
Batch: 162/231	Loss: 0.362
Batch: 185/231	Loss: 0.226
Batch: 208/231	Loss: 0.569
Batch: 231/231	Loss: 0.123
Epoch: 15	Train Loss: 0.366	Val F1: 0.347
Best Epoch: 11	Best Val F1: 0.353

****************************** Epoch: 16 ******************************
Batch: 1/231	Loss: 0.363
Batch: 24/231	Loss: 0.205
Batch: 47/231	Loss: 0.370
Batch: 70/231	Loss: 0.315
Batch: 93/231	Loss: 0.370
Batch: 116/231	Loss: 0.165
Batch: 139/231	Loss: 0.187
Batch: 162/231	Loss: 0.170
Batch: 185/231	Loss: 0.170
Batch: 208/231	Loss: 0.321
Batch: 231/231	Loss: 0.728
Epoch: 16	Train Loss: 0.340	Val F1: 0.345
Best Epoch: 11	Best Val F1: 0.353

****************************** Epoch: 17 ******************************
Batch: 1/231	Loss: 0.304
Batch: 24/231	Loss: 0.297
Batch: 47/231	Loss: 0.365
Batch: 70/231	Loss: 0.316
Batch: 93/231	Loss: 0.402
Batch: 116/231	Loss: 0.317
Batch: 139/231	Loss: 0.498
Batch: 162/231	Loss: 0.362
Batch: 185/231	Loss: 0.259
Batch: 208/231	Loss: 0.323
Batch: 231/231	Loss: 0.462
Epoch: 17	Train Loss: 0.322	Val F1: 0.346
Best Epoch: 11	Best Val F1: 0.353

****************************** Epoch: 18 ******************************
Batch: 1/231	Loss: 0.354
Batch: 24/231	Loss: 0.133
Batch: 47/231	Loss: 0.312
Batch: 70/231	Loss: 0.221
Batch: 93/231	Loss: 0.331
Batch: 116/231	Loss: 0.379
Batch: 139/231	Loss: 0.485
Batch: 162/231	Loss: 0.155
Batch: 185/231	Loss: 0.249
Batch: 208/231	Loss: 0.340
Batch: 231/231	Loss: 0.861
Epoch: 18	Train Loss: 0.305	Val F1: 0.346
Best Epoch: 11	Best Val F1: 0.353

****************************** Epoch: 19 ******************************
Batch: 1/231	Loss: 0.291
Batch: 24/231	Loss: 0.085
Batch: 47/231	Loss: 0.263
Batch: 70/231	Loss: 0.344
Batch: 93/231	Loss: 0.201
Batch: 116/231	Loss: 0.263
Batch: 139/231	Loss: 0.133
Batch: 162/231	Loss: 0.126
Batch: 185/231	Loss: 0.466
Batch: 208/231	Loss: 0.591
Batch: 231/231	Loss: 0.263
Epoch: 19	Train Loss: 0.293	Val F1: 0.355
Best Epoch: 19	Best Val F1: 0.355

****************************** Epoch: 20 ******************************
Batch: 1/231	Loss: 0.367
Batch: 24/231	Loss: 0.239
Batch: 47/231	Loss: 0.108
Batch: 70/231	Loss: 0.591
Batch: 93/231	Loss: 0.133
Batch: 116/231	Loss: 0.324
Batch: 139/231	Loss: 0.304
Batch: 162/231	Loss: 0.302
Batch: 185/231	Loss: 0.177
Batch: 208/231	Loss: 0.178
Batch: 231/231	Loss: 0.493
Epoch: 20	Train Loss: 0.277	Val F1: 0.348
Best Epoch: 19	Best Val F1: 0.355

****************************** Epoch: 21 ******************************
Batch: 1/231	Loss: 0.406
Batch: 24/231	Loss: 0.165
Batch: 47/231	Loss: 0.179
Batch: 70/231	Loss: 0.160
Batch: 93/231	Loss: 0.203
Batch: 116/231	Loss: 0.234
Batch: 139/231	Loss: 0.070
Batch: 162/231	Loss: 0.323
Batch: 185/231	Loss: 0.359
Batch: 208/231	Loss: 0.217
Batch: 231/231	Loss: 0.259
Epoch: 21	Train Loss: 0.257	Val F1: 0.357
Best Epoch: 21	Best Val F1: 0.357

****************************** Epoch: 22 ******************************
Batch: 1/231	Loss: 0.354
Batch: 24/231	Loss: 0.139
Batch: 47/231	Loss: 0.082
Batch: 70/231	Loss: 0.201
Batch: 93/231	Loss: 0.245
Batch: 116/231	Loss: 0.205
Batch: 139/231	Loss: 0.072
Batch: 162/231	Loss: 0.310
Batch: 185/231	Loss: 0.404
Batch: 208/231	Loss: 0.115
Batch: 231/231	Loss: 0.468
Epoch: 22	Train Loss: 0.234	Val F1: 0.356
Best Epoch: 21	Best Val F1: 0.357

****************************** Epoch: 23 ******************************
Batch: 1/231	Loss: 0.303
Batch: 24/231	Loss: 0.067
Batch: 47/231	Loss: 0.134
Batch: 70/231	Loss: 0.096
Batch: 93/231	Loss: 0.261
Batch: 116/231	Loss: 0.227
Batch: 139/231	Loss: 0.200
Batch: 162/231	Loss: 0.121
Batch: 185/231	Loss: 0.087
Batch: 208/231	Loss: 0.271
Batch: 231/231	Loss: 0.312
Epoch: 23	Train Loss: 0.220	Val F1: 0.369
Best Epoch: 23	Best Val F1: 0.369

****************************** Epoch: 24 ******************************
Batch: 1/231	Loss: 0.068
Batch: 24/231	Loss: 0.082
Batch: 47/231	Loss: 0.139
Batch: 70/231	Loss: 0.100
Batch: 93/231	Loss: 0.207
Batch: 116/231	Loss: 0.121
Batch: 139/231	Loss: 0.055
Batch: 162/231	Loss: 0.040
Batch: 185/231	Loss: 0.188
Batch: 208/231	Loss: 0.079
Batch: 231/231	Loss: 0.541
Epoch: 24	Train Loss: 0.194	Val F1: 0.350
Best Epoch: 23	Best Val F1: 0.369

****************************** Epoch: 25 ******************************
Batch: 1/231	Loss: 0.263
Batch: 24/231	Loss: 0.211
Batch: 47/231	Loss: 0.221
Batch: 70/231	Loss: 0.162
Batch: 93/231	Loss: 0.124
Batch: 116/231	Loss: 0.112
Batch: 139/231	Loss: 0.364
Batch: 162/231	Loss: 0.069
Batch: 185/231	Loss: 0.134
Batch: 208/231	Loss: 0.222
Batch: 231/231	Loss: 0.096
Epoch: 25	Train Loss: 0.178	Val F1: 0.356
Best Epoch: 23	Best Val F1: 0.369

****************************** Epoch: 26 ******************************
Batch: 1/231	Loss: 0.075
Batch: 24/231	Loss: 0.082
Batch: 47/231	Loss: 0.202
Batch: 70/231	Loss: 0.154
Batch: 93/231	Loss: 0.061
Batch: 116/231	Loss: 0.338
Batch: 139/231	Loss: 0.092
Batch: 162/231	Loss: 0.135
Batch: 185/231	Loss: 0.196
Batch: 208/231	Loss: 0.144
Batch: 231/231	Loss: 0.118
Epoch: 26	Train Loss: 0.150	Val F1: 0.347
Best Epoch: 23	Best Val F1: 0.369

****************************** Epoch: 27 ******************************
Batch: 1/231	Loss: 0.048
Batch: 24/231	Loss: 0.098
Batch: 47/231	Loss: 0.091
Batch: 70/231	Loss: 0.177
Batch: 93/231	Loss: 0.214
Batch: 116/231	Loss: 0.522
Batch: 139/231	Loss: 0.140
Batch: 162/231	Loss: 0.093
Batch: 185/231	Loss: 0.148
Batch: 208/231	Loss: 0.170
Batch: 231/231	Loss: 0.144
Epoch: 27	Train Loss: 0.140	Val F1: 0.353
Best Epoch: 23	Best Val F1: 0.369

****************************** Epoch: 28 ******************************
Batch: 1/231	Loss: 0.102
Batch: 24/231	Loss: 0.181
Batch: 47/231	Loss: 0.181
Batch: 70/231	Loss: 0.022
Batch: 93/231	Loss: 0.244
Batch: 116/231	Loss: 0.159
Batch: 139/231	Loss: 0.227
Batch: 162/231	Loss: 0.152
Batch: 185/231	Loss: 0.110
Batch: 208/231	Loss: 0.070
Batch: 231/231	Loss: 0.073
Epoch: 28	Train Loss: 0.130	Val F1: 0.352
Best Epoch: 23	Best Val F1: 0.369

****************************** Epoch: 29 ******************************
Batch: 1/231	Loss: 0.470
Batch: 24/231	Loss: 0.171
Batch: 47/231	Loss: 0.046
Batch: 70/231	Loss: 0.085
Batch: 93/231	Loss: 0.038
Batch: 116/231	Loss: 0.028
Batch: 139/231	Loss: 0.052
Batch: 162/231	Loss: 0.067
Batch: 185/231	Loss: 0.034
Batch: 208/231	Loss: 0.080
Batch: 231/231	Loss: 0.110
Epoch: 29	Train Loss: 0.110	Val F1: 0.359
Best Epoch: 23	Best Val F1: 0.369

****************************** Epoch: 30 ******************************
Batch: 1/231	Loss: 0.120
Batch: 24/231	Loss: 0.160
Batch: 47/231	Loss: 0.503
Batch: 70/231	Loss: 0.112
Batch: 93/231	Loss: 0.095
Batch: 116/231	Loss: 0.028
Batch: 139/231	Loss: 0.055
Batch: 162/231	Loss: 0.051
Batch: 185/231	Loss: 0.049
Batch: 208/231	Loss: 0.254
Batch: 231/231	Loss: 0.040
Epoch: 30	Train Loss: 0.105	Val F1: 0.358
Best Epoch: 23	Best Val F1: 0.369

****************************** Epoch: 31 ******************************
Batch: 1/231	Loss: 0.029
Batch: 24/231	Loss: 0.051
Batch: 47/231	Loss: 0.135
Batch: 70/231	Loss: 0.165
Batch: 93/231	Loss: 0.068
Batch: 116/231	Loss: 0.085
Batch: 139/231	Loss: 0.045
Batch: 162/231	Loss: 0.077
Batch: 185/231	Loss: 0.053
Batch: 208/231	Loss: 0.158
Batch: 231/231	Loss: 0.027
Epoch: 31	Train Loss: 0.089	Val F1: 0.360
Best Epoch: 23	Best Val F1: 0.369

****************************** Epoch: 32 ******************************
Batch: 1/231	Loss: 0.242
Batch: 24/231	Loss: 0.098
Batch: 47/231	Loss: 0.059
Batch: 70/231	Loss: 0.070
Batch: 93/231	Loss: 0.037
Batch: 116/231	Loss: 0.034
Batch: 139/231	Loss: 0.134
Batch: 162/231	Loss: 0.015
Batch: 185/231	Loss: 0.066
Batch: 208/231	Loss: 0.073
Batch: 231/231	Loss: 0.041
Epoch: 32	Train Loss: 0.076	Val F1: 0.361
Best Epoch: 23	Best Val F1: 0.369

****************************** Epoch: 33 ******************************
Batch: 1/231	Loss: 0.113
Batch: 24/231	Loss: 0.031
Batch: 47/231	Loss: 0.130
Batch: 70/231	Loss: 0.364
Batch: 93/231	Loss: 0.023
Batch: 116/231	Loss: 0.057
Batch: 139/231	Loss: 0.020
Batch: 162/231	Loss: 0.103
Batch: 185/231	Loss: 0.253
Batch: 208/231	Loss: 0.200
Batch: 231/231	Loss: 0.336
Epoch: 33	Train Loss: 0.076	Val F1: 0.348
Best Epoch: 23	Best Val F1: 0.369

Saving the best checkpoint....
Inference...
Test F1: 0.370	Test F1_Few: 0.378	Test F1_Zero: 0.359
Starting training with config: {'batch_size': 64, 'epochs': 50, 'l2_reg': 0.0008844151214437753, 'lr': 2.4433907634194055e-05, 'n_layers_freeze': 2, 'patience': 15}
Let's use 1 GPUs!
Preparing data....
Training data....
# of train examples (rows): 13477
# of grouped examples: 1845
max len: 512
Val data....
# of val examples (rows): 2062
# of grouped examples: 682
max len: 512
Test data....
# of test examples (rows): 3006
# of grouped examples: 786
max len: 512
Done

Initializing model....
****************************** Epoch: 1 ******************************
Batch: 1/29	Loss: 1.094
Batch: 3/29	Loss: 1.061
Batch: 5/29	Loss: 1.020
Batch: 7/29	Loss: 0.994
Batch: 9/29	Loss: 0.965
Batch: 11/29	Loss: 0.952
Batch: 13/29	Loss: 0.939
Batch: 15/29	Loss: 0.948
Batch: 17/29	Loss: 0.904
Batch: 19/29	Loss: 0.903
Batch: 21/29	Loss: 0.880
Batch: 23/29	Loss: 0.891
Batch: 25/29	Loss: 0.854
Batch: 27/29	Loss: 0.853
Batch: 29/29	Loss: 0.862
Epoch: 1	Train Loss: 0.939	Val F1: 0.188
Best Epoch: 1	Best Val F1: 0.188

****************************** Epoch: 2 ******************************
Batch: 1/29	Loss: 0.852
Batch: 3/29	Loss: 0.851
Batch: 5/29	Loss: 0.884
Batch: 7/29	Loss: 0.838
Batch: 9/29	Loss: 0.856
Batch: 11/29	Loss: 0.807
Batch: 13/29	Loss: 0.808
Batch: 15/29	Loss: 0.831
Batch: 17/29	Loss: 0.821
Batch: 19/29	Loss: 0.860
Batch: 21/29	Loss: 0.806
Batch: 23/29	Loss: 0.816
Batch: 25/29	Loss: 0.790
Batch: 27/29	Loss: 0.857
Batch: 29/29	Loss: 0.793
Epoch: 2	Train Loss: 0.827	Val F1: 0.187
Best Epoch: 1	Best Val F1: 0.188

****************************** Epoch: 3 ******************************
Batch: 1/29	Loss: 0.782
Batch: 3/29	Loss: 0.806
Batch: 5/29	Loss: 0.791
Batch: 7/29	Loss: 0.828
Batch: 9/29	Loss: 0.772
Batch: 11/29	Loss: 0.772
Batch: 13/29	Loss: 0.819
Batch: 15/29	Loss: 0.784
Batch: 17/29	Loss: 0.802
Batch: 19/29	Loss: 0.795
Batch: 21/29	Loss: 0.770
Batch: 23/29	Loss: 0.756
Batch: 25/29	Loss: 0.784
Batch: 27/29	Loss: 0.748
Batch: 29/29	Loss: 0.769
Epoch: 3	Train Loss: 0.787	Val F1: 0.288
Best Epoch: 3	Best Val F1: 0.288

****************************** Epoch: 4 ******************************
Batch: 1/29	Loss: 0.739
Batch: 3/29	Loss: 0.761
Batch: 5/29	Loss: 0.734
Batch: 7/29	Loss: 0.797
Batch: 9/29	Loss: 0.772
Batch: 11/29	Loss: 0.696
Batch: 13/29	Loss: 0.722
Batch: 15/29	Loss: 0.695
Batch: 17/29	Loss: 0.693
Batch: 19/29	Loss: 0.768
Batch: 21/29	Loss: 0.738
Batch: 23/29	Loss: 0.755
Batch: 25/29	Loss: 0.723
Batch: 27/29	Loss: 0.767
Batch: 29/29	Loss: 0.720
Epoch: 4	Train Loss: 0.740	Val F1: 0.335
Best Epoch: 4	Best Val F1: 0.335

****************************** Epoch: 5 ******************************
Batch: 1/29	Loss: 0.683
Batch: 3/29	Loss: 0.675
Batch: 5/29	Loss: 0.648
Batch: 7/29	Loss: 0.652
Batch: 9/29	Loss: 0.647
Batch: 11/29	Loss: 0.667
Batch: 13/29	Loss: 0.694
Batch: 15/29	Loss: 0.719
Batch: 17/29	Loss: 0.761
Batch: 19/29	Loss: 0.726
Batch: 21/29	Loss: 0.654
Batch: 23/29	Loss: 0.710
Batch: 25/29	Loss: 0.697
Batch: 27/29	Loss: 0.665
Batch: 29/29	Loss: 0.696
Epoch: 5	Train Loss: 0.699	Val F1: 0.288
Best Epoch: 4	Best Val F1: 0.335

****************************** Epoch: 6 ******************************
Batch: 1/29	Loss: 0.692
Batch: 3/29	Loss: 0.715
Batch: 5/29	Loss: 0.610
Batch: 7/29	Loss: 0.751
Batch: 9/29	Loss: 0.627
Batch: 11/29	Loss: 0.671
Batch: 13/29	Loss: 0.652
Batch: 15/29	Loss: 0.589
Batch: 17/29	Loss: 0.607
Batch: 19/29	Loss: 0.590
Batch: 21/29	Loss: 0.719
Batch: 23/29	Loss: 0.701
Batch: 25/29	Loss: 0.642
Batch: 27/29	Loss: 0.634
Batch: 29/29	Loss: 0.660
Epoch: 6	Train Loss: 0.652	Val F1: 0.337
Best Epoch: 6	Best Val F1: 0.337

****************************** Epoch: 7 ******************************
Batch: 1/29	Loss: 0.597
Batch: 3/29	Loss: 0.678
Batch: 5/29	Loss: 0.677
Batch: 7/29	Loss: 0.644
Batch: 9/29	Loss: 0.647
Batch: 11/29	Loss: 0.548
Batch: 13/29	Loss: 0.593
Batch: 15/29	Loss: 0.608
Batch: 17/29	Loss: 0.629
Batch: 19/29	Loss: 0.626
Batch: 21/29	Loss: 0.605
Batch: 23/29	Loss: 0.565
Batch: 25/29	Loss: 0.539
Batch: 27/29	Loss: 0.562
Batch: 29/29	Loss: 0.521
Epoch: 7	Train Loss: 0.598	Val F1: 0.345
Best Epoch: 7	Best Val F1: 0.345

****************************** Epoch: 8 ******************************
Batch: 1/29	Loss: 0.555
Batch: 3/29	Loss: 0.537
Batch: 5/29	Loss: 0.579
Batch: 7/29	Loss: 0.595
Batch: 9/29	Loss: 0.498
Batch: 11/29	Loss: 0.611
Batch: 13/29	Loss: 0.594
Batch: 15/29	Loss: 0.509
Batch: 17/29	Loss: 0.620
Batch: 19/29	Loss: 0.543
Batch: 21/29	Loss: 0.557
Batch: 23/29	Loss: 0.698
Batch: 25/29	Loss: 0.701
Batch: 27/29	Loss: 0.552
Batch: 29/29	Loss: 0.576
Epoch: 8	Train Loss: 0.579	Val F1: 0.351
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 9 ******************************
Batch: 1/29	Loss: 0.581
Batch: 3/29	Loss: 0.548
Batch: 5/29	Loss: 0.544
Batch: 7/29	Loss: 0.464
Batch: 9/29	Loss: 0.606
Batch: 11/29	Loss: 0.562
Batch: 13/29	Loss: 0.608
Batch: 15/29	Loss: 0.513
Batch: 17/29	Loss: 0.510
Batch: 19/29	Loss: 0.448
Batch: 21/29	Loss: 0.593
Batch: 23/29	Loss: 0.513
Batch: 25/29	Loss: 0.459
Batch: 27/29	Loss: 0.630
Batch: 29/29	Loss: 0.391
Epoch: 9	Train Loss: 0.528	Val F1: 0.341
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 10 ******************************
Batch: 1/29	Loss: 0.407
Batch: 3/29	Loss: 0.515
Batch: 5/29	Loss: 0.460
Batch: 7/29	Loss: 0.462
Batch: 9/29	Loss: 0.453
Batch: 11/29	Loss: 0.425
Batch: 13/29	Loss: 0.583
Batch: 15/29	Loss: 0.523
Batch: 17/29	Loss: 0.539
Batch: 19/29	Loss: 0.413
Batch: 21/29	Loss: 0.544
Batch: 23/29	Loss: 0.571
Batch: 25/29	Loss: 0.591
Batch: 27/29	Loss: 0.461
Batch: 29/29	Loss: 0.546
Epoch: 10	Train Loss: 0.486	Val F1: 0.343
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 11 ******************************
Batch: 1/29	Loss: 0.510
Batch: 3/29	Loss: 0.406
Batch: 5/29	Loss: 0.629
Batch: 7/29	Loss: 0.490
Batch: 9/29	Loss: 0.420
Batch: 11/29	Loss: 0.442
Batch: 13/29	Loss: 0.460
Batch: 15/29	Loss: 0.339
Batch: 17/29	Loss: 0.490
Batch: 19/29	Loss: 0.453
Batch: 21/29	Loss: 0.420
Batch: 23/29	Loss: 0.361
Batch: 25/29	Loss: 0.376
Batch: 27/29	Loss: 0.398
Batch: 29/29	Loss: 0.439
Epoch: 11	Train Loss: 0.443	Val F1: 0.336
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 12 ******************************
Batch: 1/29	Loss: 0.503
Batch: 3/29	Loss: 0.380
Batch: 5/29	Loss: 0.397
Batch: 7/29	Loss: 0.427
Batch: 9/29	Loss: 0.444
Batch: 11/29	Loss: 0.410
Batch: 13/29	Loss: 0.418
Batch: 15/29	Loss: 0.345
Batch: 17/29	Loss: 0.404
Batch: 19/29	Loss: 0.397
Batch: 21/29	Loss: 0.373
Batch: 23/29	Loss: 0.401
Batch: 25/29	Loss: 0.397
Batch: 27/29	Loss: 0.491
Batch: 29/29	Loss: 0.309
Epoch: 12	Train Loss: 0.402	Val F1: 0.345
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 13 ******************************
Batch: 1/29	Loss: 0.427
Batch: 3/29	Loss: 0.322
Batch: 5/29	Loss: 0.416
Batch: 7/29	Loss: 0.375
Batch: 9/29	Loss: 0.458
Batch: 11/29	Loss: 0.460
Batch: 13/29	Loss: 0.370
Batch: 15/29	Loss: 0.408
Batch: 17/29	Loss: 0.324
Batch: 19/29	Loss: 0.244
Batch: 21/29	Loss: 0.329
Batch: 23/29	Loss: 0.392
Batch: 25/29	Loss: 0.309
Batch: 27/29	Loss: 0.427
Batch: 29/29	Loss: 0.492
Epoch: 13	Train Loss: 0.392	Val F1: 0.330
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 14 ******************************
Batch: 1/29	Loss: 0.442
Batch: 3/29	Loss: 0.389
Batch: 5/29	Loss: 0.302
Batch: 7/29	Loss: 0.358
Batch: 9/29	Loss: 0.464
Batch: 11/29	Loss: 0.409
Batch: 13/29	Loss: 0.343
Batch: 15/29	Loss: 0.338
Batch: 17/29	Loss: 0.406
Batch: 19/29	Loss: 0.464
Batch: 21/29	Loss: 0.227
Batch: 23/29	Loss: 0.305
Batch: 25/29	Loss: 0.431
Batch: 27/29	Loss: 0.372
Batch: 29/29	Loss: 0.418
Epoch: 14	Train Loss: 0.384	Val F1: 0.329
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 15 ******************************
Batch: 1/29	Loss: 0.351
Batch: 3/29	Loss: 0.369
Batch: 5/29	Loss: 0.249
Batch: 7/29	Loss: 0.334
Batch: 9/29	Loss: 0.382
Batch: 11/29	Loss: 0.343
Batch: 13/29	Loss: 0.324
Batch: 15/29	Loss: 0.357
Batch: 17/29	Loss: 0.373
Batch: 19/29	Loss: 0.360
Batch: 21/29	Loss: 0.392
Batch: 23/29	Loss: 0.367
Batch: 25/29	Loss: 0.402
Batch: 27/29	Loss: 0.324
Batch: 29/29	Loss: 0.387
Epoch: 15	Train Loss: 0.356	Val F1: 0.342
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 16 ******************************
Batch: 1/29	Loss: 0.367
Batch: 3/29	Loss: 0.324
Batch: 5/29	Loss: 0.414
Batch: 7/29	Loss: 0.267
Batch: 9/29	Loss: 0.355
Batch: 11/29	Loss: 0.329
Batch: 13/29	Loss: 0.339
Batch: 15/29	Loss: 0.245
Batch: 17/29	Loss: 0.312
Batch: 19/29	Loss: 0.366
Batch: 21/29	Loss: 0.271
Batch: 23/29	Loss: 0.371
Batch: 25/29	Loss: 0.347
Batch: 27/29	Loss: 0.300
Batch: 29/29	Loss: 0.355
Epoch: 16	Train Loss: 0.332	Val F1: 0.338
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 17 ******************************
Batch: 1/29	Loss: 0.301
Batch: 3/29	Loss: 0.334
Batch: 5/29	Loss: 0.312
Batch: 7/29	Loss: 0.280
Batch: 9/29	Loss: 0.240
Batch: 11/29	Loss: 0.366
Batch: 13/29	Loss: 0.423
Batch: 15/29	Loss: 0.340
Batch: 17/29	Loss: 0.344
Batch: 19/29	Loss: 0.312
Batch: 21/29	Loss: 0.323
Batch: 23/29	Loss: 0.358
Batch: 25/29	Loss: 0.190
Batch: 27/29	Loss: 0.302
Batch: 29/29	Loss: 0.352
Epoch: 17	Train Loss: 0.312	Val F1: 0.345
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 18 ******************************
Batch: 1/29	Loss: 0.290
Batch: 3/29	Loss: 0.360
Batch: 5/29	Loss: 0.275
Batch: 7/29	Loss: 0.265
Batch: 9/29	Loss: 0.407
Batch: 11/29	Loss: 0.230
Batch: 13/29	Loss: 0.233
Batch: 15/29	Loss: 0.323
Batch: 17/29	Loss: 0.273
Batch: 19/29	Loss: 0.217
Batch: 21/29	Loss: 0.337
Batch: 23/29	Loss: 0.321
Batch: 25/29	Loss: 0.297
Batch: 27/29	Loss: 0.208
Batch: 29/29	Loss: 0.327
Epoch: 18	Train Loss: 0.298	Val F1: 0.335
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 19 ******************************
Batch: 1/29	Loss: 0.213
Batch: 3/29	Loss: 0.213
Batch: 5/29	Loss: 0.335
Batch: 7/29	Loss: 0.339
Batch: 9/29	Loss: 0.248
Batch: 11/29	Loss: 0.278
Batch: 13/29	Loss: 0.358
Batch: 15/29	Loss: 0.287
Batch: 17/29	Loss: 0.269
Batch: 19/29	Loss: 0.358
Batch: 21/29	Loss: 0.264
Batch: 23/29	Loss: 0.296
Batch: 25/29	Loss: 0.341
Batch: 27/29	Loss: 0.250
Batch: 29/29	Loss: 0.250
Epoch: 19	Train Loss: 0.289	Val F1: 0.335
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 20 ******************************
Batch: 1/29	Loss: 0.312
Batch: 3/29	Loss: 0.299
Batch: 5/29	Loss: 0.240
Batch: 7/29	Loss: 0.209
Batch: 9/29	Loss: 0.262
Batch: 11/29	Loss: 0.283
Batch: 13/29	Loss: 0.250
Batch: 15/29	Loss: 0.254
Batch: 17/29	Loss: 0.288
Batch: 19/29	Loss: 0.293
Batch: 21/29	Loss: 0.264
Batch: 23/29	Loss: 0.263
Batch: 25/29	Loss: 0.233
Batch: 27/29	Loss: 0.307
Batch: 29/29	Loss: 0.431
Epoch: 20	Train Loss: 0.275	Val F1: 0.338
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 21 ******************************
Batch: 1/29	Loss: 0.269
Batch: 3/29	Loss: 0.328
Batch: 5/29	Loss: 0.272
Batch: 7/29	Loss: 0.455
Batch: 9/29	Loss: 0.347
Batch: 11/29	Loss: 0.217
Batch: 13/29	Loss: 0.356
Batch: 15/29	Loss: 0.318
Batch: 17/29	Loss: 0.229
Batch: 19/29	Loss: 0.271
Batch: 21/29	Loss: 0.257
Batch: 23/29	Loss: 0.241
Batch: 25/29	Loss: 0.256
Batch: 27/29	Loss: 0.227
Batch: 29/29	Loss: 0.289
Epoch: 21	Train Loss: 0.292	Val F1: 0.342
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 22 ******************************
Batch: 1/29	Loss: 0.224
Batch: 3/29	Loss: 0.247
Batch: 5/29	Loss: 0.272
Batch: 7/29	Loss: 0.292
Batch: 9/29	Loss: 0.243
Batch: 11/29	Loss: 0.330
Batch: 13/29	Loss: 0.183
Batch: 15/29	Loss: 0.234
Batch: 17/29	Loss: 0.310
Batch: 19/29	Loss: 0.285
Batch: 21/29	Loss: 0.404
Batch: 23/29	Loss: 0.272
Batch: 25/29	Loss: 0.248
Batch: 27/29	Loss: 0.228
Batch: 29/29	Loss: 0.275
Epoch: 22	Train Loss: 0.262	Val F1: 0.336
Best Epoch: 8	Best Val F1: 0.351

****************************** Epoch: 23 ******************************
Batch: 1/29	Loss: 0.217
Batch: 3/29	Loss: 0.225
Batch: 5/29	Loss: 0.279
Batch: 7/29	Loss: 0.319
Batch: 9/29	Loss: 0.177
Batch: 11/29	Loss: 0.260
Batch: 13/29	Loss: 0.299
Batch: 15/29	Loss: 0.304
Batch: 17/29	Loss: 0.237
Batch: 19/29	Loss: 0.264
Batch: 21/29	Loss: 0.223
Batch: 23/29	Loss: 0.194
Batch: 25/29	Loss: 0.230
Batch: 27/29	Loss: 0.168
Batch: 29/29	Loss: 0.192
Epoch: 23	Train Loss: 0.243	Val F1: 0.331
Best Epoch: 8	Best Val F1: 0.351

Saving the best checkpoint....
Inference...
Test F1: 0.377	Test F1_Few: 0.454	Test F1_Zero: 0.368
