2025-02-08 16:08:12,904 - WARNING - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
2025-02-08 16:08:12,906 - INFO - Device: cuda:0
2025-02-08 16:08:13,109 - INFO - Device: cuda:1
2025-02-08 16:08:13,327 - INFO - Dataset split: 2777 training samples, 695 validation samples.
2025-02-08 16:08:13,434 - INFO - Dataset split: 2777 training samples, 695 validation samples.
2025-02-08 16:08:13,460 - INFO - Load pretrained SentenceTransformer: models
2025-02-08 16:08:13,554 - INFO - Load pretrained SentenceTransformer: models
2025-02-08 16:08:23,896 - INFO - [MEMORY] After graph construction: Memory Used: 13.65 GB; [GPU 0] Allocated: 29981.80 MB, Reserved: 35208.00 MB
2025-02-08 16:08:34,942 - INFO - [MEMORY] After model loading: Memory Used: 13.91 GB; [GPU 0] Allocated: 38728.69 MB, Reserved: 38808.00 MB
2025-02-08 16:08:38,190 - INFO - 
[INFO] Starting Epoch 1
2025-02-08 16:08:38,190 - INFO - 
[INFO] Starting Epoch 1
2025-02-08 16:14:54,589 - INFO - Epoch 1: Average Training Loss = 8.3632
2025-02-08 16:14:57,365 - INFO - ------------------------
----- TRAIN EPOCH 1 -----
----- DEBUG SAMPLE -----
Train Target Phrase Tokens: tensor([    1,  3408, 17253,   304,  4908,     2,     2], device='cuda:0')
Train Target Phrase: energy independence and security
Generated Phrase: umingrandoor scaling insane quien
Train Loss: 6.220234394073486
Train Sim Loss: 1.0342066287994385
Train Gen Loss: 6.220234394073486
Generated Tokens: tensor([[    1,     1,  9867, 24433, 11019, 19903, 21295, 20207],
        [    1,     1, 18654, 18047,  4371,  1230, 27650, 23397],
        [    1,     1, 10067,  5223, 23149, 15121, 14691,   304],
        [    1,     1,     1,  4658, 22090, 10790, 27237,  4785],
        [    1,     1, 24146, 11144,   395,   304,   304,  1760],
        [    1,     1, 28330,     1, 18538, 23801, 19096, 11216],
        [    1,     1, 10077, 15909, 24386, 12154, 12131,  6305],
        [    1,     1, 11566,   495,   810,   304,   304,  3287]],
       device='cuda:0')
Total gradient norm: 11.5091
------------------------
2025-02-08 16:14:57,365 - INFO - [MEMORY] After epoch 1: Memory Used: 17.79 GB; [GPU 0] Allocated: 61463.77 MB, Reserved: 69608.00 MB
2025-02-08 16:14:57,365 - INFO - Epoch 1: Average Training Loss = 8.3253
2025-02-08 16:18:03,224 - INFO - Epoch 1: Average Validation Loss = 6.4112
2025-02-08 16:19:07,009 - INFO - ------------------------
----- VALIDATION EPOCH 1 -----
----- DEBUG SAMPLE -----
Validation Target Phrase Tokens: tensor([    1,  6638,  5088,   302,  9981, 15981,     2,     2],
       device='cuda:0')
Validation Target Phrase: economic impact of spending cuts
Generated Phrase: hitting andline inun funding
Validation Loss: 6.1912841796875
Validation Sim Loss: 1.0378241539001465
Validation Gen Loss: 6.1912841796875
Validation Generated Tokens: tensor([[    1,     1, 17692,   304,  1081,   297,   370, 12131],
        [    1,     1,     1, 19734,  1304, 16454,  1760,  6765],
        [    1,     1,     1, 26002,  7120, 12131, 12939, 12131],
        [    1,     1, 19240, 28649,  9928, 10506,   332, 24376],
        [    1,     1,     1, 19690, 10364,   304, 10818,   304],
        [    1,     1,  2544,  5916, 21563, 16268,  2488,  4075],
        [    1,     1,  3341, 26260, 10687,  7573, 21184,  3206],
        [    1,     1,     1,  1144,   304, 28535, 15901,   304]],
       device='cuda:0')
------------------------
2025-02-08 16:19:07,012 - INFO - [MEMORY] After epoch 1: Memory Used: 18.81 GB; [GPU 0] Allocated: 61464.71 MB, Reserved: 77170.00 MB
2025-02-08 16:19:07,012 - INFO - Epoch 1: Average Validation Loss = 6.3568
2025-02-08 16:19:10,087 - INFO - 
[INFO] Starting Epoch 2
2025-02-08 16:19:10,087 - INFO - 
[INFO] Starting Epoch 2
2025-02-08 16:20:51,787 - INFO - Epoch 2: Average Training Loss = 5.0226
2025-02-08 16:20:54,433 - INFO - ------------------------
----- TRAIN EPOCH 2 -----
----- DEBUG SAMPLE -----
Train Target Phrase Tokens: tensor([    1, 17035, 17002,  4495,     2,     2,     2,     2],
       device='cuda:0')
Train Target Phrase: voting participation rights
Generated Phrase: partial jury policy policy policy
Train Loss: 4.442459583282471
Train Sim Loss: 1.0360686779022217
Train Gen Loss: 4.442459583282471
Generated Tokens: tensor([[    1,     1,     1,  4364, 19723,  4920,  4920,  4920],
        [    1,     1,     1,  8530,  7152, 10237,  2434, 13252],
        [    1,     1,     1,  9861,  9861,  6285,  9861,  9861],
        [    1,     1,     1,     1, 14164, 10369,   446,  8444],
        [    1,     1,     1,     1,  1640, 20447, 13886,  5797],
        [    1,     1,     1,  7603, 27228, 16917, 21715,  1582],
        [    1,     1,     1, 21325, 24095, 21715,   302,  8333],
        [    1,     1,     1,     1,  9735, 22907, 28709, 19843]],
       device='cuda:0')
Total gradient norm: 10.2943
------------------------
2025-02-08 16:20:54,434 - INFO - [MEMORY] After epoch 2: Memory Used: 18.90 GB; [GPU 0] Allocated: 61464.69 MB, Reserved: 71928.00 MB
2025-02-08 16:20:54,434 - INFO - Epoch 2: Average Training Loss = 5.0034
2025-02-08 16:21:08,750 - INFO - Epoch 2: Average Validation Loss = 3.6023
2025-02-08 16:21:15,615 - INFO - ------------------------
----- VALIDATION EPOCH 2 -----
----- DEBUG SAMPLE -----
Validation Target Phrase Tokens: tensor([    1,  6638,  5088,   302,  9981, 15981,     2,     2],
       device='cuda:0')
Validation Target Phrase: economic impact of spending cuts
Generated Phrase: detometry identification i
Validation Loss: 3.3851122856140137
Validation Sim Loss: 1.0378223657608032
Validation Gen Loss: 3.3851122856140137
Validation Generated Tokens: tensor([[    1,     1,     1,     1,  1276,  8289, 19451,   613],
        [    1,     1,     1,     1,     1,  6002,   466, 10066],
        [    1,     1,     1,  2758,  8326, 15637, 17050,   511],
        [    1,     1,     1,     1,  9861,  9861,  9861,  9861],
        [    1,     1,     1,     1,   771, 27864, 27377,  9915],
        [    1,     1,     1,   380,  2437, 12131, 12131, 12131],
        [    1,     1,     1,  6661,  2268, 13775,  9890, 10086],
        [    1,     1,     1, 10298, 22196,  6175, 10953,  6638]],
       device='cuda:0')
------------------------
2025-02-08 16:21:15,615 - INFO - [MEMORY] After epoch 2: Memory Used: 18.91 GB; [GPU 0] Allocated: 61464.71 MB, Reserved: 77208.00 MB
2025-02-08 16:21:15,615 - INFO - Epoch 2: Average Validation Loss = 3.5771
2025-02-08 16:21:17,862 - INFO - 
[INFO] Starting Epoch 3
2025-02-08 16:21:17,862 - INFO - 
[INFO] Starting Epoch 3
2025-02-08 16:22:55,104 - INFO - Epoch 3: Average Training Loss = 2.8380
2025-02-08 16:22:57,742 - INFO - ------------------------
----- TRAIN EPOCH 3 -----
----- DEBUG SAMPLE -----
Train Target Phrase Tokens: tensor([    1,  8467,   302,  8666,   304,  4052, 20590], device='cuda:0')
Train Target Phrase: freedom of speech and misinformation
Generated Phrase: happiness healthulative federal
Train Loss: 3.094029188156128
Train Sim Loss: 1.0391120910644531
Train Gen Loss: 3.094029188156128
Generated Tokens: tensor([[    1,     1,     1,     1, 15079,  2528, 20851,  8432],
        [    1,     1,     1,   509, 12108,  6226,  5469,  5469],
        [    1,     1,     1, 10629,   505,  1464, 25430, 27539],
        [    1,     1,     1,     1, 26653,  3502, 18164,   495],
        [    1,     1,     1, 22692, 11881, 28705,  2591,   772],
        [    1,     1,     1,     1, 28726,   425,   837,   840],
        [    1,     1,     1,  9579, 22088,  6024, 17035,  5469],
        [    1,     1,     1,  9973, 14219,  4139,  4139,   466]],
       device='cuda:0')
Total gradient norm: 9.2230
------------------------
2025-02-08 16:22:57,743 - INFO - [MEMORY] After epoch 3: Memory Used: 18.95 GB; [GPU 0] Allocated: 61463.72 MB, Reserved: 66448.00 MB
2025-02-08 16:22:57,743 - INFO - Epoch 3: Average Training Loss = 2.7726
2025-02-08 16:23:12,029 - INFO - Epoch 3: Average Validation Loss = 2.0762
2025-02-08 16:23:18,902 - INFO - ------------------------
----- VALIDATION EPOCH 3 -----
----- DEBUG SAMPLE -----
Validation Target Phrase Tokens: tensor([    1,  6638,  5088,   302,  9981, 15981,     2,     2],
       device='cuda:0')
Validation Target Phrase: economic impact of spending cuts
Generated Phrase: copied violence climate climate
Validation Loss: 1.7426985502243042
Validation Sim Loss: 1.0378209352493286
Validation Gen Loss: 1.7426985502243042
Validation Generated Tokens: tensor([[    1,     1,     1,     1, 23773,  9165, 11259, 11259],
        [    1,     1,     1,     1,   479,  8657,  4885,  2525],
        [    1,     1,     1,     1, 22986, 10864, 10864, 10864],
        [    1,     1,     1,  2488,  3469,  4099,  2528,  2528],
        [    1,     1,     1,     1,     1, 20848,  4052,  9915],
        [    1,     1,     1,     1,     1,  5469,  5469,  5469],
        [    1,     1,     1,  8326,  8326,  8326,  2735,  4607],
        [    1,     1,     1,     1, 21246, 15981, 15981, 15981]],
       device='cuda:0')
------------------------
2025-02-08 16:23:18,903 - INFO - [MEMORY] After epoch 3: Memory Used: 18.97 GB; [GPU 0] Allocated: 61464.71 MB, Reserved: 77168.00 MB
2025-02-08 16:23:18,903 - INFO - Epoch 3: Average Validation Loss = 2.0212
2025-02-08 16:23:21,081 - INFO - 
[INFO] Starting Epoch 4
2025-02-08 16:23:21,081 - INFO - 
[INFO] Starting Epoch 4
2025-02-08 16:24:58,228 - INFO - Epoch 4: Average Training Loss = 2.5266
2025-02-08 16:25:00,848 - INFO - ------------------------
----- TRAIN EPOCH 4 -----
----- DEBUG SAMPLE -----
Train Target Phrase Tokens: tensor([    1, 22907, 25741,  8147,   960,     2,     2,     2],
       device='cuda:0')
Train Target Phrase: abortion survivors protection act
Generated Phrase: support support support reserve
Train Loss: 3.3911755084991455
Train Sim Loss: 1.0415478944778442
Train Gen Loss: 3.3911755084991455
Generated Tokens: tensor([[    1,     1,     1,     1,  1760,  1760,  1760, 17575],
        [    1,     1,     1, 24843,  1741,  1760,  1962,   837],
        [    1,     1,  4139, 28710,  3332, 10953, 22851, 15405],
        [    1,     1, 18164,  9035, 14219,  7709, 14902,  2602],
        [    1,     1,  2787,  1760,  2525, 10369,  8175,  4582],
        [    1,     1,     1,  9800,  5714,   282,   271, 23354],
        [    1,     1,     1,   282, 22581, 22907,   277,  2386],
        [    1,     1, 10165, 17320,   798, 17253,   885,  5823]],
       device='cuda:0')
Total gradient norm: 15.0163
------------------------
2025-02-08 16:25:00,848 - INFO - [MEMORY] After epoch 4: Memory Used: 19.21 GB; [GPU 0] Allocated: 61464.69 MB, Reserved: 71908.00 MB
2025-02-08 16:25:00,848 - INFO - Epoch 4: Average Training Loss = 2.4990
2025-02-08 16:25:15,153 - INFO - Epoch 4: Average Validation Loss = 3.0107
2025-02-08 16:25:17,047 - INFO - No improvement for 1 epoch(s). Best val loss: 2.0762
2025-02-08 16:25:22,029 - INFO - ------------------------
----- VALIDATION EPOCH 4 -----
----- DEBUG SAMPLE -----
Validation Target Phrase Tokens: tensor([    1,  6638,  5088,   302,  9981, 15981,     2,     2],
       device='cuda:0')
Validation Target Phrase: economic impact of spending cuts
Generated Phrase: down fundsative vaccine
Validation Loss: 2.6222379207611084
Validation Sim Loss: 1.0378201007843018
Validation Gen Loss: 2.6222379207611084
Validation Generated Tokens: tensor([[    1,     1,     1,     1,  3254, 10419,  1197, 21250],
        [    1,     1,     1,  2528,  2437,  1760,  1760,   332],
        [    1,     1,     1,   297,   297,   297, 15981,   354],
        [    1,     1,     1,  2602, 28742, 28713, 28713, 28713],
        [    1,     1,     1,     1,   287, 18164,   287, 13980],
        [    1,     1,     1,     1,   286,   298,   298, 26653],
        [    1,     1,     1,  2930,  2528,  2528,  4495,   298],
        [    1,     1,     1,  2708,  1760, 15240, 15240,  3332]],
       device='cuda:0')
------------------------
2025-02-08 16:25:22,030 - INFO - [MEMORY] After epoch 4: Memory Used: 19.01 GB; [GPU 0] Allocated: 61464.71 MB, Reserved: 77130.00 MB
2025-02-08 16:25:22,030 - INFO - Epoch 4: Average Validation Loss = 2.9375
2025-02-08 16:25:24,271 - INFO - No improvement for 1 epoch(s). Best val loss: 2.0212
2025-02-08 16:25:24,273 - INFO - 
[INFO] Starting Epoch 5
2025-02-08 16:25:24,273 - INFO - 
[INFO] Starting Epoch 5
2025-02-08 16:27:00,116 - INFO - Epoch 5: Average Training Loss = 3.8152
2025-02-08 16:27:02,718 - INFO - ------------------------
----- TRAIN EPOCH 5 -----
----- DEBUG SAMPLE -----
Train Target Phrase Tokens: tensor([   1,  521,  323, 3086,  276,  823, 2436, 2007,  837,  416, 1339],
       device='cuda:0')
Train Target Phrase: unaccompanied children program amendments
Generated Phrase: oversins oil research defense protection concerns
Train Loss: 5.331656455993652
Train Sim Loss: 1.0252008438110352
Train Gen Loss: 5.331656455993652
Generated Tokens: tensor([[    1, 13775,  1126,  5503,  3332,  9968,  8147, 10864],
        [    1,     1,     1, 15988, 24843, 12106, 28714,  4139],
        [    1,     1, 28740,  1843,  8147,  3058,  1022, 14218],
        [    1,     1,  8432, 27702,   282, 12745,  1837,  4139],
        [    1,     1,   313,   454,   332,  5469, 15240,   592],
        [    1,  3058,  6765,   332,  9890,   354,  6511,  9981],
        [    1, 16117,     1,  6765,  6765,  3408,  2809,   771],
        [    1,     1, 21567,  2899,  6765,   484,  5411,  2628]],
       device='cuda:0')
Total gradient norm: 28.0178
------------------------
2025-02-08 16:27:02,719 - INFO - [MEMORY] After epoch 5: Memory Used: 19.00 GB; [GPU 0] Allocated: 61467.61 MB, Reserved: 66448.00 MB
2025-02-08 16:27:02,719 - INFO - Epoch 5: Average Training Loss = 3.8564
2025-02-08 16:27:16,957 - INFO - Epoch 5: Average Validation Loss = 4.1176
2025-02-08 16:27:18,890 - INFO - No improvement for 2 epoch(s). Best val loss: 2.0762
2025-02-08 16:27:23,845 - INFO - ------------------------
----- VALIDATION EPOCH 5 -----
----- DEBUG SAMPLE -----
Validation Target Phrase Tokens: tensor([    1,  6638,  5088,   302,  9981, 15981,     2,     2],
       device='cuda:0')
Validation Target Phrase: economic impact of spending cuts
Generated Phrase: on ofid authorityid trans
Validation Loss: 3.7157235145568848
Validation Sim Loss: 1.0378198623657227
Validation Gen Loss: 3.7157235145568848
Validation Generated Tokens: tensor([[    1,     1,   356,   302,   313,  9637,   313,  1203],
        [    1,     1, 12507,  6765,  4908,  4908, 12131, 21715],
        [    1,     1,     1,  4139,  4139, 27560,  1803,   282],
        [    1,     1,  1665, 10864,   297,  4908, 14218, 28713],
        [    1,     1, 12866, 26447, 15885,  1022,  4920,  9981],
        [    1,     1, 15405, 17035,  9890,  9968,  3559,  8147],
        [    1,     1,  3332,   313, 21715,   454, 22470,   297],
        [    1,     1, 28733,  1665,  4920,  4495, 21567, 13775]],
       device='cuda:0')
------------------------
2025-02-08 16:27:23,845 - INFO - [MEMORY] After epoch 5: Memory Used: 19.02 GB; [GPU 0] Allocated: 61464.71 MB, Reserved: 77188.00 MB
2025-02-08 16:27:23,845 - INFO - Epoch 5: Average Validation Loss = 4.0628
2025-02-08 16:27:26,115 - INFO - No improvement for 2 epoch(s). Best val loss: 2.0212
2025-02-08 16:27:26,117 - INFO - 
[INFO] Starting Epoch 6
2025-02-08 16:27:26,117 - INFO - 
[INFO] Starting Epoch 6
2025-02-08 16:29:07,165 - INFO - Epoch 6: Average Training Loss = 5.8360
2025-02-08 16:29:10,058 - INFO - ------------------------
----- TRAIN EPOCH 6 -----
----- DEBUG SAMPLE -----
Train Target Phrase Tokens: tensor([    1,   805, 27562,  1605,  8317,  8743,     2,     2,     2],
       device='cuda:0')
Train Target Phrase: offshore drilling ban
Generated Phrase: and and crisisbersic change
Train Loss: 5.3569817543029785
Train Sim Loss: 1.031315803527832
Train Gen Loss: 5.3569817543029785
Generated Tokens: tensor([[    1,   304,     1,   304, 10788,  1891,   294,  2268],
        [    1,  5362,  8147,  7223,  6409,  4262,     1,  1164],
        [    1,     1,   304,   279,   356, 23449,   304,   312],
        [    1, 21590,  4920,  1002,   298,     1,  9968,   298],
        [    1,     1,   285,   302,  1339,  5469,  2564,   294],
        [    1,     1,  4262, 14218,   304,  3339,  2708,  8265],
        [    1, 28713,  3408,  6765, 28479, 18164,     1,  6765],
        [    1,     1, 28750, 22470,   304,   798, 28713, 12131]],
       device='cuda:0')
Total gradient norm: 6.3746
------------------------
2025-02-08 16:29:10,058 - INFO - [MEMORY] After epoch 6: Memory Used: 19.03 GB; [GPU 0] Allocated: 61465.76 MB, Reserved: 71928.00 MB
2025-02-08 16:29:10,058 - INFO - Epoch 6: Average Training Loss = 5.7845
2025-02-08 16:29:24,284 - INFO - Epoch 6: Average Validation Loss = 5.6909
2025-02-08 16:29:26,156 - INFO - No improvement for 3 epoch(s). Best val loss: 2.0762
2025-02-08 16:29:31,156 - INFO - ------------------------
----- VALIDATION EPOCH 6 -----
----- DEBUG SAMPLE -----
Validation Target Phrase Tokens: tensor([    1,  6638,  5088,   302,  9981, 15981,     2,     2],
       device='cuda:0')
Validation Target Phrase: economic impact of spending cuts
Generated Phrase: reform climate defenseipartications labor assistance
Validation Loss: 5.33548641204834
Validation Sim Loss: 1.0378177165985107
Validation Gen Loss: 5.33548641204834
Validation Generated Tokens: tensor([[    1,  9861, 11259,  9968, 26653, 10399,  7579, 11611],
        [    1, 15976,   302,  6582,     1,  1494,  4282,  6175],
        [    1,  8432,     1,  1103, 22907,  7498,   304,   960],
        [    1, 13775,     1,  5113, 10953,  4920,  4908,  9968],
        [    1,  7223,  9311,     1,   298,  4139,  6175, 27562],
        [    1,  6584,  4875,  3408,  6175,     1,  1220,   304],
        [    1,  4382, 11259, 28750,  3408,   304,  9968,     1],
        [    1,  2708, 11380,     1,  4382,   298,   304,  3408]],
       device='cuda:0')
------------------------
2025-02-08 16:29:31,156 - INFO - [MEMORY] After epoch 6: Memory Used: 19.04 GB; [GPU 0] Allocated: 61464.71 MB, Reserved: 77230.00 MB
2025-02-08 16:29:31,156 - INFO - Epoch 6: Average Validation Loss = 5.6617
2025-02-08 16:29:33,474 - INFO - No improvement for 3 epoch(s). Best val loss: 2.0212
2025-02-08 16:29:33,477 - INFO - 
[INFO] Starting Epoch 7
2025-02-08 16:29:33,477 - INFO - 
[INFO] Starting Epoch 7
2025-02-08 16:31:15,726 - INFO - Epoch 7: Average Training Loss = 5.5298
2025-02-08 16:31:18,329 - INFO - ------------------------
----- TRAIN EPOCH 7 -----
----- DEBUG SAMPLE -----
Train Target Phrase Tokens: tensor([   1, 6765, 4908, 4382,    2,    2,    2], device='cuda:0')
Train Target Phrase: border security issues
Generated Phrase: re democracy u energy customer gas tele
Train Loss: 6.004737854003906
Train Sim Loss: 1.0383644104003906
Train Gen Loss: 6.004737854003906
Generated Tokens: tensor([[    1,   312, 17548,   332,  3408,  6346,  5135,  6584],
        [    1,  2528,     1,  5362,  6175,  1760,   492,   298],
        [    1, 28723, 11487,  4638,  6661,  6933, 18920,  4474],
        [    1,     1,  2708,     1, 12131,  3715,  9968, 28723],
        [    1,     1,   272,  3345,   302,  1339,   304,  9968],
        [    1,  5362, 16837,  7876,  3254, 28528, 23324,   685],
        [    1,   349, 15273,   304, 21250,   288,   304,  5362],
        [    1,   332, 22907, 11092, 28723, 24937,     1, 28750]],
       device='cuda:0')
Total gradient norm: 6.6357
------------------------
2025-02-08 16:31:18,330 - INFO - [MEMORY] After epoch 7: Memory Used: 19.03 GB; [GPU 0] Allocated: 61463.71 MB, Reserved: 66448.00 MB
2025-02-08 16:31:18,330 - INFO - Epoch 7: Average Training Loss = 5.5603
2025-02-08 16:31:32,531 - INFO - Epoch 7: Average Validation Loss = 5.6619
2025-02-08 16:31:34,482 - INFO - No improvement for 4 epoch(s). Best val loss: 2.0762
2025-02-08 16:31:39,476 - INFO - ------------------------
----- VALIDATION EPOCH 7 -----
----- DEBUG SAMPLE -----
Validation Target Phrase Tokens: tensor([    1,  6638,  5088,   302,  9981, 15981,     2,     2],
       device='cuda:0')
Validation Target Phrase: economic impact of spending cuts
Generated Phrase: b cov rights to and support
Validation Loss: 5.338702201843262
Validation Sim Loss: 1.0378167629241943
Validation Gen Loss: 5.338702201843262
Validation Generated Tokens: tensor([[    1,     1,   287, 16609,  4495,   298,   304,  1760],
        [    1,     1,   454,  4908,   272, 28634, 17130, 12131],
        [    1,   497,  3408, 28733,  1760,  9861, 28733,  2437],
        [    1,  4355,   798,  2426,  1203, 21250, 28723,  3408],
        [    1,     1, 28710,  4786,  1345,  1532, 24937,  2136],
        [    1,  4495,  6175,   354, 10788,  1002,   298,  5084],
        [    1,   304,   915,  4920, 10864,  2437,   304,   281],
        [    1,     1,   354,   302,  7709,  8432,   304,  5362]],
       device='cuda:0')
------------------------
2025-02-08 16:31:39,477 - INFO - [MEMORY] After epoch 7: Memory Used: 19.05 GB; [GPU 0] Allocated: 61464.71 MB, Reserved: 77090.00 MB
2025-02-08 16:31:39,477 - INFO - Epoch 7: Average Validation Loss = 5.6494
2025-02-08 16:31:41,745 - INFO - No improvement for 4 epoch(s). Best val loss: 2.0212
2025-02-08 16:31:41,747 - INFO - 
[INFO] Starting Epoch 8
2025-02-08 16:31:41,747 - INFO - 
[INFO] Starting Epoch 8
2025-02-08 16:33:22,393 - INFO - Epoch 8: Average Training Loss = 5.5600
2025-02-08 16:33:25,465 - INFO - ------------------------
----- TRAIN EPOCH 8 -----
----- DEBUG SAMPLE -----
Train Target Phrase Tokens: tensor([    1,  5469, 18644,   304,  1872,  2161,     2,     2,     2,     2,
            2], device='cuda:0')
Train Target Phrase: military diversity and ideology
Generated Phrase: energy cuts social abortion in opposition
Train Loss: 5.738097667694092
Train Sim Loss: 1.047346591949463
Train Gen Loss: 5.738097667694092
Generated Tokens: tensor([[    1,  3408, 15981,  2809, 22907,     1,   297, 14218],
        [    1, 16837, 14218,  5965,  4875,   354,     1, 12476],
        [    1,   837, 28713,   302,     1, 11881, 22470, 24024],
        [    1,  2602, 16837,  9968,     1, 28723,  2437, 11092],
        [    1,     1, 26146,  1502,   304,  8265,  2426, 10318],
        [    1,     1,   295,  4920,   312,   307,   287,  8432],
        [    1,   332,   297, 28705,     1,   617,  5135,  5362],
        [    1,  8432, 12131, 28723,   592,   354,     1, 28714]],
       device='cuda:0')
Total gradient norm: 6.4499
------------------------
2025-02-08 16:33:25,466 - INFO - [MEMORY] After epoch 8: Memory Used: 19.06 GB; [GPU 0] Allocated: 61467.78 MB, Reserved: 71828.00 MB
2025-02-08 16:33:25,466 - INFO - Epoch 8: Average Training Loss = 5.5529
2025-02-08 16:33:39,859 - INFO - Epoch 8: Average Validation Loss = 5.6532
2025-02-08 16:33:41,671 - INFO - No improvement for 5 epoch(s). Best val loss: 2.0762
2025-02-08 16:33:46,691 - INFO - ------------------------
----- VALIDATION EPOCH 8 -----
----- DEBUG SAMPLE -----
Validation Target Phrase Tokens: tensor([    1,  6638,  5088,   302,  9981, 15981,     2,     2],
       device='cuda:0')
Validation Target Phrase: economic impact of spending cuts
Generated Phrase: health border account justice welfarees forces
Validation Loss: 5.3333234786987305
Validation Sim Loss: 1.0378148555755615
Validation Gen Loss: 5.3333234786987305
Validation Generated Tokens: tensor([[    1,  2528,  6765,  2708, 10754, 21607,   274,  6894],
        [    1, 17035,  4885,  1494, 28713,   287,   960,  3254],
        [    1,     1, 28713,  8465,  4908, 25060,   356, 21419],
        [    1,  6270,     1, 28740, 28714,  1308,  9968,  4495],
        [    1, 26146,   298,  1339,   297,  1760, 20396,     1],
        [    1,   304,   276, 17035,     1,   349,  2628, 24937],
        [    1,  4875,  4495,     1,   288,  9968,  8689,  9861],
        [    1,  2992,   697,  9968,     1,   938, 11092,  9890]],
       device='cuda:0')
------------------------
2025-02-08 16:33:46,691 - INFO - [MEMORY] After epoch 8: Memory Used: 19.06 GB; [GPU 0] Allocated: 61464.71 MB, Reserved: 77168.00 MB
2025-02-08 16:33:46,692 - INFO - Epoch 8: Average Validation Loss = 5.6354
2025-02-08 16:33:48,960 - INFO - No improvement for 5 epoch(s). Best val loss: 2.0212
2025-02-08 16:33:48,962 - INFO - 
[INFO] Starting Epoch 9
2025-02-08 16:33:48,962 - INFO - 
[INFO] Starting Epoch 9
2025-02-08 16:35:31,424 - INFO - Epoch 9: Average Training Loss = 5.5372
2025-02-08 16:35:34,109 - INFO - ------------------------
----- TRAIN EPOCH 9 -----
----- DEBUG SAMPLE -----
Train Target Phrase Tokens: tensor([    1, 16021, 24843,  5789,  2574,     2], device='cuda:0')
Train Target Phrase: precision agriculture connectivity
Generated Phrase: safety to vaccine on cyber invest
Train Loss: 6.11534309387207
Train Sim Loss: 1.039609432220459
Train Gen Loss: 6.11534309387207
Generated Tokens: tensor([[    1,  6661,     1,   298, 21250,   356, 23449,  2631],
        [    1, 12131, 20693,  5593,  9035, 10369,     1,  8427],
        [    1, 14218, 14679, 28713,     1,  6765, 28781,  9861],
        [    1,  6107,  5362,  1611,  5088,     1,  2130,  2708],
        [    1,   302,  4908,  5503,   374,   304,     1,  2090],
        [    1,  4069,  5362, 24146,  6765,  4920,   380, 28733],
        [    1,  8803, 19843,     1,  2268,   281, 11309,   354],
        [    1, 13359,     1,  6666, 11821,   302,  9784,  1002]],
       device='cuda:0')
Total gradient norm: 7.3747
------------------------
2025-02-08 16:35:34,109 - INFO - [MEMORY] After epoch 9: Memory Used: 19.06 GB; [GPU 0] Allocated: 61462.77 MB, Reserved: 69728.00 MB
2025-02-08 16:35:34,109 - INFO - Epoch 9: Average Training Loss = 5.5164
2025-02-08 16:35:48,432 - INFO - Epoch 9: Average Validation Loss = 5.6211
2025-02-08 16:35:50,269 - INFO - No improvement for 6 epoch(s). Best val loss: 2.0762
2025-02-08 16:35:55,339 - INFO - ------------------------
----- VALIDATION EPOCH 9 -----
----- DEBUG SAMPLE -----
Validation Target Phrase Tokens: tensor([    1,  6638,  5088,   302,  9981, 15981,     2,     2],
       device='cuda:0')
Validation Target Phrase: economic impact of spending cuts
Generated Phrase: c businesses reform u education2
Validation Loss: 5.288459777832031
Validation Sim Loss: 1.0378139019012451
Validation Gen Loss: 5.288459777832031
Validation Generated Tokens: tensor([[    1,     1, 28717,  8689,  9861,   332,  5362, 28750],
        [    1,     1,  4875,  5469,  3058,  1585, 24024, 28717],
        [    1,   304,  2369,     1,   304,  4920,  3058,  6966],
        [    1,  6175,   354,  7694, 14218,   304, 18644,     1],
        [    1, 15981, 14218,  1286,   354,  4908,  8432,  6584],
        [    1,     1, 23449,   915,  9802,  3136,   304, 17204],
        [    1,   297,     1,   685,   298, 14218,  2437,  8015],
        [    1,     1,  1760, 28705,  2007,   297,  3332, 28713]],
       device='cuda:0')
------------------------
2025-02-08 16:35:55,339 - INFO - [MEMORY] After epoch 9: Memory Used: 19.06 GB; [GPU 0] Allocated: 61464.71 MB, Reserved: 77228.00 MB
2025-02-08 16:35:55,339 - INFO - Epoch 9: Average Validation Loss = 5.5934
2025-02-08 16:35:57,517 - INFO - No improvement for 6 epoch(s). Best val loss: 2.0212
2025-02-08 16:35:57,519 - INFO - 
[INFO] Starting Epoch 10
2025-02-08 16:35:57,519 - INFO - 
[INFO] Starting Epoch 10
2025-02-08 16:37:32,487 - INFO - Epoch 10: Average Training Loss = 5.4375
2025-02-08 16:37:35,209 - INFO - ------------------------
----- TRAIN EPOCH 10 -----
----- DEBUG SAMPLE -----
Train Target Phrase Tokens: tensor([    1,  3408,  4885,   304, 21088,     2,     2,     2,     2,     2],
       device='cuda:0')
Train Target Phrase: energy production and conservation
Generated Phrase: resources standards overs production concernsun
Train Loss: 5.469912528991699
Train Sim Loss: 1.0159164667129517
Train Gen Loss: 5.469912528991699
Generated Tokens: tensor([[    1,  5823,  9890, 13775,  4885, 10864,   370,     1],
        [    1, 10864,   297,  3257,  1126,   288, 28723,   304],
        [    1, 18920,     1,  3332,   304,   305,  8114,  3587],
        [    1,     1,   304,  2708,  8689,   497, 21250,   307],
        [    1,   960,  8725,     1,  4382,  8506,   261,  3408],
        [    1, 23767,   288,  3408,     1,  8326,   805,   383],
        [    1, 24937,  5503,  2735,   370, 17575,  6966,  5503],
        [    1,  5135, 14218,  3889,  2096,  3408,     1,  1605]],
       device='cuda:0')
Total gradient norm: 7.9820
------------------------
2025-02-08 16:37:35,210 - INFO - [MEMORY] After epoch 10: Memory Used: 19.06 GB; [GPU 0] Allocated: 61466.68 MB, Reserved: 69768.00 MB
2025-02-08 16:37:35,210 - INFO - Epoch 10: Average Training Loss = 5.4082
2025-02-08 16:37:49,480 - INFO - Epoch 10: Average Validation Loss = 5.5614
2025-02-08 16:37:51,345 - INFO - No improvement for 7 epoch(s). Best val loss: 2.0762
2025-02-08 16:37:56,355 - INFO - ------------------------
----- VALIDATION EPOCH 10 -----
----- DEBUG SAMPLE -----
Validation Target Phrase Tokens: tensor([    1,  6638,  5088,   302,  9981, 15981,     2,     2],
       device='cuda:0')
Validation Target Phrase: economic impact of spending cuts
Generated Phrase: costs cuts parent procedure reform in
Validation Loss: 5.297460079193115
Validation Sim Loss: 1.037811040878296
Validation Gen Loss: 5.297460079193115
Validation Generated Tokens: tensor([[    1,     1,  6966, 15981,  2564, 10722,  9861,   297],
        [    1,   304,  6891,   297, 28740,   837,  4139,     1],
        [    1,  2708, 12077, 12131,   304, 10953,  5469,     1],
        [    1,   297,   297,  8002,   305, 10582, 28734,     1],
        [    1,  1197,   287,   297,     1,  3254,  5362,   298],
        [    1, 12745,   304,   304,     1,   497,   298,  4282],
        [    1,     1,  4282,  7034, 12476,  2065,  1203, 28479],
        [    1, 18644,  2007,     1,   313, 15981,   356,  9861]],
       device='cuda:0')
------------------------
2025-02-08 16:37:56,356 - INFO - [MEMORY] After epoch 10: Memory Used: 19.07 GB; [GPU 0] Allocated: 61464.71 MB, Reserved: 77128.00 MB
2025-02-08 16:37:56,356 - INFO - Epoch 10: Average Validation Loss = 5.5331
2025-02-08 16:37:58,549 - INFO - No improvement for 7 epoch(s). Best val loss: 2.0212
2025-02-08 16:37:58,552 - INFO - 
[INFO] Starting Epoch 11
2025-02-08 16:37:58,552 - INFO - 
[INFO] Starting Epoch 11
2025-02-08 16:39:40,376 - INFO - Epoch 11: Average Training Loss = 5.3346
2025-02-08 16:39:43,379 - INFO - ------------------------
----- TRAIN EPOCH 11 -----
----- DEBUG SAMPLE -----
Train Target Phrase Tokens: tensor([    1, 27560,  1656,  1587, 10788,     2], device='cuda:0')
Train Target Phrase: foster care system crisis
Generated Phrase: educationsecurityightendmentr crisis
Train Loss: 5.198712348937988
Train Sim Loss: 1.0357322692871094
Train Gen Loss: 5.198712348937988
Generated Tokens: tensor([[    1,  5362,     1, 10165,   454, 18920, 28712, 10788],
        [    1,  6661,   304, 10864,  1009,  2930,  4920, 19158],
        [    1,   304, 14218,     1,   304, 22146,   287, 10074],
        [    1,     1,  5362, 19410, 28774,   356,  9915,  5362],
        [    1,   297, 19046, 11259,  5088,     1,  2525,  4099],
        [    1,  8326, 11259,   304,  2735,  1759,     1, 27809],
        [    1, 12131,     1,   304,   304, 15981, 20904,   313],
        [    1, 22907, 28723, 23449,   354,  5716, 21715,     1]],
       device='cuda:0')
Total gradient norm: 7.7687
------------------------
2025-02-08 16:39:43,380 - INFO - [MEMORY] After epoch 11: Memory Used: 19.06 GB; [GPU 0] Allocated: 61462.88 MB, Reserved: 67908.00 MB
2025-02-08 16:39:43,380 - INFO - Epoch 11: Average Training Loss = 5.3428
2025-02-08 16:39:57,657 - INFO - Epoch 11: Average Validation Loss = 5.4473
2025-02-08 16:39:59,509 - INFO - No improvement for 8 epoch(s). Best val loss: 2.0762
2025-02-08 16:40:04,574 - INFO - ------------------------
----- VALIDATION EPOCH 11 -----
----- DEBUG SAMPLE -----
Validation Target Phrase Tokens: tensor([    1,  6638,  5088,   302,  9981, 15981,     2,     2],
       device='cuda:0')
Validation Target Phrase: economic impact of spending cuts
Generated Phrase: and border cuts in opposition reform abortion
Validation Loss: 5.0644731521606445
Validation Sim Loss: 1.0378097295761108
Validation Gen Loss: 5.0644731521606445
Validation Generated Tokens: tensor([[    1,   304,  6765, 15981,   297, 14218,  9861, 22907],
        [    1,  4282,  1002,   354,     1,  9680,  1467, 22692],
        [    1,   304, 27539,     1,  2528, 28723, 12131, 15981],
        [    1, 12131, 12106,  2708,  2735,  9680,     1,   297],
        [    1,   282,     1,  4908,  6765,  9915, 10864, 10582],
        [    1,  3947,  1197,  9861,   304,     1,  3332, 22907],
        [    1,   285,   960, 10419, 28774,     1, 16268,  6582],
        [    1,     1,  5362,  2052, 28723, 22907, 15981,  1203]],
       device='cuda:0')
------------------------
2025-02-08 16:40:04,575 - INFO - [MEMORY] After epoch 11: Memory Used: 19.07 GB; [GPU 0] Allocated: 61464.71 MB, Reserved: 77208.00 MB
2025-02-08 16:40:04,575 - INFO - Epoch 11: Average Validation Loss = 5.3836
2025-02-08 16:40:06,850 - INFO - No improvement for 8 epoch(s). Best val loss: 2.0212
2025-02-08 16:40:06,852 - INFO - 
[INFO] Starting Epoch 12
2025-02-08 16:40:06,852 - INFO - 
[INFO] Starting Epoch 12
2025-02-08 16:41:46,428 - INFO - Epoch 12: Average Training Loss = 5.2248
2025-02-08 16:41:49,209 - INFO - ------------------------
----- TRAIN EPOCH 12 -----
----- DEBUG SAMPLE -----
Train Target Phrase Tokens: tensor([   1, 8432, 9981, 6157,    2,    2,    2,    2,    2], device='cuda:0')
Train Target Phrase: federal spending levels
Generated Phrase: id politicsight forkr development am
Train Loss: 4.918160438537598
Train Sim Loss: 1.0440833568572998
Train Gen Loss: 4.918160438537598
Generated Tokens: tensor([[    1,   313,  9800,   454,   354,  6175,  4099,   837],
        [    1,  1837,   753,   416,  1164,  2300,   960,  2130],
        [    1,   288,  6966,   304, 24843, 14204,  3408,  3408],
        [    1,  4282,     1,  9680,  9861,  1760,  1760, 13775],
        [    1, 19410,  1022,     1,  7153, 17764,  5362, 15405],
        [    1,   798,   465,  4382,  4908,  6765, 10864,     1],
        [    1,     1, 10879,  5514,  8808,   753,  9579, 20855],
        [    1,   304,     1, 16837,  8432,  4273,   960,  4920]],
       device='cuda:0')
Total gradient norm: 8.2063
------------------------
2025-02-08 16:41:49,209 - INFO - [MEMORY] After epoch 12: Memory Used: 19.13 GB; [GPU 0] Allocated: 61465.73 MB, Reserved: 72088.00 MB
2025-02-08 16:41:49,209 - INFO - Epoch 12: Average Training Loss = 5.2192
2025-02-08 16:42:03,461 - INFO - Epoch 12: Average Validation Loss = 5.2536
2025-02-08 16:42:05,329 - INFO - No improvement for 9 epoch(s). Best val loss: 2.0762
2025-02-08 16:42:10,284 - INFO - ------------------------
----- VALIDATION EPOCH 12 -----
----- DEBUG SAMPLE -----
Validation Target Phrase Tokens: tensor([    1,  6638,  5088,   302,  9981, 15981,     2,     2],
       device='cuda:0')
Validation Target Phrase: economic impact of spending cuts
Generated Phrase: am1 department oppositionproduct vaccine
Validation Loss: 5.010227203369141
Validation Sim Loss: 1.0378077030181885
Validation Gen Loss: 5.010227203369141
Validation Generated Tokens: tensor([[    1,   837,     1, 28740,  9784, 14218,  5646, 21250],
        [    1,  4371,  2268,   304, 16128,   297,  2007,  3058],
        [    1,     1, 16837,  7034, 12131, 15885,  8432, 28713],
        [    1, 18164,     1,  4495,   297, 12131,  2528,   454],
        [    1,  5088,  3889, 12826, 11259,   297, 11821, 15885],
        [    1,  2887,  9861,  4382, 12745, 14679, 18164,   302],
        [    1,  4371,  2602,     1,  1741,  8432,  6183,  8147],
        [    1,   509,     1, 12832,   304,  8432,  2437, 10953]],
       device='cuda:0')
------------------------
2025-02-08 16:42:10,284 - INFO - [MEMORY] After epoch 12: Memory Used: 19.15 GB; [GPU 0] Allocated: 61464.71 MB, Reserved: 77150.00 MB
2025-02-08 16:42:10,284 - INFO - Epoch 12: Average Validation Loss = 5.2221
2025-02-08 16:42:12,562 - INFO - No improvement for 9 epoch(s). Best val loss: 2.0212
2025-02-08 16:42:12,564 - INFO - 
[INFO] Starting Epoch 13
2025-02-08 16:42:12,564 - INFO - 
[INFO] Starting Epoch 13
2025-02-08 16:43:49,992 - INFO - Epoch 13: Average Training Loss = 5.0654
2025-02-08 16:43:52,784 - INFO - ------------------------
----- TRAIN EPOCH 13 -----
----- DEBUG SAMPLE -----
Train Target Phrase Tokens: tensor([    1,  3947,   352,   304, 19046,     2,     2,     2,     2,     2,
            2], device='cuda:0')
Train Target Phrase: taxation and enforcement
Generated Phrase: andendment and shut d reform
Train Loss: 5.235089302062988
Train Sim Loss: 1.0378681421279907
Train Gen Loss: 5.235089302062988
Generated Tokens: tensor([[    1,     1,   304, 18920,   304,  6409,   281,  9861],
        [    1, 23449,     1, 12131,  2708,   304,  3254,   304],
        [    1,   304,  8147, 28774,  6966,  2437,   304,  5362],
        [    1, 20447,  9981, 16055,     1,  7861,   304,  1532],
        [    1,  2602, 10864,  2602,  8636, 11259,  4076,  6511],
        [    1, 28740, 28733,  2899,   304, 10165, 28723,  8432],
        [    1,   288, 28720,   304,  9981,  3058, 10953,  6765],
        [    1, 28634,  4371,   304, 25761,     1, 15405,  5362]],
       device='cuda:0')
Total gradient norm: 138.5803
------------------------
2025-02-08 16:43:52,785 - INFO - [MEMORY] After epoch 13: Memory Used: 19.21 GB; [GPU 0] Allocated: 61467.69 MB, Reserved: 66448.00 MB
2025-02-08 16:43:52,785 - INFO - Epoch 13: Average Training Loss = 5.0054
2025-02-08 16:44:07,018 - INFO - Epoch 13: Average Validation Loss = 5.3014
2025-02-08 16:44:08,854 - INFO - No improvement for 10 epoch(s). Best val loss: 2.0762
2025-02-08 16:44:08,855 - INFO - Early stopping triggered. No improvement observed.
2025-02-08 16:44:13,945 - INFO - ------------------------
----- VALIDATION EPOCH 13 -----
----- DEBUG SAMPLE -----
Validation Target Phrase Tokens: tensor([    1,  6638,  5088,   302,  9981, 15981,     2,     2],
       device='cuda:0')
Validation Target Phrase: economic impact of spending cuts
Generated Phrase: ability issues federal spending funding regulations
Validation Loss: 5.0467448234558105
Validation Sim Loss: 1.0378053188323975
Validation Gen Loss: 5.0467448234558105
Validation Generated Tokens: tensor([[    1,  2437,  4382,     1,  8432,  9981, 12131, 15885],
        [    1,     1,   298,   304,  2437,  5088, 18164,  9981],
        [    1,     1,  3947,  8147,   304,  2437,  4139, 18164],
        [    1,     1, 13359,   466,  5362,   798,  5362, 26653],
        [    1, 12745,  3408,     1, 16609,  7151,  3408,   304],
        [    1,  1759,     1,   304, 17764,  2437,   617, 15885],
        [    1,   285,     1,     1,  6661, 10165,  1126, 10784],
        [    1,  4052,     1,  1380, 14218,  3408, 11611, 12131]],
       device='cuda:0')
------------------------
2025-02-08 16:44:13,945 - INFO - [MEMORY] After epoch 13: Memory Used: 19.22 GB; [GPU 0] Allocated: 61464.71 MB, Reserved: 77228.00 MB
2025-02-08 16:44:13,945 - INFO - Epoch 13: Average Validation Loss = 5.2458
2025-02-08 16:44:16,258 - INFO - No improvement for 10 epoch(s). Best val loss: 2.0212
2025-02-08 16:44:16,259 - INFO - Early stopping triggered. No improvement observed.
2025-02-08 16:45:40,793 - INFO - Training complete and model saved to topic_taxonomy_expansion/models/trained_topic_expan_model_filtered_20250208_164416.pth
